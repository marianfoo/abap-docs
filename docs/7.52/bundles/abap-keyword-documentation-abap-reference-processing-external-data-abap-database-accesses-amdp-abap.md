# ABAP - Keyword Documentation / ABAP - Reference / Processing External Data / ABAP Database Accesses / AMDP - ABAP Managed Database Procedures / AMDP - Examples

Included pages: 13



## ðŸ”— Source References

**Base URL**: [ABAP Keyword Documentation 7.52](https://help.sap.com/doc/abapdocu_752_index_htm/7.52/en-US/index.htm)

**Individual Pages in this Bundle**:
- [abenamdp_abexas.htm](https://help.sap.com/doc/abapdocu_752_index_htm/7.52/en-US/abenamdp_abexas.htm)
- [abenamdp_abexa.htm](https://help.sap.com/doc/abapdocu_752_index_htm/7.52/en-US/abenamdp_abexa.htm)
- [abenamdp_call_amdp_abexa.htm](https://help.sap.com/doc/abapdocu_752_index_htm/7.52/en-US/abenamdp_call_amdp_abexa.htm)
- [abenamdp_call_abexa.htm](https://help.sap.com/doc/abapdocu_752_index_htm/7.52/en-US/abenamdp_call_abexa.htm)
- [abenamdp_polymorphism_abexa.htm](https://help.sap.com/doc/abapdocu_752_index_htm/7.52/en-US/abenamdp_polymorphism_abexa.htm)
- [abenamdp_changing_abexa.htm](https://help.sap.com/doc/abapdocu_752_index_htm/7.52/en-US/abenamdp_changing_abexa.htm)
- [abenamdp_connection_abexa.htm](https://help.sap.com/doc/abapdocu_752_index_htm/7.52/en-US/abenamdp_connection_abexa.htm)
- [abenmesh_amdp_abexa.htm](https://help.sap.com/doc/abapdocu_752_index_htm/7.52/en-US/abenmesh_amdp_abexa.htm)
- [abenamdp_vs_open_sql_abexa.htm](https://help.sap.com/doc/abapdocu_752_index_htm/7.52/en-US/abenamdp_vs_open_sql_abexa.htm)
- [abenamdp_functions_abexa.htm](https://help.sap.com/doc/abapdocu_752_index_htm/7.52/en-US/abenamdp_functions_abexa.htm)
- [abenamdp_abap_types_abexa.htm](https://help.sap.com/doc/abapdocu_752_index_htm/7.52/en-US/abenamdp_abap_types_abexa.htm)
- [abenamdp_db_schema_abexa.htm](https://help.sap.com/doc/abapdocu_752_index_htm/7.52/en-US/abenamdp_db_schema_abexa.htm)
- [abenamdp_l_abexa.htm](https://help.sap.com/doc/abapdocu_752_index_htm/7.52/en-US/abenamdp_l_abexa.htm)

**Bundle Contains**: 13 documentation pages
**Version**: ABAP 7.52
**Generated**: 2025-09-01T11:25:46.481Z

---

### abenamdp_abexas.htm

> **ðŸ“– Official SAP Documentation**: [abenamdp_abexas.htm](https://help.sap.com/doc/abapdocu_752_index_htm/7.52/en-US/abenamdp_abexas.htm)
> **ðŸ” Direct Link**: This section contains the complete content from the official SAP ABAP documentation page.


Â  

* * *

SAP NetWeaver AS ABAP Release 752, Â©Copyright 2017 SAP AG. All rights reserved.

[ABAP - Keyword Documentation](javascript:call_link\('abenabap.htm'\))Â â†’Â  [ABAP - Reference](javascript:call_link\('abenabap_reference.htm'\))Â â†’Â  [Processing External Data](javascript:call_link\('abenabap_language_external_data.htm'\))Â â†’Â  [ABAP Database Accesses](javascript:call_link\('abenabap_sql.htm'\))Â â†’Â  [AMDP - ABAP Managed Database Procedures](javascript:call_link\('abenamdp.htm'\))Â â†’Â 

AMDP - Examples

Continue
![Example](exa.gif "Example") [AMDP, Implementation of a SQLScript Procedure](javascript:call_link\('abenamdp_abexa.htm'\))
![Example](exa.gif "Example") [AMDP, Calling an AMDP Procedure from SQLScript](javascript:call_link\('abenamdp_call_amdp_abexa.htm'\))
![Example](exa.gif "Example") [AMDP, Calling an SQLScript Procedure from AMDP](javascript:call_link\('abenamdp_call_abexa.htm'\))
![Example](exa.gif "Example") [AMDP, AMDP Methods in Interfaces and Superclasses](javascript:call_link\('abenamdp_polymorphism_abexa.htm'\))
![Example](exa.gif "Example") [AMDP, SQL Script with Tabular CHANGING Parameter](javascript:call_link\('abenamdp_changing_abexa.htm'\))
![Example](exa.gif "Example") [AMDP, AMDP Method with Specified Service Connection](javascript:call_link\('abenamdp_connection_abexa.htm'\))
![Example](exa.gif "Example") [AMDP, Filling a Mesh with SQLScript](javascript:call_link\('abenmesh_amdp_abexa.htm'\))
![Example](exa.gif "Example") [AMDP, Comparison of SQLScript with Open SQL](javascript:call_link\('abenamdp_vs_open_sql_abexa.htm'\))
![Example](exa.gif "Example") [AMDP, AMDP Functions](javascript:call_link\('abenamdp_functions_abexa.htm'\))
![Example](exa.gif "Example") [AMDP, Access to ABAP Types](javascript:call_link\('abenamdp_abap_types_abexa.htm'\))
![Example](exa.gif "Example") [AMDP, Access to Database Schemas](javascript:call_link\('abenamdp_db_schema_abexa.htm'\))
![Example](exa.gif "Example") [AMDP, Implementation of an L Procedure](javascript:call_link\('abenamdp_l_abexa.htm'\))



**ðŸ“– Source**: [abenamdp_abexas.htm](https://help.sap.com/doc/abapdocu_752_index_htm/7.52/en-US/abenamdp_abexas.htm)

### abenamdp_abexa.htm

> **ðŸ“– Official SAP Documentation**: [abenamdp_abexa.htm](https://help.sap.com/doc/abapdocu_752_index_htm/7.52/en-US/abenamdp_abexa.htm)
> **ðŸ” Direct Link**: This section contains the complete content from the official SAP ABAP documentation page.


Â  

* * *

SAP NetWeaver AS ABAP Release 752, Â©Copyright 2017 SAP AG. All rights reserved.

[ABAP - Keyword Documentation](javascript:call_link\('abenabap.htm'\))Â â†’Â  [ABAP - Reference](javascript:call_link\('abenabap_reference.htm'\))Â â†’Â  [Processing External Data](javascript:call_link\('abenabap_language_external_data.htm'\))Â â†’Â  [ABAP Database Accesses](javascript:call_link\('abenabap_sql.htm'\))Â â†’Â  [AMDP - ABAP Managed Database Procedures](javascript:call_link\('abenamdp.htm'\))Â â†’Â  [AMDP - Examples](javascript:call_link\('abenamdp_abexas.htm'\))Â â†’Â 

AMDP, Implementation of a SQLScript Procedure

This example demonstrates how an SQLScript procedure is implemented using AMDP.

Source Code

REPORT demo\_amdp.
CLASS demo DEFINITION.
Â Â PUBLIC SECTION.
Â Â Â Â CLASS-METHODS main.
ENDCLASS.
CLASS demo IMPLEMENTATION.
Â Â METHOD main.
Â Â Â Â IF NOT cl\_abap\_dbfeatures=>use\_features(
Â Â Â Â Â Â Â Â Â Â EXPORTING
Â Â Â Â Â Â Â Â Â Â Â Â requested\_features =
Â Â Â Â Â Â Â Â Â Â Â Â Â Â VALUE #( ( cl\_abap\_dbfeatures=>call\_amdp\_method ) ) ).
Â Â Â Â Â Â cl\_demo\_output=>display(
Â Â Â Â Â Â Â Â \`Current database system does not support AMDP procedures\` ).
Â Â Â Â Â Â RETURN.
Â Â Â Â ENDIF.
Â Â Â Â DATA incprice TYPE sflight-price VALUE '0.1'.
Â Â Â Â DATA(client)Â Â Â Â  = abap\_false.
Â Â Â Â DATA(cds\_client) = abap\_false.
Â Â Â Â cl\_demo\_input=>new(
Â Â Â Â Â Â )->add\_field( CHANGING
Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â field = incprice
Â Â Â Â Â Â )->add\_field( EXPORTING
Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â as\_checkbox = abap\_true
Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â textÂ Â Â Â Â Â Â Â = \`Use session variable CLIENT\`
Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â CHANGING
Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â field = client
Â Â Â Â Â Â )->add\_field( EXPORTING
Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â as\_checkbox = abap\_true
Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â  Â Â Â Â textÂ Â Â Â Â Â Â Â = \`Use session variable CDS\_CLIENT\`
Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â CHANGING
Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â field = cds\_client
Â Â Â Â Â Â )->request( ).
Â Â Â Â IF incprice IS INITIAL OR
Â Â Â Â Â Â  client IS NOT INITIAL AND cds\_client IS NOT INITIAL.
Â Â Â Â Â Â RETURN.
Â Â Â Â ENDIF.
Â Â Â Â SELECT price
Â Â Â Â Â Â Â Â Â Â  FROM sflight
Â Â Â Â Â Â Â Â Â Â  ORDER BY carrid, connid, fldate
Â Â Â Â Â Â Â Â Â Â  INTO @DATA(price\_before)
Â Â Â Â Â Â Â Â Â Â  UP TO 1 ROWS.
Â Â Â Â ENDSELECT.
Â Â Â Â IF client IS INITIAL AND cds\_client IS INITIAL.
Â Â Â Â Â Â TRY.
Â Â Â Â Â Â Â Â Â Â NEW cl\_demo\_amdp(
Â Â Â Â Â Â Â Â Â Â Â Â )->increase\_price( clnt = sy-mandt
Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â  incÂ Â = incprice ).
Â Â Â Â Â Â Â Â CATCH cx\_amdp\_error INTO DATA(amdp\_error).
Â Â Â Â Â Â Â Â Â Â cl\_demo\_output=>display( amdp\_error->get\_text( ) ).
Â Â Â Â Â Â Â Â Â Â RETURN.
Â Â Â Â Â Â ENDTRY.
Â Â Â Â ELSEIF client IS NOT INITIAL.
Â Â Â Â Â Â TRY.
Â Â Â Â Â Â Â Â Â Â NEW cl\_demo\_amdp(
Â Â Â Â Â Â Â Â Â Â Â Â )->increase\_price\_client( incÂ Â = incprice ).
Â Â Â Â Â Â Â Â CATCH cx\_amdp\_error INTO amdp\_error.
Â Â Â Â Â Â Â Â Â Â cl\_demo\_output=>display( amdp\_error->get\_text( ) ).
Â Â Â Â Â Â Â Â Â Â RETURN.
Â Â Â Â Â Â ENDTRY.
Â Â Â Â ELSEIF cds\_client IS NOT INITIAL.
Â Â Â Â Â Â TRY.
Â Â Â Â Â Â Â Â Â Â NEW cl\_demo\_amdp(
Â Â Â Â Â Â Â Â Â Â Â Â )->increase\_price\_cds\_client( incÂ Â = incprice ).
Â Â Â Â Â Â Â Â CATCH cx\_amdp\_error INTO amdp\_error.
Â Â Â Â Â Â Â Â Â Â cl\_demo\_output=>display( amdp\_error->get\_text( ) ).
Â Â Â Â Â Â Â Â Â Â RETURN.
Â Â Â Â Â Â ENDTRY.
Â Â Â Â ENDIF.
Â Â Â Â SELECT price
Â Â Â Â Â Â Â Â Â Â  FROM sflight
Â Â Â Â Â Â Â Â Â Â  ORDER BY carrid, connid, fldate
Â Â Â Â Â Â Â Â Â Â  INTO @DATA(price\_after)
Â Â Â Â Â Â Â Â Â Â  UP TO 1 ROWS.
Â Â Â Â ENDSELECT.
Â Â Â Â IF price\_after - price\_before = incprice.
Â Â Â Â Â Â cl\_demo\_output=>display( \`Price increased succesfully\` ).
Â Â Â Â ENDIF.Â Â ENDMETHOD.
ENDCLASS.
START-OF-SELECTION.
Â Â demo=>main( ).

Description

A simple [SQLScript procedure](javascript:call_link\('abensql_script_procedure_glosry.htm'\) "Glossary Entry") is implemented in three AMDP methods (showing the different options for self-defined [client handling](javascript:call_link\('abenamdp_client_handling.htm'\))) in the AMDP class CL\_DEMO\_AMDP:

-   INCREASE\_PRICE

METHOD increase\_price BY DATABASE PROCEDURE FOR HDB
Â Â Â Â  Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â  LANGUAGE SQLSCRIPT
Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â  USING sflight.
Â Â update sflight set price = price + :inc
Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â  where mandt = :clnt;
ENDMETHOD.

In this implementation, the input parameter clnt is used to access the data of the passed client, as [recommended](javascript:call_link\('abenamdp_client_handling.htm'\)).

-   INCREASE\_PRICE\_CLIENT

METHOD increase\_price\_client BY DATABASE PROCEDURE FOR HDB
Â Â Â  Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â  LANGUAGE SQLSCRIPT
Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â  USING sflight.
Â Â update sflight set price = price + :inc
Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â  where mandt = SESSION\_CONTEXT('CLIENT');
ENDMETHOD.

In this implementation, the [ABAP-specific session variable](javascript:call_link\('abenhana_session_variables.htm'\)) CLIENT is used to access the data of the current client.

-   INCREASE\_PRICE\_CDS\_CLIENT

METHOD increase\_price\_cds\_client BY DATABASE PROCEDURE FOR HDB
Â Â Â  Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â  LANGUAGE SQLSCRIPT
Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â  Â Â Â Â Â Â Â Â Â Â Â Â Â Â  USING sflight.
Â Â update sflight set price = price + :inc
Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â  where mandt = SESSION\_CONTEXT('CDS\_CLIENT');
ENDMETHOD.

In this implementation, the [ABAP-specific session variable](javascript:call_link\('abenhana_session_variables.htm'\)) CDS\_CLIENT is used to access the data of the current client. The addition [AMDP OPTIONS CDS SESSION CLIENT CURRENT](javascript:call_link\('abapmethods_amdp_options.htm'\)) is used for this purpose in the declaration of the method.

The database table SPFLI defined in ABAP Dictionary must be specified after USING. On a SAP HANA database, this program works in the same way as the executable examples for [ADBC](javascript:call_link\('abenadbc_procedure_abexa.htm'\)) and for [CALL DATABASE PROCEDURE](javascript:call_link\('abencall_db_procedure_abexa.htm'\)). AMDP replaces these technologies when calling database procedures for an SAP HANA database that is the [standard database](javascript:call_link\('abenstandard_db_glosry.htm'\) "Glossary Entry") of an AS ABAP.

It is generally preferable to pass the client ID to an input parameter of a use of the ABAP-specific session variable CLIENT or CDS\_CLIENT.

Note

This is a syntax example. The same function can be provided with the same efficiency in Open SQL. AMDP is not needed in simple cases like this.



**ðŸ“– Source**: [abenamdp_abexa.htm](https://help.sap.com/doc/abapdocu_752_index_htm/7.52/en-US/abenamdp_abexa.htm)

### abenamdp_call_amdp_abexa.htm

> **ðŸ“– Official SAP Documentation**: [abenamdp_call_amdp_abexa.htm](https://help.sap.com/doc/abapdocu_752_index_htm/7.52/en-US/abenamdp_call_amdp_abexa.htm)
> **ðŸ” Direct Link**: This section contains the complete content from the official SAP ABAP documentation page.


Â  

* * *

SAP NetWeaver AS ABAP Release 752, Â©Copyright 2017 SAP AG. All rights reserved.

[ABAP - Keyword Documentation](javascript:call_link\('abenabap.htm'\))Â â†’Â  [ABAP - Reference](javascript:call_link\('abenabap_reference.htm'\))Â â†’Â  [Processing External Data](javascript:call_link\('abenabap_language_external_data.htm'\))Â â†’Â  [ABAP Database Accesses](javascript:call_link\('abenabap_sql.htm'\))Â â†’Â  [AMDP - ABAP Managed Database Procedures](javascript:call_link\('abenamdp.htm'\))Â â†’Â  [AMDP - Examples](javascript:call_link\('abenamdp_abexas.htm'\))Â â†’Â 

AMDP, Calling an AMDP Procedure from SQLScript

This example demonstrates how an AMDP procedure is called from an AMDP procedure.

Source Code

REPORT demo\_amdp\_call\_amdp\_procedure.
CLASS demo DEFINITION.
Â Â PUBLIC SECTION.
Â Â Â Â CLASS-METHODS main.
ENDCLASS.
CLASS demo IMPLEMENTATION.
Â Â METHOD main.
Â Â Â Â DATA incprice TYPE sflight-price.
Â Â Â Â IF NOT cl\_abap\_dbfeatures=>use\_features(
Â Â Â Â Â Â Â Â Â Â EXPORTING
Â Â Â Â Â Â Â Â Â Â Â Â requested\_features =
Â Â Â Â Â Â Â Â Â Â Â Â Â Â VALUE #( ( cl\_abap\_dbfeatures=>call\_amdp\_method ) ) ).
Â Â Â Â Â Â cl\_demo\_output=>display(
Â Â Â Â Â Â Â Â \`Current database system does not support AMDP procedures\` ).
Â Â Â Â Â Â RETURN.
Â Â Â Â ENDIF.
Â Â Â Â cl\_demo\_input=>request( CHANGING field = incprice ).
Â Â Â Â IF incprice IS INITIAL.
Â Â Â Â Â Â RETURN.
Â Â Â Â ENDIF.
Â Â Â Â SELECT price
Â Â Â Â Â Â Â Â Â Â  FROM sflight
Â Â Â Â Â Â Â Â Â Â  ORDER BY carrid, connid, fldate
Â Â Â Â Â Â Â Â Â Â  INTO @DATA(price\_before)
Â Â Â Â Â Â Â Â Â Â  UP TO 1 ROWS.
Â Â Â Â ENDSELECT.
Â Â Â Â TRY.
Â Â Â Â Â Â Â Â cl\_demo\_amdp\_call\_amdp=>increase\_price( clntÂ Â Â Â  = sy-mandt
Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â  Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â incprice = incprice ).
Â Â Â Â Â Â CATCH cx\_amdp\_error INTO DATA(amdp\_error).
Â Â Â Â Â Â Â Â cl\_demo\_output=>display( amdp\_error->get\_text( ) ).
Â Â Â Â Â Â Â Â RETURN.
Â Â Â Â ENDTRY.
Â Â Â Â SELECT price
Â Â Â Â Â Â Â Â Â Â  FROM sflight
Â Â Â Â Â Â Â Â Â Â  ORDER BY carrid, connid, fldate
Â Â Â Â Â Â Â Â Â Â  INTO @DATA(price\_after)
Â Â Â Â Â Â Â Â Â Â  UP TO 1 ROWS.
Â Â Â Â ENDSELECT.
Â Â Â Â IF price\_after - price\_before = incprice.
Â Â Â Â Â Â cl\_demo\_output=>display( \`Price increased succesfully\` ).
Â Â Â Â ENDIF.Â Â ENDMETHOD.
ENDCLASS.
START-OF-SELECTION.
Â Â demo=>main( ).

Description

The [SQLScript procedure](javascript:call_link\('abensql_script_procedure_glosry.htm'\) "Glossary Entry") of the AMDP method INCREASE\_PRICE of the AMDP class CL\_DEMO\_AMDP\_CALL\_AMDP calls a further AMDP procedure implemented in the private AMDP method INCREASE\_PRICE\_AMDP in the same class:

Method was not found

The called database procedure must be specified after the addition [USING](javascript:call_link\('abapmethod_by_db_proc.htm'\)) of the statement METHOD. Compare the [executable example](javascript:call_link\('abenamdp_call_abexa.htm'\)) for calling a further database procedure not managed using AMDP.



**ðŸ“– Source**: [abenamdp_call_amdp_abexa.htm](https://help.sap.com/doc/abapdocu_752_index_htm/7.52/en-US/abenamdp_call_amdp_abexa.htm)

### abenamdp_call_abexa.htm

> **ðŸ“– Official SAP Documentation**: [abenamdp_call_abexa.htm](https://help.sap.com/doc/abapdocu_752_index_htm/7.52/en-US/abenamdp_call_abexa.htm)
> **ðŸ” Direct Link**: This section contains the complete content from the official SAP ABAP documentation page.


Â  

* * *

SAP NetWeaver AS ABAP Release 752, Â©Copyright 2017 SAP AG. All rights reserved.

[ABAP - Keyword Documentation](javascript:call_link\('abenabap.htm'\))Â â†’Â  [ABAP - Reference](javascript:call_link\('abenabap_reference.htm'\))Â â†’Â  [Processing External Data](javascript:call_link\('abenabap_language_external_data.htm'\))Â â†’Â  [ABAP Database Accesses](javascript:call_link\('abenabap_sql.htm'\))Â â†’Â  [AMDP - ABAP Managed Database Procedures](javascript:call_link\('abenamdp.htm'\))Â â†’Â  [AMDP - Examples](javascript:call_link\('abenamdp_abexas.htm'\))Â â†’Â 

AMDP, Calling an SQLScript Procedure from AMDP

This example demonstrates how a database procedure is called from an AMDP procedure.

Source Code

REPORT demo\_amdp\_call\_db\_procedure.
CLASS demo DEFINITION.
Â Â PUBLIC SECTION.
Â Â Â Â CLASS-METHODS main.
ENDCLASS.
CLASS demo IMPLEMENTATION.
Â Â METHOD main.
Â Â Â Â DATA incprice TYPE sflight-price.
Â Â Â Â IF NOT cl\_abap\_dbfeatures=>use\_features(
Â Â Â Â Â Â Â Â Â Â EXPORTING
Â Â Â Â Â Â Â Â Â Â Â Â requested\_features =
Â Â Â Â Â Â Â Â Â Â Â Â Â Â VALUE #( ( cl\_abap\_dbfeatures=>call\_amdp\_method ) ) ).
Â Â Â Â Â Â cl\_demo\_output=>display(
Â Â Â Â Â Â Â Â \`Current database system does not support AMDP procedures\` ).
Â Â Â Â Â Â RETURN.
Â Â Â Â ENDIF.
Â Â Â Â cl\_demo\_input=>request( CHANGING field = incprice ).
Â Â Â Â IF incprice IS INITIAL.
Â Â Â Â Â Â RETURN.
Â Â Â Â ENDIF.
Â Â Â Â SELECT price
Â Â Â Â Â Â Â Â Â Â  FROM sflight
Â Â Â Â Â Â Â Â Â Â  ORDER BY carrid, connid, fldate
Â Â Â Â Â Â Â Â Â Â  INTO @DATA(price\_before)
Â Â Â Â Â Â Â Â Â Â  UP TO 1 ROWS.
Â Â Â Â ENDSELECT.
Â Â Â Â TRY.
Â Â Â Â Â Â Â Â cl\_demo\_amdp\_call=>increase\_price( incprice ).
Â Â Â Â Â Â CATCH cx\_amdp\_error INTO DATA(amdp\_error).
Â Â Â Â Â Â Â Â cl\_demo\_output=>display( amdp\_error->get\_text( ) ).
Â Â Â Â Â Â Â Â RETURN.
Â Â Â Â ENDTRY.
Â Â Â Â SELECT price
Â Â Â Â Â Â Â Â Â Â  FROM sflight
Â Â Â Â Â Â Â Â Â Â  ORDER BY carrid, connid, fldate
Â Â Â Â Â Â Â Â Â Â  INTO @DATA(price\_after)
Â Â Â Â Â Â Â Â Â Â  UP TO 1 ROWS.
Â Â Â Â ENDSELECT.
Â Â Â Â IF price\_after - price\_before = incprice.
Â Â Â Â Â Â cl\_demo\_output=>display( \`Price increased succesfully\` ).
Â Â Â Â ENDIF.Â Â ENDMETHOD.
ENDCLASS.
START-OF-SELECTION.
Â Â demo=>main( ).

Description

The [SQLScript procedure](javascript:call_link\('abensql_script_procedure_glosry.htm'\) "Glossary Entry") of the AMDP method INCREASE\_PRICE in the AMDP class CL\_DEMO\_AMDP\_CALL calls a database procedure (not managed by AMDP) of the current database schema in the namespace /1BCAMDP/:

METHOD increase\_price BY DATABASE PROCEDURE FOR HDB LANGUAGE SQLSCRIPT.
Â Â call "/1BCAMDP/ABAP\_DOCU\_DEMO\_INCPRICE"( INC => :INCPRICE );
ENDMETHOD.

The called database procedure is created dynamically in the static constructor of the AMDP class CL\_DEMO\_AMDP\_CALL using [ADBC](javascript:call_link\('abenadbc.htm'\)). It is in the same database schema, but due to the namespace /1BCAMDP/ it cannot and must not be used after the addition [USING](javascript:call_link\('abapmethod_by_db_proc.htm'\)) of the METHOD statement. Compare this [executable example](javascript:call_link\('abenamdp_call_amdp_abexa.htm'\)) when calling a further AMDP procedure.



**ðŸ“– Source**: [abenamdp_call_abexa.htm](https://help.sap.com/doc/abapdocu_752_index_htm/7.52/en-US/abenamdp_call_abexa.htm)

### abenamdp_polymorphism_abexa.htm

> **ðŸ“– Official SAP Documentation**: [abenamdp_polymorphism_abexa.htm](https://help.sap.com/doc/abapdocu_752_index_htm/7.52/en-US/abenamdp_polymorphism_abexa.htm)
> **ðŸ” Direct Link**: This section contains the complete content from the official SAP ABAP documentation page.


Â  

* * *

SAP NetWeaver AS ABAP Release 752, Â©Copyright 2017 SAP AG. All rights reserved.

[ABAP - Keyword Documentation](javascript:call_link\('abenabap.htm'\))Â â†’Â  [ABAP - Reference](javascript:call_link\('abenabap_reference.htm'\))Â â†’Â  [Processing External Data](javascript:call_link\('abenabap_language_external_data.htm'\))Â â†’Â  [ABAP Database Accesses](javascript:call_link\('abenabap_sql.htm'\))Â â†’Â  [AMDP - ABAP Managed Database Procedures](javascript:call_link\('abenamdp.htm'\))Â â†’Â  [AMDP - Examples](javascript:call_link\('abenamdp_abexas.htm'\))Â â†’Â 

AMDP, AMDP Methods in Interfaces and Superclasses

This example demonstrates how AMDP methods are implemented from interfaces and superclasses.

Source Code

REPORT demo\_amdp\_polymorphism.
CLASS demo DEFINITION.
Â Â PUBLIC SECTION.
Â Â Â Â CLASS-METHODS main.
ENDCLASS.
CLASS demo IMPLEMENTATION.
Â Â METHOD main.
Â Â Â Â DATA: iref TYPE REF TO if\_demo\_amdp\_interface,
Â Â Â Â Â Â Â Â Â Â cref TYPE REF TO cl\_demo\_amdp\_superclass.
Â Â Â Â IF cl\_abap\_dbfeatures=>use\_features(
Â Â Â Â Â Â Â Â Â Â EXPORTING
Â Â Â Â Â Â Â Â Â Â Â Â requested\_features =
Â Â Â Â Â Â Â Â Â Â Â Â Â Â VALUE #( ( cl\_abap\_dbfeatures=>call\_amdp\_method ) ) ).
Â Â Â Â Â Â cref = NEW cl\_demo\_amdp\_subclass\_hdb( ).
Â Â Â Â Â Â iref = NEW cl\_demo\_amdp\_implement\_hdb( ).
Â Â Â Â ELSE.
Â Â Â Â Â Â cref = NEW cl\_demo\_amdp\_subclass\_open( ).
Â Â Â Â Â Â iref = NEW cl\_demo\_amdp\_implement\_open( ).
Â Â Â Â ENDIF.
Â Â Â Â TRY.
Â Â Â Â Â Â Â Â iref->get\_scarr( EXPORTING clntÂ Â Â Â  = sy-mandt
Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â  IMPORTING carriers = DATA(result1) ).
Â Â Â Â Â Â Â Â cref->get\_scarr( EXPORTING clntÂ Â Â Â  = sy-mandt
Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â  IMPORTING carriers = DATA(result2) ).
Â Â Â Â Â Â CATCH cx\_amdp\_error INTO DATA(amdp\_error).
Â Â Â Â Â Â Â Â cl\_demo\_output=>display( amdp\_error->get\_text( ) ).
Â Â Â Â Â Â Â Â RETURN.
Â Â Â Â ENDTRY.
Â Â Â Â ASSERT result1 = result2.
Â Â Â Â cl\_demo\_output=>display( name = 'Result'
Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â  data = result1 ).Â Â ENDMETHOD.
ENDCLASS.
START-OF-SELECTION.
Â Â demo=>main( ).

Description

An interface IF\_DEMO\_AMDP\_INTERFACE and an abstract superclass CL\_DEMO\_AMDP\_SUPERCLASS implement the tag interface IF\_AMDP\_MARKER\_HDB and contain the method GET\_CARRIER, which meets the prerequisites of an [AMDP method](javascript:call_link\('abenamdp_method_glosry.htm'\) "Glossary Entry").

The interface method is implemented once as an AMDP method and once as a regular method in the classes CL\_DEMO\_AMDP\_IMPLEMENT\_HDB and CL\_DEMO\_AMDP\_IMPLEMENT\_OPEN. In the same way, the method of the abstract superclass is redefined in the fixed subclasses CL\_DEMO\_AMDP\_SUBCLASS\_HDB and CL\_DEMO\_AMDP\_SUBCLASS\_OPEN.

This program demonstrates how objects are created using either the AMDP method or the regular method and called polymorphically, as specified by the current database.



**ðŸ“– Source**: [abenamdp_polymorphism_abexa.htm](https://help.sap.com/doc/abapdocu_752_index_htm/7.52/en-US/abenamdp_polymorphism_abexa.htm)

### abenamdp_changing_abexa.htm

> **ðŸ“– Official SAP Documentation**: [abenamdp_changing_abexa.htm](https://help.sap.com/doc/abapdocu_752_index_htm/7.52/en-US/abenamdp_changing_abexa.htm)
> **ðŸ” Direct Link**: This section contains the complete content from the official SAP ABAP documentation page.


Â  

* * *

SAP NetWeaver AS ABAP Release 752, Â©Copyright 2017 SAP AG. All rights reserved.

[ABAP - Keyword Documentation](javascript:call_link\('abenabap.htm'\))Â â†’Â  [ABAP - Reference](javascript:call_link\('abenabap_reference.htm'\))Â â†’Â  [Processing External Data](javascript:call_link\('abenabap_language_external_data.htm'\))Â â†’Â  [ABAP Database Accesses](javascript:call_link\('abenabap_sql.htm'\))Â â†’Â  [AMDP - ABAP Managed Database Procedures](javascript:call_link\('abenamdp.htm'\))Â â†’Â  [AMDP - Examples](javascript:call_link\('abenamdp_abexas.htm'\))Â â†’Â 

AMDP, SQL Script with Tabular CHANGING Parameter

This example demonstrates how an SQLScript procedure is implemented using AMDP with a tabular CHANGING parameter.

Source Code

REPORT demo\_amdp\_changing.
CLASS demo DEFINITION.
Â Â PUBLIC SECTION.
Â Â Â Â CLASS-METHODS main.
ENDCLASS.
CLASS demo IMPLEMENTATION.
Â Â METHOD main.
Â Â Â Â IF NOT cl\_abap\_dbfeatures=>use\_features(
Â Â Â Â Â Â Â Â Â Â EXPORTING
Â Â Â Â Â Â Â Â Â Â Â Â requested\_features =
Â Â Â Â Â Â Â Â Â Â Â Â Â Â VALUE #( ( cl\_abap\_dbfeatures=>call\_amdp\_method ) ) ).
Â Â Â Â Â Â cl\_demo\_output=>display(
Â Â Â Â Â Â Â Â \`Current database system does not support AMDP procedures\` ).
Â Â Â Â Â Â RETURN.
Â Â Â Â ENDIF.
Â Â Â Â DATA lower TYPE scarr-carrid VALUE 'AA'.
Â Â Â Â DATA upper TYPE scarr-carrid VALUE 'BA'.
Â Â Â Â DATA call\_flag TYPE abap\_bool.
Â Â Â Â cl\_demo\_input=>new(
Â Â Â Â Â Â  )->add\_field( CHANGING field = lower
Â Â Â Â Â Â  )->add\_field( CHANGING field = upper
Â Â Â Â Â Â  )->add\_line(
Â Â Â Â Â Â  )->add\_field( EXPORTING text = 'Indirect call'
Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â  as\_checkbox = abap\_true
Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â  CHANGINGÂ Â field = call\_flag
Â Â Â Â Â Â  )->request( ).
Â Â Â Â DATA carriers TYPE cl\_demo\_amdp\_changing=>t\_carriers.
Â Â Â Â SELECT mandt, carrid
Â Â Â Â Â Â Â Â Â Â  FROM scarr
Â Â Â Â Â Â Â Â Â Â  WHERE carrid BETWEEN @lower AND @upper
Â Â Â Â Â Â Â Â Â Â  ORDER BY mandt, carrid
Â Â Â Â Â Â Â Â Â Â  INTO CORRESPONDING FIELDS OF TABLE @carriers.
Â Â Â Â DATA(out) = cl\_demo\_output=>new( )->write( carriers ).
Â Â Â Â TRY.
Â Â Â Â Â Â Â Â IF call\_flag IS INITIAL.
Â Â Â Â Â Â Â Â Â Â NEW cl\_demo\_amdp\_changing(
Â Â Â Â Â Â Â Â Â Â Â Â )->get\_carriers( CHANGING carriers = carriers ).
Â Â Â Â Â Â Â Â ELSE.
Â Â Â Â Â Â Â Â Â Â NEW cl\_demo\_amdp\_changing(
Â Â Â Â Â Â Â Â Â Â Â Â )->call\_get\_carriers( CHANGING carriers = carriers ).
Â Â Â Â Â Â Â Â ENDIF.
Â Â Â Â Â Â CATCH cx\_amdp\_error INTO DATA(amdp\_error).
Â Â Â Â Â Â Â Â cl\_demo\_output=>display( amdp\_error->get\_text( ) ).
Â Â Â Â Â Â Â Â RETURN.
Â Â Â Â ENDTRY.
Â Â Â Â out->display( carriers ).Â Â ENDMETHOD.
ENDCLASS.
START-OF-SELECTION.
Â Â demo=>main( ).

Description

The following [SQLScript procedure](javascript:call_link\('abensql_script_procedure_glosry.htm'\) "Glossary Entry") is implemented in the AMDP method GET\_CARRIERS of the AMDP class CL\_DEMO\_AMDP\_CHANGING:

METHOD get\_carriers BY DATABASE PROCEDURE FOR HDB
Â Â Â Â Â  Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â  LANGUAGE SQLSCRIPT
Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â USING scarr.
Â Â carriersÂ Â = select s.\*
Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â  from scarr as s
Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â  inner join :carriers as c
Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â  on s.mandtÂ Â = c.mandt and
Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â s.carrid = c.carrid;
ENDMETHOD.

The tabular CHANGING parameter carriers can be used in this way in the procedure in reading positions and writing positions. Internally, the database procedure uses an identically named output parameter to which the initial value of the CHANGING parameter is assigned (using the invisible IN parameter carrriers\_\_in\_\_) when the procedure is first executed (see [SQL Script for the SAP HANA Database](javascript:call_link\('abenamdp_hdb_sqlscript.htm'\))).

A further method, CALL\_GET\_CARRIERS, demonstrates how the SQL Script procedure implemented in GET\_CARRIERS is called from a different SQL Script procedure.

METHOD call\_get\_carriers BY DATABASE PROCEDURE FOR HDB
Â Â Â Â  Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â LANGUAGE SQLSCRIPT
Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â  USING cl\_demo\_amdp\_changing=>get\_carriers.
Â Â call "CL\_DEMO\_AMDP\_CHANGING=>GET\_CARRIERS"(
Â Â Â Â CARRIERS\_\_IN\_\_Â Â => :CARRIERS,
Â Â Â Â CARRIERSÂ Â Â Â Â Â Â Â => :CARRIERS );
ENDMETHOD.

In this case, the implicit IN parameter carrriers\_\_in\_\_ must be filled explicit with the modified actual parameter.

Note

This is a syntax example. The same function can be provided with the same efficiency in Open SQL. AMDP is not needed in simple cases like this.



**ðŸ“– Source**: [abenamdp_changing_abexa.htm](https://help.sap.com/doc/abapdocu_752_index_htm/7.52/en-US/abenamdp_changing_abexa.htm)

### abenamdp_connection_abexa.htm

> **ðŸ“– Official SAP Documentation**: [abenamdp_connection_abexa.htm](https://help.sap.com/doc/abapdocu_752_index_htm/7.52/en-US/abenamdp_connection_abexa.htm)
> **ðŸ” Direct Link**: This section contains the complete content from the official SAP ABAP documentation page.


Â  

* * *

SAP NetWeaver AS ABAP Release 752, Â©Copyright 2017 SAP AG. All rights reserved.

[ABAP - Keyword Documentation](javascript:call_link\('abenabap.htm'\))Â â†’Â  [ABAP - Reference](javascript:call_link\('abenabap_reference.htm'\))Â â†’Â  [Processing External Data](javascript:call_link\('abenabap_language_external_data.htm'\))Â â†’Â  [ABAP Database Accesses](javascript:call_link\('abenabap_sql.htm'\))Â â†’Â  [AMDP - ABAP Managed Database Procedures](javascript:call_link\('abenamdp.htm'\))Â â†’Â  [AMDP - Examples](javascript:call_link\('abenamdp_abexas.htm'\))Â â†’Â 

AMDP, AMDP Method with Specified Service Connection

The example demonstrates an AMDP method with the input parameter connection.

Source Code

REPORT demo\_amdp\_connection.
CLASS demo DEFINITION.
Â Â PUBLIC SECTION.
Â Â Â Â CLASS-METHODS main.
ENDCLASS.
CLASS demo IMPLEMENTATION.
Â Â METHOD main.
Â Â Â Â IF NOT cl\_abap\_dbfeatures=>use\_features(
Â Â Â Â Â Â Â Â Â Â EXPORTING
Â Â Â Â Â Â Â Â Â Â Â Â requested\_features =
Â Â Â Â Â Â Â Â Â Â Â Â Â Â VALUE #( ( cl\_abap\_dbfeatures=>call\_amdp\_method ) ) ).
Â Â Â Â Â Â cl\_demo\_output=>display(
Â Â Â Â Â Â Â Â \`Current database system does not support AMDP procedures\` ).
Â Â Â Â Â Â RETURN.
Â Â Â Â ENDIF.
Â Â Â Â DATA connection TYPE dbcon\_name VALUE 'R/3\*my\_conn'.
Â Â Â Â cl\_demo\_input=>request( CHANGING field = connection ).
Â Â Â Â TRY.
Â Â Â Â Â Â Â Â NEW cl\_demo\_amdp\_connection(
Â Â Â Â Â Â Â Â Â Â Â Â Â Â )->get\_scarr( EXPORTING
Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â connection = connection
Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â  Â Â Â Â Â Â Â Â Â Â Â Â clntÂ Â Â Â Â Â  = sy-mandt
Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â IMPORTING
Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â carriers = DATA(result) ).
Â Â Â Â Â Â CATCH cx\_amdp\_error INTO DATA(amdp\_error).
Â Â Â Â Â Â Â Â cl\_demo\_output=>display( amdp\_error->get\_text( ) ).
Â Â Â Â Â Â Â Â RETURN.
Â Â Â Â ENDTRY.
Â Â Â Â cl\_demo\_output=>display( result ).Â Â ENDMETHOD.
ENDCLASS.
START-OF-SELECTION.
Â Â demo=>main( ).

Description

A simple [SQLScript procedure](javascript:call_link\('abensql_script_procedure_glosry.htm'\) "Glossary Entry") is implemented in the AMDP method GET\_SCARR of the AMDP class CL\_DEMO\_AMDP:

METHOD get\_scarr BY DATABASE PROCEDURE FOR HDB
Â Â Â Â Â  Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â LANGUAGE SQLSCRIPT
Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â USING scarr.
Â Â carriersÂ Â = select \*
Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â  from scarr
Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â  WHERE mandtÂ Â = clnt;
ENDMETHOD.

The method also has an optional input parameter with the predefined name connection. This is used to specify whether the [standard connection](javascript:call_link\('abenstandard_db_connection_glosry.htm'\) "Glossary Entry") or a [service connection](javascript:call_link\('abenservice_connection_glosry.htm'\) "Glossary Entry") is used. If a permitted name such as "DEFAULT" or "R/3\*my\_conn" is passed, the method is executed using either the standard connection or a service connection. Invalid names raise an exception and an exception is text is displayed.



**ðŸ“– Source**: [abenamdp_connection_abexa.htm](https://help.sap.com/doc/abapdocu_752_index_htm/7.52/en-US/abenamdp_connection_abexa.htm)

### abenmesh_amdp_abexa.htm

> **ðŸ“– Official SAP Documentation**: [abenmesh_amdp_abexa.htm](https://help.sap.com/doc/abapdocu_752_index_htm/7.52/en-US/abenmesh_amdp_abexa.htm)
> **ðŸ” Direct Link**: This section contains the complete content from the official SAP ABAP documentation page.


Â  

* * *

SAP NetWeaver AS ABAP Release 752, Â©Copyright 2017 SAP AG. All rights reserved.

[ABAP - Keyword Documentation](javascript:call_link\('abenabap.htm'\))Â â†’Â  [ABAP - Reference](javascript:call_link\('abenabap_reference.htm'\))Â â†’Â  [Processing External Data](javascript:call_link\('abenabap_language_external_data.htm'\))Â â†’Â  [ABAP Database Accesses](javascript:call_link\('abenabap_sql.htm'\))Â â†’Â  [AMDP - ABAP Managed Database Procedures](javascript:call_link\('abenamdp.htm'\))Â â†’Â  [AMDP - Examples](javascript:call_link\('abenamdp_abexas.htm'\))Â â†’Â 

AMDP, Filling a Mesh with SQLScript

This example demonstrates how a mesh is filled with a database procedure.

Source Code

REPORT demo\_amdp\_mesh.
CLASS demo DEFINITION.
Â Â PUBLIC SECTION.
Â Â Â Â CLASS-METHODS main.
Â Â PRIVATE SECTION.
Â Â Â Â TYPES:
Â Â Â Â Â Â BEGIN OF output\_line,
Â Â Â Â Â Â Â Â position TYPE string,
Â Â Â Â Â Â Â Â productÂ Â TYPE string,
Â Â Â Â Â Â END OF output\_line,
Â Â Â Â Â Â output TYPE STANDARD TABLE OF output\_line WITH EMPTY KEY.
ENDCLASS.
CLASS demo IMPLEMENTATION.
Â Â METHOD main.
Â Â Â Â DATA order\_ids TYPE RANGE OF snwd\_so-so\_id.
Â Â Â Â DATA(rows) = 1.
Â Â Â Â cl\_demo\_input=>request( EXPORTING text = \`Orders\`
Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â CHANGING field = rows ).
Â Â Â Â SELECT 'I' AS sign, 'EQ' AS option, so\_id AS low
Â Â Â Â Â Â Â Â Â Â  FROM snwd\_so
Â Â Â Â Â Â Â Â Â Â  ORDER BY low
Â Â Â Â Â Â Â Â Â Â  INTO CORRESPONDING FIELDS OF TABLE @order\_ids
Â Â Â Â Â Â Â Â Â Â  UP TO @rows ROWS. "#EC CI\_NOWHERE
Â Â Â Â DATA(out) = cl\_demo\_output=>new( ).
Â Â Â Â TRY.
Â Â Â Â Â Â Â Â DATA(order) = NEW cl\_demo\_amdp\_mesh( )->select( order\_ids ).
Â Â Â Â Â Â CATCH cx\_amdp\_error INTO DATA(amdp\_error).
Â Â Â Â Â Â Â Â out->display( amdp\_error->get\_text( ) ).
Â Â Â Â Â Â Â Â RETURN.
Â Â Â Â ENDTRY.
Â Â Â Â LOOP AT order-orders ASSIGNING FIELD-SYMBOL(<order>).
Â Â Â Â Â Â out->begin\_section( |Order #{ <order>-so\_id }| ).
Â Â Â Â Â Â ASSIGN order-orders\\\_buyers\[ <order> \]
Â Â Â Â Â Â Â Â TO FIELD-SYMBOL(<buyer>).
Â Â Â Â Â Â out->begin\_section(
Â Â Â Â Â Â Â Â |Buyer: { <buyer>-company\_name } | &&
Â Â Â Â Â Â Â Â |in { order-bupas\\\_addresses\[ <buyer> \]-city } | ).
Â Â Â Â Â Â out->write(
Â Â Â Â Â Â Â Â nameÂ Â = 'Sales Order Items'
Â Â Â Â Â Â Â Â data = VALUE output(
Â Â Â Â Â Â Â Â Â Â FOR <item> IN order-orders\\\_items\[ <order> \]
Â Â Â Â Â Â Â Â Â Â ( position = <item>-so\_item\_pos
Â Â Â Â Â Â Â Â Â Â Â Â product = order-items\\\_products\[ <item> \]-product\_id
Â Â Â Â Â Â Â Â Â Â ) ) ).
Â Â Â Â Â Â out->end\_section( )->end\_section( ).
Â Â Â Â ENDLOOP.
Â Â Â Â out->display( ).Â Â ENDMETHOD.
ENDCLASS.
START-OF-SELECTION.
Â Â demo=>main( ).

Description

The AMDP class CL\_DEMO\_AMDP\_MESH has a private AMDP method SELECT\_HDB called by the public method SELECT if the current [standard database](javascript:call_link\('abenstandard_db_glosry.htm'\) "Glossary Entry") is the SAP HANA database. For all other databases, the private method SELECT\_OPEN\_SQL is called. Both methods return the same results, verified by a [unit test](javascript:call_link\('abenunit_test_glosry.htm'\) "Glossary Entry") in the class.

The methods fill the nodes of a [mesh](javascript:call_link\('abenabap_meshes.htm'\)) for sales orders whose type is declared in the AMDP class. The number of sales orders is restricted using a ranges table. In the method SELECT\_OPEN\_SQL, the Open SQL addition FOR ALL ENTRIES is used, but in SELECT\_OPEN\_SQL the intermediate results can be evaluated in subqueries.

SQLScript implementation of the AMDP method

METHOD select\_hdbÂ Â BY DATABASE PROCEDURE
Â Â Â Â Â  Â Â Â Â Â Â Â Â Â Â Â Â  FOR HDB LANGUAGE SQLSCRIPT
Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â  OPTIONS READ-ONLY
Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â  USING snwd\_so snwd\_so\_i snwd\_pd snwd\_bpa snwd\_ad.
Â Â orders = select \* from snwd\_so
Â Â Â Â where client = :clnt and so\_id in (
Â Â Â Â Â Â select low from :order\_ids );
Â Â bupas = select \* from snwd\_bpa
Â Â Â Â where client = :clnt and node\_key in (
Â Â Â Â Â Â select DISTINCT buyer\_guid from :orders );
Â Â adresses = select \* from snwd\_ad
Â Â Â Â where client = :clnt and node\_key in (
Â Â Â Â Â Â select address\_guid from :bupas );
Â Â items = select \* from snwd\_so\_i
Â Â Â Â where parent\_key in ( select node\_key from :orders );
Â Â products = select \* from snwd\_pd as product
Â Â Â Â where client = :clnt and node\_key in (
Â Â Â Â Â Â select distinct product\_guid from :items );
ENDMETHOD.

ABAP implementation of the regular method

METHOD select\_open\_sql.
Â Â SELECT \*
Â Â Â Â Â Â Â Â  FROM snwd\_so
Â Â Â Â Â Â Â Â  INTO TABLE @orders
Â Â Â Â Â Â Â Â  WHERE so\_id IN @order\_ids.
Â Â SELECT \*
Â Â Â Â Â Â Â Â  FROM snwd\_so\_i
Â Â Â Â Â Â Â Â  FOR ALL ENTRIES IN @orders
Â Â Â Â Â Â Â Â  WHERE parent\_key = @orders-node\_key
Â Â Â Â Â Â Â Â  INTO TABLE @items.
Â Â SELECT \*
Â Â Â Â Â Â Â Â FROM snwd\_pd
Â Â Â Â Â Â Â Â FOR ALL ENTRIES IN @items
Â Â Â Â Â Â Â Â WHERE node\_key = @items-product\_guid
Â Â Â Â Â Â Â Â INTO TABLE @products.
Â Â SELECT \*
Â Â Â Â Â Â Â Â FROM snwd\_bpa
Â Â Â Â Â Â Â Â INTO TABLE bupas
Â Â Â Â Â Â Â Â FOR ALL ENTRIES IN orders
Â Â Â Â Â Â Â Â WHERE node\_key = orders-buyer\_guid
Â Â Â Â Â Â Â Â ##SELECT\_FAE\_WITH\_LOB\[WEB\_ADDRESS\].
Â Â SELECT \*
Â Â Â Â Â Â Â Â  FROM snwd\_ad
Â Â Â Â Â Â Â Â  FOR ALL ENTRIES IN @bupas
Â Â Â Â Â Â Â Â  WHERE node\_key = @bupas-address\_guid
Â Â Â Â Â Â Â Â  INTO TABLE @adresses.
ENDMETHOD.

Note

This is a syntax example. The same function can be provided with the same efficiency in Open SQL. AMDP is not needed in simple cases like this.



**ðŸ“– Source**: [abenmesh_amdp_abexa.htm](https://help.sap.com/doc/abapdocu_752_index_htm/7.52/en-US/abenmesh_amdp_abexa.htm)

### abenamdp_vs_open_sql_abexa.htm

> **ðŸ“– Official SAP Documentation**: [abenamdp_vs_open_sql_abexa.htm](https://help.sap.com/doc/abapdocu_752_index_htm/7.52/en-US/abenamdp_vs_open_sql_abexa.htm)
> **ðŸ” Direct Link**: This section contains the complete content from the official SAP ABAP documentation page.


Â  

* * *

SAP NetWeaver AS ABAP Release 752, Â©Copyright 2017 SAP AG. All rights reserved.

[ABAP - Keyword Documentation](javascript:call_link\('abenabap.htm'\))Â â†’Â  [ABAP - Reference](javascript:call_link\('abenabap_reference.htm'\))Â â†’Â  [Processing External Data](javascript:call_link\('abenabap_language_external_data.htm'\))Â â†’Â  [ABAP Database Accesses](javascript:call_link\('abenabap_sql.htm'\))Â â†’Â  [AMDP - ABAP Managed Database Procedures](javascript:call_link\('abenamdp.htm'\))Â â†’Â  [AMDP - Examples](javascript:call_link\('abenamdp_abexas.htm'\))Â â†’Â 

AMDP, Comparison of SQLScript with Open SQL

This example demonstrates the performance of SQL in AMDP when compared with Open SQL.

Source Code

REPORT demo\_amdp\_vs\_open\_sql.
CLASS demo DEFINITION.
Â Â PUBLIC SECTION.
Â Â Â Â CLASS-METHODS main.
ENDCLASS.
CLASS demo IMPLEMENTATION.
Â Â METHOD main.
Â Â Â Â DATA(out) = cl\_demo\_output=>new( ).
Â Â Â Â IF NOT cl\_abap\_dbfeatures=>use\_features(
Â Â Â Â Â Â Â Â Â Â EXPORTING
Â Â Â Â Â Â Â Â Â Â Â Â requested\_features =
Â Â Â Â Â Â Â Â Â Â Â Â Â Â VALUE #( ( cl\_abap\_dbfeatures=>call\_amdp\_method ) ) ).
Â Â Â Â Â Â cl\_demo\_output=>display(
Â Â Â Â Â Â Â Â \`Current database system does not support AMDP procedures\` ).
Â Â Â Â Â Â RETURN.
Â Â Â Â ENDIF.
Â Â Â Â DATA time\_stamps TYPE TABLE OF timestampl.
Â Â Â Â SELECT changed\_at
Â Â Â Â Â Â Â Â Â Â  FROM snwd\_so\_inv\_head UP TO 100 ROWS
Â Â Â Â Â Â Â Â Â Â  INTO TABLE time\_stamps.Â Â Â  Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â "#EC CI\_NOWHERE
Â Â Â Â IF time\_stamps IS INITIAL.
Â Â Â Â Â Â out->display( 'You must create database entries' &
Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â ' with program RS\_EPM\_DGC\_HANA first ...' ).
Â Â Â Â Â Â RETURN.
Â Â Â Â ENDIF.
Â Â Â Â DATA(rnd) =Â Â cl\_abap\_random\_int=>create(
Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â  seed = CONV i( sy-uzeit )
Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â  minÂ Â = 1
Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â  maxÂ Â = lines( time\_stamps ) )->get\_next( ).
Â Â Â Â CONVERT TIME STAMP time\_stamps\[ rnd \] TIME ZONE 'UTC'
Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â  INTO DATE DATA(payment\_date).
Â Â Â Â cl\_demo\_input=>request( CHANGING field = payment\_date ).
Â Â Â Â DATA(oref) = NEW cl\_demo\_amdp\_vs\_open\_sql( ).
Â Â Â Â TRY.
Â Â Â Â Â Â Â Â GET RUN TIME FIELD DATA(t01).
Â Â Â Â Â Â Â Â oref->amdp(
Â Â Â Â Â Â Â Â Â Â EXPORTING iv\_payment\_dateÂ Â  = payment\_date
Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â iv\_clntÂ Â Â Â Â Â Â Â Â Â  = sy-mandt
Â Â Â Â Â Â Â Â Â Â IMPORTING et\_invoice\_header = DATA(invoice\_header)
Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â et\_invoice\_itemÂ Â  = DATA(invoice\_item)
Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â et\_customer\_infoÂ Â = DATA(customer\_info) ) .
Â Â Â Â Â Â Â Â GET RUN TIME FIELD DATA(t02).
Â Â Â Â Â Â CATCH cx\_amdp\_error INTO DATA(amdp\_error).
Â Â Â Â Â Â Â Â out->display( amdp\_error->get\_text( ) ).
Â Â Â Â Â Â Â Â RETURN.
Â Â Â Â ENDTRY.
Â Â Â Â GET RUN TIME FIELD DATA(t11).
Â Â Â Â oref->open\_sql\_nested\_select(
Â Â Â Â Â Â EXPORTING iv\_payment\_dateÂ Â  = payment\_date
Â Â Â Â Â Â IMPORTING et\_invoice\_header = DATA(invoice\_header1)
Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â et\_invoice\_itemÂ Â  = DATA(invoice\_item1)
Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â et\_customer\_infoÂ Â = DATA(customer\_info1) ) .
Â Â Â Â GET RUN TIME FIELD DATA(t12).
Â Â Â Â GET RUN TIME FIELD DATA(t21).
Â Â Â Â oref->open\_sql\_for\_all\_entries(
Â Â Â Â Â Â EXPORTING iv\_payment\_dateÂ Â  = payment\_date
Â Â Â Â Â Â IMPORTING et\_invoice\_header = DATA(invoice\_header2)
Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â et\_invoice\_itemÂ Â  = DATA(invoice\_item2)
Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â et\_customer\_infoÂ Â = DATA(customer\_info2) ) .
Â Â Â Â GET RUN TIME FIELD DATA(t22).
Â Â Â Â GET RUN TIME FIELD DATA(t31).
Â Â Â Â oref->open\_sql\_subquery(
Â Â Â Â Â Â EXPORTING iv\_payment\_dateÂ Â  = payment\_date
Â Â Â Â Â Â IMPORTING et\_invoice\_header = DATA(invoice\_header3)
Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â et\_invoice\_itemÂ Â  = DATA(invoice\_item3)
Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â et\_customer\_infoÂ Â = DATA(customer\_info3) ) .
Â Â Â Â GET RUN TIME FIELD DATA(t32).
Â Â Â Â IF lines( invoice\_header ) IS INITIAL.
Â Â Â Â Â Â out->display( 'Nothing found' ).
Â Â Â Â Â Â RETURN.
Â Â Â Â ENDIF.
Â Â Â Â out->begin\_section( \`Lines of tables filled\`
Â Â Â Â Â Â )->write( |INVOICE\_HEADER: {
Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â  lines( invoice\_header ) }\\n\\n| &&
Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â |INVOICE\_ITEM:Â Â  {
Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â  lines( invoice\_item ) }\\n\\n|Â Â &&
Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â |CUSTOMER\_INFO:Â Â {
Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â  lines( customer\_info ) }| ).
Â Â Â Â out->next\_section( \`Runtime AMDP \`
Â Â Â Â Â Â )->write( |{ CONV decfloat34(
Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â ( t02 - t01 ) / 1000000 ) } seconds| ).
Â Â Â Â IF invoice\_headerÂ Â = invoice\_header1 AND
Â Â Â Â Â Â  invoice\_itemÂ Â Â Â = invoice\_item1Â Â  AND
Â Â Â Â Â Â  customer\_infoÂ Â  = customer\_info1.
Â Â Â Â Â Â out->next\_section( \`Runtime Open SQL with Nested SELECT\`
Â Â Â Â Â Â Â Â )->write( |{ CONV decfloat34(
Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â ( t12 - t11 ) / 1000000 ) } seconds| ).
Â Â Â Â ELSE.
Â Â Â Â Â Â out->write( 'Different results in Open SQL with Nested SELECT' ).
Â Â Â Â ENDIF.
Â Â Â Â IF invoice\_headerÂ Â = invoice\_header2 AND
Â Â Â Â Â Â  invoice\_itemÂ Â Â Â = invoice\_item2Â Â  AND
Â Â Â Â Â Â  customer\_infoÂ Â  = customer\_info2.
Â Â Â Â Â Â out->next\_section( \`Runtime Open SQL with FOR ALL ENTRIES\`
Â Â Â Â Â Â Â Â )->write( |{ CONV decfloat34(
Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â ( t22 - t21 ) / 1000000 ) } seconds| ).
Â Â Â Â ELSE.
Â Â Â Â Â Â out->write(
Â Â Â Â Â Â Â Â 'Different results in Open SQL with FOR ALL ENTRIES' ).
Â Â Â Â ENDIF.
Â Â Â Â IF invoice\_headerÂ Â = invoice\_header3 AND
Â Â Â Â Â Â  invoice\_itemÂ Â Â Â = invoice\_item3Â Â  AND
Â Â Â Â Â Â  customer\_infoÂ Â  = customer\_info3.
Â Â Â Â Â Â out->next\_section( \`Runtime Open SQL with Subquery\`
Â Â Â Â Â Â Â Â )->write( |{ CONV decfloat34(
Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â ( t32 - t31 ) / 1000000 ) } seconds| ).
Â Â Â Â ELSE.
Â Â Â Â Â Â out->write( 'Different results in Open SQL with Subquery' ).
Â Â Â Â ENDIF.
Â Â Â Â out->display( ).Â Â ENDMETHOD.
ENDCLASS.
START-OF-SELECTION.
Â Â demo=>main( ).

Description

The AMDP class CL\_DEMO\_AMDP\_VS\_OPEN\_SQL has an AMDP method AMDP and the regular methods OPEN\_SQL\_NESTED\_SELECT, OPEN\_SQL\_FOR\_ALL\_ENTRIES, and OPEN\_SQL\_SUBQUERY. All take the same data from database tables in the EPM model. These database tables can be filled using the program RS\_EPM\_DGC\_HANA. Create the master data again here (X) and enter, for example, the values 100000 for Number of Sales Orders and 90000 for Number Delivered, plus a time interval of approximately three months.

The example program selects a random date from the existing change data and uses it to make the selections. The selections pick invoices paid on this date, plus the associated business partners and product information.

The method OPEN\_SQL\_NESTED\_SELECT uses nested SELECT statements and provides the worst result, as expected. However, the use of FOR ALL ENTRIES in OPEN\_SQL\_FOR\_ALL\_ENTRIES or the same subqueries in OPEN\_SQL\_SUBQUERY as in AMDP demonstrates that AMDP does not provide any performance benefits as long as only SQL is implemented that can also be expressed in Open SQL.

SQLScript implementation of the method AMDP

METHOD amdp BY DATABASE PROCEDURE FOR HDB
Â Â Â Â Â Â  LANGUAGE SQLSCRIPT OPTIONS READ-ONLY
Â Â Â Â Â Â  USING snwd\_ad snwd\_bpa snwd\_so\_inv\_head snwd\_so\_inv\_item.
Â Â --Â Â Selection of invoices paid on a specified date
Â Â --Â Â plus business partner and product information
Â Â -- Retrieve all invoice header which were paid on the requested date
Â Â et\_invoice\_header = select
Â Â Â Â Â Â node\_keyÂ Â Â Â Â Â Â Â Â Â Â Â as invoice\_guid,
Â Â Â Â Â Â created\_at as created\_at,
Â Â Â Â Â Â changed\_at as paid\_at,
Â Â Â Â Â Â buyer\_guid
Â Â Â Â from
Â Â Â Â Â Â snwd\_so\_inv\_head
Â Â Â Â where
Â Â Â Â Â Â clientÂ Â Â Â Â Â Â Â  = :iv\_clnt
Â Â Â Â Â Â and payment\_status = 'P' -- only paid invoices
Â Â Â Â Â Â and left(changed\_at, 8) = :iv\_payment\_date
Â Â Â Â Â Â order by invoice\_guid;
Â Â -- Get the items of those invoices
Â Â et\_invoice\_item = select
Â Â Â Â Â Â node\_keyÂ Â  as item\_guid,
Â Â Â Â Â Â parent\_key as invoice\_guid,
Â Â Â Â Â Â product\_guid,
Â Â Â Â Â Â gross\_amount,
Â Â Â Â Â Â currency\_code
Â Â Â Â from snwd\_so\_inv\_item
Â Â Â Â where parent\_key in
Â Â Â Â Â Â Â Â ( select invoice\_guid
Â Â Â Â Â Â Â Â Â Â Â Â from :et\_invoice\_header )
Â Â Â Â Â Â order by item\_guid, invoice\_guid, product\_guid;
Â Â -- Get the information about the customers
Â Â et\_customer\_info = select
Â Â Â Â Â Â bpa.node\_keyÂ Â Â Â  as customer\_guid,
Â  Â Â Â Â bpa.bp\_idÂ Â Â Â Â Â Â Â as customer\_id,
Â Â Â Â Â Â bpa.company\_name as customer\_name,
Â Â Â Â Â Â ad.country,
Â Â Â Â Â Â ad.postal\_code,
Â Â Â Â Â Â ad.city
Â Â Â Â from snwd\_bpa as bpa
Â Â Â Â join snwd\_ad as ad on ad.node\_key = bpa.address\_guid
Â Â Â Â where bpa.node\_key in ( select distinct buyer\_guid
Â Â Â Â  Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â from :et\_invoice\_header )
Â Â Â Â order by customer\_id;
ENDMETHOD.

ABAP implementation of the method OPEN\_SQL\_NESTED\_SELECT

METHOD open\_sql\_nested\_select.
Â Â "Selection of invoices paid on a specified date
Â Â "plus business partner and product information
Â Â DATA ls\_invoice\_headÂ Â TYPE ty\_invoice\_header.
Â Â DATA lt\_invoice\_itemÂ Â TYPE tt\_invoice\_item.
Â Â DATA lt\_customer\_info TYPE tt\_customer\_info.
Â Â DATA lv\_payment\_date\_min TYPE timestamp.
Â Â DATA lv\_payment\_date\_max TYPE timestamp.
Â Â CONVERT DATE iv\_payment\_date TIME '0001'
Â Â Â Â INTO TIME STAMP lv\_payment\_date\_min TIME ZONE 'UTC'.
Â Â CONVERT DATE iv\_payment\_date TIME '2359'
Â Â Â Â INTO TIME STAMP lv\_payment\_date\_max TIME ZONE 'UTC'.
Â Â "Retrieve all invoice header which were paid on the requested date
Â Â SELECT
Â Â Â Â node\_keyÂ Â Â Â Â Â  AS invoice\_guid,
Â Â Â Â created\_atÂ Â Â Â  AS created\_at,
Â Â Â Â changed\_atÂ Â Â Â  AS paid\_at,
Â Â Â Â buyer\_guid
Â Â FROM
Â Â Â Â snwd\_so\_inv\_head
Â Â WHEREÂ Â Â  Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â  Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â  "#EC CI\_NOFIELD
Â Â Â Â payment\_status = 'P'
Â Â Â Â AND changed\_at BETWEEN @lv\_payment\_date\_min AND @lv\_payment\_date\_max
Â Â ORDER BY invoice\_guid
Â Â INTO @ls\_invoice\_head.
Â Â Â Â CLEAR lt\_invoice\_item.
Â Â Â Â CLEAR lt\_customer\_info.
Â Â Â Â "Get the items of invoice
Â Â Â Â SELECT
Â Â Â Â Â Â node\_keyÂ Â  AS item\_guid,
Â Â Â Â Â Â parent\_key AS invoice\_guid,
Â Â Â Â Â Â product\_guid,
Â Â Â Â Â Â gross\_amount,
Â Â Â Â Â Â currency\_code
Â Â Â Â FROM snwd\_so\_inv\_item
Â Â Â Â WHERE parent\_key = @ls\_invoice\_head-invoice\_guid
Â Â Â Â ORDER BY item\_guid, invoice\_guid, product\_guid
Â Â Â Â INTO TABLE @lt\_invoice\_item.
Â Â Â Â "Get the information about the customers
Â Â Â Â SELECT
Â Â Â Â  bpa~node\_keyÂ Â Â Â  AS customer\_guid,
Â Â Â Â  bpa~bp\_idÂ Â Â Â Â Â Â Â AS customer\_id,
Â Â Â Â  bpa~company\_name AS customer\_name,
Â Â Â Â  ad~country,
Â Â Â Â  ad~postal\_code,
Â Â Â Â  ad~city
Â Â  FROM snwd\_bpa AS bpa
Â Â  JOIN snwd\_ad AS ad ON ad~node\_key = bpa~address\_guid
Â Â  WHERE bpa~node\_key = @ls\_invoice\_head-buyer\_guid
Â Â  INTO TABLE @lt\_customer\_info.
Â Â Â Â APPEND ls\_invoice\_headÂ Â Â Â Â Â Â Â Â Â  TO et\_invoice\_header.
Â Â Â Â APPEND LINES OF lt\_invoice\_itemÂ Â TO et\_invoice\_item.
Â Â Â Â APPEND LINES OF lt\_customer\_info TO et\_customer\_info.
Â Â ENDSELECT.
Â Â "Remove duplicates
Â Â SORT et\_customer\_info BY customer\_guid.
Â Â DELETE ADJACENT DUPLICATES FROM et\_customer\_info.
ENDMETHOD.

ABAP implementation of the method OPEN\_SQL\_FOR\_ALL\_ENTRIES

METHOD open\_sql\_for\_all\_entries.
Â Â "Selection of invoices paid on a specified date
Â Â "plus business partner and product information
Â Â DATA lv\_payment\_date\_min TYPE timestamp.
Â Â DATA lv\_payment\_date\_max TYPE timestamp.
Â Â CONVERT DATE iv\_payment\_date TIME '0001'
Â Â Â Â INTO TIME STAMP lv\_payment\_date\_min TIME ZONE 'UTC'.
Â Â CONVERT DATE iv\_payment\_date TIME '2359'
Â Â Â Â INTO TIME STAMP lv\_payment\_date\_max TIME ZONE 'UTC'.
Â Â "Retrieve all invoice header which were paid on the requested date
Â Â SELECT
Â Â Â Â node\_keyÂ Â Â Â Â Â  AS invoice\_guid,
Â Â Â Â created\_atÂ Â Â Â  AS created\_at,
Â Â Â Â changed\_atÂ Â Â Â  AS paid\_at,
Â Â Â Â buyer\_guid
Â Â FROM
Â Â Â Â snwd\_so\_inv\_head
Â Â INTO TABLE @et\_invoice\_header
Â Â WHEREÂ Â Â Â Â Â Â  Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â  Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â  "#EC CI\_NOFIELD
Â Â Â Â payment\_status = 'P'
Â Â Â Â AND changed\_at BETWEEN @lv\_payment\_date\_min AND @lv\_payment\_date\_max
Â Â ORDER BY invoice\_guid.
Â Â "Get the items of those invoices
Â Â SELECT
Â Â Â Â Â Â node\_keyÂ Â  AS item\_guid,
Â Â Â Â Â Â parent\_key AS invoice\_guid,
Â Â Â Â Â Â product\_guid,
Â Â Â Â Â Â gross\_amount,
Â Â Â Â Â Â currency\_code
Â Â  from snwd\_so\_inv\_item
Â Â  into table @et\_invoice\_item
Â Â  for all entries in @et\_invoice\_header
Â Â  whereÂ Â parent\_key = @et\_invoice\_header-invoice\_guid
Â Â  order by primary key.
Â Â "Get the information about the customers
Â Â SELECT
Â Â Â Â Â Â bpa~node\_keyÂ Â Â Â  AS customer\_guid,
Â  Â Â Â Â bpa~bp\_idÂ Â Â Â Â Â Â Â AS customer\_id,
Â Â Â Â Â Â bpa~company\_name AS customer\_name,
Â Â Â Â Â Â ad~country,
Â Â Â Â Â Â ad~postal\_code,
Â Â Â Â Â Â ad~city
Â Â Â Â FROM snwd\_bpa AS bpa
Â Â Â Â JOIN snwd\_ad AS ad ON ad~node\_key = bpa~address\_guid
Â Â Â Â INTO TABLE @et\_customer\_info
Â Â Â Â FOR ALL ENTRIES IN @et\_invoice\_header
Â Â Â Â WHERE bpa~node\_key = @et\_invoice\_header-buyer\_guid.
Â Â SORT et\_customer\_info BY customer\_guid.
ENDMETHOD.

ABAP implementation of the method OPEN\_SQL\_SUBQUERY

METHOD open\_sql\_subquery.
Â Â "Selection of invoices paid on a specified date
Â Â "plus business partner and product information
Â Â DATA lv\_payment\_date\_min TYPE timestamp.
Â Â DATA lv\_payment\_date\_max TYPE timestamp.
Â Â CONVERT DATE iv\_payment\_date TIME '0001'
Â Â Â Â INTO TIME STAMP lv\_payment\_date\_min TIME ZONE 'UTC'.
Â Â CONVERT DATE iv\_payment\_date TIME '2359'
Â Â Â Â INTO TIME STAMP lv\_payment\_date\_max TIME ZONE 'UTC'.
Â Â "Retrieve all invoice header which were paid on the requested date
Â Â SELECT
Â Â  node\_keyÂ Â Â Â Â Â  AS invoice\_guid,
Â Â  created\_atÂ Â Â Â  AS created\_at,
Â Â  changed\_atÂ Â Â Â  AS paid\_at,
Â Â  buyer\_guid
FROM
Â Â  snwd\_so\_inv\_head
Â Â Â Â  WHERE
Â Â  payment\_status = 'P'
Â Â  AND changed\_at BETWEEN @lv\_payment\_date\_min AND @lv\_payment\_date\_max
ORDER BY invoice\_guid
INTO TABLE @et\_invoice\_header.
Â Â "Get the items of those invoices
Â Â SELECT
Â Â Â Â Â Â node\_keyÂ Â  AS item\_guid,
Â Â Â Â Â Â parent\_key AS invoice\_guid,
Â Â Â Â Â Â product\_guid,
Â Â Â Â Â Â gross\_amount,
Â Â Â Â Â Â currency\_code
Â Â  FROM snwd\_so\_inv\_item
Â Â  WHEREÂ Â parent\_key IN
Â Â Â Â Â Â Â Â ( SELECT node\_key FROM snwd\_so\_inv\_head
Â Â Â Â Â Â Â Â Â Â Â Â  WHERE payment\_status = 'P'
Â Â Â Â Â Â Â Â Â Â Â Â Â Â  AND changed\_at
Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â  BETWEEN @lv\_payment\_date\_min AND @lv\_payment\_date\_max )
Â Â  ORDER BY item\_guid, invoice\_guid, product\_guid
Â Â  INTO TABLE @et\_invoice\_item.
Â Â "Get the information about the customers
Â Â SELECT
Â Â Â Â Â Â bpa~node\_keyÂ Â Â Â  AS customer\_guid,
Â Â Â Â Â Â bpa~bp\_idÂ Â Â Â Â Â Â Â AS customer\_id,
Â Â Â Â Â Â bpa~company\_name AS customer\_name,
Â Â Â Â Â Â ad~country,
Â Â Â Â Â Â ad~postal\_code,
Â Â Â Â Â Â ad~city
Â Â Â Â FROM snwd\_bpa AS bpa
Â Â Â Â JOIN snwd\_ad AS ad ON ad~node\_key = bpa~address\_guid
Â Â Â Â WHERE bpa~node\_key IN ( SELECT buyer\_guid FROM snwd\_so\_inv\_head
Â Â Â Â Â Â Â Â Â Â Â Â  WHERE payment\_status = 'P'
Â Â Â Â Â Â Â Â Â Â Â Â Â Â  AND changed\_at
Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â  BETWEEN @lv\_payment\_date\_min AND @lv\_payment\_date\_max )
Â Â Â Â ORDER BY customer\_id
Â Â Â Â INTO TABLE @et\_customer\_info.
ENDMETHOD.



**ðŸ“– Source**: [abenamdp_vs_open_sql_abexa.htm](https://help.sap.com/doc/abapdocu_752_index_htm/7.52/en-US/abenamdp_vs_open_sql_abexa.htm)

### abenamdp_functions_abexa.htm

> **ðŸ“– Official SAP Documentation**: [abenamdp_functions_abexa.htm](https://help.sap.com/doc/abapdocu_752_index_htm/7.52/en-US/abenamdp_functions_abexa.htm)
> **ðŸ” Direct Link**: This section contains the complete content from the official SAP ABAP documentation page.


Â  

* * *

SAP NetWeaver AS ABAP Release 752, Â©Copyright 2017 SAP AG. All rights reserved.

[ABAP - Keyword Documentation](javascript:call_link\('abenabap.htm'\))Â â†’Â  [ABAP - Reference](javascript:call_link\('abenabap_reference.htm'\))Â â†’Â  [Processing External Data](javascript:call_link\('abenabap_language_external_data.htm'\))Â â†’Â  [ABAP Database Accesses](javascript:call_link\('abenabap_sql.htm'\))Â â†’Â  [AMDP - ABAP Managed Database Procedures](javascript:call_link\('abenamdp.htm'\))Â â†’Â  [AMDP - Examples](javascript:call_link\('abenamdp_abexas.htm'\))Â â†’Â 

AMDP, AMDP Functions

This example demonstrates AMDP functions and how they are used.

Source Code

REPORT demo\_amdp\_functions\_inpcl.
CLASS demo DEFINITION.
Â Â PUBLIC SECTION.
Â Â Â Â CLASS-METHODS main.
ENDCLASS.
CLASS demo IMPLEMENTATION.
Â Â METHOD main.
Â Â Â Â IF NOT cl\_abap\_dbfeatures=>use\_features(
Â Â Â Â Â Â Â Â Â Â EXPORTING
Â Â Â Â Â Â Â Â Â Â Â Â requested\_features =
Â Â Â Â Â Â Â Â Â Â Â Â Â Â VALUE #( ( cl\_abap\_dbfeatures=>call\_amdp\_method )
Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â  ( cl\_abap\_dbfeatures=>amdp\_table\_function ) ) ).
Â Â Â Â Â Â cl\_demo\_output=>display(
Â Â Â Â Â Â Â Â \`System does not support AMDP or CDS table functions\` ).
Â Â Â Â Â Â RETURN.
Â Â Â Â ENDIF.
Â Â Â Â DATA carrid TYPE s\_carr\_id VALUE 'LH'.
Â Â Â Â cl\_demo\_input=>request( CHANGING field = carrid ).
Â Â Â Â carrid = to\_upper( carrid ).
Â Â Â Â "Database function selected in database procedure
Â Â Â Â TRY.
Â Â Â Â Â Â Â Â NEW cl\_demo\_amdp\_functions\_inpcl( )->select\_get\_scarr\_spfli(
Â Â Â Â Â Â Â Â Â Â EXPORTING clntÂ Â  = sy-mandt
Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â carrid = carrid
Â Â Â Â Â Â Â Â Â Â IMPORTING scarr\_spfli\_tab = DATA(result1) ).
Â Â Â Â Â Â CATCH cx\_amdp\_error INTO DATA(amdp\_error).
Â Â Â Â Â Â Â Â cl\_demo\_output=>display( amdp\_error->get\_text( ) ).
Â Â Â Â Â Â Â Â RETURN.
Â Â Â Â ENDTRY.
Â Â Â Â "Database function selected via CDS entity
Â Â Â Â SELECT \*
Â Â Â Â Â Â Â Â Â Â  FROM demo\_cds\_get\_scarr\_spfli\_inpcl( carrid = @carrid )
Â Â Â Â Â Â Â Â Â Â  INTO TABLE @DATA(result2)
Â Â Â Â Â Â Â Â Â Â  ##db\_feature\_mode\[amdp\_table\_function\].
Â Â Â Â ASSERT result1 = result2.
Â Â Â Â cl\_demo\_output=>display( result1 ).Â Â ENDMETHOD.
ENDCLASS.
START-OF-SELECTION.
Â Â demo=>main( ).

Description

This example access [AMDP functions](javascript:call_link\('abenamdp_function_glosry.htm'\) "Glossary Entry") that are declared and implemented in the [AMDP class](javascript:call_link\('abenamdp_class_glosry.htm'\) "Glossary Entry") CL\_DEMO\_AMDP\_FUNCTIONS\_INPCL.

-   The method GET\_SCARR\_SPFLI is an [AMDP function implementation](javascript:call_link\('abenamdp_function_methods.htm'\)) for other AMDP methods with explicitly declared interfaces. It cannot be called in ABAP.

METHOD get\_scarr\_spfli BY DATABASE FUNCTION FOR HDB
Â Â Â Â  Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â  LANGUAGE SQLSCRIPT
Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â  OPTIONS READ-ONLY
Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â  USING scarr spfli.
Â Â RETURN SELECT sc.carrname, sp.connid, sp.cityfrom, sp.cityto
Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â FROM scarr AS sc
Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â INNER JOIN spfli AS sp ON sc.mandt = sp.mandt AND
Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â  Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â sc.carrid = sp.carrid
Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â WHERE sp.mandt = :clnt AND sp.carrid = :carrid
Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â ORDER BY sc.mandt, sc.carrname, sp.connid;
ENDMETHOD.

-   The method SELECT\_GET\_SCARR\_SPFLI is an [AMDP procedure implementation](javascript:call_link\('abenamdp_procedure_methods.htm'\)) that uses SELECT to access the AMDP function implemented in the method GET\_SCARR\_SPFLI. This method is called in the example program.

METHOD select\_get\_scarr\_spfli
Â Â Â Â Â Â  BY DATABASE PROCEDURE FOR HDB
Â Â Â Â Â Â  LANGUAGE SQLSCRIPT
Â Â Â Â Â Â  OPTIONS READ-ONLY
Â Â Â Â Â Â  USING cl\_demo\_amdp\_functions\_inpcl=>get\_scarr\_spfli.
Â Â SCARR\_SPFLI\_TAB =
Â Â SELECT \*
Â Â Â Â Â Â Â Â  FROM "CL\_DEMO\_AMDP\_FUNCTIONS\_INPCL=>GET\_SCARR\_SPFLI"(
Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â clnt => :clnt,
Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â carrid => :carrid );
ENDMETHOD.

-   The method GET\_SCARR\_SPFLI\_FOR\_CDS is an [AMDP function implementation](javascript:call_link\('abenamdp_function_methods.htm'\)) for the [CDS table function](javascript:call_link\('abencds_table_function_glosry.htm'\) "Glossary Entry") DEMO\_CDS\_GET\_SCARR\_SPFLI\_INPCL shown as an example of the DDL statement [DEFINE TABLE FUNCTION](javascript:call_link\('abencds_f1_define_table_function.htm'\)).

@ClientHandling.type: #CLIENT\_DEPENDENT
define table function DEMO\_CDS\_GET\_SCARR\_SPFLI\_INPCL
Â Â with parameters
Â Â Â Â @Environment.systemField: #CLIENT
Â Â Â Â clntÂ Â  :abap.clnt,
Â Â Â Â carrid :s\_carr\_id
Â Â returns
Â Â {
Â Â Â Â clientÂ Â  :s\_mandt;
Â Â Â Â carrname :s\_carrname;
Â Â Â Â connidÂ Â  :s\_conn\_id;
Â Â Â Â cityfrom :s\_from\_cit;
Â Â Â Â citytoÂ Â  :s\_to\_city;
Â Â }
Â Â implemented by method
Â Â Â Â CL\_DEMO\_AMDP\_FUNCTIONS\_INPCL=>GET\_SCARR\_SPFLI\_FOR\_CDS;

This method is declared using the addition [FOR TABLE FUNCTION](javascript:call_link\('abapclass-methods_for_tabfunc.htm'\)) and its interface is determined using theCDS table function. The example program uses [SELECT](javascript:call_link\('abapselect.htm'\)) to access the CDS table function. The input parameter is filled here.

METHOD get\_scarr\_spfli\_for\_cds
Â Â Â Â Â Â  BY DATABASE FUNCTION FOR HDB
Â Â Â Â Â Â  LANGUAGE SQLSCRIPT
Â Â Â Â Â Â  OPTIONS READ-ONLY
Â Â Â Â Â Â  USING scarr spfli.
Â Â RETURN SELECT sc.mandt as client,
Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â sc.carrname, sp.connid, sp.cityfrom, sp.cityto
Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â FROM scarr AS sc
Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â INNER JOIN spfli AS sp ON sc.mandt = sp.mandt AND
Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â  Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â sc.carrid = sp.carrid
Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â WHERE sp.mandt = :clnt AND
Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â sp.carrid = :carrid
Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â ORDER BY sc.mandt, sc.carrname, sp.connid;
ENDMETHOD.

Both accesses produce the same result (verified by the statement [ASSERT](javascript:call_link\('abapassert.htm'\))).

Note

The CDS table function DEMO\_CDS\_GET\_SCARR\_SPFLI\_INPCL used here has one input parameter for the client, annotated using the annotation [@Environment.systemField](javascript:call_link\('abencds_f1_parameter_annotations.htm'\)) and the predefined value [#CLIENT](javascript:call_link\('abencds_f1_parameter_annotations.htm'\)). This input parameter is filled explicitly with the ID of the current client by the Open SQL statement SELECT and used in the implementation of the associated AMDP method for selecting the data. The nearly identical program DEMO\_AMDP\_FUNCTIONS uses the following CDS table function DEMO\_CDS\_GET\_SCARR\_SPFLI in which the current client is selected from the results set of the table function.

@ClientHandling.type: #CLIENT\_DEPENDENT
@AccessControl.authorizationCheck:#NOT\_ALLOWED
define table function DEMO\_CDS\_GET\_SCARR\_SPFLI
Â Â with parameters
Â Â Â Â carrid :s\_carr\_id
Â Â returns
Â Â {
Â Â Â Â clientÂ Â  :s\_mandt;
Â Â Â Â carrname :s\_carrname;
Â Â Â Â connidÂ Â  :s\_conn\_id;
Â Â Â Â cityfrom :s\_from\_cit;
Â Â Â Â citytoÂ Â  :s\_to\_city;
Â Â }
Â Â implemented by method
Â Â Â Â CL\_DEMO\_AMDP\_FUNCTIONS=>GET\_SCARR\_SPFLI\_FOR\_CDS;



**ðŸ“– Source**: [abenamdp_functions_abexa.htm](https://help.sap.com/doc/abapdocu_752_index_htm/7.52/en-US/abenamdp_functions_abexa.htm)

### abenamdp_abap_types_abexa.htm

> **ðŸ“– Official SAP Documentation**: [abenamdp_abap_types_abexa.htm](https://help.sap.com/doc/abapdocu_752_index_htm/7.52/en-US/abenamdp_abap_types_abexa.htm)
> **ðŸ” Direct Link**: This section contains the complete content from the official SAP ABAP documentation page.


Â  

* * *

SAP NetWeaver AS ABAP Release 752, Â©Copyright 2017 SAP AG. All rights reserved.

[ABAP - Keyword Documentation](javascript:call_link\('abenabap.htm'\))Â â†’Â  [ABAP - Reference](javascript:call_link\('abenabap_reference.htm'\))Â â†’Â  [Processing External Data](javascript:call_link\('abenabap_language_external_data.htm'\))Â â†’Â  [ABAP Database Accesses](javascript:call_link\('abenabap_sql.htm'\))Â â†’Â  [AMDP - ABAP Managed Database Procedures](javascript:call_link\('abenamdp.htm'\))Â â†’Â  [AMDP - Examples](javascript:call_link\('abenamdp_abexas.htm'\))Â â†’Â 

AMDP, Access to ABAP Types

The example demonstrates how to access ABAP types via the [AMDP macro](javascript:call_link\('abenamdp_macro_glosry.htm'\) "Glossary Entry") [$ABAP.type](javascript:call_link\('abenamdp_abap_types.htm'\)).

Source Code

REPORT demo\_amdp\_abap\_types.
CLASS demo DEFINITION.
Â Â PUBLIC SECTION.
Â Â Â Â CLASS-METHODS main.
ENDCLASS.
CLASS demo IMPLEMENTATION.
Â Â METHOD main.
Â Â Â Â DATA itab TYPE cl\_demo\_amdp\_abap\_types=>itab.
Â Â Â Â cl\_demo\_amdp\_abap\_types=>demo\_abap\_types( IMPORTING itab = itab ).
Â Â Â Â cl\_demo\_output=>display( itab ).Â Â ENDMETHOD.
ENDCLASS.
START-OF-SELECTION.
Â Â demo=>main( ).

Description

This example calls the following [AMDP method](javascript:call_link\('abenamdp_method_glosry.htm'\) "Glossary Entry") of class CL\_DEMO\_AMDP\_ABAP\_TYPES:

METHOD demo\_abap\_types BY DATABASE PROCEDURE
Â Â Â Â Â Â  Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â  FOR HDB LANGUAGE SQLSCRIPT.
Â Â DECLARE mytab table( mandtÂ Â "$ABAP.type( mandt )",
Â Â Â  Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â  unameÂ Â "$ABAP.type( syst\_uname )",
Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â  languÂ Â "$ABAP.type( syst\_langu )",
Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â  datumÂ Â "$ABAP.type( syst\_datum )",
Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â  textÂ Â  "$ABAP.type( line-text )",
Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â  number "$ABAP.type( f )" );
Â Â mytab.mandt\[1\]Â Â := session\_context('CLIENT');
Â Â mytab.uname\[1\]Â Â := session\_context('APPLICATIONUSER');
Â Â mytab.langu\[1\]Â Â := session\_context('LOCALE\_SAP');
Â Â mytab.datum\[1\]Â Â := session\_context('SAP\_SYSTEM\_DATE');
Â Â mytab.text\[1\]Â Â  := cast( 0123456789 as "$ABAP.type( line-text )" );
Â Â mytab.number\[1\] := 333 ;
Â Â itab = select \* from :mytab;
ENDMETHOD.

In [SQLScript](javascript:call_link\('abensql_script_glosry.htm'\) "Glossary Entry") a local table variable mytab is declared with DECLARE in the method. All columns of the table variable are declared via the [AMDP macro](javascript:call_link\('abenamdp_macro_glosry.htm'\) "Glossary Entry") [$ABAP.type](javascript:call_link\('abenamdp_abap_types.htm'\)) with reference to ABAP types. The first four ABAP types MANDT, SYST\_UNAME, SYST\_LANGU and SYST\_DATUM are defined in ABAP Dictionary. Type line\_text comes from a TYPES statement of its own class. f stands for the built-in numeric ABAP type.

The table variable is filled using assignments to columns with one row, whereby the specification of the AMDP macro $ABAP.type is displayed in a CAST expression. Finally, the content of the table variable is imported into the tabular output parameter itab, whose row type is made up of components of the same ABAP types, which are used to define the table variable.



**ðŸ“– Source**: [abenamdp_abap_types_abexa.htm](https://help.sap.com/doc/abapdocu_752_index_htm/7.52/en-US/abenamdp_abap_types_abexa.htm)

### abenamdp_db_schema_abexa.htm

> **ðŸ“– Official SAP Documentation**: [abenamdp_db_schema_abexa.htm](https://help.sap.com/doc/abapdocu_752_index_htm/7.52/en-US/abenamdp_db_schema_abexa.htm)
> **ðŸ” Direct Link**: This section contains the complete content from the official SAP ABAP documentation page.


Â  

* * *

SAP NetWeaver AS ABAP Release 752, Â©Copyright 2017 SAP AG. All rights reserved.

[ABAP - Keyword Documentation](javascript:call_link\('abenabap.htm'\))Â â†’Â  [ABAP - Reference](javascript:call_link\('abenabap_reference.htm'\))Â â†’Â  [Processing External Data](javascript:call_link\('abenabap_language_external_data.htm'\))Â â†’Â  [ABAP Database Accesses](javascript:call_link\('abenabap_sql.htm'\))Â â†’Â  [AMDP - ABAP Managed Database Procedures](javascript:call_link\('abenamdp.htm'\))Â â†’Â  [AMDP - Examples](javascript:call_link\('abenamdp_abexas.htm'\))Â â†’Â 

AMDP, Access to Database Schemas

This example demonstrates how a table is accessed in a different [database schema](javascript:call_link\('abendatabase_schema_glosry.htm'\) "Glossary Entry").

Source Code

REPORT demo\_amdp\_db\_schema.
CLASS demo DEFINITION.
Â Â PUBLIC SECTION.
Â Â Â Â CLASS-METHODS main.
ENDCLASS.
CLASS demo IMPLEMENTATION.
Â Â METHOD main.
Â Â Â Â IF NOT cl\_abap\_dbfeatures=>use\_features(
Â Â Â Â Â Â Â Â Â Â EXPORTING
Â Â Â Â Â Â Â Â Â Â Â Â requested\_features =
Â Â Â Â Â Â Â Â Â Â Â Â Â Â VALUE #( ( cl\_abap\_dbfeatures=>call\_amdp\_method ) ) ).
Â Â Â Â Â Â cl\_demo\_output=>display(
Â Â Â Â Â Â Â Â \`Current database system does not support AMDP procedures\` ).
Â Â Â Â Â Â RETURN.
Â Â Â Â ENDIF.
Â Â Â Â TRY.
Â Â Â Â Â Â Â Â cl\_demo\_amdp\_db\_schema=>get\_schemas\_physical(
Â Â Â Â Â Â Â Â Â Â IMPORTING schemas = DATA(schemas\_test) ).
Â Â Â Â Â Â CATCH cx\_amdp\_error INTO DATA(amdp\_error).
Â Â Â Â Â Â Â Â cl\_demo\_output=>display( amdp\_error->get\_text( ) ).
Â Â Â Â Â Â Â Â RETURN.
Â Â Â Â ENDTRY.
Â Â Â Â TRY.
Â Â Â Â Â Â Â Â cl\_demo\_amdp\_db\_schema=>get\_schemas\_logical(
Â Â Â Â Â Â Â Â Â Â IMPORTING schemas = DATA(schemas) ).
Â Â Â Â Â Â CATCH cx\_amdp\_error INTO amdp\_error.
Â Â Â Â Â Â Â Â cl\_demo\_output=>display( amdp\_error->get\_text( ) ).
Â Â Â Â Â Â Â Â RETURN.
Â Â Â Â ENDTRY.
Â Â Â Â ASSERT schemas\_test = schemas.
Â Â Â Â cl\_demo\_output=>display( schemas ).Â Â ENDMETHOD.
ENDCLASS.
START-OF-SELECTION.
Â Â demo=>main( ).

Description

This example accesses [AMDP methods](javascript:call_link\('abenamdp_method_glosry.htm'\) "Glossary Entry") that are declared and implemented in the [AMDP class](javascript:call_link\('abenamdp_class_glosry.htm'\) "Glossary Entry") CL\_DEMO\_AMDP\_DB\_SCHEMA.

-   The method GET\_SCHEMAS\_PHYSICAL accesses the table SCHEMAS of the physical database schema SYS by specifying the schema directly. All existing database schema are saved in this table.

METHOD get\_schemas\_physical BY DATABASE PROCEDURE
Â Â Â Â Â  Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â FOR HDB LANGUAGE SQLSCRIPT.
Â Â schemas =
Â Â Â Â select schema\_name
Â Â Â Â Â Â FROM "SYS"."SCHEMAS";
ENDMETHOD.

-   The method GET\_SCHEMAS\_LOGICAL accesses the physical database schema that is mapped to the [logical database schema](javascript:call_link\('abenlogical_database_schema_glosry.htm'\) "Glossary Entry") DEMO\_LOGICAL\_DB\_SCHEMA in transaction DB\_SCHEMA\_MAP by specifying the [AMDP macro](javascript:call_link\('abenamdp_macro_glosry.htm'\) "Glossary Entry"). If this is SYS, the same table is accessed.

METHOD get\_schemas\_logical BY DATABASE PROCEDURE
Â Â Â Â Â  Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â  FOR HDB LANGUAGE SQLSCRIPT.
Â Â schemas =
Â Â Â Â select schema\_name
Â Â Â Â Â Â FROM "$ABAP.schema( DEMO\_LOGICAL\_DB\_SCHEMA )"."SCHEMAS";
ENDMETHOD.



**ðŸ“– Source**: [abenamdp_db_schema_abexa.htm](https://help.sap.com/doc/abapdocu_752_index_htm/7.52/en-US/abenamdp_db_schema_abexa.htm)

### abenamdp_l_abexa.htm

> **ðŸ“– Official SAP Documentation**: [abenamdp_l_abexa.htm](https://help.sap.com/doc/abapdocu_752_index_htm/7.52/en-US/abenamdp_l_abexa.htm)
> **ðŸ” Direct Link**: This section contains the complete content from the official SAP ABAP documentation page.


**ðŸ“– Source**: [abenamdp_l_abexa.htm](https://help.sap.com/doc/abapdocu_752_index_htm/7.52/en-US/abenamdp_l_abexa.htm)


Â  

* * *

SAP NetWeaver AS ABAP Release 752, Â©Copyright 2017 SAP AG. All rights reserved.

[ABAP - Keyword Documentation](javascript:call_link\('abenabap.htm'\))Â â†’Â  [ABAP - Reference](javascript:call_link\('abenabap_reference.htm'\))Â â†’Â  [Processing External Data](javascript:call_link\('abenabap_language_external_data.htm'\))Â â†’Â  [ABAP Database Accesses](javascript:call_link\('abenabap_sql.htm'\))Â â†’Â  [AMDP - ABAP Managed Database Procedures](javascript:call_link\('abenamdp.htm'\))Â â†’Â  [AMDP - Examples](javascript:call_link\('abenamdp_abexas.htm'\))Â â†’Â 

AMDP, Implementation of an L Procedure

This example demonstrates the implementation of a procedure in the programming language [L](javascript:call_link\('abenllang_glosry.htm'\) "Glossary Entry") using AMDP.

Source Code

REPORT demo\_amdp\_l\_language.
CLASS demo DEFINITION.
Â Â PUBLIC SECTION.
Â Â Â Â CLASS-METHODS main.
ENDCLASS.
CLASS demo IMPLEMENTATION.
Â Â METHOD main.
Â Â Â Â IF cl\_db\_sys=>is\_in\_memory\_db = abap\_false.
Â Â Â Â Â Â cl\_demo\_output=>display(
Â Â Â Â Â Â Â Â \`Example can be executed on SAP HANA Database only\` ).
Â Â Â Â Â Â LEAVE PROGRAM.
Â Â Â Â ENDIF.
Â Â Â Â DATA(text) = \`World\`.
Â Â Â Â cl\_demo\_input=>request( CHANGING field = text ).
Â Â Â Â IF text IS INITIAL.
Â Â Â Â Â Â RETURN.
Â Â Â Â ENDIF.
Â Â Â Â TRY.
Â Â Â Â Â Â Â Â NEW cl\_demo\_amdp\_l\_hello\_world(
Â Â Â Â Â Â Â Â Â Â Â Â Â Â )->hello\_world( EXPORTING textÂ Â = text
Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â IMPORTING texts = DATA(texts) ).
Â Â Â Â Â Â CATCH cx\_amdp\_error INTO DATA(amdp\_error).
Â Â Â Â Â Â Â Â cl\_demo\_output=>display( amdp\_error->get\_text( ) ).
Â Â Â Â Â Â Â Â RETURN.
Â Â Â Â ENDTRY.
Â Â Â Â cl\_demo\_output=>display( texts ).Â Â ENDMETHOD.
ENDCLASS.
START-OF-SELECTION.
Â Â demo=>main( ).

Description

The following [L procedure](javascript:call_link\('abenl_procedure_glosry.htm'\) "Glossary Entry") is implemented in the AMDP method HELLO\_WORLD of the AMDP class CL\_DEMO\_AMDP\_L\_HELLO\_WORLD:

METHOD hello\_world BY DATABASE PROCEDURE
Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â  FOR HDB LANGUAGE LLANG
Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â  OPTIONS READ-ONLY.
\* Hello World in L
Â Â typedef Table <String "TEXT"> TT\_TABLE;Â Â /\* Type definition
Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â  Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â repeatedÂ Â \*/
Â Â //Main entry point
Â Â export Void main(String text, TT\_TABLE & texts)
Â Â Â Â { String hello = String("Hello ");
Â Â Â Â Â Â texts."TEXT"\[0z\] = hello.append( text ).append( "!" ); }
ENDMETHOD.

The tabular output parameter is created from a predefined text and an interactive input made in the ABAP program.

Note

The programming language L can only be used internally and with restrictions at SAP. For general programming with the SAP HANA database, [SQL](javascript:call_link\('abensql_glosry.htm'\) "Glossary Entry") or the script language [SQLScript](javascript:call_link\('abensql_script_glosry.htm'\) "Glossary Entry") must be used. The use of L by customers and partners is not supported.
