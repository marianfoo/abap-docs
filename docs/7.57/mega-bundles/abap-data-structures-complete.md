# ABAP DATA-STRUCTURES - Complete Reference (7.57)

**Generated**: 2025-09-01T19:38:22.828Z
**Bundles Combined**: 38
**Category**: data-structures

---


## ABAP - Keyword Documentation / ABAP - Dictionary (DDIC) / DDIC - Data Types / DDIC - Table Types

**Files**: 4 | **Difficulty**: intermediate

# ABAP - Keyword Documentation / ABAP - Dictionary (DDIC) / DDIC - Data Types / DDIC - Table Types

Included pages: 4


### abenddic_table_types.htm

---
title: "DDIC - Table Types"
description: |
  A DDIC table type(https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abenddic_table_type_glosry.htm 'Glossary Entry') defines the data type of an internal table(https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abeninternal_table_glosry.htm 'Glossary Entry') in ABAP. The DDIC ta
version: "7.57"
category: "data-structures"
type: "abap-reference"
sourceUrl: "https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abenddic_table_types.htm"
abapFile: "abenddic_table_types.htm"
keywords: ["do", "if", "try", "class", "data", "types", "internal-table", "abenddic", "table"]
---

* * *

AS ABAP Release 757, ©Copyright 2023 SAP SE. All rights reserved.

[ABAP - Keyword Documentation](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abenabap.htm) →  [ABAP - Dictionary (DDIC)](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abenabap_dictionary.htm) →  [DDIC - Data Types](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abenddic_data_types.htm) → 

 [![](Mail.gif?object=Mail.gif&sap-language=EN "Feedback mail for displayed topic") Mail Feedback](mailto:f1_help@sap.com?subject=Feedback on ABAP Documentation&body=Document: DDIC - Table Types, ABENDDIC_TABLE_TYPES, 757%0D%0A%0D%0AError:%0D%0A%0D%0A%0D%0A%0D%
0ASuggestion for improvement:)

DDIC - Table Types

A [DDIC table type](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abenddic_table_type_glosry.htm "Glossary Entry") defines the data type of an [internal table](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abeninternal_table_glosry.htm "Glossary Entry") in ABAP. The DDIC table type defines the following in an internal table:

-   [Line type](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abenrow_type_glosry.htm "Glossary Entry")
-   The [table category](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abentable_category_glosry.htm "Glossary Entry")
-   The [table key](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abentable_key_glosry.htm "Glossary Entry")

A program-internal object declared with reference to a table type is an internal table of this type.

-   [Technical properties of table types](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abenddic_table_types_tech.htm)
-   [Semantic properties of table types](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abenddic_table_types_sema.htm)

Hints

-   Unlike in [data elements](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abenddic_data_elements.htm) and [DDIC structures](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abenddic_structures.htm), the DDIC table types exist only to create globally visible definitions of internal tables. DDIC table types replace the definition of internal tables in [type pools](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abentype_pool_glosry.htm "Glossary Entry") and can themselves be replaced using the declaration of internal table types in global classes and interfaces (if the context where the type is required is suitable). The properties of an internal table that can be defined in the ABAP Dictionary match those that can be specified using the statement [TYPES ... TABLE OF](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abaptypes_itab.htm) in ABAP programs completely. For more information, see the in-depth documentation about [internal tables](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abenitab.htm) in the ABAP programming language.
-   The name of a table type must follow the [naming rules for DDIC data types](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abenddic_types_names.htm).

Example

The table type SPFLI\_KEY\_TAB describes a hashed table with the structured line type SPFLI with a unique primary key and two non-unique secondary table keys.

Continue
[DDIC - Technical Properties of Table Types](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abenddic_table_types_tech.htm)
[DDIC - Semantic Properties of Table Types](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abenddic_table_types_sema.htm)
[DDIC - Ranges Table Type](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abenddic_table_types_ranges.htm)


### abenddic_table_types_tech.htm

---
title: "DDIC - Technical Properties of Table Types"
description: |
  A table type describes an internal table(https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abeninternal_table_glosry.htm 'Glossary Entry') with the following technical properties: -   Line type The line type can be defined as follows: -   Any line type can be defined by referencing any d
version: "7.57"
category: "data-structures"
type: "abap-reference"
sourceUrl: "https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abenddic_table_types_tech.htm"
abapFile: "abenddic_table_types_tech.htm"
keywords: ["loop", "do", "if", "try", "method", "data", "types", "internal-table", "field-symbol", "abenddic", "table", "tech"]
---

* * *

AS ABAP Release 757, ©Copyright 2023 SAP SE. All rights reserved.

[ABAP - Keyword Documentation](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abenabap.htm) →  [ABAP - Dictionary (DDIC)](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abenabap_dictionary.htm) →  [DDIC - Data Types](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abenddic_data_types.htm) →  [DDIC - Table Types](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abenddic_table_types.htm) → 

 [![](Mail.gif?object=Mail.gif&sap-language=EN "Feedback mail for displayed topic") Mail Feedback](mailto:f1_help@sap.com?subject=Feedback on ABAP Documentation&body=Document: DDIC - Technical Properties of Table Types, ABENDDIC_TABLE_TYPES_TECH, 757%0D%0A%0D%0
AError:%0D%0A%0D%0A%0D%0A%0D%0ASuggestion for improvement:)

DDIC - Technical Properties of Table Types

A table type describes an [internal table](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abeninternal_table_glosry.htm "Glossary Entry") with the following technical properties:

-   Line type
    
    The line type can be defined as follows:
    
    -   Any line type can be defined by referencing any [data type](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abenddic_data_types.htm), including [DDIC database tables](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abenddic_database_tables.htm) and [DDIC views](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abenddic_views.htm) in the ABAP Dictionary.
    -   Elementary or reference-like line types can also be specified by using their technical properties directly. This is done in the same way as with [data elements](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abenddic_data_elements.htm) or [structure components](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abenddic_structures_tech.htm).
-   Table category
    
    The table category can be specified as follows:
    
    -   [Standard table](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abenstandard_table_glosry.htm "Glossary Entry")
    -   [Sorted table](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abensorted_table_glosry.htm "Glossary Entry")
    -   [Hashed table](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abenhashed_table_glosry.htm "Glossary Entry")
    -   [Index table](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abenindex_table_glosry.htm "Glossary Entry") as a generic table category for standard tables and sorted tables
    -   Any table as a generic table category for all table categories
    
    These methods are the same as defining the table category using the statement [TYPES](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abaptypes_tabcat.htm).
    
-   Table key
    
    The following can be defined as table keys:
    
    -   A primary key as a [primary table key](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abenprimary_table_key_glosry.htm "Glossary Entry"). The primary key is either the [standard key](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abenstandard_key_glosry.htm "Glossary Entry"), the entire table line if it is not a table type, or does not contain a table type as a component, or is determined using individual components of a structured line type in the relevant order. A primary key of sorted tables and hashed tables can be given a unique [alias name](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abenalias_glosry.htm "Glossary Entry") from the namespace of the secondary keys. It is currently not possible to specify an [empty primary table key](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abenitab_empty_key.htm) explicitly in the ABAP Dictionary. The uniqueness of the primary key is unique or non-unique, depending on the table category, and cannot be specified for generic tables. If no primary key is specified or its uniqueness is not defined, the table type is generic for this property.
    -   Up to 15 secondary keys as [secondary table keys](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abensecondary_table_key_glosry.htm "Glossary Entry"). Each secondary key has a unique name, which cannot be PRIMARY\_KEY or LOOP\_KEY, and is either a sorted key or a hash key. Sorted keys can be either unique or non-unique and a hash key is always unique. A secondary key is defined either by the entire table line, if it is not a table type or does not contain a table type as component, or by using individual components of a structured line type in the relevant order. Using the additions [WITH](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abaptypes_keydef.htm) or [WITHOUT FURTHER SECONDARY KEYS](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abaptypes_keydef.htm) of the statement TYPES, it is possible to define explicitly whether the table type is generic with respect to the secondary keys. It is currently not possible to specify an [alias name](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abenalias_glosry.htm "Glossary Entry") for a secondary key in the ABAP Dictionary.
-   Initial row count
    
    This specification is a hint for the internal memory management of internal tables and corresponds to the addition [INITIAL SIZE](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abaptypes_itab.htm) in the declaration of an internal table in an ABAP program.
    

Hints

-   Generic table types, that is, table types for which one or more properties are generic can only be used in ABAP for [generic typings](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abengeneric_typing_glosry.htm "Glossary Entry") of formal parameters or field symbols.
-   A line type cannot be defined using a reference to a [CDS entity](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abencds_entity_glosry.htm "Glossary Entry"), nor using a reference to a [CDS-managed DDIC view (obsolete)](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abencds_mngdddic_view_glosry.htm "Glossary Entry") of a corresponding [CDS DDIC-based views (obsolete)](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abencds_v1_view_glosry.htm "Glossary Entry"). The reason is that CDS-managed DDIC views (obsolete) are [obsolete](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abencds_access_obsolete.htm).


### abenddic_table_types_sema.htm

---
title: "DDIC - Semantic Properties of Table Types"
description: |
  Table types in the ABAP Dictionary can be given the following semantic properties: -   Short text of the table type Each table type is assigned a short descriptive text that must be specified when it is created. -   Documentation A table type can be assigned documentation that can be read as require
version: "7.57"
category: "data-structures"
type: "abap-reference"
sourceUrl: "https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abenddic_table_types_sema.htm"
abapFile: "abenddic_table_types_sema.htm"
keywords: ["do", "if", "data", "types", "abenddic", "table", "sema"]
---

* * *

AS ABAP Release 757, ©Copyright 2023 SAP SE. All rights reserved.

[ABAP - Keyword Documentation](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abenabap.htm) →  [ABAP - Dictionary (DDIC)](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abenabap_dictionary.htm) →  [DDIC - Data Types](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abenddic_data_types.htm) →  [DDIC - Table Types](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abenddic_table_types.htm) → 

 [![](Mail.gif?object=Mail.gif&sap-language=EN "Feedback mail for displayed topic") Mail Feedback](mailto:f1_help@sap.com?subject=Feedback on ABAP Documentation&body=Document: DDIC - Semantic Properties of Table Types, ABENDDIC_TABLE_TYPES_SEMA, 757%0D%0A%0D%0A
Error:%0D%0A%0D%0A%0D%0A%0D%0ASuggestion for improvement:)

DDIC - Semantic Properties of Table Types

Table types in the ABAP Dictionary can be given the following semantic properties:

-   Short text of the table type
    
    Each table type is assigned a short descriptive text that must be specified when it is created.
    
-   Documentation
    
    A table type can be assigned documentation that can be read as required.
    
-   Short description of a secondary key
    
    Each secondary key his assigned a short descriptive text that must be specified when it is created.


### abenddic_table_types_ranges.htm

---
title: "DDIC - Ranges Table Type"
description: |
  A ranges table type is a table type for a ranges table(https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abenranges_table_glosry.htm 'Glossary Entry'). A ranges table is a standard table with a standard key and a specially structured line type and can be used in general logical expression
version: "7.57"
category: "data-structures"
type: "abap-reference"
sourceUrl: "https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abenddic_table_types_ranges.htm"
abapFile: "abenddic_table_types_ranges.htm"
keywords: ["select", "do", "if", "try", "data", "types", "abenddic", "table", "ranges"]
---

* * *

AS ABAP Release 757, ©Copyright 2023 SAP SE. All rights reserved.

[ABAP - Keyword Documentation](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abenabap.htm) →  [ABAP - Dictionary (DDIC)](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abenabap_dictionary.htm) →  [DDIC - Data Types](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abenddic_data_types.htm) →  [DDIC - Table Types](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abenddic_table_types.htm) → 

 [![](Mail.gif?object=Mail.gif&sap-language=EN "Feedback mail for displayed topic") Mail Feedback](mailto:f1_help@sap.com?subject=Feedback on ABAP Documentation&body=Document: DDIC - Ranges Table Type, ABENDDIC_TABLE_TYPES_RANGES, 757%0D%0A%0D%0AError:%0D%0A%0D
%0A%0D%0A%0D%0ASuggestion for improvement:)

DDIC - Ranges Table Type

A ranges table type is a table type for a [ranges table](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abenranges_table_glosry.htm "Glossary Entry"). A ranges table is a standard table with a standard key and a specially structured line type and can be used in general logical expressions with the relational expression [IN range tab](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abenlogexp_select_option.htm) or used after WHERE in ABAP SQL with the relational expression [IN range tab](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abenwhere_logexp_seltab.htm). In the ABAP Dictionary, ranges table types are created in the same way as with the statement [TYPES ... RANGE OF](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abaptypes_ranges.htm).

The data types of the components SIGN and OPTION are the data elements DDSIGN and DDOPTION. The data type for the components LOW and HIGH must be elementary and can be specified directly as a [built-in data type](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abenddic_builtin_types.htm) or using a [data element](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abenddic_data_elements.htm).

The structure of the ranges table must be a standalone DDIC structure. When a ranges table type is defined, it can be created from the type specifications for the components LOW and HIGH.

Hints

-   In ABAP programs, ranges tables can also be defined with reference to data types other than elementary data types.
-   In ABAP programs, the structure of a ranges table does not need to be a standalone structure.


---


## ABAP - Keyword Documentation / ABAP - Core Data Services (ABAP CDS) / ABAP CDS - Data Definitions / ABAP CDS - DDL for Data Definitions / ABAP CDS - CDS Entities / ABAP CDS - Table Functions / ABAP CDS - Client Handling in CDS Table Functions

**Files**: 4 | **Difficulty**: advanced

# ABAP - Keyword Documentation / ABAP - Core Data Services (ABAP CDS) / ABAP CDS - Data Definitions / ABAP CDS - DDL for Data Definitions / ABAP CDS - CDS Entity Extension / CDS DDL - EXTEND VIEW ddic_based

Included pages: 2


### abencds_extend_view.htm

---
title: "Syntax"
description: |
  @AbapCatalog.sqlViewAppendName: 'CDS_APPEND_VIEW'(https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abencds_f1_extend_view_annotations.htm) @extension_annot1(https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abencds_f1_extend_view_annotations.htm) @extension_an
version: "7.57"
category: "general"
type: "abap-reference"
sourceUrl: "https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abencds_extend_view.htm"
abapFile: "abencds_extend_view.htm"
keywords: ["select", "delete", "do", "if", "try", "data", "types", "abencds", "extend", "view"]
---

* * *

AS ABAP Release 757, ©Copyright 2023 SAP SE. All rights reserved.

[ABAP - Keyword Documentation](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abenabap.htm) →  [ABAP - Core Data Services (ABAP CDS)](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abencds.htm) →  [ABAP CDS - Data Definitions](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abencds_entities.htm) →  [ABAP CDS - DDL for Data Definitions](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abencds_f1_ddl_syntax.htm) →  [ABAP CDS - CDS Entity Extension](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abencds_view_extension.htm) → 

 [![](Mail.gif?object=Mail.gif&sap-language=EN "Feedback mail for displayed topic") Mail Feedback](mailto:f1_help@sap.com?subject=Feedback on ABAP Documentation&body=Document: CDS DDL - EXTEND VIEW ddic_based, ABENCDS_EXTEND_VIEW, 757%0D%0A%0D%0AError:%0D%0A%0D
%0A%0D%0A%0D%0ASuggestion for improvement:)

CDS DDL - EXTEND VIEW ddic\_based

Syntax

[@AbapCatalog.sqlViewAppendName: 'CDS\_APPEND\_VIEW'](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abencds_f1_extend_view_annotations.htm)
*\[*[@extension\_annot1](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abencds_f1_extend_view_annotations.htm)*\]*
*\[*[@extension\_annot2](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abencds_f1_extend_view_annotations.htm)*\]*
...
EXTEND VIEW ddic\_based\_view
       WITH cds\_view\_extension
            *\[*association1
             association2 ...*\]*
            { select\_list\_extension }
            *\[*GROUP BY field1, field2, ...  *\]*
            *\[*UNION *\[*ALL*\]* { ... }*\]* *\[*;*\]*

Additions:

[1\. ... GROUP BY field1, field2, ...](#!ABAP_ADDITION_1@1@)
[2\. ... UNION *\[*ALL*\]* { ... }](#!ABAP_ADDITION_2@2@)

Effect

Extends an existing [CDS DDIC-based view (obsolete)](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abencds_v1_view_glosry.htm "Glossary Entry") ddic\_based\_view using a [CDS view extension](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abencds_view_extend_glosry.htm "Glossary Entry") cds\_view\_extension in the [CDS DDL](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abencds_ddl_glosry.htm "Glossary Entry"). An existing CDS DDIC-based view (obsolete) can have one or more CDS view extensions.

The extended CDS view ddic\_based\_view must be specified under the name of its [CDS entity](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abencds_entity_glosry.htm "Glossary Entry"). The name of the [CDS-managed DDIC view (obsolete)](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abencds_mngdddic_view_glosry.htm "Glossary Entry") cannot be specified.

Prerequisite

As a prerequisite for the enhancement of the CDS view with the statement EXTEND VIEW, the elements of the [annotation array](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abenannotation_array_glosry.htm "Glossary Entry") [AbapCatalog.viewEnhancementCategory\[ \]](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abencds_view_anno_v1.htm) must be specified accordingly in its definition with [DEFINE VIEW](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abencds_define_view_v1.htm):

-   By default or if only the value #PROJECTION\_LIST is specified, views without [aggregate expressions](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abencds_aggregate_functions_v1.htm) in the SELECT list and without a [UNION](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abencds_union_v1.htm) clause can be extended.
-   In order to extend views that have [aggregate expressions](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abencds_aggregate_functions_v1.htm) in the SELECT list, the annotation array must contain the value #GROUP\_BY alongside #PROJECTION\_LIST.
-   In order to extend views that contain [UNION](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abencds_union_v1.htm) clauses, the annotation array must contain the value #UNION alongside #PROJECTION\_LIST.
-   If the annotation array contains the value #NONE, the view cannot be extended.

Components of a View Extension

View extensions can make additions to the original view, but it cannot modify, overwrite, or delete elements from the original view. The following components are possible in a CDS view extension:

-   The annotation [AbapCatalog.sqlViewAppendName](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abencds_f1_extend_view_annotations.htm) is mandatory. Further annotations [extension\_annot1](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abencds_f1_extend_view_annotations.htm), [extension\_annot2](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abencds_f1_extend_view_annotations.htm), ... can also be specified. This is optional.
-   New associations association1, association2 can be defined and exposed in the CDS view extension. The same rules apply that are described in topic [CDS DDL - DDIC-based view, ASSOCIATION](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abencds_simple_association_v1.htm).
    
    Note: It is not allowed to define new [CDS compositions](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abencds_composition_glosry.htm "Glossary Entry") or [CDS to-parent associations](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abento_parent_association_glosry.htm "Glossary Entry") in a view extension.
    
-   The elements of the extension list select\_list\_extension specified after EXTEND VIEW are added to the existing SELECT list. At least one element must be added. It is possible to access all fields of all data sources of the extended view in the extension list select\_list\_extension. The list can have all [elements](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abencds_select_list_entry_v1.htm) of a [SELECT list](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abencds_select_list_v1.htm), namely:
    -   [field](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abencds_field_v2.htm) of a data source
    -   [Input parameters](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abencds_parameter_v1.htm) of the extended CDS view. It is not possible to specify new input parameters in a view extension.
    -   It can expose a [CDS association](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abencds_select_list_association_v2.htm) of the extended view or a newly defined association
    -   Using a [path expressions](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abencds_path_expression_v1.htm), a field of an association target can be included. Path expressions are possible for associations of the extended view or for newly defined associations.
    -   [literals, session variables, expressions and functions](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abencds_operands_and_expr_v1.htm)
        
        Note: To add aggregate expressions to a view extension, special rules apply. See below.
        
-   Aggregate expressions are possible in the SELECT list of a view extension only if the following conditions are met:
    -   The original view must contain [aggregate expressions](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abencds_aggregate_functions_v1.htm). If the original view does not contain any aggregate expressions, this is not possible.
    -   The extended view must be annotated with AbapCatalog.viewEnhancementCategory \[#PROJECTION\_LIST, #GROUP\_BY\]
    -   If non-aggregated elements are added to a CDS view with aggregate expressions, then the [GROUP-BY](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abencds_group_by_v1.htm) clause must be extended using the addition GROUP BY
-   If the original view contains [UNION](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abencds_union_v1.htm), equivalent UNION additions must be used in the statement EXTEND VIEW. As a prerequisite, the extended view must be annotated with AbapCatalog.viewEnhancementCategory \[#PROJECTION\_LIST, #UNION\]
    
    If an appended element already occurs in the existing SELECT list or if a different extension occurs, it must be given an alternative element name using AS.
    

Restrictions

-   CDS views with an explicit [name list](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abencds_name_list_v1.htm) cannot currently be extended.
-   CDS view extensions themselves cannot be extended.
-   It is not possible to specify new input parameters in a view extension.
-   No addition [ROOT](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abencds_define_root_view_v1.htm) can be specified in the statement EXTEND VIEW to transform a regular view to a [root entity](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abenroot_entity_glosry.htm "Glossary Entry").
-   An appended field cannot be defined as a key field using KEY.
-   It is not allowed to define new to-parent or composition associations in a view extension.
-   For views that have an element of data type LRAW or LCHR in the SELECT list, no view extension is possible and the annotation AbapCatalog.viewEnhancementCategory\[#NONE\] is enforced. The reason is that elements of data types LRAW or LCHR must always be in the last position of the SELECT list.

Naming

Two repository objects are created for a CDS view extension that is defined using EXTEND VIEW. A name must be specified for each of the two objects:

-   The actual name cds\_view\_extension of the CDS view extension is specified after the keywords EXTEND VIEW. This name follows the same rules as the name of an [DDIC append view](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abenddic_append_view_glosry.htm "Glossary Entry"), but can have up to 30 characters.
-   The name CDS\_APPEND\_VIEW for an [append view](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abenddic_append_view_glosry.htm "Glossary Entry") in ABAP Dictionary must be specified in quotation marks after the annotation [@AbapCatalog.sqlViewAppendName](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abencds_f1_extend_view_annotations.htm). This name is subject to the same rules as the name of a [DDIC database view](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abendatabase_view_glosry.htm "Glossary Entry") in ABAP Dictionary, see topic [DDIC - Naming Rules for DDIC Views](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abenddic_view_names.htm). The new DDIC append view extends the [CDS-managed DDIC view (obsolete)](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abencds_mngdddic_view_glosry.htm "Glossary Entry") of the extended CDS view. The name given to the DDIC append view can no longer be changed after the CDS view extension is transported into a follow-on system.

The name of the new DDIC append view and of the actual CDS view extension should be located in the customer namespace (or in the namespace of a partner or special development) to protect it against being overwritten by upgrades or new releases.

-   Once the DDL source code of a CDS view extension has been transported, the actual name cds\_view\_extension and the name of the DDIC append view CDS\_APPEND\_VIEW can no longer be changed. The extended view ddic\_based\_view can also no longer be changed.

Note: The DDL source code of a CDS view extension does not need to have the same name as the CDS view extension entity, but it is advisable to use the name of the entity.

Hints

-   Currently it is not possible to define extension categories for CDS views. As a consequence, the following restrictions apply:
    -   CDS views have the property can be extended in any way with respect to the [extension category of DDIC structures](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abenddic_structures_enh_cat.htm). The consequences of this must be respected when extending a CDS view.
    -   The properties of a CDS view defined using [annotations](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abencds_view_anno_v1.htm), such as switching on [table buffering](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abentable_buffering_glosry.htm "Glossary Entry"), cannot currently be modified using extensions.
-   CDS view extensions specified with EXTEND ENTITY are recommended for CDS DDIC-based views (obsolete) only. However, for compatibility and migration reasons, it is also possible to extend [CDS projection views](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abencds_projection_view_glosry.htm "Glossary Entry") or [CDS view entities](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abencds_v2_view_glosry.htm "Glossary Entry") with the statement EXTEND VIEW. However, view extends defined using EXTEND VIEW do not support the syntax elements specific to projection views and CDS view entities. Therefore, it is recommended that the statement [EXTEND VIEW ENTITY](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abencds_extend_view_entity.htm) is used for extensions of CDS projection views and CDS view entities instead.
-   If, for some reason, a CDS projection view or a CDS view entity is extended with EXTEND VIEW, the [CDS-managed DDIC view (obsolete)](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abencds_mngdddic_view_glosry.htm "Glossary Entry") is deleted (as CDS projection views and CDS view entities do not have any DDIC artefacts), and entity annotations referring to the CDS-managed DDIC view are ignored.
-   CDS DDIC-based views (obsolete) are [obsolete](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abencds_ddic_entity.htm). If new CDS views are required, CDS view entities should be used.

Example

The following CDS view extension

@AbapCatalog.sqlViewAppendName: 'DEMO\_CDS\_EXTENS'
extend view demo\_cds\_original\_view with demo\_cds\_view\_extension  
  {
    spfli.distance,
    spfli.distid as unit
  };

adds two view fields to the existing CDS view.

@AbapCatalog.sqlViewName: 'DEMO\_CDS\_ORIG'
@AccessControl.authorizationCheck: #NOT\_REQUIRED
@AbapCatalog.viewEnhancementCategory: \[#PROJECTION\_LIST\]
@EndUserText.label: 'Further information about the CDS entity'
define view demo\_cds\_original\_view  
  as select from
           spfli
      join scarr on
        scarr.carrid = spfli.carrid
    {
      key scarr.carrname     as carrier,
      key spfli.connid       as flight,
          spfli.cityfrom     as departure,
          spfli.cityto       as destination
    };

The DDIC append view DEMO\_CDS\_EXTENS is created in ABAP Dictionary. The program DEMO\_CDS\_VIEW\_EXTENSION uses the statement [SELECT](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abapselect.htm) to access the enhanced view and also displays the components of the dictionary structures in question.

Addition 1   

... GROUP BY field1, field2, ...

Effect

This addition must be specified if elements not defined using aggregate expressions are added to a view with [aggregate expressions](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abencds_aggregate_functions_v1.htm). These elements must be specified after GROUP BY add extend the [GROUP-BY](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abencds_group_by_v1.htm) clause of the original view. With respect to the extended view, the extended GROUP-BY clause must follow the general rules for a GROUP-BY clause.

The addition cannot be specified if the definition of the original view does not contain any aggregate expressions in its SELECT list.

Hint

Extensions of a view with aggregate expressions require it to contain the annotation array viewEnhancementCategory\[ \] with the value #GROUP\_BY.

Example

The following CDS view extension

@AbapCatalog.sqlViewAppendName: 'DEMO\_CDS\_EXTAGG'
extend view demo\_cds\_aggregate with demo\_cds\_extend\_aggregate
  {
    connid,  
    sum(distance) as sum\_distance
  }
  group by
    connid;

extends the existing CDS view.

@AbapCatalog.sqlViewName: 'DEMO\_CDS\_AGG'
@AccessControl.authorizationCheck: #NOT\_REQUIRED
@AbapCatalog.viewEnhancementCategory: \[#PROJECTION\_LIST,#GROUP\_BY\]
define view demo\_cds\_aggregate
  as select from
    spfli  
    {
      carrid,
      sum(fltime) as sum\_fltime
    }
    group by
      carrid;

A database field connid and an aggregate expression sum(distance) are added to the SELECT list. Accordingly, the addition GROUP BY must be used to add the database field to the GROUP-BY clause of the original view.

Addition 2   

... UNION *\[*ALL*\]* { ... }

Effect

This addition must be specified when a view with [UNION](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abencds_union_v1.htm) clauses is extended. A corresponding UNION addition must be specified for each UNION clause of the original view. The addition ALL must be specified each time it is specified in the associated UNION clause of the original view. The curly brackets can contain elements that extend the SELECT list of the associated UNION clause of the original view. As specified by the SELECT list extended using select\_list\_extension, the UNION clauses must be extended so that the rules for UNION clauses are not broken in the extended view.

The addition cannot be specified if the definition of the original view does not have a UNION clause.

Hint

Extensions of a view with UNION clauses require it to contain the annotation array viewEnhancementCategory\[ \] with the value #UNION.

Example

The following CDS view extension

@AbapCatalog.sqlViewAppendName: 'DEMO\_CDS\_EXTUNI'
extend view demo\_cds\_union with demo\_cds\_extend\_union
  {
    c as c3,
    d as c4
  }
union
  {
    f as c3,
    g as c4
  }
union all
  {
    k as c3,
    l as c4
  };

extends the existing CDS view.

@AbapCatalog.sqlViewName: 'DEMO\_CDS\_UIO'
@AccessControl.authorizationCheck: #NOT\_REQUIRED
@AbapCatalog.viewEnhancementCategory: \[#PROJECTION\_LIST,#UNION\]
define view demo\_cds\_union
  as select from
    demo\_join1
    {
      a as c1,
      b as c2
    }
union select from
  demo\_join2
    {
      d as c1,
      e as c2
    }
union all select from
  demo\_join3
    {
      i as c1,
      j as c2
    };

The original view has two UNION clauses represented using corresponding UNION additions in the definition of the CDS view extension. Two elements with matching types are added to the three SELECT lists of the original view.

Continue
[CDS DDL - EXTEND VIEW, extension\_annot](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abencds_f1_extend_view_annotations.htm)


### abencds_f1_extend_view_annotations.htm

---
title: "Syntax"
description: |
  ... @annotation(https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abencds_annotations_syntax.htm) ... Effect Specifies an annotation(https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abencds_annotation_glosry.htm 'Glossary Entry') annotation(https://help.sap.com/doc/abapdocu_
version: "7.57"
category: "general"
type: "abap-reference"
sourceUrl: "https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abencds_f1_extend_view_annotations.htm"
abapFile: "abencds_f1_extend_view_annotations.htm"
keywords: ["do", "if", "try", "data", "abencds", "extend", "view", "annotations"]
---

* * *

AS ABAP Release 757, ©Copyright 2023 SAP SE. All rights reserved.

[ABAP - Keyword Documentation](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abenabap.htm) →  [ABAP - Core Data Services (ABAP CDS)](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abencds.htm) →  [ABAP CDS - Data Definitions](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abencds_entities.htm) →  [ABAP CDS - DDL for Data Definitions](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abencds_f1_ddl_syntax.htm) →  [ABAP CDS - CDS Entity Extension](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abencds_view_extension.htm) →  [CDS DDL - EXTEND VIEW ddic\_based](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abencds_extend_view.htm) → 

 [![](Mail.gif?object=Mail.gif&sap-language=EN "Feedback mail for displayed topic") Mail Feedback](mailto:f1_help@sap.com?subject=Feedback on ABAP Documentation&body=Document: CDS DDL - EXTEND VIEW, extension_annot, ABENCDS_F1_EXTEND_VIEW_ANNOTATIONS, 757%0D%0A
%0D%0AError:%0D%0A%0D%0A%0D%0A%0D%0ASuggestion for improvement:)

CDS DDL - EXTEND VIEW, extension\_annot

Syntax

... @[annotation](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abencds_annotations_syntax.htm) ...

Effect

Specifies an [annotation](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abencds_annotation_glosry.htm "Glossary Entry") [annotation](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abencds_annotations_syntax.htm) as an extension annotation in the definition of a [CDS view extension](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abencds_view_extend_glosry.htm "Glossary Entry") before the statement [EXTEND VIEW](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abencds_extend_view.htm). The character @ must be placed in front of the name annotation of the annotation. The annotation should be defined as a CDS object in a [CDS annotation definition](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abencds_anno_definition_glosry.htm "Glossary Entry") and the annotation definition annotation [@Scope](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abencds_f1_define_anno_annos.htm) should be specified here using the value #EXTEND\_VIEW.

The following tables show the possible [ABAP annotations](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abenabap_annotation_glosry.htm "Glossary Entry") that can be specified and their meanings. The ABAP annotations are evaluated by the ABAP runtime framework for every CDS entity. Annotations with other identifiers are usually [framework-specific annotations](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abencds_annotations_frmwrk.htm). These are not evaluated by the ABAP runtime framework but by other SAP frameworks instead.

The first column of the table shows the (possibly structured) name annotation of an ABAP annotation and the second column shows its meaning. The third column shows the possible [annotation values](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abenannotation_value_glosry.htm "Glossary Entry"). The fourth column shows the default value which is used if the annotation is not used at all. The fifth column shows the default value set implicitly for value in accordance with the [annotation definition](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abencds_anno_definition_glosry.htm "Glossary Entry") if the annotation is specified without a value. If nothing is specified for the annotation value, the annotation should be specified without a value.

AbapCatalog Annotations   

Technical settings of a CDS view extension.

Annotation

Meaning

Annotation Values

Default Value if Not Used

Default Value if Used Without Value

AbapCatalog.sqlViewAppendName

Name of the DDIC append view of the CDS view extension

Character string with a maximum of 16 characters consisting of letters, numbers and underscores and that starts with a [namespace prefix](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abenname_space_prefix_glosry.htm "Glossary Entry").

\-

\-

Hints

-   Each definition of a CDS view extension must contain the ABAP annotation AbapCatalog.sqlViewAppendName that defines the name of the DDIC append view in ABAP Dictionary.
-   The name given to the DDIC append view can no longer be changed after the CDS view extension is transported into a follow-on system.


---


## ABAP - Keyword Documentation / ABAP - Core Data Services (ABAP CDS) / ABAP CDS - Data Definitions / ABAP CDS - DDL for Data Definitions / ABAP CDS - CDS Entities / ABAP CDS - Table Functions / CDS DDL - DEFINE TABLE FUNCTION / CDS DDL - DEFINE TABLE FUNCTION, element_list

**Files**: 4 | **Difficulty**: advanced

# ABAP - Keyword Documentation / ABAP - Core Data Services (ABAP CDS) / ABAP CDS - Data Definitions / ABAP CDS - DDL for Data Definitions / ABAP CDS - CDS Entity Extension / CDS DDL - EXTEND VIEW ddic_based

Included pages: 2


### abencds_extend_view.htm

---
title: "Syntax"
description: |
  @AbapCatalog.sqlViewAppendName: 'CDS_APPEND_VIEW'(https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abencds_f1_extend_view_annotations.htm) @extension_annot1(https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abencds_f1_extend_view_annotations.htm) @extension_an
version: "7.57"
category: "general"
type: "abap-reference"
sourceUrl: "https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abencds_extend_view.htm"
abapFile: "abencds_extend_view.htm"
keywords: ["select", "delete", "do", "if", "try", "data", "types", "abencds", "extend", "view"]
---

* * *

AS ABAP Release 757, ©Copyright 2023 SAP SE. All rights reserved.

[ABAP - Keyword Documentation](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abenabap.htm) →  [ABAP - Core Data Services (ABAP CDS)](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abencds.htm) →  [ABAP CDS - Data Definitions](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abencds_entities.htm) →  [ABAP CDS - DDL for Data Definitions](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abencds_f1_ddl_syntax.htm) →  [ABAP CDS - CDS Entity Extension](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abencds_view_extension.htm) → 

 [![](Mail.gif?object=Mail.gif&sap-language=EN "Feedback mail for displayed topic") Mail Feedback](mailto:f1_help@sap.com?subject=Feedback on ABAP Documentation&body=Document: CDS DDL - EXTEND VIEW ddic_based, ABENCDS_EXTEND_VIEW, 757%0D%0A%0D%0AError:%0D%0A%0D
%0A%0D%0A%0D%0ASuggestion for improvement:)

CDS DDL - EXTEND VIEW ddic\_based

Syntax

[@AbapCatalog.sqlViewAppendName: 'CDS\_APPEND\_VIEW'](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abencds_f1_extend_view_annotations.htm)
*\[*[@extension\_annot1](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abencds_f1_extend_view_annotations.htm)*\]*
*\[*[@extension\_annot2](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abencds_f1_extend_view_annotations.htm)*\]*
...
EXTEND VIEW ddic\_based\_view
       WITH cds\_view\_extension
            *\[*association1
             association2 ...*\]*
            { select\_list\_extension }
            *\[*GROUP BY field1, field2, ...  *\]*
            *\[*UNION *\[*ALL*\]* { ... }*\]* *\[*;*\]*

Additions:

[1\. ... GROUP BY field1, field2, ...](#!ABAP_ADDITION_1@1@)
[2\. ... UNION *\[*ALL*\]* { ... }](#!ABAP_ADDITION_2@2@)

Effect

Extends an existing [CDS DDIC-based view (obsolete)](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abencds_v1_view_glosry.htm "Glossary Entry") ddic\_based\_view using a [CDS view extension](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abencds_view_extend_glosry.htm "Glossary Entry") cds\_view\_extension in the [CDS DDL](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abencds_ddl_glosry.htm "Glossary Entry"). An existing CDS DDIC-based view (obsolete) can have one or more CDS view extensions.

The extended CDS view ddic\_based\_view must be specified under the name of its [CDS entity](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abencds_entity_glosry.htm "Glossary Entry"). The name of the [CDS-managed DDIC view (obsolete)](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abencds_mngdddic_view_glosry.htm "Glossary Entry") cannot be specified.

Prerequisite

As a prerequisite for the enhancement of the CDS view with the statement EXTEND VIEW, the elements of the [annotation array](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abenannotation_array_glosry.htm "Glossary Entry") [AbapCatalog.viewEnhancementCategory\[ \]](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abencds_view_anno_v1.htm) must be specified accordingly in its definition with [DEFINE VIEW](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abencds_define_view_v1.htm):

-   By default or if only the value #PROJECTION\_LIST is specified, views without [aggregate expressions](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abencds_aggregate_functions_v1.htm) in the SELECT list and without a [UNION](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abencds_union_v1.htm) clause can be extended.
-   In order to extend views that have [aggregate expressions](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abencds_aggregate_functions_v1.htm) in the SELECT list, the annotation array must contain the value #GROUP\_BY alongside #PROJECTION\_LIST.
-   In order to extend views that contain [UNION](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abencds_union_v1.htm) clauses, the annotation array must contain the value #UNION alongside #PROJECTION\_LIST.
-   If the annotation array contains the value #NONE, the view cannot be extended.

Components of a View Extension

View extensions can make additions to the original view, but it cannot modify, overwrite, or delete elements from the original view. The following components are possible in a CDS view extension:

-   The annotation [AbapCatalog.sqlViewAppendName](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abencds_f1_extend_view_annotations.htm) is mandatory. Further annotations [extension\_annot1](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abencds_f1_extend_view_annotations.htm), [extension\_annot2](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abencds_f1_extend_view_annotations.htm), ... can also be specified. This is optional.
-   New associations association1, association2 can be defined and exposed in the CDS view extension. The same rules apply that are described in topic [CDS DDL - DDIC-based view, ASSOCIATION](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abencds_simple_association_v1.htm).
    
    Note: It is not allowed to define new [CDS compositions](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abencds_composition_glosry.htm "Glossary Entry") or [CDS to-parent associations](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abento_parent_association_glosry.htm "Glossary Entry") in a view extension.
    
-   The elements of the extension list select\_list\_extension specified after EXTEND VIEW are added to the existing SELECT list. At least one element must be added. It is possible to access all fields of all data sources of the extended view in the extension list select\_list\_extension. The list can have all [elements](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abencds_select_list_entry_v1.htm) of a [SELECT list](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abencds_select_list_v1.htm), namely:
    -   [field](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abencds_field_v2.htm) of a data source
    -   [Input parameters](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abencds_parameter_v1.htm) of the extended CDS view. It is not possible to specify new input parameters in a view extension.
    -   It can expose a [CDS association](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abencds_select_list_association_v2.htm) of the extended view or a newly defined association
    -   Using a [path expressions](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abencds_path_expression_v1.htm), a field of an association target can be included. Path expressions are possible for associations of the extended view or for newly defined associations.
    -   [literals, session variables, expressions and functions](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abencds_operands_and_expr_v1.htm)
        
        Note: To add aggregate expressions to a view extension, special rules apply. See below.
        
-   Aggregate expressions are possible in the SELECT list of a view extension only if the following conditions are met:
    -   The original view must contain [aggregate expressions](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abencds_aggregate_functions_v1.htm). If the original view does not contain any aggregate expressions, this is not possible.
    -   The extended view must be annotated with AbapCatalog.viewEnhancementCategory \[#PROJECTION\_LIST, #GROUP\_BY\]
    -   If non-aggregated elements are added to a CDS view with aggregate expressions, then the [GROUP-BY](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abencds_group_by_v1.htm) clause must be extended using the addition GROUP BY
-   If the original view contains [UNION](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abencds_union_v1.htm), equivalent UNION additions must be used in the statement EXTEND VIEW. As a prerequisite, the extended view must be annotated with AbapCatalog.viewEnhancementCategory \[#PROJECTION\_LIST, #UNION\]
    
    If an appended element already occurs in the existing SELECT list or if a different extension occurs, it must be given an alternative element name using AS.
    

Restrictions

-   CDS views with an explicit [name list](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abencds_name_list_v1.htm) cannot currently be extended.
-   CDS view extensions themselves cannot be extended.
-   It is not possible to specify new input parameters in a view extension.
-   No addition [ROOT](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abencds_define_root_view_v1.htm) can be specified in the statement EXTEND VIEW to transform a regular view to a [root entity](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abenroot_entity_glosry.htm "Glossary Entry").
-   An appended field cannot be defined as a key field using KEY.
-   It is not allowed to define new to-parent or composition associations in a view extension.
-   For views that have an element of data type LRAW or LCHR in the SELECT list, no view extension is possible and the annotation AbapCatalog.viewEnhancementCategory\[#NONE\] is enforced. The reason is that elements of data types LRAW or LCHR must always be in the last position of the SELECT list.

Naming

Two repository objects are created for a CDS view extension that is defined using EXTEND VIEW. A name must be specified for each of the two objects:

-   The actual name cds\_view\_extension of the CDS view extension is specified after the keywords EXTEND VIEW. This name follows the same rules as the name of an [DDIC append view](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abenddic_append_view_glosry.htm "Glossary Entry"), but can have up to 30 characters.
-   The name CDS\_APPEND\_VIEW for an [append view](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abenddic_append_view_glosry.htm "Glossary Entry") in ABAP Dictionary must be specified in quotation marks after the annotation [@AbapCatalog.sqlViewAppendName](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abencds_f1_extend_view_annotations.htm). This name is subject to the same rules as the name of a [DDIC database view](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abendatabase_view_glosry.htm "Glossary Entry") in ABAP Dictionary, see topic [DDIC - Naming Rules for DDIC Views](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abenddic_view_names.htm). The new DDIC append view extends the [CDS-managed DDIC view (obsolete)](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abencds_mngdddic_view_glosry.htm "Glossary Entry") of the extended CDS view. The name given to the DDIC append view can no longer be changed after the CDS view extension is transported into a follow-on system.

The name of the new DDIC append view and of the actual CDS view extension should be located in the customer namespace (or in the namespace of a partner or special development) to protect it against being overwritten by upgrades or new releases.

-   Once the DDL source code of a CDS view extension has been transported, the actual name cds\_view\_extension and the name of the DDIC append view CDS\_APPEND\_VIEW can no longer be changed. The extended view ddic\_based\_view can also no longer be changed.

Note: The DDL source code of a CDS view extension does not need to have the same name as the CDS view extension entity, but it is advisable to use the name of the entity.

Hints

-   Currently it is not possible to define extension categories for CDS views. As a consequence, the following restrictions apply:
    -   CDS views have the property can be extended in any way with respect to the [extension category of DDIC structures](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abenddic_structures_enh_cat.htm). The consequences of this must be respected when extending a CDS view.
    -   The properties of a CDS view defined using [annotations](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abencds_view_anno_v1.htm), such as switching on [table buffering](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abentable_buffering_glosry.htm "Glossary Entry"), cannot currently be modified using extensions.
-   CDS view extensions specified with EXTEND ENTITY are recommended for CDS DDIC-based views (obsolete) only. However, for compatibility and migration reasons, it is also possible to extend [CDS projection views](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abencds_projection_view_glosry.htm "Glossary Entry") or [CDS view entities](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abencds_v2_view_glosry.htm "Glossary Entry") with the statement EXTEND VIEW. However, view extends defined using EXTEND VIEW do not support the syntax elements specific to projection views and CDS view entities. Therefore, it is recommended that the statement [EXTEND VIEW ENTITY](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abencds_extend_view_entity.htm) is used for extensions of CDS projection views and CDS view entities instead.
-   If, for some reason, a CDS projection view or a CDS view entity is extended with EXTEND VIEW, the [CDS-managed DDIC view (obsolete)](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abencds_mngdddic_view_glosry.htm "Glossary Entry") is deleted (as CDS projection views and CDS view entities do not have any DDIC artefacts), and entity annotations referring to the CDS-managed DDIC view are ignored.
-   CDS DDIC-based views (obsolete) are [obsolete](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abencds_ddic_entity.htm). If new CDS views are required, CDS view entities should be used.

Example

The following CDS view extension

@AbapCatalog.sqlViewAppendName: 'DEMO\_CDS\_EXTENS'
extend view demo\_cds\_original\_view with demo\_cds\_view\_extension  
  {
    spfli.distance,
    spfli.distid as unit
  };

adds two view fields to the existing CDS view.

@AbapCatalog.sqlViewName: 'DEMO\_CDS\_ORIG'
@AccessControl.authorizationCheck: #NOT\_REQUIRED
@AbapCatalog.viewEnhancementCategory: \[#PROJECTION\_LIST\]
@EndUserText.label: 'Further information about the CDS entity'
define view demo\_cds\_original\_view  
  as select from
           spfli
      join scarr on
        scarr.carrid = spfli.carrid
    {
      key scarr.carrname     as carrier,
      key spfli.connid       as flight,
          spfli.cityfrom     as departure,
          spfli.cityto       as destination
    };

The DDIC append view DEMO\_CDS\_EXTENS is created in ABAP Dictionary. The program DEMO\_CDS\_VIEW\_EXTENSION uses the statement [SELECT](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abapselect.htm) to access the enhanced view and also displays the components of the dictionary structures in question.

Addition 1   

... GROUP BY field1, field2, ...

Effect

This addition must be specified if elements not defined using aggregate expressions are added to a view with [aggregate expressions](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abencds_aggregate_functions_v1.htm). These elements must be specified after GROUP BY add extend the [GROUP-BY](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abencds_group_by_v1.htm) clause of the original view. With respect to the extended view, the extended GROUP-BY clause must follow the general rules for a GROUP-BY clause.

The addition cannot be specified if the definition of the original view does not contain any aggregate expressions in its SELECT list.

Hint

Extensions of a view with aggregate expressions require it to contain the annotation array viewEnhancementCategory\[ \] with the value #GROUP\_BY.

Example

The following CDS view extension

@AbapCatalog.sqlViewAppendName: 'DEMO\_CDS\_EXTAGG'
extend view demo\_cds\_aggregate with demo\_cds\_extend\_aggregate
  {
    connid,  
    sum(distance) as sum\_distance
  }
  group by
    connid;

extends the existing CDS view.

@AbapCatalog.sqlViewName: 'DEMO\_CDS\_AGG'
@AccessControl.authorizationCheck: #NOT\_REQUIRED
@AbapCatalog.viewEnhancementCategory: \[#PROJECTION\_LIST,#GROUP\_BY\]
define view demo\_cds\_aggregate
  as select from
    spfli  
    {
      carrid,
      sum(fltime) as sum\_fltime
    }
    group by
      carrid;

A database field connid and an aggregate expression sum(distance) are added to the SELECT list. Accordingly, the addition GROUP BY must be used to add the database field to the GROUP-BY clause of the original view.

Addition 2   

... UNION *\[*ALL*\]* { ... }

Effect

This addition must be specified when a view with [UNION](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abencds_union_v1.htm) clauses is extended. A corresponding UNION addition must be specified for each UNION clause of the original view. The addition ALL must be specified each time it is specified in the associated UNION clause of the original view. The curly brackets can contain elements that extend the SELECT list of the associated UNION clause of the original view. As specified by the SELECT list extended using select\_list\_extension, the UNION clauses must be extended so that the rules for UNION clauses are not broken in the extended view.

The addition cannot be specified if the definition of the original view does not have a UNION clause.

Hint

Extensions of a view with UNION clauses require it to contain the annotation array viewEnhancementCategory\[ \] with the value #UNION.

Example

The following CDS view extension

@AbapCatalog.sqlViewAppendName: 'DEMO\_CDS\_EXTUNI'
extend view demo\_cds\_union with demo\_cds\_extend\_union
  {
    c as c3,
    d as c4
  }
union
  {
    f as c3,
    g as c4
  }
union all
  {
    k as c3,
    l as c4
  };

extends the existing CDS view.

@AbapCatalog.sqlViewName: 'DEMO\_CDS\_UIO'
@AccessControl.authorizationCheck: #NOT\_REQUIRED
@AbapCatalog.viewEnhancementCategory: \[#PROJECTION\_LIST,#UNION\]
define view demo\_cds\_union
  as select from
    demo\_join1
    {
      a as c1,
      b as c2
    }
union select from
  demo\_join2
    {
      d as c1,
      e as c2
    }
union all select from
  demo\_join3
    {
      i as c1,
      j as c2
    };

The original view has two UNION clauses represented using corresponding UNION additions in the definition of the CDS view extension. Two elements with matching types are added to the three SELECT lists of the original view.

Continue
[CDS DDL - EXTEND VIEW, extension\_annot](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abencds_f1_extend_view_annotations.htm)


### abencds_f1_extend_view_annotations.htm

---
title: "Syntax"
description: |
  ... @annotation(https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abencds_annotations_syntax.htm) ... Effect Specifies an annotation(https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abencds_annotation_glosry.htm 'Glossary Entry') annotation(https://help.sap.com/doc/abapdocu_
version: "7.57"
category: "general"
type: "abap-reference"
sourceUrl: "https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abencds_f1_extend_view_annotations.htm"
abapFile: "abencds_f1_extend_view_annotations.htm"
keywords: ["do", "if", "try", "data", "abencds", "extend", "view", "annotations"]
---

* * *

AS ABAP Release 757, ©Copyright 2023 SAP SE. All rights reserved.

[ABAP - Keyword Documentation](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abenabap.htm) →  [ABAP - Core Data Services (ABAP CDS)](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abencds.htm) →  [ABAP CDS - Data Definitions](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abencds_entities.htm) →  [ABAP CDS - DDL for Data Definitions](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abencds_f1_ddl_syntax.htm) →  [ABAP CDS - CDS Entity Extension](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abencds_view_extension.htm) →  [CDS DDL - EXTEND VIEW ddic\_based](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abencds_extend_view.htm) → 

 [![](Mail.gif?object=Mail.gif&sap-language=EN "Feedback mail for displayed topic") Mail Feedback](mailto:f1_help@sap.com?subject=Feedback on ABAP Documentation&body=Document: CDS DDL - EXTEND VIEW, extension_annot, ABENCDS_F1_EXTEND_VIEW_ANNOTATIONS, 757%0D%0A
%0D%0AError:%0D%0A%0D%0A%0D%0A%0D%0ASuggestion for improvement:)

CDS DDL - EXTEND VIEW, extension\_annot

Syntax

... @[annotation](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abencds_annotations_syntax.htm) ...

Effect

Specifies an [annotation](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abencds_annotation_glosry.htm "Glossary Entry") [annotation](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abencds_annotations_syntax.htm) as an extension annotation in the definition of a [CDS view extension](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abencds_view_extend_glosry.htm "Glossary Entry") before the statement [EXTEND VIEW](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abencds_extend_view.htm). The character @ must be placed in front of the name annotation of the annotation. The annotation should be defined as a CDS object in a [CDS annotation definition](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abencds_anno_definition_glosry.htm "Glossary Entry") and the annotation definition annotation [@Scope](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abencds_f1_define_anno_annos.htm) should be specified here using the value #EXTEND\_VIEW.

The following tables show the possible [ABAP annotations](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abenabap_annotation_glosry.htm "Glossary Entry") that can be specified and their meanings. The ABAP annotations are evaluated by the ABAP runtime framework for every CDS entity. Annotations with other identifiers are usually [framework-specific annotations](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abencds_annotations_frmwrk.htm). These are not evaluated by the ABAP runtime framework but by other SAP frameworks instead.

The first column of the table shows the (possibly structured) name annotation of an ABAP annotation and the second column shows its meaning. The third column shows the possible [annotation values](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abenannotation_value_glosry.htm "Glossary Entry"). The fourth column shows the default value which is used if the annotation is not used at all. The fifth column shows the default value set implicitly for value in accordance with the [annotation definition](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abencds_anno_definition_glosry.htm "Glossary Entry") if the annotation is specified without a value. If nothing is specified for the annotation value, the annotation should be specified without a value.

AbapCatalog Annotations   

Technical settings of a CDS view extension.

Annotation

Meaning

Annotation Values

Default Value if Not Used

Default Value if Used Without Value

AbapCatalog.sqlViewAppendName

Name of the DDIC append view of the CDS view extension

Character string with a maximum of 16 characters consisting of letters, numbers and underscores and that starts with a [namespace prefix](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abenname_space_prefix_glosry.htm "Glossary Entry").

\-

\-

Hints

-   Each definition of a CDS view extension must contain the ABAP annotation AbapCatalog.sqlViewAppendName that defines the name of the DDIC append view in ABAP Dictionary.
-   The name given to the DDIC append view can no longer be changed after the CDS view extension is transported into a follow-on system.


---


## ABAP - Keyword Documentation / ABAP - Programming Language / Calling and Exiting Program Units / Calling Programs / Calling Executable Programs / SUBMIT / SUBMIT, selscreen_options

**Files**: 3 | **Difficulty**: intermediate

# ABAP - Keyword Documentation / ABAP - Programming Language / Calling and Exiting Program Units / Calling Programs / Calling Transactions / CALL TRANSACTION / Transaction Call, Examples

Included pages: 5


### abentransactions_abexas.htm

---
title: "Transaction Call, Examples"
description: |
  !Example(exa.gif 'Example') Transaction Call, SPA/GPA Parameters(https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abencall_transaction_abexa.htm) !Example(exa.gif 'Example') Transaction Call, BDC Table(https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abencall_transaction_
version: "7.57"
category: "general"
type: "abap-reference"
sourceUrl: "https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abentransactions_abexas.htm"
abapFile: "abentransactions_abexas.htm"
keywords: ["do", "if", "abentransactions", "abexas"]
---

* * *

AS ABAP Release 757, ©Copyright 2023 SAP SE. All rights reserved.

[ABAP - Keyword Documentation](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abenabap.htm) →  [ABAP - Programming Language](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abenabap_reference.htm) →  [Calling and Exiting Program Units](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abenabap_execution.htm) →  [Calling Programs](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abenabap_program_call.htm) →  [Calling Transactions](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abenabap_call_transaction.htm) →  [CALL TRANSACTION](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abapcall_transaction.htm) → 

 [![](Mail.gif?object=Mail.gif&sap-language=EN "Feedback mail for displayed topic") Mail Feedback](mailto:f1_help@sap.com?subject=Feedback on ABAP Documentation&body=Document: Transaction Call, Examples, ABENTRANSACTIONS_ABEXAS, 757%0D%0A%0D%0AError:%0D%0A%0D%0
A%0D%0A%0D%0ASuggestion for improvement:)

Transaction Call, Examples

Continue
![Example](exa.gif "Example") [Transaction Call, SPA/GPA Parameters](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abencall_transaction_abexa.htm)
![Example](exa.gif "Example") [Transaction Call, BDC Table](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abencall_transaction_bdc_abexa.htm)
![Example](exa.gif "Example") [Transaction Call, Report Transaction](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abencall_transaction_repo_abexa.htm)
![Example](exa.gif "Example") [Transaction Call, Dialog Transaction](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abencall_transaction_dialog_abexa.htm)


### abencall_transaction_abexa.htm

---
title: "Source Code"
description: |
  REPORT demo_call_transaction_spa_gpa. PARAMETERS: carrid TYPE spfli-carrid, connid TYPE spfli-connid. CLASS demo DEFINITION. PUBLIC SECTION. CLASS-METHODS main. ENDCLASS. CLASS demo IMPLEMENTATION. METHOD main. SET PARAMETER ID: 'CAR' FIELD carrid, 'CON' FIELD connid. TRY. CALL TRANSACTION 'DEMO
version: "7.57"
category: "general"
type: "abap-reference"
sourceUrl: "https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abencall_transaction_abexa.htm"
abapFile: "abencall_transaction_abexa.htm"
keywords: ["select", "do", "if", "try", "catch", "method", "class", "abencall", "transaction", "abexa"]
---

* * *

AS ABAP Release 757, ©Copyright 2023 SAP SE. All rights reserved.

[ABAP - Keyword Documentation](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abenabap.htm) →  [ABAP - Programming Language](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abenabap_reference.htm) →  [Calling and Exiting Program Units](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abenabap_execution.htm) →  [Calling Programs](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abenabap_program_call.htm) →  [Calling Transactions](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abenabap_call_transaction.htm) →  [CALL TRANSACTION](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abapcall_transaction.htm) →  [Transaction Call, Examples](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abentransactions_abexas.htm) → 

 [![](Mail.gif?object=Mail.gif&sap-language=EN "Feedback mail for displayed topic") Mail Feedback](mailto:f1_help@sap.com?subject=Feedback on ABAP Documentation&body=Document: Transaction Call, SPA/GPA Parameters, ABENCALL_TRANSACTION_ABEXA, 757%0D%0A%0D%0AErro
r:%0D%0A%0D%0A%0D%0A%0D%0ASuggestion for improvement:)

Transaction Call, SPA/GPA Parameters

The example demonstrates a transaction call using SPA/GPA parameters.

Source Code   

REPORT demo\_call\_transaction\_spa\_gpa.
PARAMETERS: carrid TYPE spfli-carrid,
            connid TYPE spfli-connid.
CLASS demo DEFINITION.
  PUBLIC SECTION.
    CLASS-METHODS main.
ENDCLASS.
CLASS demo IMPLEMENTATION.
  METHOD main.
    SET PARAMETER ID: 'CAR' FIELD carrid,
                      'CON' FIELD connid.
    TRY.
        CALL TRANSACTION 'DEMO\_TRANSACTION' WITH AUTHORITY-CHECK.
      CATCH cx\_sy\_authorization\_error.
        RETURN.
    ENDTRY.  ENDMETHOD.
ENDCLASS.
START-OF-SELECTION.
  demo=>main( ).

Description   

The transaction DEMO\_TRANSACTION displays the details for a flight uniquely identified by the airline and the flight number. It is called from main using the statement CALL TRANSACTION and filled with [SPA/GPA parameters](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abenspa_gpa_parameter_glosry.htm "Glossary Entry") as initial values using the statement SET PARAMETER.


### abencall_transaction_bdc_abexa.htm

---
title: "Transaction Call, BDC Table"
description: |
  This example demonstrates a transaction call using a batch input table(https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abenbatch_input_table_glosry.htm 'Glossary Entry'). Source Code REPORT demo_call_transaction_bdc. CLASS demo DEFINITION. PUBLIC SECTION. CLASS-METHODS main. ENDCLASS
version: "7.57"
category: "data-structures"
type: "abap-reference"
sourceUrl: "https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abencall_transaction_bdc_abexa.htm"
abapFile: "abencall_transaction_bdc_abexa.htm"
keywords: ["select", "do", "if", "try", "catch", "method", "class", "data", "internal-table", "abencall", "transaction", "bdc", "abexa"]
---

* * *

AS ABAP Release 757, ©Copyright 2023 SAP SE. All rights reserved.

[ABAP - Keyword Documentation](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abenabap.htm) →  [ABAP - Programming Language](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abenabap_reference.htm) →  [Calling and Exiting Program Units](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abenabap_execution.htm) →  [Calling Programs](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abenabap_program_call.htm) →  [Calling Transactions](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abenabap_call_transaction.htm) →  [CALL TRANSACTION](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abapcall_transaction.htm) →  [Transaction Call, Examples](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abentransactions_abexas.htm) → 

 [![](Mail.gif?object=Mail.gif&sap-language=EN "Feedback mail for displayed topic") Mail Feedback](mailto:f1_help@sap.com?subject=Feedback on ABAP Documentation&body=Document: Transaction Call, BDC Table, ABENCALL_TRANSACTION_BDC_ABEXA, 757%0D%0A%0D%0AError:%0D
%0A%0D%0A%0D%0A%0D%0ASuggestion for improvement:)

Transaction Call, BDC Table

This example demonstrates a transaction call using a [batch input table](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abenbatch_input_table_glosry.htm "Glossary Entry").

Source Code   

REPORT demo\_call\_transaction\_bdc.
CLASS demo DEFINITION.
  PUBLIC SECTION.
    CLASS-METHODS main.
ENDCLASS.
CLASS demo IMPLEMENTATION.
  METHOD main.
    DATA class\_name TYPE c LENGTH 30 VALUE 'CL\_ABAP\_BROWSER'.
    DATA bdcdata\_tab TYPE TABLE OF bdcdata WITH EMPTY KEY.
    bdcdata\_tab = VALUE #(
      ( program  = 'SAPLSEOD' dynpro   = '1000' dynbegin = 'X' )
      ( fnam = 'BDC\_CURSOR'       fval = 'SEOCLASS-CLSNAME' )
      ( fnam = 'SEOCLASS-CLSNAME' fval = class\_name )
      ( fnam = 'BDC\_OKCODE'       fval = '=WB\_DISPLAY' ) ).
    FINAL(opt) = VALUE ctu\_params( dismode = 'E'
                                  defsize = 'X' ).
    TRY.
        CALL TRANSACTION 'SE24' WITH AUTHORITY-CHECK
                                USING bdcdata\_tab OPTIONS FROM opt.
      CATCH cx\_sy\_authorization\_error ##NO\_HANDLER.
    ENDTRY.  ENDMETHOD.
ENDCLASS.
START-OF-SELECTION.
  demo=>main( ).

Description   

Call of the Class Builder (transaction SE24) and display of the class CL\_ABAP\_BROWSER. The required authorization is checked by using the addition WITH AUTHORITY-CHECK. The internal table bdcdata\_tab contains the entry for the processing of the first dynpro (1000) of the transaction. The structure opt is used to configure processing to skip the first screen and display the subsequent screen in standard size.


### abencall_transaction_repo_abexa.htm

---
title: "Transaction Call, Report Transaction"
description: |
  The example demonstrates a selection screen call using a report transaction. Source Code REPORT demo_call_selection_screen. SELECTION-SCREEN BEGIN OF SCREEN 100. SELECTION-SCREEN BEGIN OF BLOCK sel1 WITH FRAME TITLE tit1. PARAMETERS: cityfr TYPE spfli-cityfrom, cityto TYPE spfli-cityto. SELECTION
version: "7.57"
category: "general"
type: "abap-reference"
sourceUrl: "https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abencall_transaction_repo_abexa.htm"
abapFile: "abencall_transaction_repo_abexa.htm"
keywords: ["select", "do", "if", "method", "class", "abencall", "transaction", "repo", "abexa"]
---

* * *

AS ABAP Release 757, ©Copyright 2023 SAP SE. All rights reserved.

[ABAP - Keyword Documentation](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abenabap.htm) →  [ABAP - Programming Language](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abenabap_reference.htm) →  [Calling and Exiting Program Units](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abenabap_execution.htm) →  [Calling Programs](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abenabap_program_call.htm) →  [Calling Transactions](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abenabap_call_transaction.htm) →  [CALL TRANSACTION](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abapcall_transaction.htm) →  [Transaction Call, Examples](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abentransactions_abexas.htm) → 

 [![](Mail.gif?object=Mail.gif&sap-language=EN "Feedback mail for displayed topic") Mail Feedback](mailto:f1_help@sap.com?subject=Feedback on ABAP Documentation&body=Document: Transaction Call, Report Transaction, ABENCALL_TRANSACTION_REPO_ABEXA, 757%0D%0A%0D%0
AError:%0D%0A%0D%0A%0D%0A%0D%0ASuggestion for improvement:)

Transaction Call, Report Transaction

The example demonstrates a selection screen call using a report transaction.

Source Code   

REPORT demo\_call\_selection\_screen.
SELECTION-SCREEN BEGIN OF SCREEN 100.
SELECTION-SCREEN BEGIN OF BLOCK sel1 WITH FRAME TITLE tit1.
PARAMETERS: cityfr TYPE spfli-cityfrom,
            cityto TYPE spfli-cityto.
SELECTION-SCREEN END OF BLOCK sel1.
SELECTION-SCREEN END OF SCREEN 100.
SELECTION-SCREEN BEGIN OF SCREEN 500 AS WINDOW.
SELECTION-SCREEN INCLUDE BLOCKS sel1.
SELECTION-SCREEN BEGIN OF BLOCK sel2
                          WITH FRAME TITLE tit2.
PARAMETERS: airpfr TYPE spfli-airpfrom,
            airpto TYPE spfli-airpto.
SELECTION-SCREEN END OF BLOCK sel2.
SELECTION-SCREEN END OF SCREEN 500.
CLASS start DEFINITION.
  PUBLIC SECTION.
    CLASS-METHODS main.
ENDCLASS.
CLASS start IMPLEMENTATION.
  METHOD main.
    tit1 = 'Cities'.
    CALL SELECTION-SCREEN 100 STARTING AT 10 10.
    tit1 = 'Cities for Airports'.
    tit2 = 'Airports'.
    CALL SELECTION-SCREEN 500 STARTING AT 10 10.
    tit1 = 'Cities again'.
    CALL SELECTION-SCREEN 100 STARTING AT 10 10.
    ENDMETHOD.
ENDCLASS.
START-OF-SELECTION.
  start=>main( ).

Description   

When the assigned transaction DEMO\_REPORT\_TRANSACT is called, the executable program starts with the selection screen 500 in the same GUI window. Further processing is described in the executable example [Selection Screens, Calling Standalone Selection Screens](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abensel_screen_call_sel_scr_abexa.htm).


### abencall_transaction_dialog_abexa.htm

---
title: "Transaction Call, Dialog Transaction"
description: |
  This example demonstrates a dialog transaction where the first dynpro is a selection screen. Source Code &--------------------------------------------------------------------- & Modulpool  SAPMSSLS                                                  &------------------------------------------
version: "7.57"
category: "general"
type: "abap-reference"
sourceUrl: "https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abencall_transaction_dialog_abexa.htm"
abapFile: "abencall_transaction_dialog_abexa.htm"
keywords: ["select", "do", "if", "abencall", "transaction", "dialog", "abexa"]
---

* * *

AS ABAP Release 757, ©Copyright 2023 SAP SE. All rights reserved.

[ABAP - Keyword Documentation](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abenabap.htm) →  [ABAP - Programming Language](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abenabap_reference.htm) →  [Calling and Exiting Program Units](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abenabap_execution.htm) →  [Calling Programs](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abenabap_program_call.htm) →  [Calling Transactions](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abenabap_call_transaction.htm) →  [CALL TRANSACTION](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abapcall_transaction.htm) →  [Transaction Call, Examples](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abentransactions_abexas.htm) → 

 [![](Mail.gif?object=Mail.gif&sap-language=EN "Feedback mail for displayed topic") Mail Feedback](mailto:f1_help@sap.com?subject=Feedback on ABAP Documentation&body=Document: Transaction Call, Dialog Transaction, ABENCALL_TRANSACTION_DIALOG_ABEXA, 757%0D%0A%0D
%0AError:%0D%0A%0D%0A%0D%0A%0D%0ASuggestion for improvement:)

Transaction Call, Dialog Transaction

This example demonstrates a dialog transaction where the first dynpro is a selection screen.

Source Code   

\*&---------------------------------------------------------------------\*
\*& Modulpool  SAPMSSLS                                                 \*
\*&---------------------------------------------------------------------\*
PROGRAM  sapmdemo\_selscreen\_dynp.
SET EXTENDED CHECK OFF.
SELECTION-SCREEN BEGIN OF SCREEN 500 AS WINDOW.
  SELECTION-SCREEN BEGIN OF BLOCK sel1 WITH FRAME.
    PARAMETERS: cityfr LIKE spfli-cityfrom,
                cityto LIKE spfli-cityto.
  SELECTION-SCREEN END OF BLOCK sel1.
  SELECTION-SCREEN BEGIN OF BLOCK sel2 WITH FRAME.
    PARAMETERS: airpfr LIKE spfli-airpfrom,
              airpto LIKE spfli-airpto.
  SELECTION-SCREEN END OF BLOCK sel2.
SELECTION-SCREEN END OF SCREEN 500.
AT SELECTION-SCREEN.
   ...
   LEAVE TO SCREEN 100.

Description   

When the associated transaction DEMO\_SELSCREEN\_DYNP is called, the program starts by displaying selection screen 500. The user input on the selection screen can be processed, for example, at the event AT SELECTION-SCREEN or later in the application logic. After the event AT SELECTION-SCREEN is processed (PAI of the selection screen), the program branches to a next dynpro, 100.


---


## ABAP - Keyword Documentation / ABAP - Programming Language / Calling and Exiting Program Units / Calling Programs / Calling Executable Programs / SUBMIT / SUBMIT, list_options

**Files**: 3 | **Difficulty**: intermediate

# ABAP - Keyword Documentation / ABAP - Programming Language / Calling and Exiting Program Units / Calling Programs / Calling Transactions / CALL TRANSACTION / Transaction Call, Examples

Included pages: 5


### abentransactions_abexas.htm

---
title: "Transaction Call, Examples"
description: |
  !Example(exa.gif 'Example') Transaction Call, SPA/GPA Parameters(https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abencall_transaction_abexa.htm) !Example(exa.gif 'Example') Transaction Call, BDC Table(https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abencall_transaction_
version: "7.57"
category: "general"
type: "abap-reference"
sourceUrl: "https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abentransactions_abexas.htm"
abapFile: "abentransactions_abexas.htm"
keywords: ["do", "if", "abentransactions", "abexas"]
---

* * *

AS ABAP Release 757, ©Copyright 2023 SAP SE. All rights reserved.

[ABAP - Keyword Documentation](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abenabap.htm) →  [ABAP - Programming Language](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abenabap_reference.htm) →  [Calling and Exiting Program Units](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abenabap_execution.htm) →  [Calling Programs](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abenabap_program_call.htm) →  [Calling Transactions](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abenabap_call_transaction.htm) →  [CALL TRANSACTION](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abapcall_transaction.htm) → 

 [![](Mail.gif?object=Mail.gif&sap-language=EN "Feedback mail for displayed topic") Mail Feedback](mailto:f1_help@sap.com?subject=Feedback on ABAP Documentation&body=Document: Transaction Call, Examples, ABENTRANSACTIONS_ABEXAS, 757%0D%0A%0D%0AError:%0D%0A%0D%0
A%0D%0A%0D%0ASuggestion for improvement:)

Transaction Call, Examples

Continue
![Example](exa.gif "Example") [Transaction Call, SPA/GPA Parameters](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abencall_transaction_abexa.htm)
![Example](exa.gif "Example") [Transaction Call, BDC Table](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abencall_transaction_bdc_abexa.htm)
![Example](exa.gif "Example") [Transaction Call, Report Transaction](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abencall_transaction_repo_abexa.htm)
![Example](exa.gif "Example") [Transaction Call, Dialog Transaction](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abencall_transaction_dialog_abexa.htm)


### abencall_transaction_abexa.htm

---
title: "Source Code"
description: |
  REPORT demo_call_transaction_spa_gpa. PARAMETERS: carrid TYPE spfli-carrid, connid TYPE spfli-connid. CLASS demo DEFINITION. PUBLIC SECTION. CLASS-METHODS main. ENDCLASS. CLASS demo IMPLEMENTATION. METHOD main. SET PARAMETER ID: 'CAR' FIELD carrid, 'CON' FIELD connid. TRY. CALL TRANSACTION 'DEMO
version: "7.57"
category: "general"
type: "abap-reference"
sourceUrl: "https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abencall_transaction_abexa.htm"
abapFile: "abencall_transaction_abexa.htm"
keywords: ["select", "do", "if", "try", "catch", "method", "class", "abencall", "transaction", "abexa"]
---

* * *

AS ABAP Release 757, ©Copyright 2023 SAP SE. All rights reserved.

[ABAP - Keyword Documentation](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abenabap.htm) →  [ABAP - Programming Language](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abenabap_reference.htm) →  [Calling and Exiting Program Units](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abenabap_execution.htm) →  [Calling Programs](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abenabap_program_call.htm) →  [Calling Transactions](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abenabap_call_transaction.htm) →  [CALL TRANSACTION](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abapcall_transaction.htm) →  [Transaction Call, Examples](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abentransactions_abexas.htm) → 

 [![](Mail.gif?object=Mail.gif&sap-language=EN "Feedback mail for displayed topic") Mail Feedback](mailto:f1_help@sap.com?subject=Feedback on ABAP Documentation&body=Document: Transaction Call, SPA/GPA Parameters, ABENCALL_TRANSACTION_ABEXA, 757%0D%0A%0D%0AErro
r:%0D%0A%0D%0A%0D%0A%0D%0ASuggestion for improvement:)

Transaction Call, SPA/GPA Parameters

The example demonstrates a transaction call using SPA/GPA parameters.

Source Code   

REPORT demo\_call\_transaction\_spa\_gpa.
PARAMETERS: carrid TYPE spfli-carrid,
            connid TYPE spfli-connid.
CLASS demo DEFINITION.
  PUBLIC SECTION.
    CLASS-METHODS main.
ENDCLASS.
CLASS demo IMPLEMENTATION.
  METHOD main.
    SET PARAMETER ID: 'CAR' FIELD carrid,
                      'CON' FIELD connid.
    TRY.
        CALL TRANSACTION 'DEMO\_TRANSACTION' WITH AUTHORITY-CHECK.
      CATCH cx\_sy\_authorization\_error.
        RETURN.
    ENDTRY.  ENDMETHOD.
ENDCLASS.
START-OF-SELECTION.
  demo=>main( ).

Description   

The transaction DEMO\_TRANSACTION displays the details for a flight uniquely identified by the airline and the flight number. It is called from main using the statement CALL TRANSACTION and filled with [SPA/GPA parameters](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abenspa_gpa_parameter_glosry.htm "Glossary Entry") as initial values using the statement SET PARAMETER.


### abencall_transaction_bdc_abexa.htm

---
title: "Transaction Call, BDC Table"
description: |
  This example demonstrates a transaction call using a batch input table(https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abenbatch_input_table_glosry.htm 'Glossary Entry'). Source Code REPORT demo_call_transaction_bdc. CLASS demo DEFINITION. PUBLIC SECTION. CLASS-METHODS main. ENDCLASS
version: "7.57"
category: "data-structures"
type: "abap-reference"
sourceUrl: "https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abencall_transaction_bdc_abexa.htm"
abapFile: "abencall_transaction_bdc_abexa.htm"
keywords: ["select", "do", "if", "try", "catch", "method", "class", "data", "internal-table", "abencall", "transaction", "bdc", "abexa"]
---

* * *

AS ABAP Release 757, ©Copyright 2023 SAP SE. All rights reserved.

[ABAP - Keyword Documentation](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abenabap.htm) →  [ABAP - Programming Language](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abenabap_reference.htm) →  [Calling and Exiting Program Units](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abenabap_execution.htm) →  [Calling Programs](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abenabap_program_call.htm) →  [Calling Transactions](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abenabap_call_transaction.htm) →  [CALL TRANSACTION](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abapcall_transaction.htm) →  [Transaction Call, Examples](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abentransactions_abexas.htm) → 

 [![](Mail.gif?object=Mail.gif&sap-language=EN "Feedback mail for displayed topic") Mail Feedback](mailto:f1_help@sap.com?subject=Feedback on ABAP Documentation&body=Document: Transaction Call, BDC Table, ABENCALL_TRANSACTION_BDC_ABEXA, 757%0D%0A%0D%0AError:%0D
%0A%0D%0A%0D%0A%0D%0ASuggestion for improvement:)

Transaction Call, BDC Table

This example demonstrates a transaction call using a [batch input table](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abenbatch_input_table_glosry.htm "Glossary Entry").

Source Code   

REPORT demo\_call\_transaction\_bdc.
CLASS demo DEFINITION.
  PUBLIC SECTION.
    CLASS-METHODS main.
ENDCLASS.
CLASS demo IMPLEMENTATION.
  METHOD main.
    DATA class\_name TYPE c LENGTH 30 VALUE 'CL\_ABAP\_BROWSER'.
    DATA bdcdata\_tab TYPE TABLE OF bdcdata WITH EMPTY KEY.
    bdcdata\_tab = VALUE #(
      ( program  = 'SAPLSEOD' dynpro   = '1000' dynbegin = 'X' )
      ( fnam = 'BDC\_CURSOR'       fval = 'SEOCLASS-CLSNAME' )
      ( fnam = 'SEOCLASS-CLSNAME' fval = class\_name )
      ( fnam = 'BDC\_OKCODE'       fval = '=WB\_DISPLAY' ) ).
    FINAL(opt) = VALUE ctu\_params( dismode = 'E'
                                  defsize = 'X' ).
    TRY.
        CALL TRANSACTION 'SE24' WITH AUTHORITY-CHECK
                                USING bdcdata\_tab OPTIONS FROM opt.
      CATCH cx\_sy\_authorization\_error ##NO\_HANDLER.
    ENDTRY.  ENDMETHOD.
ENDCLASS.
START-OF-SELECTION.
  demo=>main( ).

Description   

Call of the Class Builder (transaction SE24) and display of the class CL\_ABAP\_BROWSER. The required authorization is checked by using the addition WITH AUTHORITY-CHECK. The internal table bdcdata\_tab contains the entry for the processing of the first dynpro (1000) of the transaction. The structure opt is used to configure processing to skip the first screen and display the subsequent screen in standard size.


### abencall_transaction_repo_abexa.htm

---
title: "Transaction Call, Report Transaction"
description: |
  The example demonstrates a selection screen call using a report transaction. Source Code REPORT demo_call_selection_screen. SELECTION-SCREEN BEGIN OF SCREEN 100. SELECTION-SCREEN BEGIN OF BLOCK sel1 WITH FRAME TITLE tit1. PARAMETERS: cityfr TYPE spfli-cityfrom, cityto TYPE spfli-cityto. SELECTION
version: "7.57"
category: "general"
type: "abap-reference"
sourceUrl: "https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abencall_transaction_repo_abexa.htm"
abapFile: "abencall_transaction_repo_abexa.htm"
keywords: ["select", "do", "if", "method", "class", "abencall", "transaction", "repo", "abexa"]
---

* * *

AS ABAP Release 757, ©Copyright 2023 SAP SE. All rights reserved.

[ABAP - Keyword Documentation](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abenabap.htm) →  [ABAP - Programming Language](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abenabap_reference.htm) →  [Calling and Exiting Program Units](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abenabap_execution.htm) →  [Calling Programs](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abenabap_program_call.htm) →  [Calling Transactions](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abenabap_call_transaction.htm) →  [CALL TRANSACTION](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abapcall_transaction.htm) →  [Transaction Call, Examples](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abentransactions_abexas.htm) → 

 [![](Mail.gif?object=Mail.gif&sap-language=EN "Feedback mail for displayed topic") Mail Feedback](mailto:f1_help@sap.com?subject=Feedback on ABAP Documentation&body=Document: Transaction Call, Report Transaction, ABENCALL_TRANSACTION_REPO_ABEXA, 757%0D%0A%0D%0
AError:%0D%0A%0D%0A%0D%0A%0D%0ASuggestion for improvement:)

Transaction Call, Report Transaction

The example demonstrates a selection screen call using a report transaction.

Source Code   

REPORT demo\_call\_selection\_screen.
SELECTION-SCREEN BEGIN OF SCREEN 100.
SELECTION-SCREEN BEGIN OF BLOCK sel1 WITH FRAME TITLE tit1.
PARAMETERS: cityfr TYPE spfli-cityfrom,
            cityto TYPE spfli-cityto.
SELECTION-SCREEN END OF BLOCK sel1.
SELECTION-SCREEN END OF SCREEN 100.
SELECTION-SCREEN BEGIN OF SCREEN 500 AS WINDOW.
SELECTION-SCREEN INCLUDE BLOCKS sel1.
SELECTION-SCREEN BEGIN OF BLOCK sel2
                          WITH FRAME TITLE tit2.
PARAMETERS: airpfr TYPE spfli-airpfrom,
            airpto TYPE spfli-airpto.
SELECTION-SCREEN END OF BLOCK sel2.
SELECTION-SCREEN END OF SCREEN 500.
CLASS start DEFINITION.
  PUBLIC SECTION.
    CLASS-METHODS main.
ENDCLASS.
CLASS start IMPLEMENTATION.
  METHOD main.
    tit1 = 'Cities'.
    CALL SELECTION-SCREEN 100 STARTING AT 10 10.
    tit1 = 'Cities for Airports'.
    tit2 = 'Airports'.
    CALL SELECTION-SCREEN 500 STARTING AT 10 10.
    tit1 = 'Cities again'.
    CALL SELECTION-SCREEN 100 STARTING AT 10 10.
    ENDMETHOD.
ENDCLASS.
START-OF-SELECTION.
  start=>main( ).

Description   

When the assigned transaction DEMO\_REPORT\_TRANSACT is called, the executable program starts with the selection screen 500 in the same GUI window. Further processing is described in the executable example [Selection Screens, Calling Standalone Selection Screens](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abensel_screen_call_sel_scr_abexa.htm).


### abencall_transaction_dialog_abexa.htm

---
title: "Transaction Call, Dialog Transaction"
description: |
  This example demonstrates a dialog transaction where the first dynpro is a selection screen. Source Code &--------------------------------------------------------------------- & Modulpool  SAPMSSLS                                                  &------------------------------------------
version: "7.57"
category: "general"
type: "abap-reference"
sourceUrl: "https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abencall_transaction_dialog_abexa.htm"
abapFile: "abencall_transaction_dialog_abexa.htm"
keywords: ["select", "do", "if", "abencall", "transaction", "dialog", "abexa"]
---

* * *

AS ABAP Release 757, ©Copyright 2023 SAP SE. All rights reserved.

[ABAP - Keyword Documentation](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abenabap.htm) →  [ABAP - Programming Language](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abenabap_reference.htm) →  [Calling and Exiting Program Units](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abenabap_execution.htm) →  [Calling Programs](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abenabap_program_call.htm) →  [Calling Transactions](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abenabap_call_transaction.htm) →  [CALL TRANSACTION](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abapcall_transaction.htm) →  [Transaction Call, Examples](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abentransactions_abexas.htm) → 

 [![](Mail.gif?object=Mail.gif&sap-language=EN "Feedback mail for displayed topic") Mail Feedback](mailto:f1_help@sap.com?subject=Feedback on ABAP Documentation&body=Document: Transaction Call, Dialog Transaction, ABENCALL_TRANSACTION_DIALOG_ABEXA, 757%0D%0A%0D
%0AError:%0D%0A%0D%0A%0D%0A%0D%0ASuggestion for improvement:)

Transaction Call, Dialog Transaction

This example demonstrates a dialog transaction where the first dynpro is a selection screen.

Source Code   

\*&---------------------------------------------------------------------\*
\*& Modulpool  SAPMSSLS                                                 \*
\*&---------------------------------------------------------------------\*
PROGRAM  sapmdemo\_selscreen\_dynp.
SET EXTENDED CHECK OFF.
SELECTION-SCREEN BEGIN OF SCREEN 500 AS WINDOW.
  SELECTION-SCREEN BEGIN OF BLOCK sel1 WITH FRAME.
    PARAMETERS: cityfr LIKE spfli-cityfrom,
                cityto LIKE spfli-cityto.
  SELECTION-SCREEN END OF BLOCK sel1.
  SELECTION-SCREEN BEGIN OF BLOCK sel2 WITH FRAME.
    PARAMETERS: airpfr LIKE spfli-airpfrom,
              airpto LIKE spfli-airpto.
  SELECTION-SCREEN END OF BLOCK sel2.
SELECTION-SCREEN END OF SCREEN 500.
AT SELECTION-SCREEN.
   ...
   LEAVE TO SCREEN 100.

Description   

When the associated transaction DEMO\_SELSCREEN\_DYNP is called, the program starts by displaying selection screen 500. The user input on the selection screen can be processed, for example, at the event AT SELECTION-SCREEN or later in the application logic. After the event AT SELECTION-SCREEN is processed (PAI of the selection screen), the program branches to a next dynpro, 100.


---


## ABAP - Keyword Documentation / ABAP - Programming Language / Program Flow Logic / Expressions and Functions for Conditions / Logical Expressions (log_exp) / Comparison Expressions (rel_exp) / rel_exp - Comparison Rules / rel_exp - Comparing Internal Tables

**Files**: 2 | **Difficulty**: intermediate

# ABAP - Keyword Documentation / ABAP - Programming Language / Program Flow Logic / Expressions and Functions for Conditions / Logical Functions

Included pages: 2


### abenlogic_functions.htm

---
title: "Logical Functions"
description: |
  Logical functions are a part of built-in functions(https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abenbuilt_in_functions.htm). They are divided into: -   Boolean functions(https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abenboole_functions.htm) -   Predicate functions(ht
version: "7.57"
category: "general"
type: "abap-reference"
sourceUrl: "https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abenlogic_functions.htm"
abapFile: "abenlogic_functions.htm"
keywords: ["do", "if", "abenlogic", "functions"]
---

* * *

AS ABAP Release 757, ©Copyright 2023 SAP SE. All rights reserved.

[ABAP - Keyword Documentation](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abenabap.htm) →  [ABAP - Programming Language](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abenabap_reference.htm) →  [Program Flow Logic](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abenabap_flow_logic.htm) →  [Expressions and Functions for Conditions](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abenlogical_expr_func.htm) → 

 [![](Mail.gif?object=Mail.gif&sap-language=EN "Feedback mail for displayed topic") Mail Feedback](mailto:f1_help@sap.com?subject=Feedback on ABAP Documentation&body=Document: Logical Functions, ABENLOGIC_FUNCTIONS, 757%0D%0A%0D%0AError:%0D%0A%0D%0A%0D%0A%0D%0A
Suggestion for improvement:)

Logical Functions

Logical functions are a part of [built-in functions](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abenbuilt_in_functions.htm). They are divided into:

-   [Boolean functions](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abenboole_functions.htm)
-   [Predicate functions](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abenpredicate_functions.htm)

Hint

The program DEMO\_EXPRESSIONS shows examples of how to use logical functions.

Continue
[boolc, boolx, xsdbool, Boolean Functions](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abenboole_functions.htm)


### abenboole_functions.htm

---
title: "Effect"
description: |
  The built-in(https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abenbuilt_in_functions.htm) Boolean functions determine the truth value(https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abentruth_value_glosry.htm 'Glossary Entry') of a logical expression log_exp(https://help.
version: "7.57"
category: "general"
type: "abap-reference"
sourceUrl: "https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abenboole_functions.htm"
abapFile: "abenboole_functions.htm"
keywords: ["do", "if", "try", "method", "data", "types", "abenboole", "functions"]
---

* * *

AS ABAP Release 757, ©Copyright 2023 SAP SE. All rights reserved.

[ABAP - Keyword Documentation](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abenabap.htm) →  [ABAP - Programming Language](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abenabap_reference.htm) →  [Program Flow Logic](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abenabap_flow_logic.htm) →  [Expressions and Functions for Conditions](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abenlogical_expr_func.htm) →  [Logical Functions](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abenlogic_functions.htm) → 

 [![](Mail.gif?object=Mail.gif&sap-language=EN "Feedback mail for displayed topic") Mail Feedback](mailto:f1_help@sap.com?subject=Feedback on ABAP Documentation&body=Document: boolc, boolx, xsdbool, Boolean Functions, ABENBOOLE_FUNCTIONS, 757%0D%0A%0D%0AError:%
0D%0A%0D%0A%0D%0A%0D%0ASuggestion for improvement:)

boolc, boolx, xsdbool, Boolean Functions

Variants:

[1\. ... boolc( log\_exp ) ...](#!ABAP_VARIANT_1@1@)
[2\. ... boolx( bool = log\_exp bit = bit ) ...](#!ABAP_VARIANT_2@2@)
[3\. ... xsdbool( log\_exp ) ...](#!ABAP_VARIANT_3@3@)

Effect

The [built-in](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abenbuilt_in_functions.htm) Boolean functions determine the [truth value](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abentruth_value_glosry.htm "Glossary Entry") of a logical expression [log\_exp](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abenlogexp.htm) specified as an argument. For log\_exp, any logical expression can be specified in accordance with the applicable rules. The return value of a Boolean function has a data type dependent on the function and expresses the truth value of the logical expression with a value of this type.

Hint

These functions can be considered a partial replacement for the Boolean data type for truth values that is not available in ABAP. In particular, xsdbool and, under certain circumstances, boolc can be used in many operand positions where values of the type abap\_bool of the type pool ABAP are expected.

Variant 1   

... boolc( log\_exp ) ...

Effect

The function boolc returns a single-character character string of the type string. If the logical expression is true, X is returned. If the logical expression is false, a blank is returned. In principle, boolc is one of the [processing functions with character-like results](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abenprocess_functions.htm) and can be specified in [general expression positions](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abengeneral_expr_position_glosry.htm "Glossary Entry") and in [character-like expression positions](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abencharlike_expr_position_glosry.htm "Glossary Entry").

Hints

-   If boolc requires return values other than X or blank (for example, "Y" and "N" or "1" and "0"), the result of boolc can be processed directly using the function [translate](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abentranslate_functions.htm) or another suitable [processing function](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abenprocess_functions.htm).
-   The result of boolc should not be compared with the constants abap\_true and abap\_false in relational expressions, since the latter converts from c to string and ignores any blanks. Comparisons of this type are not usually necessary. If a comparison of this type is to be executed anyway, the function xsdbool can be used instead of boolc whose result has the same ABAP type as abap\_bool.
-   If the logical expression is false, the result of boolc does not meet the condition [IS INITIAL](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abenlogexp_initial.htm), since a blank and no empty string is returned. If this is desired, the function xsdbool can be used instead of boolc.
-   If boolc is used in inappropriate places as specified in the points above, this leads to a syntax warning, which can be hidden using a pragma.

Example

The value 0, 1, or 2 is assigned to the variable bool\_value, depending on the result of the logical expressions log\_exp1 and log\_exp2.

DATA bool\_value TYPE i.
bool\_value = strlen( condense( val = boolc( log\_exp1 ) ) ) +
             strlen( condense( val = boolc( log\_exp2 ) ) ).

Example

Call of a method, where the input parameter no\_dialog is supplied with the character-like representation of the results of a predicate expression.

PARAMETERS word TYPE c length 30.
DATA result\_tab TYPE cl\_abap\_docu=>search\_results.
cl\_abap\_docu=>start(
  EXPORTING word           = word
            no\_dialog      = boolc( sy-batch IS NOT INITIAL )
  IMPORTING search\_results = result\_tab ).

Variant 2   

... boolx( bool = log\_exp bit = bit ) ...

Effect

The function boolx returns a byte chain of the type xstring. If the logical expression is true, the byte chain is filled as if the function [bit-set( bit )](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abenbit_functions.htm) were executed. If the logical expression is false, the byte chain is filled as if the function [bit-set( 0 )](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abenbit_functions.htm) were executed. bit expects a data object of the type i. In principle, boolx belongs to the [bit functions](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abenbit_functions.htm) and can be used in all positions where a [bit expression](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abenbit_expression_glosry.htm "Glossary Entry") is also allowed.

Hint

The function boolx can be used for efficient storage of sequences of truth values.

Example

The result of the following [bit expression](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abenbit_expression_glosry.htm "Glossary Entry") is hexadecimal 55, which corresponds to the calculated bit string 01010101.

FINAL(result) = boolx( bool = 2 > 1 bit = 8 )
        BIT-OR boolx( bool = 2 < 1 bit = 7 )
        BIT-OR boolx( bool = 2 > 1 bit = 6 )
        BIT-OR boolx( bool = 2 < 1 bit = 5 )
        BIT-OR boolx( bool = 2 > 1 bit = 4 )
        BIT-OR boolx( bool = 2 < 1 bit = 3 )
        BIT-OR boolx( bool = 2 > 1 bit = 2 )
        BIT-OR boolx( bool = 2 < 1 bit = 1 ).

The bit expression above can be expressed using the following iteration with the operator [REDUCE](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abenconstructor_expression_reduce.htm).

FINAL(result) =
  REDUCE xstring( INIT x TYPE xstring
                  FOR j = 4 THEN j - 1 UNTIL j < 1
                  LET b1 = 2 \* j b2 = 2 \* j - 2 IN
                  NEXT x = x BIT-OR boolx( bool = 2 > 1  bit = b1 )
                             BIT-OR boolx( bool = 2 < 1  bit = b2 ) ).

Variant 3   

... xsdbool( log\_exp ) ...

Effect

Like boolc, the function xsdbool returns the value X for true and a blank for false. The data type of the return value, however, has the type c of the length 1 here.

The return value references the type XSDBOOLEAN from the ABAP Dictionary. This type, which refers to the identically named domain of type CHAR and length 1, is handled like a real Boolean type in serializations and deserializations to or from [asXML](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abenabap_xslt_asxml_schema.htm) and [asJSON](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abenabap_asjson_schema.htm) using [CALL TRANSFORMATION](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abapcall_transformation.htm). The XML or JSON values true and false are assigned to the values X and blank of this type.

xsdbool can be specified in [general](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abengeneral_expr_position_glosry.htm "Glossary Entry") and [character-like expression positions](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abencharlike_expr_position_glosry.htm "Glossary Entry").

Hints

-   The result of xsdbool can be used like a value of the type abap\_bool and can be compared with the constants abap\_true and abap\_false without any problems.
-   If the logical expression is false, the result of boolc fulfills the condition [IS INITIAL](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abenlogexp_initial.htm), since the returned blank is the type-dependent initial value at the same time.
-   The result of xsdbool cannot usually be converted directly using a [processing function](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abenprocess_functions.htm) such as [translate](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abentranslate_functions.htm), since the trailing blanks here are ignored in text fields of type c. The result of a false logical expression would be ignored. The result of the function boolc of type string is better suited for conversions of this type.
-   The abbreviation xsd stands for [XML schema data types](http://www.w3.org/TR/xmlschema-2/).

Example

This example sets the type and the value of the variable gui\_flag declared inline using the Boolean function xsdbool for whose argument a [predicative method call](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abenpredicative_method_call_glosry.htm "Glossary Entry") is listed. The variable is then serialized to [asXML](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abenasxml_glosry.htm "Glossary Entry") and [asJSON](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abenasjson_glosry.htm "Glossary Entry") using the predefined [identity transformation](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abenid_trafo_glosry.htm "Glossary Entry") [ID](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abenabap_xslt_id.htm). This produces the value true or false. After a comparison with the identically typed constant abap\_false, the formatted result of the serialization is either read or displayed.

The result would be quite different if boolc were used instead of xsdbool. First, the transformations would have a different result since the values X and blank are not transformed to true or false; second, the logical expression gui\_flag = abap\_false would always be false, since abap\_false loses its blank when converting to the type string.

FINAL(gui\_flag) = xsdbool( cl\_demo\_sap\_gui=>check( ) ).
CALL TRANSFORMATION id SOURCE gui\_flag = gui\_flag
                       RESULT XML FINAL(xml).
FINAL(writer) =
  cl\_sxml\_string\_writer=>create( type = if\_sxml=>co\_xt\_json ).
CALL TRANSFORMATION id SOURCE gui\_flag = gui\_flag
                       RESULT XML writer.
FINAL(json) = writer->get\_output( ).
cl\_demo\_output=>write\_xml( xml ).
cl\_demo\_output=>write\_json( json ).
IF gui\_flag = abap\_false.
  cl\_demo\_output=>get( ).
ELSE.
  cl\_demo\_output=>display( ).
ENDIF.


---


## ABAP - Keyword Documentation / ABAP - Programming Language / Processing Internal Data / Internal Tables (itab) / itab - Overview / itab - Table Key / itab - Primary Table Key

**Files**: 3 | **Difficulty**: beginner

# ABAP - Keyword Documentation / ABAP - Programming Language / Processing Internal Data / Internal Tables (itab) / itab - Performance Notes

Included pages: 2


### abenitab_perfo.htm

---
title: "Table Sharing"
description: |
  When assignments are made between internal tables of the same type whose line type does not contain any table types, only the internal administration functions are passed to the table body(https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abentable_body_glosry.htm 'Glossary Entry') for pe
version: "7.57"
category: "data-structures"
type: "abap-reference"
sourceUrl: "https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abenitab_perfo.htm"
abapFile: "abenitab_perfo.htm"
keywords: ["select", "insert", "update", "delete", "loop", "do", "if", "case", "try", "data", "types", "internal-table", "abenitab", "perfo"]
---

* * *

AS ABAP Release 757, ©Copyright 2023 SAP SE. All rights reserved.

[ABAP - Keyword Documentation](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abenabap.htm) →  [ABAP - Programming Language](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abenabap_reference.htm) →  [Processing Internal Data](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abenabap_data_working.htm) →  [Internal Tables (itab)](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abenitab.htm) → 

 [![](Mail.gif?object=Mail.gif&sap-language=EN "Feedback mail for displayed topic") Mail Feedback](mailto:f1_help@sap.com?subject=Feedback on ABAP Documentation&body=Document: itab - Performance Notes, ABENITAB_PERFO, 757%0D%0A%0D%0AError:%0D%0A%0D%0A%0D%0A%0D%
0ASuggestion for improvement:)

itab - Performance Notes

-   [Table Sharing](#abenitab-perfo-1-------initial-memory-requirement---@ITOC@@ABENITAB_PERFO_2)
-   [Index Administration](#abenitab-perfo-3-------block-processing-of-table-lines---@ITOC@@ABENITAB_PERFO_4)
-   [Selective Data Transport](#abenitab-perfo-5-------using-secondary-keys---@ITOC@@ABENITAB_PERFO_6)
-   [Deleting Table Lines](#abenitab-perfo-7-------free-key-specified-for-sorted-tables-and-hashed-tables---@ITOC@@ABENITAB_PERFO_8)
-   [Sorting](#abenitab-perfo-9---table-sharing-----when-assignments-are-made-between-internal-tables-of-the-same-type-whose-line-type-does-not-contain-any-table-types--only-the-internal-administration-functions-are-passed-to-the--table-body--https---help-sap-com-doc-abapdocu-757-index-htm-7-57-en-us-abentable-body-glosry-htm--glossary-entry---for-performance-reasons---table-sharing--https---help-sap-com-doc-abapdocu-757-index-htm-7-57-en-us-abentable-sharing-glosry-htm--glossary-entry---is-revoked-only-when-write-access-to-one-of-the-tables-involved-is-initiated--the-actual-copy-process-then-takes-place---initial-memory-requirement-----internal-tables-are--dynamic-data-objects--https---help-sap-com-doc-abapdocu-757-index-htm-7-57-en-us-abendynamic-data-object-glosry-htm--glossary-entry---whose-area-in-the-memory-is-extended-block-by-block--the-size-of-the-first-block-in-the-memory-is-called--initial-memory-requirement--https---help-sap-com-doc-abapdocu-757-index-htm-7-57-en-us-abeninitial-mem-req-glosry-htm--glossary-entry---and-can-be-affected-in-the-declaration-of-an-internal-table-using-the-additions--initial-size--https---help-sap-com-doc-abapdocu-757-index-htm-7-57-en-us-abaptypes-itab-htm--and-the-obsolete--occurs--https---help-sap-com-doc-abapdocu-757-index-htm-7-57-en-us-abapdata-occurs-htm----it-is-usually-up-to-the-system-to-determine-the-size-of-the-first-block--initial-size-is-not-used-or-specified-with-the-value-0--in-this-case--a-suitable-block-size-is-chosen-the-first-time-lines-are-added-to-an-internal-table---specifying-a-concrete-value-greater-than-0-after-initial-size-is-only-practical-if-it-is-known-in-advance-how-many-entries-are-to-be-made-in-the-table--and-the-first-block-is-therefore-to-be-created-with-the-most-suitable-dimensions--this-can-be-particularly-important-for-internal-tables-that-are-components-of-other-internal-tables--and-which-only-contain-a-few-lines--no-more-than-around-5----to-avoid-excessive-memory-demands--the-system-ignores-values-that-produce-memory-demands-greater-than-the-constant-block-size---index-administration-----in-an--index-table--https---help-sap-com-doc-abapdocu-757-index-htm-7-57-en-us-abenindex-table-glosry-htm--glossary-entry----the-logical-order-of-the-table-entries-is-not-generally-consistent-with-the-physical-order-of-the-entries-in-the-main-memory--in-this-case--the-logical-order-is-no-longer-administrated-by-a-physical-index--but-by-a-logical-index--the-same-basically-applies-to-the--secondary-table-indexes--https---help-sap-com-doc-abapdocu-757-index-htm-7-57-en-us-abensecondary-table-index-glosry-htm--glossary-entry---used-to-manage--secondary--https---help-sap-com-doc-abapdocu-757-index-htm-7-57-en-us-abensecondary-table-key-glosry-htm--glossary-entry----sorted-keys--https---help-sap-com-doc-abapdocu-757-index-htm-7-57-en-us-abensorted-key-glosry-htm--glossary-entry-----use-of-the-logical-index-produces-additional-memory-requirements--and-index-maintenance-places-a-high-demand-on-resources--time-and-memory--when-inserting-or-deleting-table-lines--the-resource-requirements-increase-proportionally-with-the-number-of-remaining-lines-after-the-insertion-or-deletion-position--for-very-large-internal-tables--this-can-result-in-considerable-demands-on-performance-at-runtime---the-logical-index-is-only-created-when-it-is-needed--that-is--when-a-line-is-inserted-in-front-of-another-line--if-the-order-of-the-table-lines-is-changed--or-a-line-other-than-the-last-line-is-deleted--a-logical-index-is-not-required-if-an-internal-table-is-filled-using-only--append--https---help-sap-com-doc-abapdocu-757-index-htm-7-57-en-us-abapappend-htm---and-if-only-its-last-line-or-lines-is-are-deleted-using--delete--https---help-sap-com-doc-abapdocu-757-index-htm-7-57-en-us-abapdelete-itab-htm----hint--in-contrast-to-filling-a-table-with--insert--https---help-sap-com-doc-abapdocu-757-index-htm-7-57-en-us-abapinsert-itab-htm---appending-lines-with--append--https---help-sap-com-doc-abapdocu-757-index-htm-7-57-en-us-abapappend-htm--does-not-require-any-resources-for-index-maintenance--it-is-therefore-preferable-to-use-append-instead-of-insert-to-create-a--standard-table--https---help-sap-com-doc-abapdocu-757-index-htm-7-57-en-us-abenstandard-table-glosry-htm--glossary-entry----this-is-possible-if-the-order-of-the-entries-is-not-important--or-if-entries-can-be-appended-in-the-correct-order---block-processing-of-table-lines-----if-entire-line-areas-of-a-table-can-be-processed-at-once--this-should-not-be-done-line-by-line--but-using-block-operations--block-operations-are-possible-using-the-from-and-to-additions-of-the-statements--insert--https---help-sap-com-doc-abapdocu-757-index-htm-7-57-en-us-abapinsert-itab-htm----append--https---help-sap-com-doc-abapdocu-757-index-htm-7-57-en-us-abapappend-htm--and--delete--https---help-sap-com-doc-abapdocu-757-index-htm-7-57-en-us-abapdelete-itab-htm---block-operations-are-also-more-efficient-than-single-record-operations-when-reading-from-or-modifying-database-tables-with--abap-sql--https---help-sap-com-doc-abapdocu-757-index-htm-7-57-en-us-abenabap-sql-glosry-htm--glossary-entry---statements-with-the-additions-from---appending---to-table---selective-data-transport-----if--when-reading-table-lines-using--read-table--https---help-sap-com-doc-abapdocu-757-index-htm-7-57-en-us-abapread-table-htm--or--loop-at--https---help-sap-com-doc-abapdocu-757-index-htm-7-57-en-us-abaploop-at-itab-htm---a-work-area-is-used-or-table-lines-can-be-changed-using--modify--https---help-sap-com-doc-abapdocu-757-index-htm-7-57-en-us-abapmodify-itab-htm--instead-of-direct-access--the-transporting-addition-can-be-used-to-prevent-unnecessary-assignments-of-table-components-to-the-work-area--this-can-lead-to-a-noticeable-improvement-in-performance--particularly-if-table-like-components-are-excluded-from-processing---using-secondary-keys-----the--use-of-secondary-table-keys--https---help-sap-com-doc-abapdocu-757-index-htm-7-57-en-us-abenitab-key-secondary-usage-htm--should-be-planned-and-executed-carefully-and-sparingly--the-time-gained-when-accessing-individual-lines-should-not-be-lost-again-by-the-increased-memory-and-time-requirements-for-managing-the-secondary-keys--secondary-keys-are-generally-recommended-for-internal-tables-that-are-filled-once-and-rarely-changed-during-program-execution---example--the-program-demo--secondary--keys-demonstrates-how-a-secondary-table-key-is-specified-and-the-resulting-performance-gain---deleting-table-lines-----when-lines-are-deleted-from-an-internal-table--administration-costs-are-incurred-for-all-table-keys-and-table-indexes--the-primary-key-and-all-unique-secondary-keys-are-updated-directly--but-non-unique-secondary-keys-are-updated-only-if-the-line-to-be-deleted-is-included-in-the-updated-part-of-an-associated-index---lazy-update--https---help-sap-com-doc-abapdocu-757-index-htm-7-57-en-us-abenlazy-update-glosry-htm--glossary-entry------it-should-be-noted-that--particularly-for-standard-tables--the-mean-runtime-of-the-statement--delete--https---help-sap-com-doc-abapdocu-757-index-htm-7-57-en-us-abapdelete-itab-htm--always-depends-linearly-on-the-number-of-table-lines--even-when-secondary-keys-are-specified-using--with-table-key--https---help-sap-com-doc-abapdocu-757-index-htm-7-57-en-us-abapdelete-itab-key-htm--or--using-key--https---help-sap-com-doc-abapdocu-757-index-htm-7-57-en-us-abapdelete-itab-key-htm---this-is-because-a-linear-search-is-required-to-update-the-primary-index--even-though-the-line-to-be-deleted-can-itself-be-found-quickly---deleting-lines-in-internal-tables-using--delete--https---help-sap-com-doc-abapdocu-757-index-htm-7-57-en-us-abapdelete-itab-htm--does-not-usually-release-any-memory-in-the-internal-table--statements-such-as--clear--https---help-sap-com-doc-abapdocu-757-index-htm-7-57-en-us-abapclear-htm--or--free--https---help-sap-com-doc-abapdocu-757-index-htm-7-57-en-us-abapfree-dataobject-htm--must-be-used-to-release-memory-in-internal-tables---free-key-specified-for-sorted-tables-and-hashed-tables-----when-using-the--read--https---help-sap-com-doc-abapdocu-757-index-htm-7-57-en-us-abapread-table-htm--statement-with-a-specified-free-key-of-the-form--with-key------https---help-sap-com-doc-abapdocu-757-index-htm-7-57-en-us-abapread-table-free-htm---the-search-is-optimized-in-all-cases-where-this-is-possible--that-is-------in--sorted-tables--https---help-sap-com-doc-abapdocu-757-index-htm-7-57-en-us-abensorted-table-glosry-htm--glossary-entry----if-any-initial-section-of-the--table-key--https---help-sap-com-doc-abapdocu-757-index-htm-7-57-en-us-abentable-key-glosry-htm--glossary-entry---or-the-complete-table-key-is-covered-by-the-specified-key------in--hashed-tables--https---help-sap-com-doc-abapdocu-757-index-htm-7-57-en-us-abenhashed-table-glosry-htm--glossary-entry----if-the-complete-table-key-is-covered---if-part-of-a-free-key-meets-these-conditions--this-partial-key-is-first-used-to-search-for-an-entry--in-sorted-tables--this-is-done-using-a-binary-search-with-a-logarithmic-consumption-of-resources--and-in-hashed-tables-using-a-hash-algorithm--that-is--with-constant-resource-consumption--if-an-entry-is-found--the-system-checks-whether-the-rest-of-the-key-conditions-are-also-met--this-means-that-over-specific-keys-in-particular-are-optimized---hint--see-also--optimization-of-the-where-condition--https---help-sap-com-doc-abapdocu-757-index-htm-7-57-en-us-abenitab-where-optimization-htm----sorting-----for-textual-sorting-of-an-internal-table-in-accordance-with-the-current--text-environment--https---help-sap-com-doc-abapdocu-757-index-htm-7-57-en-us-abentext-environment-glosry-htm--glossary-entry----it-can-be-more-efficient-to-use-the-statement--convert-text-into-sortable-code--https---help-sap-com-doc-abapdocu-757-index-htm-7-57-en-us-abapconvert-text-htm--instead-of--sort-as-text--https---help-sap-com-doc-abapdocu-757-index-htm-7-57-en-us-abapsort-itab-htm--in-the-following-cases-------if-an-internal-table-is-sorted-by-locale-and-then-searched-binarily-using-the-statement-read-table-or-using-a--table-expression--https---help-sap-com-doc-abapdocu-757-index-htm-7-57-en-us-abentable-expressions-htm-------an-internal-table-must-be-sorted-more-than-once------indexes-for-database-tables-should-be-structured-in-accordance-with-a-locale---continue--itab---optimizing-the-where-condition--https---help-sap-com-doc-abapdocu-757-index-htm-7-57-en-us-abenitab-where-optimization-htm--------abenitab-where-optimization-htm------title---hint--description------if-the-lines-selected-using-where-are-modified-or-deleted-using-modify-https---help-sap-com-doc-abapdocu-757-index-htm-7-57-en-us-abapmodify-itab-htm--or-delete-https---help-sap-com-doc-abapdocu-757-index-htm-7-57-en-us-abapdelete-itab-htm--and-not-just-read-using-loop-at-https---help-sap-com--version---7-57--category---general--type---abap-reference--sourceurl---https---help-sap-com-doc-abapdocu-757-index-htm-7-57-en-us-abenitab-where-optimization-htm--abapfile---abenitab-where-optimization-htm--keywords----select----update----delete----loop----do----if----case----try----catch----data----types----internal-table----abenitab----where----optimization---------------as-abap-release-757---copyright-2023-sap-se--all-rights-reserved----abap---keyword-documentation--https---help-sap-com-doc-abapdocu-757-index-htm-7-57-en-us-abenabap-htm------abap---programming-language--https---help-sap-com-doc-abapdocu-757-index-htm-7-57-en-us-abenabap-reference-htm------processing-internal-data--https---help-sap-com-doc-abapdocu-757-index-htm-7-57-en-us-abenabap-data-working-htm------internal-tables--itab---https---help-sap-com-doc-abapdocu-757-index-htm-7-57-en-us-abenitab-htm------itab---performance-notes--https---help-sap-com-doc-abapdocu-757-index-htm-7-57-en-us-abenitab-perfo-htm------------mail-gif-object-mail-gif-sap-language-en--feedback-mail-for-displayed-topic---mail-feedback--mailto-f1-helpsap.com?subject=Feedback on ABAP Documentation&body=Document: itab - Optimizing the WHERE Condition, ABENITAB_WHERE_OPTIMIZATION, 757%0D%0A%0D%0AEr
ror:%0D%0A%0D%0A%0D%0A%0D%0ASuggestion for improvement:)

itab - Optimizing the WHERE Condition

The statements [LOOP AT](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abaploop_at_itab.htm), [DELETE](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abapdelete_itab.htm), and [MODIFY](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abapmodify_itab.htm) can be specified together with a WHERE condition that selects specific lines of the internal table. Searches in a [standard table](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abenstandard_table_glosry.htm "Glossary Entry") using the [primary table key](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abenprimary_table_key_glosry.htm "Glossary Entry") are always linear and cannot be optimized. Searches using a [sorted key](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abensorted_key_glosry.htm "Glossary Entry") or a [hash key](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abenhash_key_glosry.htm "Glossary Entry"), however, can be optimized in certain circumstances. These keys are used for:

-   accessing a [sorted table](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abensorted_table_glosry.htm "Glossary Entry") using its primary key.
-   accessing a [hashed table](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abenhashed_table_glosry.htm "Glossary Entry") using its primary key.
-   accessing a table of any table type using a [secondary table key](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abensecondary_table_key_glosry.htm "Glossary Entry") specified by USING KEY.

The optimization takes place by mapping all [relational expressions](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abenrelational_expression_glosry.htm "Glossary Entry") or a group of the relational expressions in the WHERE condition to a specified key. This specified key performs a corresponding optimized key access (binary search or hash algorithm as in the statement [READ TABLE](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abapread_table.htm) or a [table expression](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abentable_expressions.htm)), to find one or more lines. The found line or lines are then checked using those remaining relational expressions from the WHERE condition that were not mapped to the specified key.

Prerequisites for the optimization are therefore:

-   The relational expressions of the WHERE condition can be transformed to a specified key.
-   The corresponding key access returns the same results as the evaluation of this part of the logical expression would. This is guaranteed only for compatible data types, since in the case of incompatible data types:
    -   the content of the specified data objects is converted to the data type of the columns before the evaluation in the case of key accesses.
    -   The [comparison rules](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abenlogexp_rules.htm) for incompatible data types apply when evaluating a [comparison expression](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abencomparison_expression_glosry.htm "Glossary Entry"). Here, all the data types involved play a part in determining which operand is converted into which comparison type.

If there are no or insufficient relational expressions to meet both of these prerequisites, no optimization is possible and the behavior is as follows:

-   If a sorted table or a hashed table is accessed using the primary table key, all lines of the internal table are checked as in a standard table.
-   If the table is read using a secondary table key, that is, if said key is specified after USING KEY, a syntax error or syntax check warning, or an exception is raised. Access using a secondary table key must always be executed in an optimized way.

The following sections describe exactly when an access can be optimized.

-   [Prerequisites for the Optimization of Hash Keys](#abenitab-where-optimization-1-------prerequisites-for-the-optimization-of-sorted-keys---@ITOC@@ABENITAB_WHERE_OPTIMIZATION_2)
-   [Requirements Made on the Operands](#@@ITOC@@ABENITAB_WHERE_OPTIMIZATION_3)

Hint

If the lines selected using WHERE are modified or deleted using [MODIFY](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abapmodify_itab.htm) or [DELETE](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abapdelete_itab.htm) and not just read using [LOOP AT](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abaploop_at_itab.htm), further update costs are incurred in addition to the search for the lines. When deleting lines from standard tables, it should be noted that searches using a secondary key optimize the selection of lines to be deleted, but not the update required for the primary key, which is usually performed using a linear search.

Prerequisites for the Optimization of Hash Keys   

In the case of [hash key](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abenhash_key_glosry.htm "Glossary Entry") accesses, there must be exactly one relational expression combined using AND for each component of the key. This expression is either

-   a [comparison expression](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abencomparison_expression_glosry.htm "Glossary Entry") with the comparison operator \= (or EQ), whose operands meet the requirements above or
-   a [predicate expression](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abenpredicate_expression_glosry.htm "Glossary Entry") IS INITIAL without the addition NOT.

These relational expressions construct the part of the logical expression used for the key access. This part must not contain duplicate key components. The remainder of the logical expression can contain any number of relational expressions combined using AND. Optimization may not be possible, however, if the Boolean operators NOT or OR are used. Key components may be used in the relational expressions not used for the key access.

Hint

Relational expressions other than comparisons using \= (or EQ) or predicate expressions IS INITIAL are not part of the key access. This applies particularly to the tabular comparison operator [IN range\_tab](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abenlogexp_select_option.htm), even if it can be traced back to optimizable comparisons.

Example

In the following example, the first two WHERE conditions can be optimized as key accesses with the secondary table key key. This is because:

1.  The optimizable conditions for b, d, and e cover the entire key.
2.  The optimizable conditions b, d, and e cover the entire key and a is a condition on a non-key column that is not involved in the part of the WHERE condition required for the optimization.
3.  The optimizable conditions b, d, and e cover the entire key and the other two conditions on the key columns b and d are not optimizable and are hence not involved in the part of the WHERE condition required for the optimization.

The next six WHERE conditions cannot be optimized and produce syntax errors. This is because:

1.  The key component d is not specified.
2.  A key component is combined using OR instead of AND.
3.  Two non-optimizable comparison operators are used.
4.  An operand of type i is used in the comparison b of type c, which does not meet the requirements made on the operands.
5.  The Boolean operator NOT is used in front of a key component.
6.  A further comparison is combined using OR.
7.  A further comparison is negated using NOT.
    
    DATA: BEGIN OF line,
            a TYPE c LENGTH 3,
            b TYPE c LENGTH 3,
            c TYPE c LENGTH 3,
            d TYPE c LENGTH 3,
            e TYPE c LENGTH 3,
            f TYPE c LENGTH 3,
          END OF line.
    DATA itab LIKE STANDARD TABLE OF line
                   WITH UNIQUE HASHED KEY key COMPONENTS b e d.
    DATA b\_tab LIKE RANGE OF line-b.
    LOOP AT itab INTO line USING KEY key
         WHERE b = '...' AND d = '...' AND e IS INITIAL.
    ENDLOOP.
    LOOP AT itab INTO line USING KEY key
         WHERE a = '...' AND b = '...' AND d = '...' AND e IS INITIAL.
    ENDLOOP.
    LOOP AT itab INTO line USING KEY key
         WHERE  b = '...' AND d = '...' AND e IS INITIAL AND
                b IN b\_tab AND d <> '...'.
    ENDLOOP.
    LOOP AT itab INTO line USING KEY key
         WHERE b = '...' AND e IS INITIAL.                     "syntax error
    ENDLOOP.
    LOOP AT itab INTO line USING KEY key
         WHERE b = '...' OR d = '...' AND e IS INITIAL OR      "syntax error
    ENDLOOP.
    LOOP AT itab INTO line USING KEY key
         WHERE b = '...' AND d <> '...' AND e IS NOT INITIAL.  "syntax error
    ENDLOOP.
    LOOP AT itab INTO line USING KEY key
         WHERE b = 333 AND d = '...' AND e IS INITIAL.         "syntax error
    ENDLOOP.
    LOOP AT itab INTO line USING KEY key
         WHERE b = '...'  AND NOT d = '...' AND e IS INITIAL.  "syntax error
    ENDLOOP.
    LOOP AT itab INTO line USING KEY key
         WHERE b = '...' AND d = '...' AND e IS INITIAL OR     "syntax error
               a = '...'.
    ENDLOOP.
    LOOP AT itab INTO line USING KEY key
         WHERE b = '...' AND d = '...' AND e IS INITIAL AND    "syntax error
               NOT a = '...'.
    ENDLOOP.
    

Prerequisites for the Optimization of Sorted Keys   

In the case of reads using a [sorted key](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abensorted_key_glosry.htm "Glossary Entry"), the same applies as to a hash key. The only difference is that only an initial section of the key consisting of at least one component needs to be covered rather than the entire key.

The internal table is accessed in part sequentially. The starting point for the processing of the table is determined by a binary search using the subconditions that cover the table key completely or partially. From the starting point onwards, the table is only processed for as long as these subconditions remain fulfilled.

Example

In the following example, the first five WHERE conditions can be optimized as key accesses with the secondary table key key. This is because:

1.  b is an initial part of the key.
2.  b is an initial part of the key and a is an independent condition.
3.  b and e are an initial part of the key.
4.  b, e, and d are an initial part of the key and the order in the WHERE condition is ignored.
5.  b is an initial part of the key and in this case, d is an independent condition, even though it is part of the key.

The next five WHERE conditions cannot be optimized and produce syntax errors. This is because:

1.  e is not an initial part of the key.
2.  No inequality comparison takes place.
3.  A comparison in a ranges table is specified.
4.  The Boolean operator NOT is used.
5.  An additional OR relationship is used.
    
    DATA: BEGIN OF line,
            a TYPE c LENGTH 3,
            b TYPE c LENGTH 3,
            c TYPE c LENGTH 3,
            d TYPE c LENGTH 3,
            e TYPE c LENGTH 3,
            f TYPE c LENGTH 3,
          END OF line.
    DATA itab LIKE STANDARD TABLE OF line
                   WITH UNIQUE SORTED KEY key COMPONENTS b e d.
    DATA b\_tab LIKE RANGE OF line-b.
    LOOP AT itab INTO line USING KEY key
                 WHERE b = '...'.
    ENDLOOP.
    LOOP AT itab INTO line USING KEY key
                 WHERE a = '...' AND b IS INITIAL.
    ENDLOOP.
    LOOP AT itab INTO line USING KEY key
                 WHERE b = '...' AND e = '...'.
    ENDLOOP.
    LOOP AT itab INTO line USING KEY key
                 WHERE b = '...' AND d IS INITIAL AND e = '...'.
    ENDLOOP.
    LOOP AT itab INTO line USING KEY key
                 WHERE b = '...' AND d <> '...'.
    ENDLOOP.
    LOOP AT itab INTO line USING KEY key
                 WHERE e = '...'.                    "syntax error
    ENDLOOP.
    LOOP AT itab INTO line USING KEY key
                 WHERE b <> '...'.                   "syntax error
    ENDLOOP.
    LOOP AT itab INTO line USING KEY key
                 WHERE b IN b\_tab.                   "syntax error
    ENDLOOP.
    LOOP AT itab INTO line USING KEY key
                 WHERE b = '...'  AND NOT e = '...'. "syntax error
    ENDLOOP.
    LOOP AT itab INTO line USING KEY key             "syntax error
                 WHERE b = '...'  AND ( d = '...' OR e IS INITIAL ).
    ENDLOOP.
    

Requirements Made on the Operands   

The part of the logical expression that can be mapped to a key access must select the same lines as a statement [READ TABLE](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abapread_table.htm) or a corresponding [table expression](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abentable_expressions.htm) that specifies the corresponding components as keys.

-   When comparing incompatible data objects, the WHERE condition is subject to the same [comparison rules](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abenlogexp_rules.htm) for incompatible data types. Here, the data types involved determine which operand is converted to which comparison type.
-   If the additions [WITH TABLE KEY](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abapread_table_key.htm) and [WITH KEY](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abapread_table_free.htm) of the statement READ or [KEY](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abentable_exp_itab_line.htm) in a table expression are used, however, the content of the specified data objects is always converted to the data type of the columns before the comparison.

If this produces differing results, an optimization is not possible. Due to the complexity of the comparison rules, particularly for [elementary data types](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abenlogexp_rules_operands.htm), it is not a good idea to construct a set of rules detailing exactly when the comparison type matches the data type of the left operand. Generally speaking,

-   only fully compatible operands are optimizable,
-   in some cases, elementary operands with different data types can be optimized, if the value ranges or lengths are suitable. For example, a comparison of a column with the type of a floating point number with an operand of type integer or of a column of c with a similar operand, if its length is less than the length of the column.

For this reason, it is advisable to use only pairs of [compatible](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abencompatible_glosry.htm "Glossary Entry") operands in the WHERE condition. This guarantees that the differences in behavior of the WHERE condition and the specified key do not affect the result.

Example

The following example is largely similar to the example in the section WHERE log\_exp in [LOOP AT itab](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abaploop_at_itab_cond.htm). In that case, access takes place using the primary key and no optimization. Here, however, access takes place using a secondary table key and a syntax check warning is produced and an exception raised when the program is executed. The number of lines in the internal table determines whether the exception is raised.

DATA text\_short TYPE c LENGTH 2.
DATA text\_long  TYPE c LENGTH 4.
DATA itab LIKE TABLE OF text\_short
          WITH UNIQUE HASHED KEY key COMPONENTS table\_line.
itab = VALUE #( ( 'AA' )
                ( 'BB' )
                ( 'CC' )
                ( 'DD' )
                ( 'EE' )
                ( 'FF' )
                ( 'GG' )
                ( 'HH' )
                ( 'II' )
                ( 'JJ' )
                ( 'KK' )
                ( 'LL' )
                ( 'MM' ) ).
text\_short = 'AA'.
text\_long  = 'AAXX'.
LOOP AT itab INTO text\_short USING KEY key
             WHERE table\_line = text\_long.
ENDLOOP.
cl\_demo\_output=>write( |LOOP: { sy-subrc }| ).
"Statement
READ TABLE itab INTO text\_short WITH TABLE KEY key
                                COMPONENTS table\_line = text\_long.
cl\_demo\_output=>write( |READ: { sy-subrc }| ).
"Expression
TRY.
    text\_short = itab\[ KEY key COMPONENTS table\_line = text\_long \].
  catch CX\_SY\_ITAB\_LINE\_NOT\_FOUND.
    ...
ENDTRY.
cl\_demo\_output=>display( |Expression: { text\_short }| ).


---


## ABAP - Keyword Documentation / ABAP - Programming Language / Processing Internal Data / Internal Tables (itab) / itab - Overview / itab - Table Key / itab - Secondary Table Key

**Files**: 4 | **Difficulty**: beginner

# ABAP - Keyword Documentation / ABAP - Programming Language / Processing Internal Data / Internal Tables (itab) / itab - Performance Notes

Included pages: 2


### abenitab_perfo.htm

---
title: "Table Sharing"
description: |
  When assignments are made between internal tables of the same type whose line type does not contain any table types, only the internal administration functions are passed to the table body(https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abentable_body_glosry.htm 'Glossary Entry') for pe
version: "7.57"
category: "data-structures"
type: "abap-reference"
sourceUrl: "https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abenitab_perfo.htm"
abapFile: "abenitab_perfo.htm"
keywords: ["select", "insert", "update", "delete", "loop", "do", "if", "case", "try", "data", "types", "internal-table", "abenitab", "perfo"]
---

* * *

AS ABAP Release 757, ©Copyright 2023 SAP SE. All rights reserved.

[ABAP - Keyword Documentation](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abenabap.htm) →  [ABAP - Programming Language](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abenabap_reference.htm) →  [Processing Internal Data](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abenabap_data_working.htm) →  [Internal Tables (itab)](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abenitab.htm) → 

 [![](Mail.gif?object=Mail.gif&sap-language=EN "Feedback mail for displayed topic") Mail Feedback](mailto:f1_help@sap.com?subject=Feedback on ABAP Documentation&body=Document: itab - Performance Notes, ABENITAB_PERFO, 757%0D%0A%0D%0AError:%0D%0A%0D%0A%0D%0A%0D%
0ASuggestion for improvement:)

itab - Performance Notes

-   [Table Sharing](#abenitab-perfo-1-------initial-memory-requirement---@ITOC@@ABENITAB_PERFO_2)
-   [Index Administration](#abenitab-perfo-3-------block-processing-of-table-lines---@ITOC@@ABENITAB_PERFO_4)
-   [Selective Data Transport](#abenitab-perfo-5-------using-secondary-keys---@ITOC@@ABENITAB_PERFO_6)
-   [Deleting Table Lines](#abenitab-perfo-7-------free-key-specified-for-sorted-tables-and-hashed-tables---@ITOC@@ABENITAB_PERFO_8)
-   [Sorting](#abenitab-perfo-9---table-sharing-----when-assignments-are-made-between-internal-tables-of-the-same-type-whose-line-type-does-not-contain-any-table-types--only-the-internal-administration-functions-are-passed-to-the--table-body--https---help-sap-com-doc-abapdocu-757-index-htm-7-57-en-us-abentable-body-glosry-htm--glossary-entry---for-performance-reasons---table-sharing--https---help-sap-com-doc-abapdocu-757-index-htm-7-57-en-us-abentable-sharing-glosry-htm--glossary-entry---is-revoked-only-when-write-access-to-one-of-the-tables-involved-is-initiated--the-actual-copy-process-then-takes-place---initial-memory-requirement-----internal-tables-are--dynamic-data-objects--https---help-sap-com-doc-abapdocu-757-index-htm-7-57-en-us-abendynamic-data-object-glosry-htm--glossary-entry---whose-area-in-the-memory-is-extended-block-by-block--the-size-of-the-first-block-in-the-memory-is-called--initial-memory-requirement--https---help-sap-com-doc-abapdocu-757-index-htm-7-57-en-us-abeninitial-mem-req-glosry-htm--glossary-entry---and-can-be-affected-in-the-declaration-of-an-internal-table-using-the-additions--initial-size--https---help-sap-com-doc-abapdocu-757-index-htm-7-57-en-us-abaptypes-itab-htm--and-the-obsolete--occurs--https---help-sap-com-doc-abapdocu-757-index-htm-7-57-en-us-abapdata-occurs-htm----it-is-usually-up-to-the-system-to-determine-the-size-of-the-first-block--initial-size-is-not-used-or-specified-with-the-value-0--in-this-case--a-suitable-block-size-is-chosen-the-first-time-lines-are-added-to-an-internal-table---specifying-a-concrete-value-greater-than-0-after-initial-size-is-only-practical-if-it-is-known-in-advance-how-many-entries-are-to-be-made-in-the-table--and-the-first-block-is-therefore-to-be-created-with-the-most-suitable-dimensions--this-can-be-particularly-important-for-internal-tables-that-are-components-of-other-internal-tables--and-which-only-contain-a-few-lines--no-more-than-around-5----to-avoid-excessive-memory-demands--the-system-ignores-values-that-produce-memory-demands-greater-than-the-constant-block-size---index-administration-----in-an--index-table--https---help-sap-com-doc-abapdocu-757-index-htm-7-57-en-us-abenindex-table-glosry-htm--glossary-entry----the-logical-order-of-the-table-entries-is-not-generally-consistent-with-the-physical-order-of-the-entries-in-the-main-memory--in-this-case--the-logical-order-is-no-longer-administrated-by-a-physical-index--but-by-a-logical-index--the-same-basically-applies-to-the--secondary-table-indexes--https---help-sap-com-doc-abapdocu-757-index-htm-7-57-en-us-abensecondary-table-index-glosry-htm--glossary-entry---used-to-manage--secondary--https---help-sap-com-doc-abapdocu-757-index-htm-7-57-en-us-abensecondary-table-key-glosry-htm--glossary-entry----sorted-keys--https---help-sap-com-doc-abapdocu-757-index-htm-7-57-en-us-abensorted-key-glosry-htm--glossary-entry-----use-of-the-logical-index-produces-additional-memory-requirements--and-index-maintenance-places-a-high-demand-on-resources--time-and-memory--when-inserting-or-deleting-table-lines--the-resource-requirements-increase-proportionally-with-the-number-of-remaining-lines-after-the-insertion-or-deletion-position--for-very-large-internal-tables--this-can-result-in-considerable-demands-on-performance-at-runtime---the-logical-index-is-only-created-when-it-is-needed--that-is--when-a-line-is-inserted-in-front-of-another-line--if-the-order-of-the-table-lines-is-changed--or-a-line-other-than-the-last-line-is-deleted--a-logical-index-is-not-required-if-an-internal-table-is-filled-using-only--append--https---help-sap-com-doc-abapdocu-757-index-htm-7-57-en-us-abapappend-htm---and-if-only-its-last-line-or-lines-is-are-deleted-using--delete--https---help-sap-com-doc-abapdocu-757-index-htm-7-57-en-us-abapdelete-itab-htm----hint--in-contrast-to-filling-a-table-with--insert--https---help-sap-com-doc-abapdocu-757-index-htm-7-57-en-us-abapinsert-itab-htm---appending-lines-with--append--https---help-sap-com-doc-abapdocu-757-index-htm-7-57-en-us-abapappend-htm--does-not-require-any-resources-for-index-maintenance--it-is-therefore-preferable-to-use-append-instead-of-insert-to-create-a--standard-table--https---help-sap-com-doc-abapdocu-757-index-htm-7-57-en-us-abenstandard-table-glosry-htm--glossary-entry----this-is-possible-if-the-order-of-the-entries-is-not-important--or-if-entries-can-be-appended-in-the-correct-order---block-processing-of-table-lines-----if-entire-line-areas-of-a-table-can-be-processed-at-once--this-should-not-be-done-line-by-line--but-using-block-operations--block-operations-are-possible-using-the-from-and-to-additions-of-the-statements--insert--https---help-sap-com-doc-abapdocu-757-index-htm-7-57-en-us-abapinsert-itab-htm----append--https---help-sap-com-doc-abapdocu-757-index-htm-7-57-en-us-abapappend-htm--and--delete--https---help-sap-com-doc-abapdocu-757-index-htm-7-57-en-us-abapdelete-itab-htm---block-operations-are-also-more-efficient-than-single-record-operations-when-reading-from-or-modifying-database-tables-with--abap-sql--https---help-sap-com-doc-abapdocu-757-index-htm-7-57-en-us-abenabap-sql-glosry-htm--glossary-entry---statements-with-the-additions-from---appending---to-table---selective-data-transport-----if--when-reading-table-lines-using--read-table--https---help-sap-com-doc-abapdocu-757-index-htm-7-57-en-us-abapread-table-htm--or--loop-at--https---help-sap-com-doc-abapdocu-757-index-htm-7-57-en-us-abaploop-at-itab-htm---a-work-area-is-used-or-table-lines-can-be-changed-using--modify--https---help-sap-com-doc-abapdocu-757-index-htm-7-57-en-us-abapmodify-itab-htm--instead-of-direct-access--the-transporting-addition-can-be-used-to-prevent-unnecessary-assignments-of-table-components-to-the-work-area--this-can-lead-to-a-noticeable-improvement-in-performance--particularly-if-table-like-components-are-excluded-from-processing---using-secondary-keys-----the--use-of-secondary-table-keys--https---help-sap-com-doc-abapdocu-757-index-htm-7-57-en-us-abenitab-key-secondary-usage-htm--should-be-planned-and-executed-carefully-and-sparingly--the-time-gained-when-accessing-individual-lines-should-not-be-lost-again-by-the-increased-memory-and-time-requirements-for-managing-the-secondary-keys--secondary-keys-are-generally-recommended-for-internal-tables-that-are-filled-once-and-rarely-changed-during-program-execution---example--the-program-demo--secondary--keys-demonstrates-how-a-secondary-table-key-is-specified-and-the-resulting-performance-gain---deleting-table-lines-----when-lines-are-deleted-from-an-internal-table--administration-costs-are-incurred-for-all-table-keys-and-table-indexes--the-primary-key-and-all-unique-secondary-keys-are-updated-directly--but-non-unique-secondary-keys-are-updated-only-if-the-line-to-be-deleted-is-included-in-the-updated-part-of-an-associated-index---lazy-update--https---help-sap-com-doc-abapdocu-757-index-htm-7-57-en-us-abenlazy-update-glosry-htm--glossary-entry------it-should-be-noted-that--particularly-for-standard-tables--the-mean-runtime-of-the-statement--delete--https---help-sap-com-doc-abapdocu-757-index-htm-7-57-en-us-abapdelete-itab-htm--always-depends-linearly-on-the-number-of-table-lines--even-when-secondary-keys-are-specified-using--with-table-key--https---help-sap-com-doc-abapdocu-757-index-htm-7-57-en-us-abapdelete-itab-key-htm--or--using-key--https---help-sap-com-doc-abapdocu-757-index-htm-7-57-en-us-abapdelete-itab-key-htm---this-is-because-a-linear-search-is-required-to-update-the-primary-index--even-though-the-line-to-be-deleted-can-itself-be-found-quickly---deleting-lines-in-internal-tables-using--delete--https---help-sap-com-doc-abapdocu-757-index-htm-7-57-en-us-abapdelete-itab-htm--does-not-usually-release-any-memory-in-the-internal-table--statements-such-as--clear--https---help-sap-com-doc-abapdocu-757-index-htm-7-57-en-us-abapclear-htm--or--free--https---help-sap-com-doc-abapdocu-757-index-htm-7-57-en-us-abapfree-dataobject-htm--must-be-used-to-release-memory-in-internal-tables---free-key-specified-for-sorted-tables-and-hashed-tables-----when-using-the--read--https---help-sap-com-doc-abapdocu-757-index-htm-7-57-en-us-abapread-table-htm--statement-with-a-specified-free-key-of-the-form--with-key------https---help-sap-com-doc-abapdocu-757-index-htm-7-57-en-us-abapread-table-free-htm---the-search-is-optimized-in-all-cases-where-this-is-possible--that-is-------in--sorted-tables--https---help-sap-com-doc-abapdocu-757-index-htm-7-57-en-us-abensorted-table-glosry-htm--glossary-entry----if-any-initial-section-of-the--table-key--https---help-sap-com-doc-abapdocu-757-index-htm-7-57-en-us-abentable-key-glosry-htm--glossary-entry---or-the-complete-table-key-is-covered-by-the-specified-key------in--hashed-tables--https---help-sap-com-doc-abapdocu-757-index-htm-7-57-en-us-abenhashed-table-glosry-htm--glossary-entry----if-the-complete-table-key-is-covered---if-part-of-a-free-key-meets-these-conditions--this-partial-key-is-first-used-to-search-for-an-entry--in-sorted-tables--this-is-done-using-a-binary-search-with-a-logarithmic-consumption-of-resources--and-in-hashed-tables-using-a-hash-algorithm--that-is--with-constant-resource-consumption--if-an-entry-is-found--the-system-checks-whether-the-rest-of-the-key-conditions-are-also-met--this-means-that-over-specific-keys-in-particular-are-optimized---hint--see-also--optimization-of-the-where-condition--https---help-sap-com-doc-abapdocu-757-index-htm-7-57-en-us-abenitab-where-optimization-htm----sorting-----for-textual-sorting-of-an-internal-table-in-accordance-with-the-current--text-environment--https---help-sap-com-doc-abapdocu-757-index-htm-7-57-en-us-abentext-environment-glosry-htm--glossary-entry----it-can-be-more-efficient-to-use-the-statement--convert-text-into-sortable-code--https---help-sap-com-doc-abapdocu-757-index-htm-7-57-en-us-abapconvert-text-htm--instead-of--sort-as-text--https---help-sap-com-doc-abapdocu-757-index-htm-7-57-en-us-abapsort-itab-htm--in-the-following-cases-------if-an-internal-table-is-sorted-by-locale-and-then-searched-binarily-using-the-statement-read-table-or-using-a--table-expression--https---help-sap-com-doc-abapdocu-757-index-htm-7-57-en-us-abentable-expressions-htm-------an-internal-table-must-be-sorted-more-than-once------indexes-for-database-tables-should-be-structured-in-accordance-with-a-locale---continue--itab---optimizing-the-where-condition--https---help-sap-com-doc-abapdocu-757-index-htm-7-57-en-us-abenitab-where-optimization-htm--------abenitab-where-optimization-htm------title---hint--description------if-the-lines-selected-using-where-are-modified-or-deleted-using-modify-https---help-sap-com-doc-abapdocu-757-index-htm-7-57-en-us-abapmodify-itab-htm--or-delete-https---help-sap-com-doc-abapdocu-757-index-htm-7-57-en-us-abapdelete-itab-htm--and-not-just-read-using-loop-at-https---help-sap-com--version---7-57--category---general--type---abap-reference--sourceurl---https---help-sap-com-doc-abapdocu-757-index-htm-7-57-en-us-abenitab-where-optimization-htm--abapfile---abenitab-where-optimization-htm--keywords----select----update----delete----loop----do----if----case----try----catch----data----types----internal-table----abenitab----where----optimization---------------as-abap-release-757---copyright-2023-sap-se--all-rights-reserved----abap---keyword-documentation--https---help-sap-com-doc-abapdocu-757-index-htm-7-57-en-us-abenabap-htm------abap---programming-language--https---help-sap-com-doc-abapdocu-757-index-htm-7-57-en-us-abenabap-reference-htm------processing-internal-data--https---help-sap-com-doc-abapdocu-757-index-htm-7-57-en-us-abenabap-data-working-htm------internal-tables--itab---https---help-sap-com-doc-abapdocu-757-index-htm-7-57-en-us-abenitab-htm------itab---performance-notes--https---help-sap-com-doc-abapdocu-757-index-htm-7-57-en-us-abenitab-perfo-htm------------mail-gif-object-mail-gif-sap-language-en--feedback-mail-for-displayed-topic---mail-feedback--mailto-f1-helpsap.com?subject=Feedback on ABAP Documentation&body=Document: itab - Optimizing the WHERE Condition, ABENITAB_WHERE_OPTIMIZATION, 757%0D%0A%0D%0AEr
ror:%0D%0A%0D%0A%0D%0A%0D%0ASuggestion for improvement:)

itab - Optimizing the WHERE Condition

The statements [LOOP AT](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abaploop_at_itab.htm), [DELETE](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abapdelete_itab.htm), and [MODIFY](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abapmodify_itab.htm) can be specified together with a WHERE condition that selects specific lines of the internal table. Searches in a [standard table](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abenstandard_table_glosry.htm "Glossary Entry") using the [primary table key](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abenprimary_table_key_glosry.htm "Glossary Entry") are always linear and cannot be optimized. Searches using a [sorted key](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abensorted_key_glosry.htm "Glossary Entry") or a [hash key](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abenhash_key_glosry.htm "Glossary Entry"), however, can be optimized in certain circumstances. These keys are used for:

-   accessing a [sorted table](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abensorted_table_glosry.htm "Glossary Entry") using its primary key.
-   accessing a [hashed table](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abenhashed_table_glosry.htm "Glossary Entry") using its primary key.
-   accessing a table of any table type using a [secondary table key](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abensecondary_table_key_glosry.htm "Glossary Entry") specified by USING KEY.

The optimization takes place by mapping all [relational expressions](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abenrelational_expression_glosry.htm "Glossary Entry") or a group of the relational expressions in the WHERE condition to a specified key. This specified key performs a corresponding optimized key access (binary search or hash algorithm as in the statement [READ TABLE](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abapread_table.htm) or a [table expression](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abentable_expressions.htm)), to find one or more lines. The found line or lines are then checked using those remaining relational expressions from the WHERE condition that were not mapped to the specified key.

Prerequisites for the optimization are therefore:

-   The relational expressions of the WHERE condition can be transformed to a specified key.
-   The corresponding key access returns the same results as the evaluation of this part of the logical expression would. This is guaranteed only for compatible data types, since in the case of incompatible data types:
    -   the content of the specified data objects is converted to the data type of the columns before the evaluation in the case of key accesses.
    -   The [comparison rules](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abenlogexp_rules.htm) for incompatible data types apply when evaluating a [comparison expression](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abencomparison_expression_glosry.htm "Glossary Entry"). Here, all the data types involved play a part in determining which operand is converted into which comparison type.

If there are no or insufficient relational expressions to meet both of these prerequisites, no optimization is possible and the behavior is as follows:

-   If a sorted table or a hashed table is accessed using the primary table key, all lines of the internal table are checked as in a standard table.
-   If the table is read using a secondary table key, that is, if said key is specified after USING KEY, a syntax error or syntax check warning, or an exception is raised. Access using a secondary table key must always be executed in an optimized way.

The following sections describe exactly when an access can be optimized.

-   [Prerequisites for the Optimization of Hash Keys](#abenitab-where-optimization-1-------prerequisites-for-the-optimization-of-sorted-keys---@ITOC@@ABENITAB_WHERE_OPTIMIZATION_2)
-   [Requirements Made on the Operands](#@@ITOC@@ABENITAB_WHERE_OPTIMIZATION_3)

Hint

If the lines selected using WHERE are modified or deleted using [MODIFY](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abapmodify_itab.htm) or [DELETE](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abapdelete_itab.htm) and not just read using [LOOP AT](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abaploop_at_itab.htm), further update costs are incurred in addition to the search for the lines. When deleting lines from standard tables, it should be noted that searches using a secondary key optimize the selection of lines to be deleted, but not the update required for the primary key, which is usually performed using a linear search.

Prerequisites for the Optimization of Hash Keys   

In the case of [hash key](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abenhash_key_glosry.htm "Glossary Entry") accesses, there must be exactly one relational expression combined using AND for each component of the key. This expression is either

-   a [comparison expression](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abencomparison_expression_glosry.htm "Glossary Entry") with the comparison operator \= (or EQ), whose operands meet the requirements above or
-   a [predicate expression](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abenpredicate_expression_glosry.htm "Glossary Entry") IS INITIAL without the addition NOT.

These relational expressions construct the part of the logical expression used for the key access. This part must not contain duplicate key components. The remainder of the logical expression can contain any number of relational expressions combined using AND. Optimization may not be possible, however, if the Boolean operators NOT or OR are used. Key components may be used in the relational expressions not used for the key access.

Hint

Relational expressions other than comparisons using \= (or EQ) or predicate expressions IS INITIAL are not part of the key access. This applies particularly to the tabular comparison operator [IN range\_tab](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abenlogexp_select_option.htm), even if it can be traced back to optimizable comparisons.

Example

In the following example, the first two WHERE conditions can be optimized as key accesses with the secondary table key key. This is because:

1.  The optimizable conditions for b, d, and e cover the entire key.
2.  The optimizable conditions b, d, and e cover the entire key and a is a condition on a non-key column that is not involved in the part of the WHERE condition required for the optimization.
3.  The optimizable conditions b, d, and e cover the entire key and the other two conditions on the key columns b and d are not optimizable and are hence not involved in the part of the WHERE condition required for the optimization.

The next six WHERE conditions cannot be optimized and produce syntax errors. This is because:

1.  The key component d is not specified.
2.  A key component is combined using OR instead of AND.
3.  Two non-optimizable comparison operators are used.
4.  An operand of type i is used in the comparison b of type c, which does not meet the requirements made on the operands.
5.  The Boolean operator NOT is used in front of a key component.
6.  A further comparison is combined using OR.
7.  A further comparison is negated using NOT.
    
    DATA: BEGIN OF line,
            a TYPE c LENGTH 3,
            b TYPE c LENGTH 3,
            c TYPE c LENGTH 3,
            d TYPE c LENGTH 3,
            e TYPE c LENGTH 3,
            f TYPE c LENGTH 3,
          END OF line.
    DATA itab LIKE STANDARD TABLE OF line
                   WITH UNIQUE HASHED KEY key COMPONENTS b e d.
    DATA b\_tab LIKE RANGE OF line-b.
    LOOP AT itab INTO line USING KEY key
         WHERE b = '...' AND d = '...' AND e IS INITIAL.
    ENDLOOP.
    LOOP AT itab INTO line USING KEY key
         WHERE a = '...' AND b = '...' AND d = '...' AND e IS INITIAL.
    ENDLOOP.
    LOOP AT itab INTO line USING KEY key
         WHERE  b = '...' AND d = '...' AND e IS INITIAL AND
                b IN b\_tab AND d <> '...'.
    ENDLOOP.
    LOOP AT itab INTO line USING KEY key
         WHERE b = '...' AND e IS INITIAL.                     "syntax error
    ENDLOOP.
    LOOP AT itab INTO line USING KEY key
         WHERE b = '...' OR d = '...' AND e IS INITIAL OR      "syntax error
    ENDLOOP.
    LOOP AT itab INTO line USING KEY key
         WHERE b = '...' AND d <> '...' AND e IS NOT INITIAL.  "syntax error
    ENDLOOP.
    LOOP AT itab INTO line USING KEY key
         WHERE b = 333 AND d = '...' AND e IS INITIAL.         "syntax error
    ENDLOOP.
    LOOP AT itab INTO line USING KEY key
         WHERE b = '...'  AND NOT d = '...' AND e IS INITIAL.  "syntax error
    ENDLOOP.
    LOOP AT itab INTO line USING KEY key
         WHERE b = '...' AND d = '...' AND e IS INITIAL OR     "syntax error
               a = '...'.
    ENDLOOP.
    LOOP AT itab INTO line USING KEY key
         WHERE b = '...' AND d = '...' AND e IS INITIAL AND    "syntax error
               NOT a = '...'.
    ENDLOOP.
    

Prerequisites for the Optimization of Sorted Keys   

In the case of reads using a [sorted key](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abensorted_key_glosry.htm "Glossary Entry"), the same applies as to a hash key. The only difference is that only an initial section of the key consisting of at least one component needs to be covered rather than the entire key.

The internal table is accessed in part sequentially. The starting point for the processing of the table is determined by a binary search using the subconditions that cover the table key completely or partially. From the starting point onwards, the table is only processed for as long as these subconditions remain fulfilled.

Example

In the following example, the first five WHERE conditions can be optimized as key accesses with the secondary table key key. This is because:

1.  b is an initial part of the key.
2.  b is an initial part of the key and a is an independent condition.
3.  b and e are an initial part of the key.
4.  b, e, and d are an initial part of the key and the order in the WHERE condition is ignored.
5.  b is an initial part of the key and in this case, d is an independent condition, even though it is part of the key.

The next five WHERE conditions cannot be optimized and produce syntax errors. This is because:

1.  e is not an initial part of the key.
2.  No inequality comparison takes place.
3.  A comparison in a ranges table is specified.
4.  The Boolean operator NOT is used.
5.  An additional OR relationship is used.
    
    DATA: BEGIN OF line,
            a TYPE c LENGTH 3,
            b TYPE c LENGTH 3,
            c TYPE c LENGTH 3,
            d TYPE c LENGTH 3,
            e TYPE c LENGTH 3,
            f TYPE c LENGTH 3,
          END OF line.
    DATA itab LIKE STANDARD TABLE OF line
                   WITH UNIQUE SORTED KEY key COMPONENTS b e d.
    DATA b\_tab LIKE RANGE OF line-b.
    LOOP AT itab INTO line USING KEY key
                 WHERE b = '...'.
    ENDLOOP.
    LOOP AT itab INTO line USING KEY key
                 WHERE a = '...' AND b IS INITIAL.
    ENDLOOP.
    LOOP AT itab INTO line USING KEY key
                 WHERE b = '...' AND e = '...'.
    ENDLOOP.
    LOOP AT itab INTO line USING KEY key
                 WHERE b = '...' AND d IS INITIAL AND e = '...'.
    ENDLOOP.
    LOOP AT itab INTO line USING KEY key
                 WHERE b = '...' AND d <> '...'.
    ENDLOOP.
    LOOP AT itab INTO line USING KEY key
                 WHERE e = '...'.                    "syntax error
    ENDLOOP.
    LOOP AT itab INTO line USING KEY key
                 WHERE b <> '...'.                   "syntax error
    ENDLOOP.
    LOOP AT itab INTO line USING KEY key
                 WHERE b IN b\_tab.                   "syntax error
    ENDLOOP.
    LOOP AT itab INTO line USING KEY key
                 WHERE b = '...'  AND NOT e = '...'. "syntax error
    ENDLOOP.
    LOOP AT itab INTO line USING KEY key             "syntax error
                 WHERE b = '...'  AND ( d = '...' OR e IS INITIAL ).
    ENDLOOP.
    

Requirements Made on the Operands   

The part of the logical expression that can be mapped to a key access must select the same lines as a statement [READ TABLE](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abapread_table.htm) or a corresponding [table expression](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abentable_expressions.htm) that specifies the corresponding components as keys.

-   When comparing incompatible data objects, the WHERE condition is subject to the same [comparison rules](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abenlogexp_rules.htm) for incompatible data types. Here, the data types involved determine which operand is converted to which comparison type.
-   If the additions [WITH TABLE KEY](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abapread_table_key.htm) and [WITH KEY](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abapread_table_free.htm) of the statement READ or [KEY](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abentable_exp_itab_line.htm) in a table expression are used, however, the content of the specified data objects is always converted to the data type of the columns before the comparison.

If this produces differing results, an optimization is not possible. Due to the complexity of the comparison rules, particularly for [elementary data types](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abenlogexp_rules_operands.htm), it is not a good idea to construct a set of rules detailing exactly when the comparison type matches the data type of the left operand. Generally speaking,

-   only fully compatible operands are optimizable,
-   in some cases, elementary operands with different data types can be optimized, if the value ranges or lengths are suitable. For example, a comparison of a column with the type of a floating point number with an operand of type integer or of a column of c with a similar operand, if its length is less than the length of the column.

For this reason, it is advisable to use only pairs of [compatible](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abencompatible_glosry.htm "Glossary Entry") operands in the WHERE condition. This guarantees that the differences in behavior of the WHERE condition and the specified key do not affect the result.

Example

The following example is largely similar to the example in the section WHERE log\_exp in [LOOP AT itab](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abaploop_at_itab_cond.htm). In that case, access takes place using the primary key and no optimization. Here, however, access takes place using a secondary table key and a syntax check warning is produced and an exception raised when the program is executed. The number of lines in the internal table determines whether the exception is raised.

DATA text\_short TYPE c LENGTH 2.
DATA text\_long  TYPE c LENGTH 4.
DATA itab LIKE TABLE OF text\_short
          WITH UNIQUE HASHED KEY key COMPONENTS table\_line.
itab = VALUE #( ( 'AA' )
                ( 'BB' )
                ( 'CC' )
                ( 'DD' )
                ( 'EE' )
                ( 'FF' )
                ( 'GG' )
                ( 'HH' )
                ( 'II' )
                ( 'JJ' )
                ( 'KK' )
                ( 'LL' )
                ( 'MM' ) ).
text\_short = 'AA'.
text\_long  = 'AAXX'.
LOOP AT itab INTO text\_short USING KEY key
             WHERE table\_line = text\_long.
ENDLOOP.
cl\_demo\_output=>write( |LOOP: { sy-subrc }| ).
"Statement
READ TABLE itab INTO text\_short WITH TABLE KEY key
                                COMPONENTS table\_line = text\_long.
cl\_demo\_output=>write( |READ: { sy-subrc }| ).
"Expression
TRY.
    text\_short = itab\[ KEY key COMPONENTS table\_line = text\_long \].
  catch CX\_SY\_ITAB\_LINE\_NOT\_FOUND.
    ...
ENDTRY.
cl\_demo\_output=>display( |Expression: { text\_short }| ).


---


## ABAP - Keyword Documentation / ABAP - Programming Language / Processing Internal Data / Internal Tables (itab) / itab - Processing Statements / READ TABLE itab / READ TABLE, result

**Files**: 3 | **Difficulty**: intermediate

# ABAP - Keyword Documentation / ABAP - Programming Language / Processing Internal Data / Internal Tables (itab) / itab - Performance Notes

Included pages: 2


### abenitab_perfo.htm

---
title: "Table Sharing"
description: |
  When assignments are made between internal tables of the same type whose line type does not contain any table types, only the internal administration functions are passed to the table body(https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abentable_body_glosry.htm 'Glossary Entry') for pe
version: "7.57"
category: "data-structures"
type: "abap-reference"
sourceUrl: "https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abenitab_perfo.htm"
abapFile: "abenitab_perfo.htm"
keywords: ["select", "insert", "update", "delete", "loop", "do", "if", "case", "try", "data", "types", "internal-table", "abenitab", "perfo"]
---

* * *

AS ABAP Release 757, ©Copyright 2023 SAP SE. All rights reserved.

[ABAP - Keyword Documentation](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abenabap.htm) →  [ABAP - Programming Language](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abenabap_reference.htm) →  [Processing Internal Data](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abenabap_data_working.htm) →  [Internal Tables (itab)](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abenitab.htm) → 

 [![](Mail.gif?object=Mail.gif&sap-language=EN "Feedback mail for displayed topic") Mail Feedback](mailto:f1_help@sap.com?subject=Feedback on ABAP Documentation&body=Document: itab - Performance Notes, ABENITAB_PERFO, 757%0D%0A%0D%0AError:%0D%0A%0D%0A%0D%0A%0D%
0ASuggestion for improvement:)

itab - Performance Notes

-   [Table Sharing](#abenitab-perfo-1-------initial-memory-requirement---@ITOC@@ABENITAB_PERFO_2)
-   [Index Administration](#abenitab-perfo-3-------block-processing-of-table-lines---@ITOC@@ABENITAB_PERFO_4)
-   [Selective Data Transport](#abenitab-perfo-5-------using-secondary-keys---@ITOC@@ABENITAB_PERFO_6)
-   [Deleting Table Lines](#abenitab-perfo-7-------free-key-specified-for-sorted-tables-and-hashed-tables---@ITOC@@ABENITAB_PERFO_8)
-   [Sorting](#abenitab-perfo-9---table-sharing-----when-assignments-are-made-between-internal-tables-of-the-same-type-whose-line-type-does-not-contain-any-table-types--only-the-internal-administration-functions-are-passed-to-the--table-body--https---help-sap-com-doc-abapdocu-757-index-htm-7-57-en-us-abentable-body-glosry-htm--glossary-entry---for-performance-reasons---table-sharing--https---help-sap-com-doc-abapdocu-757-index-htm-7-57-en-us-abentable-sharing-glosry-htm--glossary-entry---is-revoked-only-when-write-access-to-one-of-the-tables-involved-is-initiated--the-actual-copy-process-then-takes-place---initial-memory-requirement-----internal-tables-are--dynamic-data-objects--https---help-sap-com-doc-abapdocu-757-index-htm-7-57-en-us-abendynamic-data-object-glosry-htm--glossary-entry---whose-area-in-the-memory-is-extended-block-by-block--the-size-of-the-first-block-in-the-memory-is-called--initial-memory-requirement--https---help-sap-com-doc-abapdocu-757-index-htm-7-57-en-us-abeninitial-mem-req-glosry-htm--glossary-entry---and-can-be-affected-in-the-declaration-of-an-internal-table-using-the-additions--initial-size--https---help-sap-com-doc-abapdocu-757-index-htm-7-57-en-us-abaptypes-itab-htm--and-the-obsolete--occurs--https---help-sap-com-doc-abapdocu-757-index-htm-7-57-en-us-abapdata-occurs-htm----it-is-usually-up-to-the-system-to-determine-the-size-of-the-first-block--initial-size-is-not-used-or-specified-with-the-value-0--in-this-case--a-suitable-block-size-is-chosen-the-first-time-lines-are-added-to-an-internal-table---specifying-a-concrete-value-greater-than-0-after-initial-size-is-only-practical-if-it-is-known-in-advance-how-many-entries-are-to-be-made-in-the-table--and-the-first-block-is-therefore-to-be-created-with-the-most-suitable-dimensions--this-can-be-particularly-important-for-internal-tables-that-are-components-of-other-internal-tables--and-which-only-contain-a-few-lines--no-more-than-around-5----to-avoid-excessive-memory-demands--the-system-ignores-values-that-produce-memory-demands-greater-than-the-constant-block-size---index-administration-----in-an--index-table--https---help-sap-com-doc-abapdocu-757-index-htm-7-57-en-us-abenindex-table-glosry-htm--glossary-entry----the-logical-order-of-the-table-entries-is-not-generally-consistent-with-the-physical-order-of-the-entries-in-the-main-memory--in-this-case--the-logical-order-is-no-longer-administrated-by-a-physical-index--but-by-a-logical-index--the-same-basically-applies-to-the--secondary-table-indexes--https---help-sap-com-doc-abapdocu-757-index-htm-7-57-en-us-abensecondary-table-index-glosry-htm--glossary-entry---used-to-manage--secondary--https---help-sap-com-doc-abapdocu-757-index-htm-7-57-en-us-abensecondary-table-key-glosry-htm--glossary-entry----sorted-keys--https---help-sap-com-doc-abapdocu-757-index-htm-7-57-en-us-abensorted-key-glosry-htm--glossary-entry-----use-of-the-logical-index-produces-additional-memory-requirements--and-index-maintenance-places-a-high-demand-on-resources--time-and-memory--when-inserting-or-deleting-table-lines--the-resource-requirements-increase-proportionally-with-the-number-of-remaining-lines-after-the-insertion-or-deletion-position--for-very-large-internal-tables--this-can-result-in-considerable-demands-on-performance-at-runtime---the-logical-index-is-only-created-when-it-is-needed--that-is--when-a-line-is-inserted-in-front-of-another-line--if-the-order-of-the-table-lines-is-changed--or-a-line-other-than-the-last-line-is-deleted--a-logical-index-is-not-required-if-an-internal-table-is-filled-using-only--append--https---help-sap-com-doc-abapdocu-757-index-htm-7-57-en-us-abapappend-htm---and-if-only-its-last-line-or-lines-is-are-deleted-using--delete--https---help-sap-com-doc-abapdocu-757-index-htm-7-57-en-us-abapdelete-itab-htm----hint--in-contrast-to-filling-a-table-with--insert--https---help-sap-com-doc-abapdocu-757-index-htm-7-57-en-us-abapinsert-itab-htm---appending-lines-with--append--https---help-sap-com-doc-abapdocu-757-index-htm-7-57-en-us-abapappend-htm--does-not-require-any-resources-for-index-maintenance--it-is-therefore-preferable-to-use-append-instead-of-insert-to-create-a--standard-table--https---help-sap-com-doc-abapdocu-757-index-htm-7-57-en-us-abenstandard-table-glosry-htm--glossary-entry----this-is-possible-if-the-order-of-the-entries-is-not-important--or-if-entries-can-be-appended-in-the-correct-order---block-processing-of-table-lines-----if-entire-line-areas-of-a-table-can-be-processed-at-once--this-should-not-be-done-line-by-line--but-using-block-operations--block-operations-are-possible-using-the-from-and-to-additions-of-the-statements--insert--https---help-sap-com-doc-abapdocu-757-index-htm-7-57-en-us-abapinsert-itab-htm----append--https---help-sap-com-doc-abapdocu-757-index-htm-7-57-en-us-abapappend-htm--and--delete--https---help-sap-com-doc-abapdocu-757-index-htm-7-57-en-us-abapdelete-itab-htm---block-operations-are-also-more-efficient-than-single-record-operations-when-reading-from-or-modifying-database-tables-with--abap-sql--https---help-sap-com-doc-abapdocu-757-index-htm-7-57-en-us-abenabap-sql-glosry-htm--glossary-entry---statements-with-the-additions-from---appending---to-table---selective-data-transport-----if--when-reading-table-lines-using--read-table--https---help-sap-com-doc-abapdocu-757-index-htm-7-57-en-us-abapread-table-htm--or--loop-at--https---help-sap-com-doc-abapdocu-757-index-htm-7-57-en-us-abaploop-at-itab-htm---a-work-area-is-used-or-table-lines-can-be-changed-using--modify--https---help-sap-com-doc-abapdocu-757-index-htm-7-57-en-us-abapmodify-itab-htm--instead-of-direct-access--the-transporting-addition-can-be-used-to-prevent-unnecessary-assignments-of-table-components-to-the-work-area--this-can-lead-to-a-noticeable-improvement-in-performance--particularly-if-table-like-components-are-excluded-from-processing---using-secondary-keys-----the--use-of-secondary-table-keys--https---help-sap-com-doc-abapdocu-757-index-htm-7-57-en-us-abenitab-key-secondary-usage-htm--should-be-planned-and-executed-carefully-and-sparingly--the-time-gained-when-accessing-individual-lines-should-not-be-lost-again-by-the-increased-memory-and-time-requirements-for-managing-the-secondary-keys--secondary-keys-are-generally-recommended-for-internal-tables-that-are-filled-once-and-rarely-changed-during-program-execution---example--the-program-demo--secondary--keys-demonstrates-how-a-secondary-table-key-is-specified-and-the-resulting-performance-gain---deleting-table-lines-----when-lines-are-deleted-from-an-internal-table--administration-costs-are-incurred-for-all-table-keys-and-table-indexes--the-primary-key-and-all-unique-secondary-keys-are-updated-directly--but-non-unique-secondary-keys-are-updated-only-if-the-line-to-be-deleted-is-included-in-the-updated-part-of-an-associated-index---lazy-update--https---help-sap-com-doc-abapdocu-757-index-htm-7-57-en-us-abenlazy-update-glosry-htm--glossary-entry------it-should-be-noted-that--particularly-for-standard-tables--the-mean-runtime-of-the-statement--delete--https---help-sap-com-doc-abapdocu-757-index-htm-7-57-en-us-abapdelete-itab-htm--always-depends-linearly-on-the-number-of-table-lines--even-when-secondary-keys-are-specified-using--with-table-key--https---help-sap-com-doc-abapdocu-757-index-htm-7-57-en-us-abapdelete-itab-key-htm--or--using-key--https---help-sap-com-doc-abapdocu-757-index-htm-7-57-en-us-abapdelete-itab-key-htm---this-is-because-a-linear-search-is-required-to-update-the-primary-index--even-though-the-line-to-be-deleted-can-itself-be-found-quickly---deleting-lines-in-internal-tables-using--delete--https---help-sap-com-doc-abapdocu-757-index-htm-7-57-en-us-abapdelete-itab-htm--does-not-usually-release-any-memory-in-the-internal-table--statements-such-as--clear--https---help-sap-com-doc-abapdocu-757-index-htm-7-57-en-us-abapclear-htm--or--free--https---help-sap-com-doc-abapdocu-757-index-htm-7-57-en-us-abapfree-dataobject-htm--must-be-used-to-release-memory-in-internal-tables---free-key-specified-for-sorted-tables-and-hashed-tables-----when-using-the--read--https---help-sap-com-doc-abapdocu-757-index-htm-7-57-en-us-abapread-table-htm--statement-with-a-specified-free-key-of-the-form--with-key------https---help-sap-com-doc-abapdocu-757-index-htm-7-57-en-us-abapread-table-free-htm---the-search-is-optimized-in-all-cases-where-this-is-possible--that-is-------in--sorted-tables--https---help-sap-com-doc-abapdocu-757-index-htm-7-57-en-us-abensorted-table-glosry-htm--glossary-entry----if-any-initial-section-of-the--table-key--https---help-sap-com-doc-abapdocu-757-index-htm-7-57-en-us-abentable-key-glosry-htm--glossary-entry---or-the-complete-table-key-is-covered-by-the-specified-key------in--hashed-tables--https---help-sap-com-doc-abapdocu-757-index-htm-7-57-en-us-abenhashed-table-glosry-htm--glossary-entry----if-the-complete-table-key-is-covered---if-part-of-a-free-key-meets-these-conditions--this-partial-key-is-first-used-to-search-for-an-entry--in-sorted-tables--this-is-done-using-a-binary-search-with-a-logarithmic-consumption-of-resources--and-in-hashed-tables-using-a-hash-algorithm--that-is--with-constant-resource-consumption--if-an-entry-is-found--the-system-checks-whether-the-rest-of-the-key-conditions-are-also-met--this-means-that-over-specific-keys-in-particular-are-optimized---hint--see-also--optimization-of-the-where-condition--https---help-sap-com-doc-abapdocu-757-index-htm-7-57-en-us-abenitab-where-optimization-htm----sorting-----for-textual-sorting-of-an-internal-table-in-accordance-with-the-current--text-environment--https---help-sap-com-doc-abapdocu-757-index-htm-7-57-en-us-abentext-environment-glosry-htm--glossary-entry----it-can-be-more-efficient-to-use-the-statement--convert-text-into-sortable-code--https---help-sap-com-doc-abapdocu-757-index-htm-7-57-en-us-abapconvert-text-htm--instead-of--sort-as-text--https---help-sap-com-doc-abapdocu-757-index-htm-7-57-en-us-abapsort-itab-htm--in-the-following-cases-------if-an-internal-table-is-sorted-by-locale-and-then-searched-binarily-using-the-statement-read-table-or-using-a--table-expression--https---help-sap-com-doc-abapdocu-757-index-htm-7-57-en-us-abentable-expressions-htm-------an-internal-table-must-be-sorted-more-than-once------indexes-for-database-tables-should-be-structured-in-accordance-with-a-locale---continue--itab---optimizing-the-where-condition--https---help-sap-com-doc-abapdocu-757-index-htm-7-57-en-us-abenitab-where-optimization-htm--------abenitab-where-optimization-htm------title---hint--description------if-the-lines-selected-using-where-are-modified-or-deleted-using-modify-https---help-sap-com-doc-abapdocu-757-index-htm-7-57-en-us-abapmodify-itab-htm--or-delete-https---help-sap-com-doc-abapdocu-757-index-htm-7-57-en-us-abapdelete-itab-htm--and-not-just-read-using-loop-at-https---help-sap-com--version---7-57--category---general--type---abap-reference--sourceurl---https---help-sap-com-doc-abapdocu-757-index-htm-7-57-en-us-abenitab-where-optimization-htm--abapfile---abenitab-where-optimization-htm--keywords----select----update----delete----loop----do----if----case----try----catch----data----types----internal-table----abenitab----where----optimization---------------as-abap-release-757---copyright-2023-sap-se--all-rights-reserved----abap---keyword-documentation--https---help-sap-com-doc-abapdocu-757-index-htm-7-57-en-us-abenabap-htm------abap---programming-language--https---help-sap-com-doc-abapdocu-757-index-htm-7-57-en-us-abenabap-reference-htm------processing-internal-data--https---help-sap-com-doc-abapdocu-757-index-htm-7-57-en-us-abenabap-data-working-htm------internal-tables--itab---https---help-sap-com-doc-abapdocu-757-index-htm-7-57-en-us-abenitab-htm------itab---performance-notes--https---help-sap-com-doc-abapdocu-757-index-htm-7-57-en-us-abenitab-perfo-htm------------mail-gif-object-mail-gif-sap-language-en--feedback-mail-for-displayed-topic---mail-feedback--mailto-f1-helpsap.com?subject=Feedback on ABAP Documentation&body=Document: itab - Optimizing the WHERE Condition, ABENITAB_WHERE_OPTIMIZATION, 757%0D%0A%0D%0AEr
ror:%0D%0A%0D%0A%0D%0A%0D%0ASuggestion for improvement:)

itab - Optimizing the WHERE Condition

The statements [LOOP AT](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abaploop_at_itab.htm), [DELETE](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abapdelete_itab.htm), and [MODIFY](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abapmodify_itab.htm) can be specified together with a WHERE condition that selects specific lines of the internal table. Searches in a [standard table](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abenstandard_table_glosry.htm "Glossary Entry") using the [primary table key](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abenprimary_table_key_glosry.htm "Glossary Entry") are always linear and cannot be optimized. Searches using a [sorted key](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abensorted_key_glosry.htm "Glossary Entry") or a [hash key](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abenhash_key_glosry.htm "Glossary Entry"), however, can be optimized in certain circumstances. These keys are used for:

-   accessing a [sorted table](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abensorted_table_glosry.htm "Glossary Entry") using its primary key.
-   accessing a [hashed table](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abenhashed_table_glosry.htm "Glossary Entry") using its primary key.
-   accessing a table of any table type using a [secondary table key](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abensecondary_table_key_glosry.htm "Glossary Entry") specified by USING KEY.

The optimization takes place by mapping all [relational expressions](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abenrelational_expression_glosry.htm "Glossary Entry") or a group of the relational expressions in the WHERE condition to a specified key. This specified key performs a corresponding optimized key access (binary search or hash algorithm as in the statement [READ TABLE](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abapread_table.htm) or a [table expression](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abentable_expressions.htm)), to find one or more lines. The found line or lines are then checked using those remaining relational expressions from the WHERE condition that were not mapped to the specified key.

Prerequisites for the optimization are therefore:

-   The relational expressions of the WHERE condition can be transformed to a specified key.
-   The corresponding key access returns the same results as the evaluation of this part of the logical expression would. This is guaranteed only for compatible data types, since in the case of incompatible data types:
    -   the content of the specified data objects is converted to the data type of the columns before the evaluation in the case of key accesses.
    -   The [comparison rules](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abenlogexp_rules.htm) for incompatible data types apply when evaluating a [comparison expression](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abencomparison_expression_glosry.htm "Glossary Entry"). Here, all the data types involved play a part in determining which operand is converted into which comparison type.

If there are no or insufficient relational expressions to meet both of these prerequisites, no optimization is possible and the behavior is as follows:

-   If a sorted table or a hashed table is accessed using the primary table key, all lines of the internal table are checked as in a standard table.
-   If the table is read using a secondary table key, that is, if said key is specified after USING KEY, a syntax error or syntax check warning, or an exception is raised. Access using a secondary table key must always be executed in an optimized way.

The following sections describe exactly when an access can be optimized.

-   [Prerequisites for the Optimization of Hash Keys](#abenitab-where-optimization-1-------prerequisites-for-the-optimization-of-sorted-keys---@ITOC@@ABENITAB_WHERE_OPTIMIZATION_2)
-   [Requirements Made on the Operands](#@@ITOC@@ABENITAB_WHERE_OPTIMIZATION_3)

Hint

If the lines selected using WHERE are modified or deleted using [MODIFY](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abapmodify_itab.htm) or [DELETE](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abapdelete_itab.htm) and not just read using [LOOP AT](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abaploop_at_itab.htm), further update costs are incurred in addition to the search for the lines. When deleting lines from standard tables, it should be noted that searches using a secondary key optimize the selection of lines to be deleted, but not the update required for the primary key, which is usually performed using a linear search.

Prerequisites for the Optimization of Hash Keys   

In the case of [hash key](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abenhash_key_glosry.htm "Glossary Entry") accesses, there must be exactly one relational expression combined using AND for each component of the key. This expression is either

-   a [comparison expression](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abencomparison_expression_glosry.htm "Glossary Entry") with the comparison operator \= (or EQ), whose operands meet the requirements above or
-   a [predicate expression](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abenpredicate_expression_glosry.htm "Glossary Entry") IS INITIAL without the addition NOT.

These relational expressions construct the part of the logical expression used for the key access. This part must not contain duplicate key components. The remainder of the logical expression can contain any number of relational expressions combined using AND. Optimization may not be possible, however, if the Boolean operators NOT or OR are used. Key components may be used in the relational expressions not used for the key access.

Hint

Relational expressions other than comparisons using \= (or EQ) or predicate expressions IS INITIAL are not part of the key access. This applies particularly to the tabular comparison operator [IN range\_tab](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abenlogexp_select_option.htm), even if it can be traced back to optimizable comparisons.

Example

In the following example, the first two WHERE conditions can be optimized as key accesses with the secondary table key key. This is because:

1.  The optimizable conditions for b, d, and e cover the entire key.
2.  The optimizable conditions b, d, and e cover the entire key and a is a condition on a non-key column that is not involved in the part of the WHERE condition required for the optimization.
3.  The optimizable conditions b, d, and e cover the entire key and the other two conditions on the key columns b and d are not optimizable and are hence not involved in the part of the WHERE condition required for the optimization.

The next six WHERE conditions cannot be optimized and produce syntax errors. This is because:

1.  The key component d is not specified.
2.  A key component is combined using OR instead of AND.
3.  Two non-optimizable comparison operators are used.
4.  An operand of type i is used in the comparison b of type c, which does not meet the requirements made on the operands.
5.  The Boolean operator NOT is used in front of a key component.
6.  A further comparison is combined using OR.
7.  A further comparison is negated using NOT.
    
    DATA: BEGIN OF line,
            a TYPE c LENGTH 3,
            b TYPE c LENGTH 3,
            c TYPE c LENGTH 3,
            d TYPE c LENGTH 3,
            e TYPE c LENGTH 3,
            f TYPE c LENGTH 3,
          END OF line.
    DATA itab LIKE STANDARD TABLE OF line
                   WITH UNIQUE HASHED KEY key COMPONENTS b e d.
    DATA b\_tab LIKE RANGE OF line-b.
    LOOP AT itab INTO line USING KEY key
         WHERE b = '...' AND d = '...' AND e IS INITIAL.
    ENDLOOP.
    LOOP AT itab INTO line USING KEY key
         WHERE a = '...' AND b = '...' AND d = '...' AND e IS INITIAL.
    ENDLOOP.
    LOOP AT itab INTO line USING KEY key
         WHERE  b = '...' AND d = '...' AND e IS INITIAL AND
                b IN b\_tab AND d <> '...'.
    ENDLOOP.
    LOOP AT itab INTO line USING KEY key
         WHERE b = '...' AND e IS INITIAL.                     "syntax error
    ENDLOOP.
    LOOP AT itab INTO line USING KEY key
         WHERE b = '...' OR d = '...' AND e IS INITIAL OR      "syntax error
    ENDLOOP.
    LOOP AT itab INTO line USING KEY key
         WHERE b = '...' AND d <> '...' AND e IS NOT INITIAL.  "syntax error
    ENDLOOP.
    LOOP AT itab INTO line USING KEY key
         WHERE b = 333 AND d = '...' AND e IS INITIAL.         "syntax error
    ENDLOOP.
    LOOP AT itab INTO line USING KEY key
         WHERE b = '...'  AND NOT d = '...' AND e IS INITIAL.  "syntax error
    ENDLOOP.
    LOOP AT itab INTO line USING KEY key
         WHERE b = '...' AND d = '...' AND e IS INITIAL OR     "syntax error
               a = '...'.
    ENDLOOP.
    LOOP AT itab INTO line USING KEY key
         WHERE b = '...' AND d = '...' AND e IS INITIAL AND    "syntax error
               NOT a = '...'.
    ENDLOOP.
    

Prerequisites for the Optimization of Sorted Keys   

In the case of reads using a [sorted key](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abensorted_key_glosry.htm "Glossary Entry"), the same applies as to a hash key. The only difference is that only an initial section of the key consisting of at least one component needs to be covered rather than the entire key.

The internal table is accessed in part sequentially. The starting point for the processing of the table is determined by a binary search using the subconditions that cover the table key completely or partially. From the starting point onwards, the table is only processed for as long as these subconditions remain fulfilled.

Example

In the following example, the first five WHERE conditions can be optimized as key accesses with the secondary table key key. This is because:

1.  b is an initial part of the key.
2.  b is an initial part of the key and a is an independent condition.
3.  b and e are an initial part of the key.
4.  b, e, and d are an initial part of the key and the order in the WHERE condition is ignored.
5.  b is an initial part of the key and in this case, d is an independent condition, even though it is part of the key.

The next five WHERE conditions cannot be optimized and produce syntax errors. This is because:

1.  e is not an initial part of the key.
2.  No inequality comparison takes place.
3.  A comparison in a ranges table is specified.
4.  The Boolean operator NOT is used.
5.  An additional OR relationship is used.
    
    DATA: BEGIN OF line,
            a TYPE c LENGTH 3,
            b TYPE c LENGTH 3,
            c TYPE c LENGTH 3,
            d TYPE c LENGTH 3,
            e TYPE c LENGTH 3,
            f TYPE c LENGTH 3,
          END OF line.
    DATA itab LIKE STANDARD TABLE OF line
                   WITH UNIQUE SORTED KEY key COMPONENTS b e d.
    DATA b\_tab LIKE RANGE OF line-b.
    LOOP AT itab INTO line USING KEY key
                 WHERE b = '...'.
    ENDLOOP.
    LOOP AT itab INTO line USING KEY key
                 WHERE a = '...' AND b IS INITIAL.
    ENDLOOP.
    LOOP AT itab INTO line USING KEY key
                 WHERE b = '...' AND e = '...'.
    ENDLOOP.
    LOOP AT itab INTO line USING KEY key
                 WHERE b = '...' AND d IS INITIAL AND e = '...'.
    ENDLOOP.
    LOOP AT itab INTO line USING KEY key
                 WHERE b = '...' AND d <> '...'.
    ENDLOOP.
    LOOP AT itab INTO line USING KEY key
                 WHERE e = '...'.                    "syntax error
    ENDLOOP.
    LOOP AT itab INTO line USING KEY key
                 WHERE b <> '...'.                   "syntax error
    ENDLOOP.
    LOOP AT itab INTO line USING KEY key
                 WHERE b IN b\_tab.                   "syntax error
    ENDLOOP.
    LOOP AT itab INTO line USING KEY key
                 WHERE b = '...'  AND NOT e = '...'. "syntax error
    ENDLOOP.
    LOOP AT itab INTO line USING KEY key             "syntax error
                 WHERE b = '...'  AND ( d = '...' OR e IS INITIAL ).
    ENDLOOP.
    

Requirements Made on the Operands   

The part of the logical expression that can be mapped to a key access must select the same lines as a statement [READ TABLE](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abapread_table.htm) or a corresponding [table expression](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abentable_expressions.htm) that specifies the corresponding components as keys.

-   When comparing incompatible data objects, the WHERE condition is subject to the same [comparison rules](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abenlogexp_rules.htm) for incompatible data types. Here, the data types involved determine which operand is converted to which comparison type.
-   If the additions [WITH TABLE KEY](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abapread_table_key.htm) and [WITH KEY](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abapread_table_free.htm) of the statement READ or [KEY](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abentable_exp_itab_line.htm) in a table expression are used, however, the content of the specified data objects is always converted to the data type of the columns before the comparison.

If this produces differing results, an optimization is not possible. Due to the complexity of the comparison rules, particularly for [elementary data types](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abenlogexp_rules_operands.htm), it is not a good idea to construct a set of rules detailing exactly when the comparison type matches the data type of the left operand. Generally speaking,

-   only fully compatible operands are optimizable,
-   in some cases, elementary operands with different data types can be optimized, if the value ranges or lengths are suitable. For example, a comparison of a column with the type of a floating point number with an operand of type integer or of a column of c with a similar operand, if its length is less than the length of the column.

For this reason, it is advisable to use only pairs of [compatible](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abencompatible_glosry.htm "Glossary Entry") operands in the WHERE condition. This guarantees that the differences in behavior of the WHERE condition and the specified key do not affect the result.

Example

The following example is largely similar to the example in the section WHERE log\_exp in [LOOP AT itab](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abaploop_at_itab_cond.htm). In that case, access takes place using the primary key and no optimization. Here, however, access takes place using a secondary table key and a syntax check warning is produced and an exception raised when the program is executed. The number of lines in the internal table determines whether the exception is raised.

DATA text\_short TYPE c LENGTH 2.
DATA text\_long  TYPE c LENGTH 4.
DATA itab LIKE TABLE OF text\_short
          WITH UNIQUE HASHED KEY key COMPONENTS table\_line.
itab = VALUE #( ( 'AA' )
                ( 'BB' )
                ( 'CC' )
                ( 'DD' )
                ( 'EE' )
                ( 'FF' )
                ( 'GG' )
                ( 'HH' )
                ( 'II' )
                ( 'JJ' )
                ( 'KK' )
                ( 'LL' )
                ( 'MM' ) ).
text\_short = 'AA'.
text\_long  = 'AAXX'.
LOOP AT itab INTO text\_short USING KEY key
             WHERE table\_line = text\_long.
ENDLOOP.
cl\_demo\_output=>write( |LOOP: { sy-subrc }| ).
"Statement
READ TABLE itab INTO text\_short WITH TABLE KEY key
                                COMPONENTS table\_line = text\_long.
cl\_demo\_output=>write( |READ: { sy-subrc }| ).
"Expression
TRY.
    text\_short = itab\[ KEY key COMPONENTS table\_line = text\_long \].
  catch CX\_SY\_ITAB\_LINE\_NOT\_FOUND.
    ...
ENDTRY.
cl\_demo\_output=>display( |Expression: { text\_short }| ).


---


## ABAP - Keyword Documentation / ABAP - Programming Language / Processing Internal Data / Internal Tables (itab) / itab - Processing Statements / LOOP AT itab / LOOP AT itab, Basic Form / LOOP AT itab, cond

**Files**: 4 | **Difficulty**: beginner

# ABAP - Keyword Documentation / ABAP - Programming Language / Processing Internal Data / Internal Tables (itab) / itab - Performance Notes

Included pages: 2


### abenitab_perfo.htm

---
title: "Table Sharing"
description: |
  When assignments are made between internal tables of the same type whose line type does not contain any table types, only the internal administration functions are passed to the table body(https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abentable_body_glosry.htm 'Glossary Entry') for pe
version: "7.57"
category: "data-structures"
type: "abap-reference"
sourceUrl: "https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abenitab_perfo.htm"
abapFile: "abenitab_perfo.htm"
keywords: ["select", "insert", "update", "delete", "loop", "do", "if", "case", "try", "data", "types", "internal-table", "abenitab", "perfo"]
---

* * *

AS ABAP Release 757, ©Copyright 2023 SAP SE. All rights reserved.

[ABAP - Keyword Documentation](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abenabap.htm) →  [ABAP - Programming Language](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abenabap_reference.htm) →  [Processing Internal Data](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abenabap_data_working.htm) →  [Internal Tables (itab)](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abenitab.htm) → 

 [![](Mail.gif?object=Mail.gif&sap-language=EN "Feedback mail for displayed topic") Mail Feedback](mailto:f1_help@sap.com?subject=Feedback on ABAP Documentation&body=Document: itab - Performance Notes, ABENITAB_PERFO, 757%0D%0A%0D%0AError:%0D%0A%0D%0A%0D%0A%0D%
0ASuggestion for improvement:)

itab - Performance Notes

-   [Table Sharing](#abenitab-perfo-1-------initial-memory-requirement---@ITOC@@ABENITAB_PERFO_2)
-   [Index Administration](#abenitab-perfo-3-------block-processing-of-table-lines---@ITOC@@ABENITAB_PERFO_4)
-   [Selective Data Transport](#abenitab-perfo-5-------using-secondary-keys---@ITOC@@ABENITAB_PERFO_6)
-   [Deleting Table Lines](#abenitab-perfo-7-------free-key-specified-for-sorted-tables-and-hashed-tables---@ITOC@@ABENITAB_PERFO_8)
-   [Sorting](#abenitab-perfo-9---table-sharing-----when-assignments-are-made-between-internal-tables-of-the-same-type-whose-line-type-does-not-contain-any-table-types--only-the-internal-administration-functions-are-passed-to-the--table-body--https---help-sap-com-doc-abapdocu-757-index-htm-7-57-en-us-abentable-body-glosry-htm--glossary-entry---for-performance-reasons---table-sharing--https---help-sap-com-doc-abapdocu-757-index-htm-7-57-en-us-abentable-sharing-glosry-htm--glossary-entry---is-revoked-only-when-write-access-to-one-of-the-tables-involved-is-initiated--the-actual-copy-process-then-takes-place---initial-memory-requirement-----internal-tables-are--dynamic-data-objects--https---help-sap-com-doc-abapdocu-757-index-htm-7-57-en-us-abendynamic-data-object-glosry-htm--glossary-entry---whose-area-in-the-memory-is-extended-block-by-block--the-size-of-the-first-block-in-the-memory-is-called--initial-memory-requirement--https---help-sap-com-doc-abapdocu-757-index-htm-7-57-en-us-abeninitial-mem-req-glosry-htm--glossary-entry---and-can-be-affected-in-the-declaration-of-an-internal-table-using-the-additions--initial-size--https---help-sap-com-doc-abapdocu-757-index-htm-7-57-en-us-abaptypes-itab-htm--and-the-obsolete--occurs--https---help-sap-com-doc-abapdocu-757-index-htm-7-57-en-us-abapdata-occurs-htm----it-is-usually-up-to-the-system-to-determine-the-size-of-the-first-block--initial-size-is-not-used-or-specified-with-the-value-0--in-this-case--a-suitable-block-size-is-chosen-the-first-time-lines-are-added-to-an-internal-table---specifying-a-concrete-value-greater-than-0-after-initial-size-is-only-practical-if-it-is-known-in-advance-how-many-entries-are-to-be-made-in-the-table--and-the-first-block-is-therefore-to-be-created-with-the-most-suitable-dimensions--this-can-be-particularly-important-for-internal-tables-that-are-components-of-other-internal-tables--and-which-only-contain-a-few-lines--no-more-than-around-5----to-avoid-excessive-memory-demands--the-system-ignores-values-that-produce-memory-demands-greater-than-the-constant-block-size---index-administration-----in-an--index-table--https---help-sap-com-doc-abapdocu-757-index-htm-7-57-en-us-abenindex-table-glosry-htm--glossary-entry----the-logical-order-of-the-table-entries-is-not-generally-consistent-with-the-physical-order-of-the-entries-in-the-main-memory--in-this-case--the-logical-order-is-no-longer-administrated-by-a-physical-index--but-by-a-logical-index--the-same-basically-applies-to-the--secondary-table-indexes--https---help-sap-com-doc-abapdocu-757-index-htm-7-57-en-us-abensecondary-table-index-glosry-htm--glossary-entry---used-to-manage--secondary--https---help-sap-com-doc-abapdocu-757-index-htm-7-57-en-us-abensecondary-table-key-glosry-htm--glossary-entry----sorted-keys--https---help-sap-com-doc-abapdocu-757-index-htm-7-57-en-us-abensorted-key-glosry-htm--glossary-entry-----use-of-the-logical-index-produces-additional-memory-requirements--and-index-maintenance-places-a-high-demand-on-resources--time-and-memory--when-inserting-or-deleting-table-lines--the-resource-requirements-increase-proportionally-with-the-number-of-remaining-lines-after-the-insertion-or-deletion-position--for-very-large-internal-tables--this-can-result-in-considerable-demands-on-performance-at-runtime---the-logical-index-is-only-created-when-it-is-needed--that-is--when-a-line-is-inserted-in-front-of-another-line--if-the-order-of-the-table-lines-is-changed--or-a-line-other-than-the-last-line-is-deleted--a-logical-index-is-not-required-if-an-internal-table-is-filled-using-only--append--https---help-sap-com-doc-abapdocu-757-index-htm-7-57-en-us-abapappend-htm---and-if-only-its-last-line-or-lines-is-are-deleted-using--delete--https---help-sap-com-doc-abapdocu-757-index-htm-7-57-en-us-abapdelete-itab-htm----hint--in-contrast-to-filling-a-table-with--insert--https---help-sap-com-doc-abapdocu-757-index-htm-7-57-en-us-abapinsert-itab-htm---appending-lines-with--append--https---help-sap-com-doc-abapdocu-757-index-htm-7-57-en-us-abapappend-htm--does-not-require-any-resources-for-index-maintenance--it-is-therefore-preferable-to-use-append-instead-of-insert-to-create-a--standard-table--https---help-sap-com-doc-abapdocu-757-index-htm-7-57-en-us-abenstandard-table-glosry-htm--glossary-entry----this-is-possible-if-the-order-of-the-entries-is-not-important--or-if-entries-can-be-appended-in-the-correct-order---block-processing-of-table-lines-----if-entire-line-areas-of-a-table-can-be-processed-at-once--this-should-not-be-done-line-by-line--but-using-block-operations--block-operations-are-possible-using-the-from-and-to-additions-of-the-statements--insert--https---help-sap-com-doc-abapdocu-757-index-htm-7-57-en-us-abapinsert-itab-htm----append--https---help-sap-com-doc-abapdocu-757-index-htm-7-57-en-us-abapappend-htm--and--delete--https---help-sap-com-doc-abapdocu-757-index-htm-7-57-en-us-abapdelete-itab-htm---block-operations-are-also-more-efficient-than-single-record-operations-when-reading-from-or-modifying-database-tables-with--abap-sql--https---help-sap-com-doc-abapdocu-757-index-htm-7-57-en-us-abenabap-sql-glosry-htm--glossary-entry---statements-with-the-additions-from---appending---to-table---selective-data-transport-----if--when-reading-table-lines-using--read-table--https---help-sap-com-doc-abapdocu-757-index-htm-7-57-en-us-abapread-table-htm--or--loop-at--https---help-sap-com-doc-abapdocu-757-index-htm-7-57-en-us-abaploop-at-itab-htm---a-work-area-is-used-or-table-lines-can-be-changed-using--modify--https---help-sap-com-doc-abapdocu-757-index-htm-7-57-en-us-abapmodify-itab-htm--instead-of-direct-access--the-transporting-addition-can-be-used-to-prevent-unnecessary-assignments-of-table-components-to-the-work-area--this-can-lead-to-a-noticeable-improvement-in-performance--particularly-if-table-like-components-are-excluded-from-processing---using-secondary-keys-----the--use-of-secondary-table-keys--https---help-sap-com-doc-abapdocu-757-index-htm-7-57-en-us-abenitab-key-secondary-usage-htm--should-be-planned-and-executed-carefully-and-sparingly--the-time-gained-when-accessing-individual-lines-should-not-be-lost-again-by-the-increased-memory-and-time-requirements-for-managing-the-secondary-keys--secondary-keys-are-generally-recommended-for-internal-tables-that-are-filled-once-and-rarely-changed-during-program-execution---example--the-program-demo--secondary--keys-demonstrates-how-a-secondary-table-key-is-specified-and-the-resulting-performance-gain---deleting-table-lines-----when-lines-are-deleted-from-an-internal-table--administration-costs-are-incurred-for-all-table-keys-and-table-indexes--the-primary-key-and-all-unique-secondary-keys-are-updated-directly--but-non-unique-secondary-keys-are-updated-only-if-the-line-to-be-deleted-is-included-in-the-updated-part-of-an-associated-index---lazy-update--https---help-sap-com-doc-abapdocu-757-index-htm-7-57-en-us-abenlazy-update-glosry-htm--glossary-entry------it-should-be-noted-that--particularly-for-standard-tables--the-mean-runtime-of-the-statement--delete--https---help-sap-com-doc-abapdocu-757-index-htm-7-57-en-us-abapdelete-itab-htm--always-depends-linearly-on-the-number-of-table-lines--even-when-secondary-keys-are-specified-using--with-table-key--https---help-sap-com-doc-abapdocu-757-index-htm-7-57-en-us-abapdelete-itab-key-htm--or--using-key--https---help-sap-com-doc-abapdocu-757-index-htm-7-57-en-us-abapdelete-itab-key-htm---this-is-because-a-linear-search-is-required-to-update-the-primary-index--even-though-the-line-to-be-deleted-can-itself-be-found-quickly---deleting-lines-in-internal-tables-using--delete--https---help-sap-com-doc-abapdocu-757-index-htm-7-57-en-us-abapdelete-itab-htm--does-not-usually-release-any-memory-in-the-internal-table--statements-such-as--clear--https---help-sap-com-doc-abapdocu-757-index-htm-7-57-en-us-abapclear-htm--or--free--https---help-sap-com-doc-abapdocu-757-index-htm-7-57-en-us-abapfree-dataobject-htm--must-be-used-to-release-memory-in-internal-tables---free-key-specified-for-sorted-tables-and-hashed-tables-----when-using-the--read--https---help-sap-com-doc-abapdocu-757-index-htm-7-57-en-us-abapread-table-htm--statement-with-a-specified-free-key-of-the-form--with-key------https---help-sap-com-doc-abapdocu-757-index-htm-7-57-en-us-abapread-table-free-htm---the-search-is-optimized-in-all-cases-where-this-is-possible--that-is-------in--sorted-tables--https---help-sap-com-doc-abapdocu-757-index-htm-7-57-en-us-abensorted-table-glosry-htm--glossary-entry----if-any-initial-section-of-the--table-key--https---help-sap-com-doc-abapdocu-757-index-htm-7-57-en-us-abentable-key-glosry-htm--glossary-entry---or-the-complete-table-key-is-covered-by-the-specified-key------in--hashed-tables--https---help-sap-com-doc-abapdocu-757-index-htm-7-57-en-us-abenhashed-table-glosry-htm--glossary-entry----if-the-complete-table-key-is-covered---if-part-of-a-free-key-meets-these-conditions--this-partial-key-is-first-used-to-search-for-an-entry--in-sorted-tables--this-is-done-using-a-binary-search-with-a-logarithmic-consumption-of-resources--and-in-hashed-tables-using-a-hash-algorithm--that-is--with-constant-resource-consumption--if-an-entry-is-found--the-system-checks-whether-the-rest-of-the-key-conditions-are-also-met--this-means-that-over-specific-keys-in-particular-are-optimized---hint--see-also--optimization-of-the-where-condition--https---help-sap-com-doc-abapdocu-757-index-htm-7-57-en-us-abenitab-where-optimization-htm----sorting-----for-textual-sorting-of-an-internal-table-in-accordance-with-the-current--text-environment--https---help-sap-com-doc-abapdocu-757-index-htm-7-57-en-us-abentext-environment-glosry-htm--glossary-entry----it-can-be-more-efficient-to-use-the-statement--convert-text-into-sortable-code--https---help-sap-com-doc-abapdocu-757-index-htm-7-57-en-us-abapconvert-text-htm--instead-of--sort-as-text--https---help-sap-com-doc-abapdocu-757-index-htm-7-57-en-us-abapsort-itab-htm--in-the-following-cases-------if-an-internal-table-is-sorted-by-locale-and-then-searched-binarily-using-the-statement-read-table-or-using-a--table-expression--https---help-sap-com-doc-abapdocu-757-index-htm-7-57-en-us-abentable-expressions-htm-------an-internal-table-must-be-sorted-more-than-once------indexes-for-database-tables-should-be-structured-in-accordance-with-a-locale---continue--itab---optimizing-the-where-condition--https---help-sap-com-doc-abapdocu-757-index-htm-7-57-en-us-abenitab-where-optimization-htm--------abenitab-where-optimization-htm------title---hint--description------if-the-lines-selected-using-where-are-modified-or-deleted-using-modify-https---help-sap-com-doc-abapdocu-757-index-htm-7-57-en-us-abapmodify-itab-htm--or-delete-https---help-sap-com-doc-abapdocu-757-index-htm-7-57-en-us-abapdelete-itab-htm--and-not-just-read-using-loop-at-https---help-sap-com--version---7-57--category---general--type---abap-reference--sourceurl---https---help-sap-com-doc-abapdocu-757-index-htm-7-57-en-us-abenitab-where-optimization-htm--abapfile---abenitab-where-optimization-htm--keywords----select----update----delete----loop----do----if----case----try----catch----data----types----internal-table----abenitab----where----optimization---------------as-abap-release-757---copyright-2023-sap-se--all-rights-reserved----abap---keyword-documentation--https---help-sap-com-doc-abapdocu-757-index-htm-7-57-en-us-abenabap-htm------abap---programming-language--https---help-sap-com-doc-abapdocu-757-index-htm-7-57-en-us-abenabap-reference-htm------processing-internal-data--https---help-sap-com-doc-abapdocu-757-index-htm-7-57-en-us-abenabap-data-working-htm------internal-tables--itab---https---help-sap-com-doc-abapdocu-757-index-htm-7-57-en-us-abenitab-htm------itab---performance-notes--https---help-sap-com-doc-abapdocu-757-index-htm-7-57-en-us-abenitab-perfo-htm------------mail-gif-object-mail-gif-sap-language-en--feedback-mail-for-displayed-topic---mail-feedback--mailto-f1-helpsap.com?subject=Feedback on ABAP Documentation&body=Document: itab - Optimizing the WHERE Condition, ABENITAB_WHERE_OPTIMIZATION, 757%0D%0A%0D%0AEr
ror:%0D%0A%0D%0A%0D%0A%0D%0ASuggestion for improvement:)

itab - Optimizing the WHERE Condition

The statements [LOOP AT](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abaploop_at_itab.htm), [DELETE](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abapdelete_itab.htm), and [MODIFY](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abapmodify_itab.htm) can be specified together with a WHERE condition that selects specific lines of the internal table. Searches in a [standard table](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abenstandard_table_glosry.htm "Glossary Entry") using the [primary table key](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abenprimary_table_key_glosry.htm "Glossary Entry") are always linear and cannot be optimized. Searches using a [sorted key](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abensorted_key_glosry.htm "Glossary Entry") or a [hash key](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abenhash_key_glosry.htm "Glossary Entry"), however, can be optimized in certain circumstances. These keys are used for:

-   accessing a [sorted table](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abensorted_table_glosry.htm "Glossary Entry") using its primary key.
-   accessing a [hashed table](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abenhashed_table_glosry.htm "Glossary Entry") using its primary key.
-   accessing a table of any table type using a [secondary table key](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abensecondary_table_key_glosry.htm "Glossary Entry") specified by USING KEY.

The optimization takes place by mapping all [relational expressions](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abenrelational_expression_glosry.htm "Glossary Entry") or a group of the relational expressions in the WHERE condition to a specified key. This specified key performs a corresponding optimized key access (binary search or hash algorithm as in the statement [READ TABLE](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abapread_table.htm) or a [table expression](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abentable_expressions.htm)), to find one or more lines. The found line or lines are then checked using those remaining relational expressions from the WHERE condition that were not mapped to the specified key.

Prerequisites for the optimization are therefore:

-   The relational expressions of the WHERE condition can be transformed to a specified key.
-   The corresponding key access returns the same results as the evaluation of this part of the logical expression would. This is guaranteed only for compatible data types, since in the case of incompatible data types:
    -   the content of the specified data objects is converted to the data type of the columns before the evaluation in the case of key accesses.
    -   The [comparison rules](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abenlogexp_rules.htm) for incompatible data types apply when evaluating a [comparison expression](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abencomparison_expression_glosry.htm "Glossary Entry"). Here, all the data types involved play a part in determining which operand is converted into which comparison type.

If there are no or insufficient relational expressions to meet both of these prerequisites, no optimization is possible and the behavior is as follows:

-   If a sorted table or a hashed table is accessed using the primary table key, all lines of the internal table are checked as in a standard table.
-   If the table is read using a secondary table key, that is, if said key is specified after USING KEY, a syntax error or syntax check warning, or an exception is raised. Access using a secondary table key must always be executed in an optimized way.

The following sections describe exactly when an access can be optimized.

-   [Prerequisites for the Optimization of Hash Keys](#abenitab-where-optimization-1-------prerequisites-for-the-optimization-of-sorted-keys---@ITOC@@ABENITAB_WHERE_OPTIMIZATION_2)
-   [Requirements Made on the Operands](#@@ITOC@@ABENITAB_WHERE_OPTIMIZATION_3)

Hint

If the lines selected using WHERE are modified or deleted using [MODIFY](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abapmodify_itab.htm) or [DELETE](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abapdelete_itab.htm) and not just read using [LOOP AT](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abaploop_at_itab.htm), further update costs are incurred in addition to the search for the lines. When deleting lines from standard tables, it should be noted that searches using a secondary key optimize the selection of lines to be deleted, but not the update required for the primary key, which is usually performed using a linear search.

Prerequisites for the Optimization of Hash Keys   

In the case of [hash key](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abenhash_key_glosry.htm "Glossary Entry") accesses, there must be exactly one relational expression combined using AND for each component of the key. This expression is either

-   a [comparison expression](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abencomparison_expression_glosry.htm "Glossary Entry") with the comparison operator \= (or EQ), whose operands meet the requirements above or
-   a [predicate expression](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abenpredicate_expression_glosry.htm "Glossary Entry") IS INITIAL without the addition NOT.

These relational expressions construct the part of the logical expression used for the key access. This part must not contain duplicate key components. The remainder of the logical expression can contain any number of relational expressions combined using AND. Optimization may not be possible, however, if the Boolean operators NOT or OR are used. Key components may be used in the relational expressions not used for the key access.

Hint

Relational expressions other than comparisons using \= (or EQ) or predicate expressions IS INITIAL are not part of the key access. This applies particularly to the tabular comparison operator [IN range\_tab](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abenlogexp_select_option.htm), even if it can be traced back to optimizable comparisons.

Example

In the following example, the first two WHERE conditions can be optimized as key accesses with the secondary table key key. This is because:

1.  The optimizable conditions for b, d, and e cover the entire key.
2.  The optimizable conditions b, d, and e cover the entire key and a is a condition on a non-key column that is not involved in the part of the WHERE condition required for the optimization.
3.  The optimizable conditions b, d, and e cover the entire key and the other two conditions on the key columns b and d are not optimizable and are hence not involved in the part of the WHERE condition required for the optimization.

The next six WHERE conditions cannot be optimized and produce syntax errors. This is because:

1.  The key component d is not specified.
2.  A key component is combined using OR instead of AND.
3.  Two non-optimizable comparison operators are used.
4.  An operand of type i is used in the comparison b of type c, which does not meet the requirements made on the operands.
5.  The Boolean operator NOT is used in front of a key component.
6.  A further comparison is combined using OR.
7.  A further comparison is negated using NOT.
    
    DATA: BEGIN OF line,
            a TYPE c LENGTH 3,
            b TYPE c LENGTH 3,
            c TYPE c LENGTH 3,
            d TYPE c LENGTH 3,
            e TYPE c LENGTH 3,
            f TYPE c LENGTH 3,
          END OF line.
    DATA itab LIKE STANDARD TABLE OF line
                   WITH UNIQUE HASHED KEY key COMPONENTS b e d.
    DATA b\_tab LIKE RANGE OF line-b.
    LOOP AT itab INTO line USING KEY key
         WHERE b = '...' AND d = '...' AND e IS INITIAL.
    ENDLOOP.
    LOOP AT itab INTO line USING KEY key
         WHERE a = '...' AND b = '...' AND d = '...' AND e IS INITIAL.
    ENDLOOP.
    LOOP AT itab INTO line USING KEY key
         WHERE  b = '...' AND d = '...' AND e IS INITIAL AND
                b IN b\_tab AND d <> '...'.
    ENDLOOP.
    LOOP AT itab INTO line USING KEY key
         WHERE b = '...' AND e IS INITIAL.                     "syntax error
    ENDLOOP.
    LOOP AT itab INTO line USING KEY key
         WHERE b = '...' OR d = '...' AND e IS INITIAL OR      "syntax error
    ENDLOOP.
    LOOP AT itab INTO line USING KEY key
         WHERE b = '...' AND d <> '...' AND e IS NOT INITIAL.  "syntax error
    ENDLOOP.
    LOOP AT itab INTO line USING KEY key
         WHERE b = 333 AND d = '...' AND e IS INITIAL.         "syntax error
    ENDLOOP.
    LOOP AT itab INTO line USING KEY key
         WHERE b = '...'  AND NOT d = '...' AND e IS INITIAL.  "syntax error
    ENDLOOP.
    LOOP AT itab INTO line USING KEY key
         WHERE b = '...' AND d = '...' AND e IS INITIAL OR     "syntax error
               a = '...'.
    ENDLOOP.
    LOOP AT itab INTO line USING KEY key
         WHERE b = '...' AND d = '...' AND e IS INITIAL AND    "syntax error
               NOT a = '...'.
    ENDLOOP.
    

Prerequisites for the Optimization of Sorted Keys   

In the case of reads using a [sorted key](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abensorted_key_glosry.htm "Glossary Entry"), the same applies as to a hash key. The only difference is that only an initial section of the key consisting of at least one component needs to be covered rather than the entire key.

The internal table is accessed in part sequentially. The starting point for the processing of the table is determined by a binary search using the subconditions that cover the table key completely or partially. From the starting point onwards, the table is only processed for as long as these subconditions remain fulfilled.

Example

In the following example, the first five WHERE conditions can be optimized as key accesses with the secondary table key key. This is because:

1.  b is an initial part of the key.
2.  b is an initial part of the key and a is an independent condition.
3.  b and e are an initial part of the key.
4.  b, e, and d are an initial part of the key and the order in the WHERE condition is ignored.
5.  b is an initial part of the key and in this case, d is an independent condition, even though it is part of the key.

The next five WHERE conditions cannot be optimized and produce syntax errors. This is because:

1.  e is not an initial part of the key.
2.  No inequality comparison takes place.
3.  A comparison in a ranges table is specified.
4.  The Boolean operator NOT is used.
5.  An additional OR relationship is used.
    
    DATA: BEGIN OF line,
            a TYPE c LENGTH 3,
            b TYPE c LENGTH 3,
            c TYPE c LENGTH 3,
            d TYPE c LENGTH 3,
            e TYPE c LENGTH 3,
            f TYPE c LENGTH 3,
          END OF line.
    DATA itab LIKE STANDARD TABLE OF line
                   WITH UNIQUE SORTED KEY key COMPONENTS b e d.
    DATA b\_tab LIKE RANGE OF line-b.
    LOOP AT itab INTO line USING KEY key
                 WHERE b = '...'.
    ENDLOOP.
    LOOP AT itab INTO line USING KEY key
                 WHERE a = '...' AND b IS INITIAL.
    ENDLOOP.
    LOOP AT itab INTO line USING KEY key
                 WHERE b = '...' AND e = '...'.
    ENDLOOP.
    LOOP AT itab INTO line USING KEY key
                 WHERE b = '...' AND d IS INITIAL AND e = '...'.
    ENDLOOP.
    LOOP AT itab INTO line USING KEY key
                 WHERE b = '...' AND d <> '...'.
    ENDLOOP.
    LOOP AT itab INTO line USING KEY key
                 WHERE e = '...'.                    "syntax error
    ENDLOOP.
    LOOP AT itab INTO line USING KEY key
                 WHERE b <> '...'.                   "syntax error
    ENDLOOP.
    LOOP AT itab INTO line USING KEY key
                 WHERE b IN b\_tab.                   "syntax error
    ENDLOOP.
    LOOP AT itab INTO line USING KEY key
                 WHERE b = '...'  AND NOT e = '...'. "syntax error
    ENDLOOP.
    LOOP AT itab INTO line USING KEY key             "syntax error
                 WHERE b = '...'  AND ( d = '...' OR e IS INITIAL ).
    ENDLOOP.
    

Requirements Made on the Operands   

The part of the logical expression that can be mapped to a key access must select the same lines as a statement [READ TABLE](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abapread_table.htm) or a corresponding [table expression](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abentable_expressions.htm) that specifies the corresponding components as keys.

-   When comparing incompatible data objects, the WHERE condition is subject to the same [comparison rules](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abenlogexp_rules.htm) for incompatible data types. Here, the data types involved determine which operand is converted to which comparison type.
-   If the additions [WITH TABLE KEY](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abapread_table_key.htm) and [WITH KEY](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abapread_table_free.htm) of the statement READ or [KEY](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abentable_exp_itab_line.htm) in a table expression are used, however, the content of the specified data objects is always converted to the data type of the columns before the comparison.

If this produces differing results, an optimization is not possible. Due to the complexity of the comparison rules, particularly for [elementary data types](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abenlogexp_rules_operands.htm), it is not a good idea to construct a set of rules detailing exactly when the comparison type matches the data type of the left operand. Generally speaking,

-   only fully compatible operands are optimizable,
-   in some cases, elementary operands with different data types can be optimized, if the value ranges or lengths are suitable. For example, a comparison of a column with the type of a floating point number with an operand of type integer or of a column of c with a similar operand, if its length is less than the length of the column.

For this reason, it is advisable to use only pairs of [compatible](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abencompatible_glosry.htm "Glossary Entry") operands in the WHERE condition. This guarantees that the differences in behavior of the WHERE condition and the specified key do not affect the result.

Example

The following example is largely similar to the example in the section WHERE log\_exp in [LOOP AT itab](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abaploop_at_itab_cond.htm). In that case, access takes place using the primary key and no optimization. Here, however, access takes place using a secondary table key and a syntax check warning is produced and an exception raised when the program is executed. The number of lines in the internal table determines whether the exception is raised.

DATA text\_short TYPE c LENGTH 2.
DATA text\_long  TYPE c LENGTH 4.
DATA itab LIKE TABLE OF text\_short
          WITH UNIQUE HASHED KEY key COMPONENTS table\_line.
itab = VALUE #( ( 'AA' )
                ( 'BB' )
                ( 'CC' )
                ( 'DD' )
                ( 'EE' )
                ( 'FF' )
                ( 'GG' )
                ( 'HH' )
                ( 'II' )
                ( 'JJ' )
                ( 'KK' )
                ( 'LL' )
                ( 'MM' ) ).
text\_short = 'AA'.
text\_long  = 'AAXX'.
LOOP AT itab INTO text\_short USING KEY key
             WHERE table\_line = text\_long.
ENDLOOP.
cl\_demo\_output=>write( |LOOP: { sy-subrc }| ).
"Statement
READ TABLE itab INTO text\_short WITH TABLE KEY key
                                COMPONENTS table\_line = text\_long.
cl\_demo\_output=>write( |READ: { sy-subrc }| ).
"Expression
TRY.
    text\_short = itab\[ KEY key COMPONENTS table\_line = text\_long \].
  catch CX\_SY\_ITAB\_LINE\_NOT\_FOUND.
    ...
ENDTRY.
cl\_demo\_output=>display( |Expression: { text\_short }| ).


---


## ABAP - Keyword Documentation / ABAP - Programming Language / Processing Internal Data / Internal Tables (itab) / itab - Processing Statements / LOOP AT itab / LOOP AT itab, Basic Form / AT, Group Level Processing

**Files**: 8 | **Difficulty**: beginner

# ABAP - Keyword Documentation / ABAP - Programming Language / Processing Internal Data / Internal Tables (itab) / itab - Performance Notes

Included pages: 2


### abenitab_perfo.htm

---
title: "Table Sharing"
description: |
  When assignments are made between internal tables of the same type whose line type does not contain any table types, only the internal administration functions are passed to the table body(https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abentable_body_glosry.htm 'Glossary Entry') for pe
version: "7.57"
category: "data-structures"
type: "abap-reference"
sourceUrl: "https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abenitab_perfo.htm"
abapFile: "abenitab_perfo.htm"
keywords: ["select", "insert", "update", "delete", "loop", "do", "if", "case", "try", "data", "types", "internal-table", "abenitab", "perfo"]
---

* * *

AS ABAP Release 757, ©Copyright 2023 SAP SE. All rights reserved.

[ABAP - Keyword Documentation](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abenabap.htm) →  [ABAP - Programming Language](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abenabap_reference.htm) →  [Processing Internal Data](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abenabap_data_working.htm) →  [Internal Tables (itab)](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abenitab.htm) → 

 [![](Mail.gif?object=Mail.gif&sap-language=EN "Feedback mail for displayed topic") Mail Feedback](mailto:f1_help@sap.com?subject=Feedback on ABAP Documentation&body=Document: itab - Performance Notes, ABENITAB_PERFO, 757%0D%0A%0D%0AError:%0D%0A%0D%0A%0D%0A%0D%
0ASuggestion for improvement:)

itab - Performance Notes

-   [Table Sharing](#abenitab-perfo-1-------initial-memory-requirement---@ITOC@@ABENITAB_PERFO_2)
-   [Index Administration](#abenitab-perfo-3-------block-processing-of-table-lines---@ITOC@@ABENITAB_PERFO_4)
-   [Selective Data Transport](#abenitab-perfo-5-------using-secondary-keys---@ITOC@@ABENITAB_PERFO_6)
-   [Deleting Table Lines](#abenitab-perfo-7-------free-key-specified-for-sorted-tables-and-hashed-tables---@ITOC@@ABENITAB_PERFO_8)
-   [Sorting](#abenitab-perfo-9---table-sharing-----when-assignments-are-made-between-internal-tables-of-the-same-type-whose-line-type-does-not-contain-any-table-types--only-the-internal-administration-functions-are-passed-to-the--table-body--https---help-sap-com-doc-abapdocu-757-index-htm-7-57-en-us-abentable-body-glosry-htm--glossary-entry---for-performance-reasons---table-sharing--https---help-sap-com-doc-abapdocu-757-index-htm-7-57-en-us-abentable-sharing-glosry-htm--glossary-entry---is-revoked-only-when-write-access-to-one-of-the-tables-involved-is-initiated--the-actual-copy-process-then-takes-place---initial-memory-requirement-----internal-tables-are--dynamic-data-objects--https---help-sap-com-doc-abapdocu-757-index-htm-7-57-en-us-abendynamic-data-object-glosry-htm--glossary-entry---whose-area-in-the-memory-is-extended-block-by-block--the-size-of-the-first-block-in-the-memory-is-called--initial-memory-requirement--https---help-sap-com-doc-abapdocu-757-index-htm-7-57-en-us-abeninitial-mem-req-glosry-htm--glossary-entry---and-can-be-affected-in-the-declaration-of-an-internal-table-using-the-additions--initial-size--https---help-sap-com-doc-abapdocu-757-index-htm-7-57-en-us-abaptypes-itab-htm--and-the-obsolete--occurs--https---help-sap-com-doc-abapdocu-757-index-htm-7-57-en-us-abapdata-occurs-htm----it-is-usually-up-to-the-system-to-determine-the-size-of-the-first-block--initial-size-is-not-used-or-specified-with-the-value-0--in-this-case--a-suitable-block-size-is-chosen-the-first-time-lines-are-added-to-an-internal-table---specifying-a-concrete-value-greater-than-0-after-initial-size-is-only-practical-if-it-is-known-in-advance-how-many-entries-are-to-be-made-in-the-table--and-the-first-block-is-therefore-to-be-created-with-the-most-suitable-dimensions--this-can-be-particularly-important-for-internal-tables-that-are-components-of-other-internal-tables--and-which-only-contain-a-few-lines--no-more-than-around-5----to-avoid-excessive-memory-demands--the-system-ignores-values-that-produce-memory-demands-greater-than-the-constant-block-size---index-administration-----in-an--index-table--https---help-sap-com-doc-abapdocu-757-index-htm-7-57-en-us-abenindex-table-glosry-htm--glossary-entry----the-logical-order-of-the-table-entries-is-not-generally-consistent-with-the-physical-order-of-the-entries-in-the-main-memory--in-this-case--the-logical-order-is-no-longer-administrated-by-a-physical-index--but-by-a-logical-index--the-same-basically-applies-to-the--secondary-table-indexes--https---help-sap-com-doc-abapdocu-757-index-htm-7-57-en-us-abensecondary-table-index-glosry-htm--glossary-entry---used-to-manage--secondary--https---help-sap-com-doc-abapdocu-757-index-htm-7-57-en-us-abensecondary-table-key-glosry-htm--glossary-entry----sorted-keys--https---help-sap-com-doc-abapdocu-757-index-htm-7-57-en-us-abensorted-key-glosry-htm--glossary-entry-----use-of-the-logical-index-produces-additional-memory-requirements--and-index-maintenance-places-a-high-demand-on-resources--time-and-memory--when-inserting-or-deleting-table-lines--the-resource-requirements-increase-proportionally-with-the-number-of-remaining-lines-after-the-insertion-or-deletion-position--for-very-large-internal-tables--this-can-result-in-considerable-demands-on-performance-at-runtime---the-logical-index-is-only-created-when-it-is-needed--that-is--when-a-line-is-inserted-in-front-of-another-line--if-the-order-of-the-table-lines-is-changed--or-a-line-other-than-the-last-line-is-deleted--a-logical-index-is-not-required-if-an-internal-table-is-filled-using-only--append--https---help-sap-com-doc-abapdocu-757-index-htm-7-57-en-us-abapappend-htm---and-if-only-its-last-line-or-lines-is-are-deleted-using--delete--https---help-sap-com-doc-abapdocu-757-index-htm-7-57-en-us-abapdelete-itab-htm----hint--in-contrast-to-filling-a-table-with--insert--https---help-sap-com-doc-abapdocu-757-index-htm-7-57-en-us-abapinsert-itab-htm---appending-lines-with--append--https---help-sap-com-doc-abapdocu-757-index-htm-7-57-en-us-abapappend-htm--does-not-require-any-resources-for-index-maintenance--it-is-therefore-preferable-to-use-append-instead-of-insert-to-create-a--standard-table--https---help-sap-com-doc-abapdocu-757-index-htm-7-57-en-us-abenstandard-table-glosry-htm--glossary-entry----this-is-possible-if-the-order-of-the-entries-is-not-important--or-if-entries-can-be-appended-in-the-correct-order---block-processing-of-table-lines-----if-entire-line-areas-of-a-table-can-be-processed-at-once--this-should-not-be-done-line-by-line--but-using-block-operations--block-operations-are-possible-using-the-from-and-to-additions-of-the-statements--insert--https---help-sap-com-doc-abapdocu-757-index-htm-7-57-en-us-abapinsert-itab-htm----append--https---help-sap-com-doc-abapdocu-757-index-htm-7-57-en-us-abapappend-htm--and--delete--https---help-sap-com-doc-abapdocu-757-index-htm-7-57-en-us-abapdelete-itab-htm---block-operations-are-also-more-efficient-than-single-record-operations-when-reading-from-or-modifying-database-tables-with--abap-sql--https---help-sap-com-doc-abapdocu-757-index-htm-7-57-en-us-abenabap-sql-glosry-htm--glossary-entry---statements-with-the-additions-from---appending---to-table---selective-data-transport-----if--when-reading-table-lines-using--read-table--https---help-sap-com-doc-abapdocu-757-index-htm-7-57-en-us-abapread-table-htm--or--loop-at--https---help-sap-com-doc-abapdocu-757-index-htm-7-57-en-us-abaploop-at-itab-htm---a-work-area-is-used-or-table-lines-can-be-changed-using--modify--https---help-sap-com-doc-abapdocu-757-index-htm-7-57-en-us-abapmodify-itab-htm--instead-of-direct-access--the-transporting-addition-can-be-used-to-prevent-unnecessary-assignments-of-table-components-to-the-work-area--this-can-lead-to-a-noticeable-improvement-in-performance--particularly-if-table-like-components-are-excluded-from-processing---using-secondary-keys-----the--use-of-secondary-table-keys--https---help-sap-com-doc-abapdocu-757-index-htm-7-57-en-us-abenitab-key-secondary-usage-htm--should-be-planned-and-executed-carefully-and-sparingly--the-time-gained-when-accessing-individual-lines-should-not-be-lost-again-by-the-increased-memory-and-time-requirements-for-managing-the-secondary-keys--secondary-keys-are-generally-recommended-for-internal-tables-that-are-filled-once-and-rarely-changed-during-program-execution---example--the-program-demo--secondary--keys-demonstrates-how-a-secondary-table-key-is-specified-and-the-resulting-performance-gain---deleting-table-lines-----when-lines-are-deleted-from-an-internal-table--administration-costs-are-incurred-for-all-table-keys-and-table-indexes--the-primary-key-and-all-unique-secondary-keys-are-updated-directly--but-non-unique-secondary-keys-are-updated-only-if-the-line-to-be-deleted-is-included-in-the-updated-part-of-an-associated-index---lazy-update--https---help-sap-com-doc-abapdocu-757-index-htm-7-57-en-us-abenlazy-update-glosry-htm--glossary-entry------it-should-be-noted-that--particularly-for-standard-tables--the-mean-runtime-of-the-statement--delete--https---help-sap-com-doc-abapdocu-757-index-htm-7-57-en-us-abapdelete-itab-htm--always-depends-linearly-on-the-number-of-table-lines--even-when-secondary-keys-are-specified-using--with-table-key--https---help-sap-com-doc-abapdocu-757-index-htm-7-57-en-us-abapdelete-itab-key-htm--or--using-key--https---help-sap-com-doc-abapdocu-757-index-htm-7-57-en-us-abapdelete-itab-key-htm---this-is-because-a-linear-search-is-required-to-update-the-primary-index--even-though-the-line-to-be-deleted-can-itself-be-found-quickly---deleting-lines-in-internal-tables-using--delete--https---help-sap-com-doc-abapdocu-757-index-htm-7-57-en-us-abapdelete-itab-htm--does-not-usually-release-any-memory-in-the-internal-table--statements-such-as--clear--https---help-sap-com-doc-abapdocu-757-index-htm-7-57-en-us-abapclear-htm--or--free--https---help-sap-com-doc-abapdocu-757-index-htm-7-57-en-us-abapfree-dataobject-htm--must-be-used-to-release-memory-in-internal-tables---free-key-specified-for-sorted-tables-and-hashed-tables-----when-using-the--read--https---help-sap-com-doc-abapdocu-757-index-htm-7-57-en-us-abapread-table-htm--statement-with-a-specified-free-key-of-the-form--with-key------https---help-sap-com-doc-abapdocu-757-index-htm-7-57-en-us-abapread-table-free-htm---the-search-is-optimized-in-all-cases-where-this-is-possible--that-is-------in--sorted-tables--https---help-sap-com-doc-abapdocu-757-index-htm-7-57-en-us-abensorted-table-glosry-htm--glossary-entry----if-any-initial-section-of-the--table-key--https---help-sap-com-doc-abapdocu-757-index-htm-7-57-en-us-abentable-key-glosry-htm--glossary-entry---or-the-complete-table-key-is-covered-by-the-specified-key------in--hashed-tables--https---help-sap-com-doc-abapdocu-757-index-htm-7-57-en-us-abenhashed-table-glosry-htm--glossary-entry----if-the-complete-table-key-is-covered---if-part-of-a-free-key-meets-these-conditions--this-partial-key-is-first-used-to-search-for-an-entry--in-sorted-tables--this-is-done-using-a-binary-search-with-a-logarithmic-consumption-of-resources--and-in-hashed-tables-using-a-hash-algorithm--that-is--with-constant-resource-consumption--if-an-entry-is-found--the-system-checks-whether-the-rest-of-the-key-conditions-are-also-met--this-means-that-over-specific-keys-in-particular-are-optimized---hint--see-also--optimization-of-the-where-condition--https---help-sap-com-doc-abapdocu-757-index-htm-7-57-en-us-abenitab-where-optimization-htm----sorting-----for-textual-sorting-of-an-internal-table-in-accordance-with-the-current--text-environment--https---help-sap-com-doc-abapdocu-757-index-htm-7-57-en-us-abentext-environment-glosry-htm--glossary-entry----it-can-be-more-efficient-to-use-the-statement--convert-text-into-sortable-code--https---help-sap-com-doc-abapdocu-757-index-htm-7-57-en-us-abapconvert-text-htm--instead-of--sort-as-text--https---help-sap-com-doc-abapdocu-757-index-htm-7-57-en-us-abapsort-itab-htm--in-the-following-cases-------if-an-internal-table-is-sorted-by-locale-and-then-searched-binarily-using-the-statement-read-table-or-using-a--table-expression--https---help-sap-com-doc-abapdocu-757-index-htm-7-57-en-us-abentable-expressions-htm-------an-internal-table-must-be-sorted-more-than-once------indexes-for-database-tables-should-be-structured-in-accordance-with-a-locale---continue--itab---optimizing-the-where-condition--https---help-sap-com-doc-abapdocu-757-index-htm-7-57-en-us-abenitab-where-optimization-htm--------abenitab-where-optimization-htm------title---hint--description------if-the-lines-selected-using-where-are-modified-or-deleted-using-modify-https---help-sap-com-doc-abapdocu-757-index-htm-7-57-en-us-abapmodify-itab-htm--or-delete-https---help-sap-com-doc-abapdocu-757-index-htm-7-57-en-us-abapdelete-itab-htm--and-not-just-read-using-loop-at-https---help-sap-com--version---7-57--category---general--type---abap-reference--sourceurl---https---help-sap-com-doc-abapdocu-757-index-htm-7-57-en-us-abenitab-where-optimization-htm--abapfile---abenitab-where-optimization-htm--keywords----select----update----delete----loop----do----if----case----try----catch----data----types----internal-table----abenitab----where----optimization---------------as-abap-release-757---copyright-2023-sap-se--all-rights-reserved----abap---keyword-documentation--https---help-sap-com-doc-abapdocu-757-index-htm-7-57-en-us-abenabap-htm------abap---programming-language--https---help-sap-com-doc-abapdocu-757-index-htm-7-57-en-us-abenabap-reference-htm------processing-internal-data--https---help-sap-com-doc-abapdocu-757-index-htm-7-57-en-us-abenabap-data-working-htm------internal-tables--itab---https---help-sap-com-doc-abapdocu-757-index-htm-7-57-en-us-abenitab-htm------itab---performance-notes--https---help-sap-com-doc-abapdocu-757-index-htm-7-57-en-us-abenitab-perfo-htm------------mail-gif-object-mail-gif-sap-language-en--feedback-mail-for-displayed-topic---mail-feedback--mailto-f1-helpsap.com?subject=Feedback on ABAP Documentation&body=Document: itab - Optimizing the WHERE Condition, ABENITAB_WHERE_OPTIMIZATION, 757%0D%0A%0D%0AEr
ror:%0D%0A%0D%0A%0D%0A%0D%0ASuggestion for improvement:)

itab - Optimizing the WHERE Condition

The statements [LOOP AT](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abaploop_at_itab.htm), [DELETE](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abapdelete_itab.htm), and [MODIFY](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abapmodify_itab.htm) can be specified together with a WHERE condition that selects specific lines of the internal table. Searches in a [standard table](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abenstandard_table_glosry.htm "Glossary Entry") using the [primary table key](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abenprimary_table_key_glosry.htm "Glossary Entry") are always linear and cannot be optimized. Searches using a [sorted key](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abensorted_key_glosry.htm "Glossary Entry") or a [hash key](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abenhash_key_glosry.htm "Glossary Entry"), however, can be optimized in certain circumstances. These keys are used for:

-   accessing a [sorted table](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abensorted_table_glosry.htm "Glossary Entry") using its primary key.
-   accessing a [hashed table](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abenhashed_table_glosry.htm "Glossary Entry") using its primary key.
-   accessing a table of any table type using a [secondary table key](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abensecondary_table_key_glosry.htm "Glossary Entry") specified by USING KEY.

The optimization takes place by mapping all [relational expressions](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abenrelational_expression_glosry.htm "Glossary Entry") or a group of the relational expressions in the WHERE condition to a specified key. This specified key performs a corresponding optimized key access (binary search or hash algorithm as in the statement [READ TABLE](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abapread_table.htm) or a [table expression](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abentable_expressions.htm)), to find one or more lines. The found line or lines are then checked using those remaining relational expressions from the WHERE condition that were not mapped to the specified key.

Prerequisites for the optimization are therefore:

-   The relational expressions of the WHERE condition can be transformed to a specified key.
-   The corresponding key access returns the same results as the evaluation of this part of the logical expression would. This is guaranteed only for compatible data types, since in the case of incompatible data types:
    -   the content of the specified data objects is converted to the data type of the columns before the evaluation in the case of key accesses.
    -   The [comparison rules](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abenlogexp_rules.htm) for incompatible data types apply when evaluating a [comparison expression](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abencomparison_expression_glosry.htm "Glossary Entry"). Here, all the data types involved play a part in determining which operand is converted into which comparison type.

If there are no or insufficient relational expressions to meet both of these prerequisites, no optimization is possible and the behavior is as follows:

-   If a sorted table or a hashed table is accessed using the primary table key, all lines of the internal table are checked as in a standard table.
-   If the table is read using a secondary table key, that is, if said key is specified after USING KEY, a syntax error or syntax check warning, or an exception is raised. Access using a secondary table key must always be executed in an optimized way.

The following sections describe exactly when an access can be optimized.

-   [Prerequisites for the Optimization of Hash Keys](#abenitab-where-optimization-1-------prerequisites-for-the-optimization-of-sorted-keys---@ITOC@@ABENITAB_WHERE_OPTIMIZATION_2)
-   [Requirements Made on the Operands](#@@ITOC@@ABENITAB_WHERE_OPTIMIZATION_3)

Hint

If the lines selected using WHERE are modified or deleted using [MODIFY](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abapmodify_itab.htm) or [DELETE](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abapdelete_itab.htm) and not just read using [LOOP AT](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abaploop_at_itab.htm), further update costs are incurred in addition to the search for the lines. When deleting lines from standard tables, it should be noted that searches using a secondary key optimize the selection of lines to be deleted, but not the update required for the primary key, which is usually performed using a linear search.

Prerequisites for the Optimization of Hash Keys   

In the case of [hash key](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abenhash_key_glosry.htm "Glossary Entry") accesses, there must be exactly one relational expression combined using AND for each component of the key. This expression is either

-   a [comparison expression](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abencomparison_expression_glosry.htm "Glossary Entry") with the comparison operator \= (or EQ), whose operands meet the requirements above or
-   a [predicate expression](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abenpredicate_expression_glosry.htm "Glossary Entry") IS INITIAL without the addition NOT.

These relational expressions construct the part of the logical expression used for the key access. This part must not contain duplicate key components. The remainder of the logical expression can contain any number of relational expressions combined using AND. Optimization may not be possible, however, if the Boolean operators NOT or OR are used. Key components may be used in the relational expressions not used for the key access.

Hint

Relational expressions other than comparisons using \= (or EQ) or predicate expressions IS INITIAL are not part of the key access. This applies particularly to the tabular comparison operator [IN range\_tab](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abenlogexp_select_option.htm), even if it can be traced back to optimizable comparisons.

Example

In the following example, the first two WHERE conditions can be optimized as key accesses with the secondary table key key. This is because:

1.  The optimizable conditions for b, d, and e cover the entire key.
2.  The optimizable conditions b, d, and e cover the entire key and a is a condition on a non-key column that is not involved in the part of the WHERE condition required for the optimization.
3.  The optimizable conditions b, d, and e cover the entire key and the other two conditions on the key columns b and d are not optimizable and are hence not involved in the part of the WHERE condition required for the optimization.

The next six WHERE conditions cannot be optimized and produce syntax errors. This is because:

1.  The key component d is not specified.
2.  A key component is combined using OR instead of AND.
3.  Two non-optimizable comparison operators are used.
4.  An operand of type i is used in the comparison b of type c, which does not meet the requirements made on the operands.
5.  The Boolean operator NOT is used in front of a key component.
6.  A further comparison is combined using OR.
7.  A further comparison is negated using NOT.
    
    DATA: BEGIN OF line,
            a TYPE c LENGTH 3,
            b TYPE c LENGTH 3,
            c TYPE c LENGTH 3,
            d TYPE c LENGTH 3,
            e TYPE c LENGTH 3,
            f TYPE c LENGTH 3,
          END OF line.
    DATA itab LIKE STANDARD TABLE OF line
                   WITH UNIQUE HASHED KEY key COMPONENTS b e d.
    DATA b\_tab LIKE RANGE OF line-b.
    LOOP AT itab INTO line USING KEY key
         WHERE b = '...' AND d = '...' AND e IS INITIAL.
    ENDLOOP.
    LOOP AT itab INTO line USING KEY key
         WHERE a = '...' AND b = '...' AND d = '...' AND e IS INITIAL.
    ENDLOOP.
    LOOP AT itab INTO line USING KEY key
         WHERE  b = '...' AND d = '...' AND e IS INITIAL AND
                b IN b\_tab AND d <> '...'.
    ENDLOOP.
    LOOP AT itab INTO line USING KEY key
         WHERE b = '...' AND e IS INITIAL.                     "syntax error
    ENDLOOP.
    LOOP AT itab INTO line USING KEY key
         WHERE b = '...' OR d = '...' AND e IS INITIAL OR      "syntax error
    ENDLOOP.
    LOOP AT itab INTO line USING KEY key
         WHERE b = '...' AND d <> '...' AND e IS NOT INITIAL.  "syntax error
    ENDLOOP.
    LOOP AT itab INTO line USING KEY key
         WHERE b = 333 AND d = '...' AND e IS INITIAL.         "syntax error
    ENDLOOP.
    LOOP AT itab INTO line USING KEY key
         WHERE b = '...'  AND NOT d = '...' AND e IS INITIAL.  "syntax error
    ENDLOOP.
    LOOP AT itab INTO line USING KEY key
         WHERE b = '...' AND d = '...' AND e IS INITIAL OR     "syntax error
               a = '...'.
    ENDLOOP.
    LOOP AT itab INTO line USING KEY key
         WHERE b = '...' AND d = '...' AND e IS INITIAL AND    "syntax error
               NOT a = '...'.
    ENDLOOP.
    

Prerequisites for the Optimization of Sorted Keys   

In the case of reads using a [sorted key](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abensorted_key_glosry.htm "Glossary Entry"), the same applies as to a hash key. The only difference is that only an initial section of the key consisting of at least one component needs to be covered rather than the entire key.

The internal table is accessed in part sequentially. The starting point for the processing of the table is determined by a binary search using the subconditions that cover the table key completely or partially. From the starting point onwards, the table is only processed for as long as these subconditions remain fulfilled.

Example

In the following example, the first five WHERE conditions can be optimized as key accesses with the secondary table key key. This is because:

1.  b is an initial part of the key.
2.  b is an initial part of the key and a is an independent condition.
3.  b and e are an initial part of the key.
4.  b, e, and d are an initial part of the key and the order in the WHERE condition is ignored.
5.  b is an initial part of the key and in this case, d is an independent condition, even though it is part of the key.

The next five WHERE conditions cannot be optimized and produce syntax errors. This is because:

1.  e is not an initial part of the key.
2.  No inequality comparison takes place.
3.  A comparison in a ranges table is specified.
4.  The Boolean operator NOT is used.
5.  An additional OR relationship is used.
    
    DATA: BEGIN OF line,
            a TYPE c LENGTH 3,
            b TYPE c LENGTH 3,
            c TYPE c LENGTH 3,
            d TYPE c LENGTH 3,
            e TYPE c LENGTH 3,
            f TYPE c LENGTH 3,
          END OF line.
    DATA itab LIKE STANDARD TABLE OF line
                   WITH UNIQUE SORTED KEY key COMPONENTS b e d.
    DATA b\_tab LIKE RANGE OF line-b.
    LOOP AT itab INTO line USING KEY key
                 WHERE b = '...'.
    ENDLOOP.
    LOOP AT itab INTO line USING KEY key
                 WHERE a = '...' AND b IS INITIAL.
    ENDLOOP.
    LOOP AT itab INTO line USING KEY key
                 WHERE b = '...' AND e = '...'.
    ENDLOOP.
    LOOP AT itab INTO line USING KEY key
                 WHERE b = '...' AND d IS INITIAL AND e = '...'.
    ENDLOOP.
    LOOP AT itab INTO line USING KEY key
                 WHERE b = '...' AND d <> '...'.
    ENDLOOP.
    LOOP AT itab INTO line USING KEY key
                 WHERE e = '...'.                    "syntax error
    ENDLOOP.
    LOOP AT itab INTO line USING KEY key
                 WHERE b <> '...'.                   "syntax error
    ENDLOOP.
    LOOP AT itab INTO line USING KEY key
                 WHERE b IN b\_tab.                   "syntax error
    ENDLOOP.
    LOOP AT itab INTO line USING KEY key
                 WHERE b = '...'  AND NOT e = '...'. "syntax error
    ENDLOOP.
    LOOP AT itab INTO line USING KEY key             "syntax error
                 WHERE b = '...'  AND ( d = '...' OR e IS INITIAL ).
    ENDLOOP.
    

Requirements Made on the Operands   

The part of the logical expression that can be mapped to a key access must select the same lines as a statement [READ TABLE](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abapread_table.htm) or a corresponding [table expression](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abentable_expressions.htm) that specifies the corresponding components as keys.

-   When comparing incompatible data objects, the WHERE condition is subject to the same [comparison rules](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abenlogexp_rules.htm) for incompatible data types. Here, the data types involved determine which operand is converted to which comparison type.
-   If the additions [WITH TABLE KEY](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abapread_table_key.htm) and [WITH KEY](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abapread_table_free.htm) of the statement READ or [KEY](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abentable_exp_itab_line.htm) in a table expression are used, however, the content of the specified data objects is always converted to the data type of the columns before the comparison.

If this produces differing results, an optimization is not possible. Due to the complexity of the comparison rules, particularly for [elementary data types](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abenlogexp_rules_operands.htm), it is not a good idea to construct a set of rules detailing exactly when the comparison type matches the data type of the left operand. Generally speaking,

-   only fully compatible operands are optimizable,
-   in some cases, elementary operands with different data types can be optimized, if the value ranges or lengths are suitable. For example, a comparison of a column with the type of a floating point number with an operand of type integer or of a column of c with a similar operand, if its length is less than the length of the column.

For this reason, it is advisable to use only pairs of [compatible](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abencompatible_glosry.htm "Glossary Entry") operands in the WHERE condition. This guarantees that the differences in behavior of the WHERE condition and the specified key do not affect the result.

Example

The following example is largely similar to the example in the section WHERE log\_exp in [LOOP AT itab](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abaploop_at_itab_cond.htm). In that case, access takes place using the primary key and no optimization. Here, however, access takes place using a secondary table key and a syntax check warning is produced and an exception raised when the program is executed. The number of lines in the internal table determines whether the exception is raised.

DATA text\_short TYPE c LENGTH 2.
DATA text\_long  TYPE c LENGTH 4.
DATA itab LIKE TABLE OF text\_short
          WITH UNIQUE HASHED KEY key COMPONENTS table\_line.
itab = VALUE #( ( 'AA' )
                ( 'BB' )
                ( 'CC' )
                ( 'DD' )
                ( 'EE' )
                ( 'FF' )
                ( 'GG' )
                ( 'HH' )
                ( 'II' )
                ( 'JJ' )
                ( 'KK' )
                ( 'LL' )
                ( 'MM' ) ).
text\_short = 'AA'.
text\_long  = 'AAXX'.
LOOP AT itab INTO text\_short USING KEY key
             WHERE table\_line = text\_long.
ENDLOOP.
cl\_demo\_output=>write( |LOOP: { sy-subrc }| ).
"Statement
READ TABLE itab INTO text\_short WITH TABLE KEY key
                                COMPONENTS table\_line = text\_long.
cl\_demo\_output=>write( |READ: { sy-subrc }| ).
"Expression
TRY.
    text\_short = itab\[ KEY key COMPONENTS table\_line = text\_long \].
  catch CX\_SY\_ITAB\_LINE\_NOT\_FOUND.
    ...
ENDTRY.
cl\_demo\_output=>display( |Expression: { text\_short }| ).


---


## ABAP - Keyword Documentation / ABAP - Programming Language / Processing Internal Data / Internal Tables (itab) / itab - Processing Statements / INSERT itab

**Files**: 5 | **Difficulty**: intermediate

# ABAP - Keyword Documentation / ABAP - Programming Language / Processing Internal Data / Internal Tables (itab) / itab - Performance Notes

Included pages: 2


### abenitab_perfo.htm

---
title: "Table Sharing"
description: |
  When assignments are made between internal tables of the same type whose line type does not contain any table types, only the internal administration functions are passed to the table body(https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abentable_body_glosry.htm 'Glossary Entry') for pe
version: "7.57"
category: "data-structures"
type: "abap-reference"
sourceUrl: "https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abenitab_perfo.htm"
abapFile: "abenitab_perfo.htm"
keywords: ["select", "insert", "update", "delete", "loop", "do", "if", "case", "try", "data", "types", "internal-table", "abenitab", "perfo"]
---

* * *

AS ABAP Release 757, ©Copyright 2023 SAP SE. All rights reserved.

[ABAP - Keyword Documentation](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abenabap.htm) →  [ABAP - Programming Language](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abenabap_reference.htm) →  [Processing Internal Data](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abenabap_data_working.htm) →  [Internal Tables (itab)](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abenitab.htm) → 

 [![](Mail.gif?object=Mail.gif&sap-language=EN "Feedback mail for displayed topic") Mail Feedback](mailto:f1_help@sap.com?subject=Feedback on ABAP Documentation&body=Document: itab - Performance Notes, ABENITAB_PERFO, 757%0D%0A%0D%0AError:%0D%0A%0D%0A%0D%0A%0D%
0ASuggestion for improvement:)

itab - Performance Notes

-   [Table Sharing](#abenitab-perfo-1-------initial-memory-requirement---@ITOC@@ABENITAB_PERFO_2)
-   [Index Administration](#abenitab-perfo-3-------block-processing-of-table-lines---@ITOC@@ABENITAB_PERFO_4)
-   [Selective Data Transport](#abenitab-perfo-5-------using-secondary-keys---@ITOC@@ABENITAB_PERFO_6)
-   [Deleting Table Lines](#abenitab-perfo-7-------free-key-specified-for-sorted-tables-and-hashed-tables---@ITOC@@ABENITAB_PERFO_8)
-   [Sorting](#abenitab-perfo-9---table-sharing-----when-assignments-are-made-between-internal-tables-of-the-same-type-whose-line-type-does-not-contain-any-table-types--only-the-internal-administration-functions-are-passed-to-the--table-body--https---help-sap-com-doc-abapdocu-757-index-htm-7-57-en-us-abentable-body-glosry-htm--glossary-entry---for-performance-reasons---table-sharing--https---help-sap-com-doc-abapdocu-757-index-htm-7-57-en-us-abentable-sharing-glosry-htm--glossary-entry---is-revoked-only-when-write-access-to-one-of-the-tables-involved-is-initiated--the-actual-copy-process-then-takes-place---initial-memory-requirement-----internal-tables-are--dynamic-data-objects--https---help-sap-com-doc-abapdocu-757-index-htm-7-57-en-us-abendynamic-data-object-glosry-htm--glossary-entry---whose-area-in-the-memory-is-extended-block-by-block--the-size-of-the-first-block-in-the-memory-is-called--initial-memory-requirement--https---help-sap-com-doc-abapdocu-757-index-htm-7-57-en-us-abeninitial-mem-req-glosry-htm--glossary-entry---and-can-be-affected-in-the-declaration-of-an-internal-table-using-the-additions--initial-size--https---help-sap-com-doc-abapdocu-757-index-htm-7-57-en-us-abaptypes-itab-htm--and-the-obsolete--occurs--https---help-sap-com-doc-abapdocu-757-index-htm-7-57-en-us-abapdata-occurs-htm----it-is-usually-up-to-the-system-to-determine-the-size-of-the-first-block--initial-size-is-not-used-or-specified-with-the-value-0--in-this-case--a-suitable-block-size-is-chosen-the-first-time-lines-are-added-to-an-internal-table---specifying-a-concrete-value-greater-than-0-after-initial-size-is-only-practical-if-it-is-known-in-advance-how-many-entries-are-to-be-made-in-the-table--and-the-first-block-is-therefore-to-be-created-with-the-most-suitable-dimensions--this-can-be-particularly-important-for-internal-tables-that-are-components-of-other-internal-tables--and-which-only-contain-a-few-lines--no-more-than-around-5----to-avoid-excessive-memory-demands--the-system-ignores-values-that-produce-memory-demands-greater-than-the-constant-block-size---index-administration-----in-an--index-table--https---help-sap-com-doc-abapdocu-757-index-htm-7-57-en-us-abenindex-table-glosry-htm--glossary-entry----the-logical-order-of-the-table-entries-is-not-generally-consistent-with-the-physical-order-of-the-entries-in-the-main-memory--in-this-case--the-logical-order-is-no-longer-administrated-by-a-physical-index--but-by-a-logical-index--the-same-basically-applies-to-the--secondary-table-indexes--https---help-sap-com-doc-abapdocu-757-index-htm-7-57-en-us-abensecondary-table-index-glosry-htm--glossary-entry---used-to-manage--secondary--https---help-sap-com-doc-abapdocu-757-index-htm-7-57-en-us-abensecondary-table-key-glosry-htm--glossary-entry----sorted-keys--https---help-sap-com-doc-abapdocu-757-index-htm-7-57-en-us-abensorted-key-glosry-htm--glossary-entry-----use-of-the-logical-index-produces-additional-memory-requirements--and-index-maintenance-places-a-high-demand-on-resources--time-and-memory--when-inserting-or-deleting-table-lines--the-resource-requirements-increase-proportionally-with-the-number-of-remaining-lines-after-the-insertion-or-deletion-position--for-very-large-internal-tables--this-can-result-in-considerable-demands-on-performance-at-runtime---the-logical-index-is-only-created-when-it-is-needed--that-is--when-a-line-is-inserted-in-front-of-another-line--if-the-order-of-the-table-lines-is-changed--or-a-line-other-than-the-last-line-is-deleted--a-logical-index-is-not-required-if-an-internal-table-is-filled-using-only--append--https---help-sap-com-doc-abapdocu-757-index-htm-7-57-en-us-abapappend-htm---and-if-only-its-last-line-or-lines-is-are-deleted-using--delete--https---help-sap-com-doc-abapdocu-757-index-htm-7-57-en-us-abapdelete-itab-htm----hint--in-contrast-to-filling-a-table-with--insert--https---help-sap-com-doc-abapdocu-757-index-htm-7-57-en-us-abapinsert-itab-htm---appending-lines-with--append--https---help-sap-com-doc-abapdocu-757-index-htm-7-57-en-us-abapappend-htm--does-not-require-any-resources-for-index-maintenance--it-is-therefore-preferable-to-use-append-instead-of-insert-to-create-a--standard-table--https---help-sap-com-doc-abapdocu-757-index-htm-7-57-en-us-abenstandard-table-glosry-htm--glossary-entry----this-is-possible-if-the-order-of-the-entries-is-not-important--or-if-entries-can-be-appended-in-the-correct-order---block-processing-of-table-lines-----if-entire-line-areas-of-a-table-can-be-processed-at-once--this-should-not-be-done-line-by-line--but-using-block-operations--block-operations-are-possible-using-the-from-and-to-additions-of-the-statements--insert--https---help-sap-com-doc-abapdocu-757-index-htm-7-57-en-us-abapinsert-itab-htm----append--https---help-sap-com-doc-abapdocu-757-index-htm-7-57-en-us-abapappend-htm--and--delete--https---help-sap-com-doc-abapdocu-757-index-htm-7-57-en-us-abapdelete-itab-htm---block-operations-are-also-more-efficient-than-single-record-operations-when-reading-from-or-modifying-database-tables-with--abap-sql--https---help-sap-com-doc-abapdocu-757-index-htm-7-57-en-us-abenabap-sql-glosry-htm--glossary-entry---statements-with-the-additions-from---appending---to-table---selective-data-transport-----if--when-reading-table-lines-using--read-table--https---help-sap-com-doc-abapdocu-757-index-htm-7-57-en-us-abapread-table-htm--or--loop-at--https---help-sap-com-doc-abapdocu-757-index-htm-7-57-en-us-abaploop-at-itab-htm---a-work-area-is-used-or-table-lines-can-be-changed-using--modify--https---help-sap-com-doc-abapdocu-757-index-htm-7-57-en-us-abapmodify-itab-htm--instead-of-direct-access--the-transporting-addition-can-be-used-to-prevent-unnecessary-assignments-of-table-components-to-the-work-area--this-can-lead-to-a-noticeable-improvement-in-performance--particularly-if-table-like-components-are-excluded-from-processing---using-secondary-keys-----the--use-of-secondary-table-keys--https---help-sap-com-doc-abapdocu-757-index-htm-7-57-en-us-abenitab-key-secondary-usage-htm--should-be-planned-and-executed-carefully-and-sparingly--the-time-gained-when-accessing-individual-lines-should-not-be-lost-again-by-the-increased-memory-and-time-requirements-for-managing-the-secondary-keys--secondary-keys-are-generally-recommended-for-internal-tables-that-are-filled-once-and-rarely-changed-during-program-execution---example--the-program-demo--secondary--keys-demonstrates-how-a-secondary-table-key-is-specified-and-the-resulting-performance-gain---deleting-table-lines-----when-lines-are-deleted-from-an-internal-table--administration-costs-are-incurred-for-all-table-keys-and-table-indexes--the-primary-key-and-all-unique-secondary-keys-are-updated-directly--but-non-unique-secondary-keys-are-updated-only-if-the-line-to-be-deleted-is-included-in-the-updated-part-of-an-associated-index---lazy-update--https---help-sap-com-doc-abapdocu-757-index-htm-7-57-en-us-abenlazy-update-glosry-htm--glossary-entry------it-should-be-noted-that--particularly-for-standard-tables--the-mean-runtime-of-the-statement--delete--https---help-sap-com-doc-abapdocu-757-index-htm-7-57-en-us-abapdelete-itab-htm--always-depends-linearly-on-the-number-of-table-lines--even-when-secondary-keys-are-specified-using--with-table-key--https---help-sap-com-doc-abapdocu-757-index-htm-7-57-en-us-abapdelete-itab-key-htm--or--using-key--https---help-sap-com-doc-abapdocu-757-index-htm-7-57-en-us-abapdelete-itab-key-htm---this-is-because-a-linear-search-is-required-to-update-the-primary-index--even-though-the-line-to-be-deleted-can-itself-be-found-quickly---deleting-lines-in-internal-tables-using--delete--https---help-sap-com-doc-abapdocu-757-index-htm-7-57-en-us-abapdelete-itab-htm--does-not-usually-release-any-memory-in-the-internal-table--statements-such-as--clear--https---help-sap-com-doc-abapdocu-757-index-htm-7-57-en-us-abapclear-htm--or--free--https---help-sap-com-doc-abapdocu-757-index-htm-7-57-en-us-abapfree-dataobject-htm--must-be-used-to-release-memory-in-internal-tables---free-key-specified-for-sorted-tables-and-hashed-tables-----when-using-the--read--https---help-sap-com-doc-abapdocu-757-index-htm-7-57-en-us-abapread-table-htm--statement-with-a-specified-free-key-of-the-form--with-key------https---help-sap-com-doc-abapdocu-757-index-htm-7-57-en-us-abapread-table-free-htm---the-search-is-optimized-in-all-cases-where-this-is-possible--that-is-------in--sorted-tables--https---help-sap-com-doc-abapdocu-757-index-htm-7-57-en-us-abensorted-table-glosry-htm--glossary-entry----if-any-initial-section-of-the--table-key--https---help-sap-com-doc-abapdocu-757-index-htm-7-57-en-us-abentable-key-glosry-htm--glossary-entry---or-the-complete-table-key-is-covered-by-the-specified-key------in--hashed-tables--https---help-sap-com-doc-abapdocu-757-index-htm-7-57-en-us-abenhashed-table-glosry-htm--glossary-entry----if-the-complete-table-key-is-covered---if-part-of-a-free-key-meets-these-conditions--this-partial-key-is-first-used-to-search-for-an-entry--in-sorted-tables--this-is-done-using-a-binary-search-with-a-logarithmic-consumption-of-resources--and-in-hashed-tables-using-a-hash-algorithm--that-is--with-constant-resource-consumption--if-an-entry-is-found--the-system-checks-whether-the-rest-of-the-key-conditions-are-also-met--this-means-that-over-specific-keys-in-particular-are-optimized---hint--see-also--optimization-of-the-where-condition--https---help-sap-com-doc-abapdocu-757-index-htm-7-57-en-us-abenitab-where-optimization-htm----sorting-----for-textual-sorting-of-an-internal-table-in-accordance-with-the-current--text-environment--https---help-sap-com-doc-abapdocu-757-index-htm-7-57-en-us-abentext-environment-glosry-htm--glossary-entry----it-can-be-more-efficient-to-use-the-statement--convert-text-into-sortable-code--https---help-sap-com-doc-abapdocu-757-index-htm-7-57-en-us-abapconvert-text-htm--instead-of--sort-as-text--https---help-sap-com-doc-abapdocu-757-index-htm-7-57-en-us-abapsort-itab-htm--in-the-following-cases-------if-an-internal-table-is-sorted-by-locale-and-then-searched-binarily-using-the-statement-read-table-or-using-a--table-expression--https---help-sap-com-doc-abapdocu-757-index-htm-7-57-en-us-abentable-expressions-htm-------an-internal-table-must-be-sorted-more-than-once------indexes-for-database-tables-should-be-structured-in-accordance-with-a-locale---continue--itab---optimizing-the-where-condition--https---help-sap-com-doc-abapdocu-757-index-htm-7-57-en-us-abenitab-where-optimization-htm--------abenitab-where-optimization-htm------title---hint--description------if-the-lines-selected-using-where-are-modified-or-deleted-using-modify-https---help-sap-com-doc-abapdocu-757-index-htm-7-57-en-us-abapmodify-itab-htm--or-delete-https---help-sap-com-doc-abapdocu-757-index-htm-7-57-en-us-abapdelete-itab-htm--and-not-just-read-using-loop-at-https---help-sap-com--version---7-57--category---general--type---abap-reference--sourceurl---https---help-sap-com-doc-abapdocu-757-index-htm-7-57-en-us-abenitab-where-optimization-htm--abapfile---abenitab-where-optimization-htm--keywords----select----update----delete----loop----do----if----case----try----catch----data----types----internal-table----abenitab----where----optimization---------------as-abap-release-757---copyright-2023-sap-se--all-rights-reserved----abap---keyword-documentation--https---help-sap-com-doc-abapdocu-757-index-htm-7-57-en-us-abenabap-htm------abap---programming-language--https---help-sap-com-doc-abapdocu-757-index-htm-7-57-en-us-abenabap-reference-htm------processing-internal-data--https---help-sap-com-doc-abapdocu-757-index-htm-7-57-en-us-abenabap-data-working-htm------internal-tables--itab---https---help-sap-com-doc-abapdocu-757-index-htm-7-57-en-us-abenitab-htm------itab---performance-notes--https---help-sap-com-doc-abapdocu-757-index-htm-7-57-en-us-abenitab-perfo-htm------------mail-gif-object-mail-gif-sap-language-en--feedback-mail-for-displayed-topic---mail-feedback--mailto-f1-helpsap.com?subject=Feedback on ABAP Documentation&body=Document: itab - Optimizing the WHERE Condition, ABENITAB_WHERE_OPTIMIZATION, 757%0D%0A%0D%0AEr
ror:%0D%0A%0D%0A%0D%0A%0D%0ASuggestion for improvement:)

itab - Optimizing the WHERE Condition

The statements [LOOP AT](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abaploop_at_itab.htm), [DELETE](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abapdelete_itab.htm), and [MODIFY](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abapmodify_itab.htm) can be specified together with a WHERE condition that selects specific lines of the internal table. Searches in a [standard table](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abenstandard_table_glosry.htm "Glossary Entry") using the [primary table key](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abenprimary_table_key_glosry.htm "Glossary Entry") are always linear and cannot be optimized. Searches using a [sorted key](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abensorted_key_glosry.htm "Glossary Entry") or a [hash key](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abenhash_key_glosry.htm "Glossary Entry"), however, can be optimized in certain circumstances. These keys are used for:

-   accessing a [sorted table](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abensorted_table_glosry.htm "Glossary Entry") using its primary key.
-   accessing a [hashed table](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abenhashed_table_glosry.htm "Glossary Entry") using its primary key.
-   accessing a table of any table type using a [secondary table key](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abensecondary_table_key_glosry.htm "Glossary Entry") specified by USING KEY.

The optimization takes place by mapping all [relational expressions](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abenrelational_expression_glosry.htm "Glossary Entry") or a group of the relational expressions in the WHERE condition to a specified key. This specified key performs a corresponding optimized key access (binary search or hash algorithm as in the statement [READ TABLE](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abapread_table.htm) or a [table expression](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abentable_expressions.htm)), to find one or more lines. The found line or lines are then checked using those remaining relational expressions from the WHERE condition that were not mapped to the specified key.

Prerequisites for the optimization are therefore:

-   The relational expressions of the WHERE condition can be transformed to a specified key.
-   The corresponding key access returns the same results as the evaluation of this part of the logical expression would. This is guaranteed only for compatible data types, since in the case of incompatible data types:
    -   the content of the specified data objects is converted to the data type of the columns before the evaluation in the case of key accesses.
    -   The [comparison rules](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abenlogexp_rules.htm) for incompatible data types apply when evaluating a [comparison expression](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abencomparison_expression_glosry.htm "Glossary Entry"). Here, all the data types involved play a part in determining which operand is converted into which comparison type.

If there are no or insufficient relational expressions to meet both of these prerequisites, no optimization is possible and the behavior is as follows:

-   If a sorted table or a hashed table is accessed using the primary table key, all lines of the internal table are checked as in a standard table.
-   If the table is read using a secondary table key, that is, if said key is specified after USING KEY, a syntax error or syntax check warning, or an exception is raised. Access using a secondary table key must always be executed in an optimized way.

The following sections describe exactly when an access can be optimized.

-   [Prerequisites for the Optimization of Hash Keys](#abenitab-where-optimization-1-------prerequisites-for-the-optimization-of-sorted-keys---@ITOC@@ABENITAB_WHERE_OPTIMIZATION_2)
-   [Requirements Made on the Operands](#@@ITOC@@ABENITAB_WHERE_OPTIMIZATION_3)

Hint

If the lines selected using WHERE are modified or deleted using [MODIFY](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abapmodify_itab.htm) or [DELETE](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abapdelete_itab.htm) and not just read using [LOOP AT](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abaploop_at_itab.htm), further update costs are incurred in addition to the search for the lines. When deleting lines from standard tables, it should be noted that searches using a secondary key optimize the selection of lines to be deleted, but not the update required for the primary key, which is usually performed using a linear search.

Prerequisites for the Optimization of Hash Keys   

In the case of [hash key](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abenhash_key_glosry.htm "Glossary Entry") accesses, there must be exactly one relational expression combined using AND for each component of the key. This expression is either

-   a [comparison expression](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abencomparison_expression_glosry.htm "Glossary Entry") with the comparison operator \= (or EQ), whose operands meet the requirements above or
-   a [predicate expression](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abenpredicate_expression_glosry.htm "Glossary Entry") IS INITIAL without the addition NOT.

These relational expressions construct the part of the logical expression used for the key access. This part must not contain duplicate key components. The remainder of the logical expression can contain any number of relational expressions combined using AND. Optimization may not be possible, however, if the Boolean operators NOT or OR are used. Key components may be used in the relational expressions not used for the key access.

Hint

Relational expressions other than comparisons using \= (or EQ) or predicate expressions IS INITIAL are not part of the key access. This applies particularly to the tabular comparison operator [IN range\_tab](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abenlogexp_select_option.htm), even if it can be traced back to optimizable comparisons.

Example

In the following example, the first two WHERE conditions can be optimized as key accesses with the secondary table key key. This is because:

1.  The optimizable conditions for b, d, and e cover the entire key.
2.  The optimizable conditions b, d, and e cover the entire key and a is a condition on a non-key column that is not involved in the part of the WHERE condition required for the optimization.
3.  The optimizable conditions b, d, and e cover the entire key and the other two conditions on the key columns b and d are not optimizable and are hence not involved in the part of the WHERE condition required for the optimization.

The next six WHERE conditions cannot be optimized and produce syntax errors. This is because:

1.  The key component d is not specified.
2.  A key component is combined using OR instead of AND.
3.  Two non-optimizable comparison operators are used.
4.  An operand of type i is used in the comparison b of type c, which does not meet the requirements made on the operands.
5.  The Boolean operator NOT is used in front of a key component.
6.  A further comparison is combined using OR.
7.  A further comparison is negated using NOT.
    
    DATA: BEGIN OF line,
            a TYPE c LENGTH 3,
            b TYPE c LENGTH 3,
            c TYPE c LENGTH 3,
            d TYPE c LENGTH 3,
            e TYPE c LENGTH 3,
            f TYPE c LENGTH 3,
          END OF line.
    DATA itab LIKE STANDARD TABLE OF line
                   WITH UNIQUE HASHED KEY key COMPONENTS b e d.
    DATA b\_tab LIKE RANGE OF line-b.
    LOOP AT itab INTO line USING KEY key
         WHERE b = '...' AND d = '...' AND e IS INITIAL.
    ENDLOOP.
    LOOP AT itab INTO line USING KEY key
         WHERE a = '...' AND b = '...' AND d = '...' AND e IS INITIAL.
    ENDLOOP.
    LOOP AT itab INTO line USING KEY key
         WHERE  b = '...' AND d = '...' AND e IS INITIAL AND
                b IN b\_tab AND d <> '...'.
    ENDLOOP.
    LOOP AT itab INTO line USING KEY key
         WHERE b = '...' AND e IS INITIAL.                     "syntax error
    ENDLOOP.
    LOOP AT itab INTO line USING KEY key
         WHERE b = '...' OR d = '...' AND e IS INITIAL OR      "syntax error
    ENDLOOP.
    LOOP AT itab INTO line USING KEY key
         WHERE b = '...' AND d <> '...' AND e IS NOT INITIAL.  "syntax error
    ENDLOOP.
    LOOP AT itab INTO line USING KEY key
         WHERE b = 333 AND d = '...' AND e IS INITIAL.         "syntax error
    ENDLOOP.
    LOOP AT itab INTO line USING KEY key
         WHERE b = '...'  AND NOT d = '...' AND e IS INITIAL.  "syntax error
    ENDLOOP.
    LOOP AT itab INTO line USING KEY key
         WHERE b = '...' AND d = '...' AND e IS INITIAL OR     "syntax error
               a = '...'.
    ENDLOOP.
    LOOP AT itab INTO line USING KEY key
         WHERE b = '...' AND d = '...' AND e IS INITIAL AND    "syntax error
               NOT a = '...'.
    ENDLOOP.
    

Prerequisites for the Optimization of Sorted Keys   

In the case of reads using a [sorted key](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abensorted_key_glosry.htm "Glossary Entry"), the same applies as to a hash key. The only difference is that only an initial section of the key consisting of at least one component needs to be covered rather than the entire key.

The internal table is accessed in part sequentially. The starting point for the processing of the table is determined by a binary search using the subconditions that cover the table key completely or partially. From the starting point onwards, the table is only processed for as long as these subconditions remain fulfilled.

Example

In the following example, the first five WHERE conditions can be optimized as key accesses with the secondary table key key. This is because:

1.  b is an initial part of the key.
2.  b is an initial part of the key and a is an independent condition.
3.  b and e are an initial part of the key.
4.  b, e, and d are an initial part of the key and the order in the WHERE condition is ignored.
5.  b is an initial part of the key and in this case, d is an independent condition, even though it is part of the key.

The next five WHERE conditions cannot be optimized and produce syntax errors. This is because:

1.  e is not an initial part of the key.
2.  No inequality comparison takes place.
3.  A comparison in a ranges table is specified.
4.  The Boolean operator NOT is used.
5.  An additional OR relationship is used.
    
    DATA: BEGIN OF line,
            a TYPE c LENGTH 3,
            b TYPE c LENGTH 3,
            c TYPE c LENGTH 3,
            d TYPE c LENGTH 3,
            e TYPE c LENGTH 3,
            f TYPE c LENGTH 3,
          END OF line.
    DATA itab LIKE STANDARD TABLE OF line
                   WITH UNIQUE SORTED KEY key COMPONENTS b e d.
    DATA b\_tab LIKE RANGE OF line-b.
    LOOP AT itab INTO line USING KEY key
                 WHERE b = '...'.
    ENDLOOP.
    LOOP AT itab INTO line USING KEY key
                 WHERE a = '...' AND b IS INITIAL.
    ENDLOOP.
    LOOP AT itab INTO line USING KEY key
                 WHERE b = '...' AND e = '...'.
    ENDLOOP.
    LOOP AT itab INTO line USING KEY key
                 WHERE b = '...' AND d IS INITIAL AND e = '...'.
    ENDLOOP.
    LOOP AT itab INTO line USING KEY key
                 WHERE b = '...' AND d <> '...'.
    ENDLOOP.
    LOOP AT itab INTO line USING KEY key
                 WHERE e = '...'.                    "syntax error
    ENDLOOP.
    LOOP AT itab INTO line USING KEY key
                 WHERE b <> '...'.                   "syntax error
    ENDLOOP.
    LOOP AT itab INTO line USING KEY key
                 WHERE b IN b\_tab.                   "syntax error
    ENDLOOP.
    LOOP AT itab INTO line USING KEY key
                 WHERE b = '...'  AND NOT e = '...'. "syntax error
    ENDLOOP.
    LOOP AT itab INTO line USING KEY key             "syntax error
                 WHERE b = '...'  AND ( d = '...' OR e IS INITIAL ).
    ENDLOOP.
    

Requirements Made on the Operands   

The part of the logical expression that can be mapped to a key access must select the same lines as a statement [READ TABLE](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abapread_table.htm) or a corresponding [table expression](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abentable_expressions.htm) that specifies the corresponding components as keys.

-   When comparing incompatible data objects, the WHERE condition is subject to the same [comparison rules](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abenlogexp_rules.htm) for incompatible data types. Here, the data types involved determine which operand is converted to which comparison type.
-   If the additions [WITH TABLE KEY](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abapread_table_key.htm) and [WITH KEY](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abapread_table_free.htm) of the statement READ or [KEY](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abentable_exp_itab_line.htm) in a table expression are used, however, the content of the specified data objects is always converted to the data type of the columns before the comparison.

If this produces differing results, an optimization is not possible. Due to the complexity of the comparison rules, particularly for [elementary data types](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abenlogexp_rules_operands.htm), it is not a good idea to construct a set of rules detailing exactly when the comparison type matches the data type of the left operand. Generally speaking,

-   only fully compatible operands are optimizable,
-   in some cases, elementary operands with different data types can be optimized, if the value ranges or lengths are suitable. For example, a comparison of a column with the type of a floating point number with an operand of type integer or of a column of c with a similar operand, if its length is less than the length of the column.

For this reason, it is advisable to use only pairs of [compatible](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abencompatible_glosry.htm "Glossary Entry") operands in the WHERE condition. This guarantees that the differences in behavior of the WHERE condition and the specified key do not affect the result.

Example

The following example is largely similar to the example in the section WHERE log\_exp in [LOOP AT itab](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abaploop_at_itab_cond.htm). In that case, access takes place using the primary key and no optimization. Here, however, access takes place using a secondary table key and a syntax check warning is produced and an exception raised when the program is executed. The number of lines in the internal table determines whether the exception is raised.

DATA text\_short TYPE c LENGTH 2.
DATA text\_long  TYPE c LENGTH 4.
DATA itab LIKE TABLE OF text\_short
          WITH UNIQUE HASHED KEY key COMPONENTS table\_line.
itab = VALUE #( ( 'AA' )
                ( 'BB' )
                ( 'CC' )
                ( 'DD' )
                ( 'EE' )
                ( 'FF' )
                ( 'GG' )
                ( 'HH' )
                ( 'II' )
                ( 'JJ' )
                ( 'KK' )
                ( 'LL' )
                ( 'MM' ) ).
text\_short = 'AA'.
text\_long  = 'AAXX'.
LOOP AT itab INTO text\_short USING KEY key
             WHERE table\_line = text\_long.
ENDLOOP.
cl\_demo\_output=>write( |LOOP: { sy-subrc }| ).
"Statement
READ TABLE itab INTO text\_short WITH TABLE KEY key
                                COMPONENTS table\_line = text\_long.
cl\_demo\_output=>write( |READ: { sy-subrc }| ).
"Expression
TRY.
    text\_short = itab\[ KEY key COMPONENTS table\_line = text\_long \].
  catch CX\_SY\_ITAB\_LINE\_NOT\_FOUND.
    ...
ENDTRY.
cl\_demo\_output=>display( |Expression: { text\_short }| ).


---


## ABAP - Keyword Documentation / ABAP - Programming Language / Processing Internal Data / Internal Tables (itab) / itab - Processing Statements / COLLECT

**Files**: 2 | **Difficulty**: intermediate

# ABAP - Keyword Documentation / ABAP - Programming Language / Processing Internal Data / Internal Tables (itab) / itab - Performance Notes

Included pages: 2


### abenitab_perfo.htm

---
title: "Table Sharing"
description: |
  When assignments are made between internal tables of the same type whose line type does not contain any table types, only the internal administration functions are passed to the table body(https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abentable_body_glosry.htm 'Glossary Entry') for pe
version: "7.57"
category: "data-structures"
type: "abap-reference"
sourceUrl: "https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abenitab_perfo.htm"
abapFile: "abenitab_perfo.htm"
keywords: ["select", "insert", "update", "delete", "loop", "do", "if", "case", "try", "data", "types", "internal-table", "abenitab", "perfo"]
---

* * *

AS ABAP Release 757, ©Copyright 2023 SAP SE. All rights reserved.

[ABAP - Keyword Documentation](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abenabap.htm) →  [ABAP - Programming Language](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abenabap_reference.htm) →  [Processing Internal Data](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abenabap_data_working.htm) →  [Internal Tables (itab)](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abenitab.htm) → 

 [![](Mail.gif?object=Mail.gif&sap-language=EN "Feedback mail for displayed topic") Mail Feedback](mailto:f1_help@sap.com?subject=Feedback on ABAP Documentation&body=Document: itab - Performance Notes, ABENITAB_PERFO, 757%0D%0A%0D%0AError:%0D%0A%0D%0A%0D%0A%0D%
0ASuggestion for improvement:)

itab - Performance Notes

-   [Table Sharing](#abenitab-perfo-1-------initial-memory-requirement---@ITOC@@ABENITAB_PERFO_2)
-   [Index Administration](#abenitab-perfo-3-------block-processing-of-table-lines---@ITOC@@ABENITAB_PERFO_4)
-   [Selective Data Transport](#abenitab-perfo-5-------using-secondary-keys---@ITOC@@ABENITAB_PERFO_6)
-   [Deleting Table Lines](#abenitab-perfo-7-------free-key-specified-for-sorted-tables-and-hashed-tables---@ITOC@@ABENITAB_PERFO_8)
-   [Sorting](#abenitab-perfo-9---table-sharing-----when-assignments-are-made-between-internal-tables-of-the-same-type-whose-line-type-does-not-contain-any-table-types--only-the-internal-administration-functions-are-passed-to-the--table-body--https---help-sap-com-doc-abapdocu-757-index-htm-7-57-en-us-abentable-body-glosry-htm--glossary-entry---for-performance-reasons---table-sharing--https---help-sap-com-doc-abapdocu-757-index-htm-7-57-en-us-abentable-sharing-glosry-htm--glossary-entry---is-revoked-only-when-write-access-to-one-of-the-tables-involved-is-initiated--the-actual-copy-process-then-takes-place---initial-memory-requirement-----internal-tables-are--dynamic-data-objects--https---help-sap-com-doc-abapdocu-757-index-htm-7-57-en-us-abendynamic-data-object-glosry-htm--glossary-entry---whose-area-in-the-memory-is-extended-block-by-block--the-size-of-the-first-block-in-the-memory-is-called--initial-memory-requirement--https---help-sap-com-doc-abapdocu-757-index-htm-7-57-en-us-abeninitial-mem-req-glosry-htm--glossary-entry---and-can-be-affected-in-the-declaration-of-an-internal-table-using-the-additions--initial-size--https---help-sap-com-doc-abapdocu-757-index-htm-7-57-en-us-abaptypes-itab-htm--and-the-obsolete--occurs--https---help-sap-com-doc-abapdocu-757-index-htm-7-57-en-us-abapdata-occurs-htm----it-is-usually-up-to-the-system-to-determine-the-size-of-the-first-block--initial-size-is-not-used-or-specified-with-the-value-0--in-this-case--a-suitable-block-size-is-chosen-the-first-time-lines-are-added-to-an-internal-table---specifying-a-concrete-value-greater-than-0-after-initial-size-is-only-practical-if-it-is-known-in-advance-how-many-entries-are-to-be-made-in-the-table--and-the-first-block-is-therefore-to-be-created-with-the-most-suitable-dimensions--this-can-be-particularly-important-for-internal-tables-that-are-components-of-other-internal-tables--and-which-only-contain-a-few-lines--no-more-than-around-5----to-avoid-excessive-memory-demands--the-system-ignores-values-that-produce-memory-demands-greater-than-the-constant-block-size---index-administration-----in-an--index-table--https---help-sap-com-doc-abapdocu-757-index-htm-7-57-en-us-abenindex-table-glosry-htm--glossary-entry----the-logical-order-of-the-table-entries-is-not-generally-consistent-with-the-physical-order-of-the-entries-in-the-main-memory--in-this-case--the-logical-order-is-no-longer-administrated-by-a-physical-index--but-by-a-logical-index--the-same-basically-applies-to-the--secondary-table-indexes--https---help-sap-com-doc-abapdocu-757-index-htm-7-57-en-us-abensecondary-table-index-glosry-htm--glossary-entry---used-to-manage--secondary--https---help-sap-com-doc-abapdocu-757-index-htm-7-57-en-us-abensecondary-table-key-glosry-htm--glossary-entry----sorted-keys--https---help-sap-com-doc-abapdocu-757-index-htm-7-57-en-us-abensorted-key-glosry-htm--glossary-entry-----use-of-the-logical-index-produces-additional-memory-requirements--and-index-maintenance-places-a-high-demand-on-resources--time-and-memory--when-inserting-or-deleting-table-lines--the-resource-requirements-increase-proportionally-with-the-number-of-remaining-lines-after-the-insertion-or-deletion-position--for-very-large-internal-tables--this-can-result-in-considerable-demands-on-performance-at-runtime---the-logical-index-is-only-created-when-it-is-needed--that-is--when-a-line-is-inserted-in-front-of-another-line--if-the-order-of-the-table-lines-is-changed--or-a-line-other-than-the-last-line-is-deleted--a-logical-index-is-not-required-if-an-internal-table-is-filled-using-only--append--https---help-sap-com-doc-abapdocu-757-index-htm-7-57-en-us-abapappend-htm---and-if-only-its-last-line-or-lines-is-are-deleted-using--delete--https---help-sap-com-doc-abapdocu-757-index-htm-7-57-en-us-abapdelete-itab-htm----hint--in-contrast-to-filling-a-table-with--insert--https---help-sap-com-doc-abapdocu-757-index-htm-7-57-en-us-abapinsert-itab-htm---appending-lines-with--append--https---help-sap-com-doc-abapdocu-757-index-htm-7-57-en-us-abapappend-htm--does-not-require-any-resources-for-index-maintenance--it-is-therefore-preferable-to-use-append-instead-of-insert-to-create-a--standard-table--https---help-sap-com-doc-abapdocu-757-index-htm-7-57-en-us-abenstandard-table-glosry-htm--glossary-entry----this-is-possible-if-the-order-of-the-entries-is-not-important--or-if-entries-can-be-appended-in-the-correct-order---block-processing-of-table-lines-----if-entire-line-areas-of-a-table-can-be-processed-at-once--this-should-not-be-done-line-by-line--but-using-block-operations--block-operations-are-possible-using-the-from-and-to-additions-of-the-statements--insert--https---help-sap-com-doc-abapdocu-757-index-htm-7-57-en-us-abapinsert-itab-htm----append--https---help-sap-com-doc-abapdocu-757-index-htm-7-57-en-us-abapappend-htm--and--delete--https---help-sap-com-doc-abapdocu-757-index-htm-7-57-en-us-abapdelete-itab-htm---block-operations-are-also-more-efficient-than-single-record-operations-when-reading-from-or-modifying-database-tables-with--abap-sql--https---help-sap-com-doc-abapdocu-757-index-htm-7-57-en-us-abenabap-sql-glosry-htm--glossary-entry---statements-with-the-additions-from---appending---to-table---selective-data-transport-----if--when-reading-table-lines-using--read-table--https---help-sap-com-doc-abapdocu-757-index-htm-7-57-en-us-abapread-table-htm--or--loop-at--https---help-sap-com-doc-abapdocu-757-index-htm-7-57-en-us-abaploop-at-itab-htm---a-work-area-is-used-or-table-lines-can-be-changed-using--modify--https---help-sap-com-doc-abapdocu-757-index-htm-7-57-en-us-abapmodify-itab-htm--instead-of-direct-access--the-transporting-addition-can-be-used-to-prevent-unnecessary-assignments-of-table-components-to-the-work-area--this-can-lead-to-a-noticeable-improvement-in-performance--particularly-if-table-like-components-are-excluded-from-processing---using-secondary-keys-----the--use-of-secondary-table-keys--https---help-sap-com-doc-abapdocu-757-index-htm-7-57-en-us-abenitab-key-secondary-usage-htm--should-be-planned-and-executed-carefully-and-sparingly--the-time-gained-when-accessing-individual-lines-should-not-be-lost-again-by-the-increased-memory-and-time-requirements-for-managing-the-secondary-keys--secondary-keys-are-generally-recommended-for-internal-tables-that-are-filled-once-and-rarely-changed-during-program-execution---example--the-program-demo--secondary--keys-demonstrates-how-a-secondary-table-key-is-specified-and-the-resulting-performance-gain---deleting-table-lines-----when-lines-are-deleted-from-an-internal-table--administration-costs-are-incurred-for-all-table-keys-and-table-indexes--the-primary-key-and-all-unique-secondary-keys-are-updated-directly--but-non-unique-secondary-keys-are-updated-only-if-the-line-to-be-deleted-is-included-in-the-updated-part-of-an-associated-index---lazy-update--https---help-sap-com-doc-abapdocu-757-index-htm-7-57-en-us-abenlazy-update-glosry-htm--glossary-entry------it-should-be-noted-that--particularly-for-standard-tables--the-mean-runtime-of-the-statement--delete--https---help-sap-com-doc-abapdocu-757-index-htm-7-57-en-us-abapdelete-itab-htm--always-depends-linearly-on-the-number-of-table-lines--even-when-secondary-keys-are-specified-using--with-table-key--https---help-sap-com-doc-abapdocu-757-index-htm-7-57-en-us-abapdelete-itab-key-htm--or--using-key--https---help-sap-com-doc-abapdocu-757-index-htm-7-57-en-us-abapdelete-itab-key-htm---this-is-because-a-linear-search-is-required-to-update-the-primary-index--even-though-the-line-to-be-deleted-can-itself-be-found-quickly---deleting-lines-in-internal-tables-using--delete--https---help-sap-com-doc-abapdocu-757-index-htm-7-57-en-us-abapdelete-itab-htm--does-not-usually-release-any-memory-in-the-internal-table--statements-such-as--clear--https---help-sap-com-doc-abapdocu-757-index-htm-7-57-en-us-abapclear-htm--or--free--https---help-sap-com-doc-abapdocu-757-index-htm-7-57-en-us-abapfree-dataobject-htm--must-be-used-to-release-memory-in-internal-tables---free-key-specified-for-sorted-tables-and-hashed-tables-----when-using-the--read--https---help-sap-com-doc-abapdocu-757-index-htm-7-57-en-us-abapread-table-htm--statement-with-a-specified-free-key-of-the-form--with-key------https---help-sap-com-doc-abapdocu-757-index-htm-7-57-en-us-abapread-table-free-htm---the-search-is-optimized-in-all-cases-where-this-is-possible--that-is-------in--sorted-tables--https---help-sap-com-doc-abapdocu-757-index-htm-7-57-en-us-abensorted-table-glosry-htm--glossary-entry----if-any-initial-section-of-the--table-key--https---help-sap-com-doc-abapdocu-757-index-htm-7-57-en-us-abentable-key-glosry-htm--glossary-entry---or-the-complete-table-key-is-covered-by-the-specified-key------in--hashed-tables--https---help-sap-com-doc-abapdocu-757-index-htm-7-57-en-us-abenhashed-table-glosry-htm--glossary-entry----if-the-complete-table-key-is-covered---if-part-of-a-free-key-meets-these-conditions--this-partial-key-is-first-used-to-search-for-an-entry--in-sorted-tables--this-is-done-using-a-binary-search-with-a-logarithmic-consumption-of-resources--and-in-hashed-tables-using-a-hash-algorithm--that-is--with-constant-resource-consumption--if-an-entry-is-found--the-system-checks-whether-the-rest-of-the-key-conditions-are-also-met--this-means-that-over-specific-keys-in-particular-are-optimized---hint--see-also--optimization-of-the-where-condition--https---help-sap-com-doc-abapdocu-757-index-htm-7-57-en-us-abenitab-where-optimization-htm----sorting-----for-textual-sorting-of-an-internal-table-in-accordance-with-the-current--text-environment--https---help-sap-com-doc-abapdocu-757-index-htm-7-57-en-us-abentext-environment-glosry-htm--glossary-entry----it-can-be-more-efficient-to-use-the-statement--convert-text-into-sortable-code--https---help-sap-com-doc-abapdocu-757-index-htm-7-57-en-us-abapconvert-text-htm--instead-of--sort-as-text--https---help-sap-com-doc-abapdocu-757-index-htm-7-57-en-us-abapsort-itab-htm--in-the-following-cases-------if-an-internal-table-is-sorted-by-locale-and-then-searched-binarily-using-the-statement-read-table-or-using-a--table-expression--https---help-sap-com-doc-abapdocu-757-index-htm-7-57-en-us-abentable-expressions-htm-------an-internal-table-must-be-sorted-more-than-once------indexes-for-database-tables-should-be-structured-in-accordance-with-a-locale---continue--itab---optimizing-the-where-condition--https---help-sap-com-doc-abapdocu-757-index-htm-7-57-en-us-abenitab-where-optimization-htm--------abenitab-where-optimization-htm------title---hint--description------if-the-lines-selected-using-where-are-modified-or-deleted-using-modify-https---help-sap-com-doc-abapdocu-757-index-htm-7-57-en-us-abapmodify-itab-htm--or-delete-https---help-sap-com-doc-abapdocu-757-index-htm-7-57-en-us-abapdelete-itab-htm--and-not-just-read-using-loop-at-https---help-sap-com--version---7-57--category---general--type---abap-reference--sourceurl---https---help-sap-com-doc-abapdocu-757-index-htm-7-57-en-us-abenitab-where-optimization-htm--abapfile---abenitab-where-optimization-htm--keywords----select----update----delete----loop----do----if----case----try----catch----data----types----internal-table----abenitab----where----optimization---------------as-abap-release-757---copyright-2023-sap-se--all-rights-reserved----abap---keyword-documentation--https---help-sap-com-doc-abapdocu-757-index-htm-7-57-en-us-abenabap-htm------abap---programming-language--https---help-sap-com-doc-abapdocu-757-index-htm-7-57-en-us-abenabap-reference-htm------processing-internal-data--https---help-sap-com-doc-abapdocu-757-index-htm-7-57-en-us-abenabap-data-working-htm------internal-tables--itab---https---help-sap-com-doc-abapdocu-757-index-htm-7-57-en-us-abenitab-htm------itab---performance-notes--https---help-sap-com-doc-abapdocu-757-index-htm-7-57-en-us-abenitab-perfo-htm------------mail-gif-object-mail-gif-sap-language-en--feedback-mail-for-displayed-topic---mail-feedback--mailto-f1-helpsap.com?subject=Feedback on ABAP Documentation&body=Document: itab - Optimizing the WHERE Condition, ABENITAB_WHERE_OPTIMIZATION, 757%0D%0A%0D%0AEr
ror:%0D%0A%0D%0A%0D%0A%0D%0ASuggestion for improvement:)

itab - Optimizing the WHERE Condition

The statements [LOOP AT](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abaploop_at_itab.htm), [DELETE](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abapdelete_itab.htm), and [MODIFY](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abapmodify_itab.htm) can be specified together with a WHERE condition that selects specific lines of the internal table. Searches in a [standard table](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abenstandard_table_glosry.htm "Glossary Entry") using the [primary table key](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abenprimary_table_key_glosry.htm "Glossary Entry") are always linear and cannot be optimized. Searches using a [sorted key](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abensorted_key_glosry.htm "Glossary Entry") or a [hash key](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abenhash_key_glosry.htm "Glossary Entry"), however, can be optimized in certain circumstances. These keys are used for:

-   accessing a [sorted table](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abensorted_table_glosry.htm "Glossary Entry") using its primary key.
-   accessing a [hashed table](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abenhashed_table_glosry.htm "Glossary Entry") using its primary key.
-   accessing a table of any table type using a [secondary table key](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abensecondary_table_key_glosry.htm "Glossary Entry") specified by USING KEY.

The optimization takes place by mapping all [relational expressions](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abenrelational_expression_glosry.htm "Glossary Entry") or a group of the relational expressions in the WHERE condition to a specified key. This specified key performs a corresponding optimized key access (binary search or hash algorithm as in the statement [READ TABLE](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abapread_table.htm) or a [table expression](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abentable_expressions.htm)), to find one or more lines. The found line or lines are then checked using those remaining relational expressions from the WHERE condition that were not mapped to the specified key.

Prerequisites for the optimization are therefore:

-   The relational expressions of the WHERE condition can be transformed to a specified key.
-   The corresponding key access returns the same results as the evaluation of this part of the logical expression would. This is guaranteed only for compatible data types, since in the case of incompatible data types:
    -   the content of the specified data objects is converted to the data type of the columns before the evaluation in the case of key accesses.
    -   The [comparison rules](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abenlogexp_rules.htm) for incompatible data types apply when evaluating a [comparison expression](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abencomparison_expression_glosry.htm "Glossary Entry"). Here, all the data types involved play a part in determining which operand is converted into which comparison type.

If there are no or insufficient relational expressions to meet both of these prerequisites, no optimization is possible and the behavior is as follows:

-   If a sorted table or a hashed table is accessed using the primary table key, all lines of the internal table are checked as in a standard table.
-   If the table is read using a secondary table key, that is, if said key is specified after USING KEY, a syntax error or syntax check warning, or an exception is raised. Access using a secondary table key must always be executed in an optimized way.

The following sections describe exactly when an access can be optimized.

-   [Prerequisites for the Optimization of Hash Keys](#abenitab-where-optimization-1-------prerequisites-for-the-optimization-of-sorted-keys---@ITOC@@ABENITAB_WHERE_OPTIMIZATION_2)
-   [Requirements Made on the Operands](#@@ITOC@@ABENITAB_WHERE_OPTIMIZATION_3)

Hint

If the lines selected using WHERE are modified or deleted using [MODIFY](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abapmodify_itab.htm) or [DELETE](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abapdelete_itab.htm) and not just read using [LOOP AT](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abaploop_at_itab.htm), further update costs are incurred in addition to the search for the lines. When deleting lines from standard tables, it should be noted that searches using a secondary key optimize the selection of lines to be deleted, but not the update required for the primary key, which is usually performed using a linear search.

Prerequisites for the Optimization of Hash Keys   

In the case of [hash key](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abenhash_key_glosry.htm "Glossary Entry") accesses, there must be exactly one relational expression combined using AND for each component of the key. This expression is either

-   a [comparison expression](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abencomparison_expression_glosry.htm "Glossary Entry") with the comparison operator \= (or EQ), whose operands meet the requirements above or
-   a [predicate expression](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abenpredicate_expression_glosry.htm "Glossary Entry") IS INITIAL without the addition NOT.

These relational expressions construct the part of the logical expression used for the key access. This part must not contain duplicate key components. The remainder of the logical expression can contain any number of relational expressions combined using AND. Optimization may not be possible, however, if the Boolean operators NOT or OR are used. Key components may be used in the relational expressions not used for the key access.

Hint

Relational expressions other than comparisons using \= (or EQ) or predicate expressions IS INITIAL are not part of the key access. This applies particularly to the tabular comparison operator [IN range\_tab](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abenlogexp_select_option.htm), even if it can be traced back to optimizable comparisons.

Example

In the following example, the first two WHERE conditions can be optimized as key accesses with the secondary table key key. This is because:

1.  The optimizable conditions for b, d, and e cover the entire key.
2.  The optimizable conditions b, d, and e cover the entire key and a is a condition on a non-key column that is not involved in the part of the WHERE condition required for the optimization.
3.  The optimizable conditions b, d, and e cover the entire key and the other two conditions on the key columns b and d are not optimizable and are hence not involved in the part of the WHERE condition required for the optimization.

The next six WHERE conditions cannot be optimized and produce syntax errors. This is because:

1.  The key component d is not specified.
2.  A key component is combined using OR instead of AND.
3.  Two non-optimizable comparison operators are used.
4.  An operand of type i is used in the comparison b of type c, which does not meet the requirements made on the operands.
5.  The Boolean operator NOT is used in front of a key component.
6.  A further comparison is combined using OR.
7.  A further comparison is negated using NOT.
    
    DATA: BEGIN OF line,
            a TYPE c LENGTH 3,
            b TYPE c LENGTH 3,
            c TYPE c LENGTH 3,
            d TYPE c LENGTH 3,
            e TYPE c LENGTH 3,
            f TYPE c LENGTH 3,
          END OF line.
    DATA itab LIKE STANDARD TABLE OF line
                   WITH UNIQUE HASHED KEY key COMPONENTS b e d.
    DATA b\_tab LIKE RANGE OF line-b.
    LOOP AT itab INTO line USING KEY key
         WHERE b = '...' AND d = '...' AND e IS INITIAL.
    ENDLOOP.
    LOOP AT itab INTO line USING KEY key
         WHERE a = '...' AND b = '...' AND d = '...' AND e IS INITIAL.
    ENDLOOP.
    LOOP AT itab INTO line USING KEY key
         WHERE  b = '...' AND d = '...' AND e IS INITIAL AND
                b IN b\_tab AND d <> '...'.
    ENDLOOP.
    LOOP AT itab INTO line USING KEY key
         WHERE b = '...' AND e IS INITIAL.                     "syntax error
    ENDLOOP.
    LOOP AT itab INTO line USING KEY key
         WHERE b = '...' OR d = '...' AND e IS INITIAL OR      "syntax error
    ENDLOOP.
    LOOP AT itab INTO line USING KEY key
         WHERE b = '...' AND d <> '...' AND e IS NOT INITIAL.  "syntax error
    ENDLOOP.
    LOOP AT itab INTO line USING KEY key
         WHERE b = 333 AND d = '...' AND e IS INITIAL.         "syntax error
    ENDLOOP.
    LOOP AT itab INTO line USING KEY key
         WHERE b = '...'  AND NOT d = '...' AND e IS INITIAL.  "syntax error
    ENDLOOP.
    LOOP AT itab INTO line USING KEY key
         WHERE b = '...' AND d = '...' AND e IS INITIAL OR     "syntax error
               a = '...'.
    ENDLOOP.
    LOOP AT itab INTO line USING KEY key
         WHERE b = '...' AND d = '...' AND e IS INITIAL AND    "syntax error
               NOT a = '...'.
    ENDLOOP.
    

Prerequisites for the Optimization of Sorted Keys   

In the case of reads using a [sorted key](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abensorted_key_glosry.htm "Glossary Entry"), the same applies as to a hash key. The only difference is that only an initial section of the key consisting of at least one component needs to be covered rather than the entire key.

The internal table is accessed in part sequentially. The starting point for the processing of the table is determined by a binary search using the subconditions that cover the table key completely or partially. From the starting point onwards, the table is only processed for as long as these subconditions remain fulfilled.

Example

In the following example, the first five WHERE conditions can be optimized as key accesses with the secondary table key key. This is because:

1.  b is an initial part of the key.
2.  b is an initial part of the key and a is an independent condition.
3.  b and e are an initial part of the key.
4.  b, e, and d are an initial part of the key and the order in the WHERE condition is ignored.
5.  b is an initial part of the key and in this case, d is an independent condition, even though it is part of the key.

The next five WHERE conditions cannot be optimized and produce syntax errors. This is because:

1.  e is not an initial part of the key.
2.  No inequality comparison takes place.
3.  A comparison in a ranges table is specified.
4.  The Boolean operator NOT is used.
5.  An additional OR relationship is used.
    
    DATA: BEGIN OF line,
            a TYPE c LENGTH 3,
            b TYPE c LENGTH 3,
            c TYPE c LENGTH 3,
            d TYPE c LENGTH 3,
            e TYPE c LENGTH 3,
            f TYPE c LENGTH 3,
          END OF line.
    DATA itab LIKE STANDARD TABLE OF line
                   WITH UNIQUE SORTED KEY key COMPONENTS b e d.
    DATA b\_tab LIKE RANGE OF line-b.
    LOOP AT itab INTO line USING KEY key
                 WHERE b = '...'.
    ENDLOOP.
    LOOP AT itab INTO line USING KEY key
                 WHERE a = '...' AND b IS INITIAL.
    ENDLOOP.
    LOOP AT itab INTO line USING KEY key
                 WHERE b = '...' AND e = '...'.
    ENDLOOP.
    LOOP AT itab INTO line USING KEY key
                 WHERE b = '...' AND d IS INITIAL AND e = '...'.
    ENDLOOP.
    LOOP AT itab INTO line USING KEY key
                 WHERE b = '...' AND d <> '...'.
    ENDLOOP.
    LOOP AT itab INTO line USING KEY key
                 WHERE e = '...'.                    "syntax error
    ENDLOOP.
    LOOP AT itab INTO line USING KEY key
                 WHERE b <> '...'.                   "syntax error
    ENDLOOP.
    LOOP AT itab INTO line USING KEY key
                 WHERE b IN b\_tab.                   "syntax error
    ENDLOOP.
    LOOP AT itab INTO line USING KEY key
                 WHERE b = '...'  AND NOT e = '...'. "syntax error
    ENDLOOP.
    LOOP AT itab INTO line USING KEY key             "syntax error
                 WHERE b = '...'  AND ( d = '...' OR e IS INITIAL ).
    ENDLOOP.
    

Requirements Made on the Operands   

The part of the logical expression that can be mapped to a key access must select the same lines as a statement [READ TABLE](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abapread_table.htm) or a corresponding [table expression](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abentable_expressions.htm) that specifies the corresponding components as keys.

-   When comparing incompatible data objects, the WHERE condition is subject to the same [comparison rules](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abenlogexp_rules.htm) for incompatible data types. Here, the data types involved determine which operand is converted to which comparison type.
-   If the additions [WITH TABLE KEY](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abapread_table_key.htm) and [WITH KEY](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abapread_table_free.htm) of the statement READ or [KEY](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abentable_exp_itab_line.htm) in a table expression are used, however, the content of the specified data objects is always converted to the data type of the columns before the comparison.

If this produces differing results, an optimization is not possible. Due to the complexity of the comparison rules, particularly for [elementary data types](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abenlogexp_rules_operands.htm), it is not a good idea to construct a set of rules detailing exactly when the comparison type matches the data type of the left operand. Generally speaking,

-   only fully compatible operands are optimizable,
-   in some cases, elementary operands with different data types can be optimized, if the value ranges or lengths are suitable. For example, a comparison of a column with the type of a floating point number with an operand of type integer or of a column of c with a similar operand, if its length is less than the length of the column.

For this reason, it is advisable to use only pairs of [compatible](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abencompatible_glosry.htm "Glossary Entry") operands in the WHERE condition. This guarantees that the differences in behavior of the WHERE condition and the specified key do not affect the result.

Example

The following example is largely similar to the example in the section WHERE log\_exp in [LOOP AT itab](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abaploop_at_itab_cond.htm). In that case, access takes place using the primary key and no optimization. Here, however, access takes place using a secondary table key and a syntax check warning is produced and an exception raised when the program is executed. The number of lines in the internal table determines whether the exception is raised.

DATA text\_short TYPE c LENGTH 2.
DATA text\_long  TYPE c LENGTH 4.
DATA itab LIKE TABLE OF text\_short
          WITH UNIQUE HASHED KEY key COMPONENTS table\_line.
itab = VALUE #( ( 'AA' )
                ( 'BB' )
                ( 'CC' )
                ( 'DD' )
                ( 'EE' )
                ( 'FF' )
                ( 'GG' )
                ( 'HH' )
                ( 'II' )
                ( 'JJ' )
                ( 'KK' )
                ( 'LL' )
                ( 'MM' ) ).
text\_short = 'AA'.
text\_long  = 'AAXX'.
LOOP AT itab INTO text\_short USING KEY key
             WHERE table\_line = text\_long.
ENDLOOP.
cl\_demo\_output=>write( |LOOP: { sy-subrc }| ).
"Statement
READ TABLE itab INTO text\_short WITH TABLE KEY key
                                COMPONENTS table\_line = text\_long.
cl\_demo\_output=>write( |READ: { sy-subrc }| ).
"Expression
TRY.
    text\_short = itab\[ KEY key COMPONENTS table\_line = text\_long \].
  catch CX\_SY\_ITAB\_LINE\_NOT\_FOUND.
    ...
ENDTRY.
cl\_demo\_output=>display( |Expression: { text\_short }| ).


---


## ABAP - Keyword Documentation / ABAP - Programming Language / Processing Internal Data / Internal Tables (itab) / itab - Processing Statements / APPEND

**Files**: 4 | **Difficulty**: intermediate

# ABAP - Keyword Documentation / ABAP - Programming Language / Processing Internal Data / Internal Tables (itab) / itab - Performance Notes

Included pages: 2


### abenitab_perfo.htm

---
title: "Table Sharing"
description: |
  When assignments are made between internal tables of the same type whose line type does not contain any table types, only the internal administration functions are passed to the table body(https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abentable_body_glosry.htm 'Glossary Entry') for pe
version: "7.57"
category: "data-structures"
type: "abap-reference"
sourceUrl: "https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abenitab_perfo.htm"
abapFile: "abenitab_perfo.htm"
keywords: ["select", "insert", "update", "delete", "loop", "do", "if", "case", "try", "data", "types", "internal-table", "abenitab", "perfo"]
---

* * *

AS ABAP Release 757, ©Copyright 2023 SAP SE. All rights reserved.

[ABAP - Keyword Documentation](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abenabap.htm) →  [ABAP - Programming Language](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abenabap_reference.htm) →  [Processing Internal Data](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abenabap_data_working.htm) →  [Internal Tables (itab)](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abenitab.htm) → 

 [![](Mail.gif?object=Mail.gif&sap-language=EN "Feedback mail for displayed topic") Mail Feedback](mailto:f1_help@sap.com?subject=Feedback on ABAP Documentation&body=Document: itab - Performance Notes, ABENITAB_PERFO, 757%0D%0A%0D%0AError:%0D%0A%0D%0A%0D%0A%0D%
0ASuggestion for improvement:)

itab - Performance Notes

-   [Table Sharing](#abenitab-perfo-1-------initial-memory-requirement---@ITOC@@ABENITAB_PERFO_2)
-   [Index Administration](#abenitab-perfo-3-------block-processing-of-table-lines---@ITOC@@ABENITAB_PERFO_4)
-   [Selective Data Transport](#abenitab-perfo-5-------using-secondary-keys---@ITOC@@ABENITAB_PERFO_6)
-   [Deleting Table Lines](#abenitab-perfo-7-------free-key-specified-for-sorted-tables-and-hashed-tables---@ITOC@@ABENITAB_PERFO_8)
-   [Sorting](#abenitab-perfo-9---table-sharing-----when-assignments-are-made-between-internal-tables-of-the-same-type-whose-line-type-does-not-contain-any-table-types--only-the-internal-administration-functions-are-passed-to-the--table-body--https---help-sap-com-doc-abapdocu-757-index-htm-7-57-en-us-abentable-body-glosry-htm--glossary-entry---for-performance-reasons---table-sharing--https---help-sap-com-doc-abapdocu-757-index-htm-7-57-en-us-abentable-sharing-glosry-htm--glossary-entry---is-revoked-only-when-write-access-to-one-of-the-tables-involved-is-initiated--the-actual-copy-process-then-takes-place---initial-memory-requirement-----internal-tables-are--dynamic-data-objects--https---help-sap-com-doc-abapdocu-757-index-htm-7-57-en-us-abendynamic-data-object-glosry-htm--glossary-entry---whose-area-in-the-memory-is-extended-block-by-block--the-size-of-the-first-block-in-the-memory-is-called--initial-memory-requirement--https---help-sap-com-doc-abapdocu-757-index-htm-7-57-en-us-abeninitial-mem-req-glosry-htm--glossary-entry---and-can-be-affected-in-the-declaration-of-an-internal-table-using-the-additions--initial-size--https---help-sap-com-doc-abapdocu-757-index-htm-7-57-en-us-abaptypes-itab-htm--and-the-obsolete--occurs--https---help-sap-com-doc-abapdocu-757-index-htm-7-57-en-us-abapdata-occurs-htm----it-is-usually-up-to-the-system-to-determine-the-size-of-the-first-block--initial-size-is-not-used-or-specified-with-the-value-0--in-this-case--a-suitable-block-size-is-chosen-the-first-time-lines-are-added-to-an-internal-table---specifying-a-concrete-value-greater-than-0-after-initial-size-is-only-practical-if-it-is-known-in-advance-how-many-entries-are-to-be-made-in-the-table--and-the-first-block-is-therefore-to-be-created-with-the-most-suitable-dimensions--this-can-be-particularly-important-for-internal-tables-that-are-components-of-other-internal-tables--and-which-only-contain-a-few-lines--no-more-than-around-5----to-avoid-excessive-memory-demands--the-system-ignores-values-that-produce-memory-demands-greater-than-the-constant-block-size---index-administration-----in-an--index-table--https---help-sap-com-doc-abapdocu-757-index-htm-7-57-en-us-abenindex-table-glosry-htm--glossary-entry----the-logical-order-of-the-table-entries-is-not-generally-consistent-with-the-physical-order-of-the-entries-in-the-main-memory--in-this-case--the-logical-order-is-no-longer-administrated-by-a-physical-index--but-by-a-logical-index--the-same-basically-applies-to-the--secondary-table-indexes--https---help-sap-com-doc-abapdocu-757-index-htm-7-57-en-us-abensecondary-table-index-glosry-htm--glossary-entry---used-to-manage--secondary--https---help-sap-com-doc-abapdocu-757-index-htm-7-57-en-us-abensecondary-table-key-glosry-htm--glossary-entry----sorted-keys--https---help-sap-com-doc-abapdocu-757-index-htm-7-57-en-us-abensorted-key-glosry-htm--glossary-entry-----use-of-the-logical-index-produces-additional-memory-requirements--and-index-maintenance-places-a-high-demand-on-resources--time-and-memory--when-inserting-or-deleting-table-lines--the-resource-requirements-increase-proportionally-with-the-number-of-remaining-lines-after-the-insertion-or-deletion-position--for-very-large-internal-tables--this-can-result-in-considerable-demands-on-performance-at-runtime---the-logical-index-is-only-created-when-it-is-needed--that-is--when-a-line-is-inserted-in-front-of-another-line--if-the-order-of-the-table-lines-is-changed--or-a-line-other-than-the-last-line-is-deleted--a-logical-index-is-not-required-if-an-internal-table-is-filled-using-only--append--https---help-sap-com-doc-abapdocu-757-index-htm-7-57-en-us-abapappend-htm---and-if-only-its-last-line-or-lines-is-are-deleted-using--delete--https---help-sap-com-doc-abapdocu-757-index-htm-7-57-en-us-abapdelete-itab-htm----hint--in-contrast-to-filling-a-table-with--insert--https---help-sap-com-doc-abapdocu-757-index-htm-7-57-en-us-abapinsert-itab-htm---appending-lines-with--append--https---help-sap-com-doc-abapdocu-757-index-htm-7-57-en-us-abapappend-htm--does-not-require-any-resources-for-index-maintenance--it-is-therefore-preferable-to-use-append-instead-of-insert-to-create-a--standard-table--https---help-sap-com-doc-abapdocu-757-index-htm-7-57-en-us-abenstandard-table-glosry-htm--glossary-entry----this-is-possible-if-the-order-of-the-entries-is-not-important--or-if-entries-can-be-appended-in-the-correct-order---block-processing-of-table-lines-----if-entire-line-areas-of-a-table-can-be-processed-at-once--this-should-not-be-done-line-by-line--but-using-block-operations--block-operations-are-possible-using-the-from-and-to-additions-of-the-statements--insert--https---help-sap-com-doc-abapdocu-757-index-htm-7-57-en-us-abapinsert-itab-htm----append--https---help-sap-com-doc-abapdocu-757-index-htm-7-57-en-us-abapappend-htm--and--delete--https---help-sap-com-doc-abapdocu-757-index-htm-7-57-en-us-abapdelete-itab-htm---block-operations-are-also-more-efficient-than-single-record-operations-when-reading-from-or-modifying-database-tables-with--abap-sql--https---help-sap-com-doc-abapdocu-757-index-htm-7-57-en-us-abenabap-sql-glosry-htm--glossary-entry---statements-with-the-additions-from---appending---to-table---selective-data-transport-----if--when-reading-table-lines-using--read-table--https---help-sap-com-doc-abapdocu-757-index-htm-7-57-en-us-abapread-table-htm--or--loop-at--https---help-sap-com-doc-abapdocu-757-index-htm-7-57-en-us-abaploop-at-itab-htm---a-work-area-is-used-or-table-lines-can-be-changed-using--modify--https---help-sap-com-doc-abapdocu-757-index-htm-7-57-en-us-abapmodify-itab-htm--instead-of-direct-access--the-transporting-addition-can-be-used-to-prevent-unnecessary-assignments-of-table-components-to-the-work-area--this-can-lead-to-a-noticeable-improvement-in-performance--particularly-if-table-like-components-are-excluded-from-processing---using-secondary-keys-----the--use-of-secondary-table-keys--https---help-sap-com-doc-abapdocu-757-index-htm-7-57-en-us-abenitab-key-secondary-usage-htm--should-be-planned-and-executed-carefully-and-sparingly--the-time-gained-when-accessing-individual-lines-should-not-be-lost-again-by-the-increased-memory-and-time-requirements-for-managing-the-secondary-keys--secondary-keys-are-generally-recommended-for-internal-tables-that-are-filled-once-and-rarely-changed-during-program-execution---example--the-program-demo--secondary--keys-demonstrates-how-a-secondary-table-key-is-specified-and-the-resulting-performance-gain---deleting-table-lines-----when-lines-are-deleted-from-an-internal-table--administration-costs-are-incurred-for-all-table-keys-and-table-indexes--the-primary-key-and-all-unique-secondary-keys-are-updated-directly--but-non-unique-secondary-keys-are-updated-only-if-the-line-to-be-deleted-is-included-in-the-updated-part-of-an-associated-index---lazy-update--https---help-sap-com-doc-abapdocu-757-index-htm-7-57-en-us-abenlazy-update-glosry-htm--glossary-entry------it-should-be-noted-that--particularly-for-standard-tables--the-mean-runtime-of-the-statement--delete--https---help-sap-com-doc-abapdocu-757-index-htm-7-57-en-us-abapdelete-itab-htm--always-depends-linearly-on-the-number-of-table-lines--even-when-secondary-keys-are-specified-using--with-table-key--https---help-sap-com-doc-abapdocu-757-index-htm-7-57-en-us-abapdelete-itab-key-htm--or--using-key--https---help-sap-com-doc-abapdocu-757-index-htm-7-57-en-us-abapdelete-itab-key-htm---this-is-because-a-linear-search-is-required-to-update-the-primary-index--even-though-the-line-to-be-deleted-can-itself-be-found-quickly---deleting-lines-in-internal-tables-using--delete--https---help-sap-com-doc-abapdocu-757-index-htm-7-57-en-us-abapdelete-itab-htm--does-not-usually-release-any-memory-in-the-internal-table--statements-such-as--clear--https---help-sap-com-doc-abapdocu-757-index-htm-7-57-en-us-abapclear-htm--or--free--https---help-sap-com-doc-abapdocu-757-index-htm-7-57-en-us-abapfree-dataobject-htm--must-be-used-to-release-memory-in-internal-tables---free-key-specified-for-sorted-tables-and-hashed-tables-----when-using-the--read--https---help-sap-com-doc-abapdocu-757-index-htm-7-57-en-us-abapread-table-htm--statement-with-a-specified-free-key-of-the-form--with-key------https---help-sap-com-doc-abapdocu-757-index-htm-7-57-en-us-abapread-table-free-htm---the-search-is-optimized-in-all-cases-where-this-is-possible--that-is-------in--sorted-tables--https---help-sap-com-doc-abapdocu-757-index-htm-7-57-en-us-abensorted-table-glosry-htm--glossary-entry----if-any-initial-section-of-the--table-key--https---help-sap-com-doc-abapdocu-757-index-htm-7-57-en-us-abentable-key-glosry-htm--glossary-entry---or-the-complete-table-key-is-covered-by-the-specified-key------in--hashed-tables--https---help-sap-com-doc-abapdocu-757-index-htm-7-57-en-us-abenhashed-table-glosry-htm--glossary-entry----if-the-complete-table-key-is-covered---if-part-of-a-free-key-meets-these-conditions--this-partial-key-is-first-used-to-search-for-an-entry--in-sorted-tables--this-is-done-using-a-binary-search-with-a-logarithmic-consumption-of-resources--and-in-hashed-tables-using-a-hash-algorithm--that-is--with-constant-resource-consumption--if-an-entry-is-found--the-system-checks-whether-the-rest-of-the-key-conditions-are-also-met--this-means-that-over-specific-keys-in-particular-are-optimized---hint--see-also--optimization-of-the-where-condition--https---help-sap-com-doc-abapdocu-757-index-htm-7-57-en-us-abenitab-where-optimization-htm----sorting-----for-textual-sorting-of-an-internal-table-in-accordance-with-the-current--text-environment--https---help-sap-com-doc-abapdocu-757-index-htm-7-57-en-us-abentext-environment-glosry-htm--glossary-entry----it-can-be-more-efficient-to-use-the-statement--convert-text-into-sortable-code--https---help-sap-com-doc-abapdocu-757-index-htm-7-57-en-us-abapconvert-text-htm--instead-of--sort-as-text--https---help-sap-com-doc-abapdocu-757-index-htm-7-57-en-us-abapsort-itab-htm--in-the-following-cases-------if-an-internal-table-is-sorted-by-locale-and-then-searched-binarily-using-the-statement-read-table-or-using-a--table-expression--https---help-sap-com-doc-abapdocu-757-index-htm-7-57-en-us-abentable-expressions-htm-------an-internal-table-must-be-sorted-more-than-once------indexes-for-database-tables-should-be-structured-in-accordance-with-a-locale---continue--itab---optimizing-the-where-condition--https---help-sap-com-doc-abapdocu-757-index-htm-7-57-en-us-abenitab-where-optimization-htm--------abenitab-where-optimization-htm------title---hint--description------if-the-lines-selected-using-where-are-modified-or-deleted-using-modify-https---help-sap-com-doc-abapdocu-757-index-htm-7-57-en-us-abapmodify-itab-htm--or-delete-https---help-sap-com-doc-abapdocu-757-index-htm-7-57-en-us-abapdelete-itab-htm--and-not-just-read-using-loop-at-https---help-sap-com--version---7-57--category---general--type---abap-reference--sourceurl---https---help-sap-com-doc-abapdocu-757-index-htm-7-57-en-us-abenitab-where-optimization-htm--abapfile---abenitab-where-optimization-htm--keywords----select----update----delete----loop----do----if----case----try----catch----data----types----internal-table----abenitab----where----optimization---------------as-abap-release-757---copyright-2023-sap-se--all-rights-reserved----abap---keyword-documentation--https---help-sap-com-doc-abapdocu-757-index-htm-7-57-en-us-abenabap-htm------abap---programming-language--https---help-sap-com-doc-abapdocu-757-index-htm-7-57-en-us-abenabap-reference-htm------processing-internal-data--https---help-sap-com-doc-abapdocu-757-index-htm-7-57-en-us-abenabap-data-working-htm------internal-tables--itab---https---help-sap-com-doc-abapdocu-757-index-htm-7-57-en-us-abenitab-htm------itab---performance-notes--https---help-sap-com-doc-abapdocu-757-index-htm-7-57-en-us-abenitab-perfo-htm------------mail-gif-object-mail-gif-sap-language-en--feedback-mail-for-displayed-topic---mail-feedback--mailto-f1-helpsap.com?subject=Feedback on ABAP Documentation&body=Document: itab - Optimizing the WHERE Condition, ABENITAB_WHERE_OPTIMIZATION, 757%0D%0A%0D%0AEr
ror:%0D%0A%0D%0A%0D%0A%0D%0ASuggestion for improvement:)

itab - Optimizing the WHERE Condition

The statements [LOOP AT](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abaploop_at_itab.htm), [DELETE](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abapdelete_itab.htm), and [MODIFY](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abapmodify_itab.htm) can be specified together with a WHERE condition that selects specific lines of the internal table. Searches in a [standard table](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abenstandard_table_glosry.htm "Glossary Entry") using the [primary table key](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abenprimary_table_key_glosry.htm "Glossary Entry") are always linear and cannot be optimized. Searches using a [sorted key](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abensorted_key_glosry.htm "Glossary Entry") or a [hash key](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abenhash_key_glosry.htm "Glossary Entry"), however, can be optimized in certain circumstances. These keys are used for:

-   accessing a [sorted table](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abensorted_table_glosry.htm "Glossary Entry") using its primary key.
-   accessing a [hashed table](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abenhashed_table_glosry.htm "Glossary Entry") using its primary key.
-   accessing a table of any table type using a [secondary table key](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abensecondary_table_key_glosry.htm "Glossary Entry") specified by USING KEY.

The optimization takes place by mapping all [relational expressions](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abenrelational_expression_glosry.htm "Glossary Entry") or a group of the relational expressions in the WHERE condition to a specified key. This specified key performs a corresponding optimized key access (binary search or hash algorithm as in the statement [READ TABLE](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abapread_table.htm) or a [table expression](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abentable_expressions.htm)), to find one or more lines. The found line or lines are then checked using those remaining relational expressions from the WHERE condition that were not mapped to the specified key.

Prerequisites for the optimization are therefore:

-   The relational expressions of the WHERE condition can be transformed to a specified key.
-   The corresponding key access returns the same results as the evaluation of this part of the logical expression would. This is guaranteed only for compatible data types, since in the case of incompatible data types:
    -   the content of the specified data objects is converted to the data type of the columns before the evaluation in the case of key accesses.
    -   The [comparison rules](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abenlogexp_rules.htm) for incompatible data types apply when evaluating a [comparison expression](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abencomparison_expression_glosry.htm "Glossary Entry"). Here, all the data types involved play a part in determining which operand is converted into which comparison type.

If there are no or insufficient relational expressions to meet both of these prerequisites, no optimization is possible and the behavior is as follows:

-   If a sorted table or a hashed table is accessed using the primary table key, all lines of the internal table are checked as in a standard table.
-   If the table is read using a secondary table key, that is, if said key is specified after USING KEY, a syntax error or syntax check warning, or an exception is raised. Access using a secondary table key must always be executed in an optimized way.

The following sections describe exactly when an access can be optimized.

-   [Prerequisites for the Optimization of Hash Keys](#abenitab-where-optimization-1-------prerequisites-for-the-optimization-of-sorted-keys---@ITOC@@ABENITAB_WHERE_OPTIMIZATION_2)
-   [Requirements Made on the Operands](#@@ITOC@@ABENITAB_WHERE_OPTIMIZATION_3)

Hint

If the lines selected using WHERE are modified or deleted using [MODIFY](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abapmodify_itab.htm) or [DELETE](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abapdelete_itab.htm) and not just read using [LOOP AT](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abaploop_at_itab.htm), further update costs are incurred in addition to the search for the lines. When deleting lines from standard tables, it should be noted that searches using a secondary key optimize the selection of lines to be deleted, but not the update required for the primary key, which is usually performed using a linear search.

Prerequisites for the Optimization of Hash Keys   

In the case of [hash key](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abenhash_key_glosry.htm "Glossary Entry") accesses, there must be exactly one relational expression combined using AND for each component of the key. This expression is either

-   a [comparison expression](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abencomparison_expression_glosry.htm "Glossary Entry") with the comparison operator \= (or EQ), whose operands meet the requirements above or
-   a [predicate expression](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abenpredicate_expression_glosry.htm "Glossary Entry") IS INITIAL without the addition NOT.

These relational expressions construct the part of the logical expression used for the key access. This part must not contain duplicate key components. The remainder of the logical expression can contain any number of relational expressions combined using AND. Optimization may not be possible, however, if the Boolean operators NOT or OR are used. Key components may be used in the relational expressions not used for the key access.

Hint

Relational expressions other than comparisons using \= (or EQ) or predicate expressions IS INITIAL are not part of the key access. This applies particularly to the tabular comparison operator [IN range\_tab](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abenlogexp_select_option.htm), even if it can be traced back to optimizable comparisons.

Example

In the following example, the first two WHERE conditions can be optimized as key accesses with the secondary table key key. This is because:

1.  The optimizable conditions for b, d, and e cover the entire key.
2.  The optimizable conditions b, d, and e cover the entire key and a is a condition on a non-key column that is not involved in the part of the WHERE condition required for the optimization.
3.  The optimizable conditions b, d, and e cover the entire key and the other two conditions on the key columns b and d are not optimizable and are hence not involved in the part of the WHERE condition required for the optimization.

The next six WHERE conditions cannot be optimized and produce syntax errors. This is because:

1.  The key component d is not specified.
2.  A key component is combined using OR instead of AND.
3.  Two non-optimizable comparison operators are used.
4.  An operand of type i is used in the comparison b of type c, which does not meet the requirements made on the operands.
5.  The Boolean operator NOT is used in front of a key component.
6.  A further comparison is combined using OR.
7.  A further comparison is negated using NOT.
    
    DATA: BEGIN OF line,
            a TYPE c LENGTH 3,
            b TYPE c LENGTH 3,
            c TYPE c LENGTH 3,
            d TYPE c LENGTH 3,
            e TYPE c LENGTH 3,
            f TYPE c LENGTH 3,
          END OF line.
    DATA itab LIKE STANDARD TABLE OF line
                   WITH UNIQUE HASHED KEY key COMPONENTS b e d.
    DATA b\_tab LIKE RANGE OF line-b.
    LOOP AT itab INTO line USING KEY key
         WHERE b = '...' AND d = '...' AND e IS INITIAL.
    ENDLOOP.
    LOOP AT itab INTO line USING KEY key
         WHERE a = '...' AND b = '...' AND d = '...' AND e IS INITIAL.
    ENDLOOP.
    LOOP AT itab INTO line USING KEY key
         WHERE  b = '...' AND d = '...' AND e IS INITIAL AND
                b IN b\_tab AND d <> '...'.
    ENDLOOP.
    LOOP AT itab INTO line USING KEY key
         WHERE b = '...' AND e IS INITIAL.                     "syntax error
    ENDLOOP.
    LOOP AT itab INTO line USING KEY key
         WHERE b = '...' OR d = '...' AND e IS INITIAL OR      "syntax error
    ENDLOOP.
    LOOP AT itab INTO line USING KEY key
         WHERE b = '...' AND d <> '...' AND e IS NOT INITIAL.  "syntax error
    ENDLOOP.
    LOOP AT itab INTO line USING KEY key
         WHERE b = 333 AND d = '...' AND e IS INITIAL.         "syntax error
    ENDLOOP.
    LOOP AT itab INTO line USING KEY key
         WHERE b = '...'  AND NOT d = '...' AND e IS INITIAL.  "syntax error
    ENDLOOP.
    LOOP AT itab INTO line USING KEY key
         WHERE b = '...' AND d = '...' AND e IS INITIAL OR     "syntax error
               a = '...'.
    ENDLOOP.
    LOOP AT itab INTO line USING KEY key
         WHERE b = '...' AND d = '...' AND e IS INITIAL AND    "syntax error
               NOT a = '...'.
    ENDLOOP.
    

Prerequisites for the Optimization of Sorted Keys   

In the case of reads using a [sorted key](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abensorted_key_glosry.htm "Glossary Entry"), the same applies as to a hash key. The only difference is that only an initial section of the key consisting of at least one component needs to be covered rather than the entire key.

The internal table is accessed in part sequentially. The starting point for the processing of the table is determined by a binary search using the subconditions that cover the table key completely or partially. From the starting point onwards, the table is only processed for as long as these subconditions remain fulfilled.

Example

In the following example, the first five WHERE conditions can be optimized as key accesses with the secondary table key key. This is because:

1.  b is an initial part of the key.
2.  b is an initial part of the key and a is an independent condition.
3.  b and e are an initial part of the key.
4.  b, e, and d are an initial part of the key and the order in the WHERE condition is ignored.
5.  b is an initial part of the key and in this case, d is an independent condition, even though it is part of the key.

The next five WHERE conditions cannot be optimized and produce syntax errors. This is because:

1.  e is not an initial part of the key.
2.  No inequality comparison takes place.
3.  A comparison in a ranges table is specified.
4.  The Boolean operator NOT is used.
5.  An additional OR relationship is used.
    
    DATA: BEGIN OF line,
            a TYPE c LENGTH 3,
            b TYPE c LENGTH 3,
            c TYPE c LENGTH 3,
            d TYPE c LENGTH 3,
            e TYPE c LENGTH 3,
            f TYPE c LENGTH 3,
          END OF line.
    DATA itab LIKE STANDARD TABLE OF line
                   WITH UNIQUE SORTED KEY key COMPONENTS b e d.
    DATA b\_tab LIKE RANGE OF line-b.
    LOOP AT itab INTO line USING KEY key
                 WHERE b = '...'.
    ENDLOOP.
    LOOP AT itab INTO line USING KEY key
                 WHERE a = '...' AND b IS INITIAL.
    ENDLOOP.
    LOOP AT itab INTO line USING KEY key
                 WHERE b = '...' AND e = '...'.
    ENDLOOP.
    LOOP AT itab INTO line USING KEY key
                 WHERE b = '...' AND d IS INITIAL AND e = '...'.
    ENDLOOP.
    LOOP AT itab INTO line USING KEY key
                 WHERE b = '...' AND d <> '...'.
    ENDLOOP.
    LOOP AT itab INTO line USING KEY key
                 WHERE e = '...'.                    "syntax error
    ENDLOOP.
    LOOP AT itab INTO line USING KEY key
                 WHERE b <> '...'.                   "syntax error
    ENDLOOP.
    LOOP AT itab INTO line USING KEY key
                 WHERE b IN b\_tab.                   "syntax error
    ENDLOOP.
    LOOP AT itab INTO line USING KEY key
                 WHERE b = '...'  AND NOT e = '...'. "syntax error
    ENDLOOP.
    LOOP AT itab INTO line USING KEY key             "syntax error
                 WHERE b = '...'  AND ( d = '...' OR e IS INITIAL ).
    ENDLOOP.
    

Requirements Made on the Operands   

The part of the logical expression that can be mapped to a key access must select the same lines as a statement [READ TABLE](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abapread_table.htm) or a corresponding [table expression](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abentable_expressions.htm) that specifies the corresponding components as keys.

-   When comparing incompatible data objects, the WHERE condition is subject to the same [comparison rules](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abenlogexp_rules.htm) for incompatible data types. Here, the data types involved determine which operand is converted to which comparison type.
-   If the additions [WITH TABLE KEY](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abapread_table_key.htm) and [WITH KEY](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abapread_table_free.htm) of the statement READ or [KEY](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abentable_exp_itab_line.htm) in a table expression are used, however, the content of the specified data objects is always converted to the data type of the columns before the comparison.

If this produces differing results, an optimization is not possible. Due to the complexity of the comparison rules, particularly for [elementary data types](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abenlogexp_rules_operands.htm), it is not a good idea to construct a set of rules detailing exactly when the comparison type matches the data type of the left operand. Generally speaking,

-   only fully compatible operands are optimizable,
-   in some cases, elementary operands with different data types can be optimized, if the value ranges or lengths are suitable. For example, a comparison of a column with the type of a floating point number with an operand of type integer or of a column of c with a similar operand, if its length is less than the length of the column.

For this reason, it is advisable to use only pairs of [compatible](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abencompatible_glosry.htm "Glossary Entry") operands in the WHERE condition. This guarantees that the differences in behavior of the WHERE condition and the specified key do not affect the result.

Example

The following example is largely similar to the example in the section WHERE log\_exp in [LOOP AT itab](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abaploop_at_itab_cond.htm). In that case, access takes place using the primary key and no optimization. Here, however, access takes place using a secondary table key and a syntax check warning is produced and an exception raised when the program is executed. The number of lines in the internal table determines whether the exception is raised.

DATA text\_short TYPE c LENGTH 2.
DATA text\_long  TYPE c LENGTH 4.
DATA itab LIKE TABLE OF text\_short
          WITH UNIQUE HASHED KEY key COMPONENTS table\_line.
itab = VALUE #( ( 'AA' )
                ( 'BB' )
                ( 'CC' )
                ( 'DD' )
                ( 'EE' )
                ( 'FF' )
                ( 'GG' )
                ( 'HH' )
                ( 'II' )
                ( 'JJ' )
                ( 'KK' )
                ( 'LL' )
                ( 'MM' ) ).
text\_short = 'AA'.
text\_long  = 'AAXX'.
LOOP AT itab INTO text\_short USING KEY key
             WHERE table\_line = text\_long.
ENDLOOP.
cl\_demo\_output=>write( |LOOP: { sy-subrc }| ).
"Statement
READ TABLE itab INTO text\_short WITH TABLE KEY key
                                COMPONENTS table\_line = text\_long.
cl\_demo\_output=>write( |READ: { sy-subrc }| ).
"Expression
TRY.
    text\_short = itab\[ KEY key COMPONENTS table\_line = text\_long \].
  catch CX\_SY\_ITAB\_LINE\_NOT\_FOUND.
    ...
ENDTRY.
cl\_demo\_output=>display( |Expression: { text\_short }| ).


---


## ABAP - Keyword Documentation / ABAP - Programming Language / Processing Internal Data / Internal Tables (itab) / itab - Processing Statements / MODIFY itab / MODIFY itab, itab_line

**Files**: 5 | **Difficulty**: intermediate

# ABAP - Keyword Documentation / ABAP - Programming Language / Processing Internal Data / Internal Tables (itab) / itab - Performance Notes

Included pages: 2


### abenitab_perfo.htm

---
title: "Table Sharing"
description: |
  When assignments are made between internal tables of the same type whose line type does not contain any table types, only the internal administration functions are passed to the table body(https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abentable_body_glosry.htm 'Glossary Entry') for pe
version: "7.57"
category: "data-structures"
type: "abap-reference"
sourceUrl: "https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abenitab_perfo.htm"
abapFile: "abenitab_perfo.htm"
keywords: ["select", "insert", "update", "delete", "loop", "do", "if", "case", "try", "data", "types", "internal-table", "abenitab", "perfo"]
---

* * *

AS ABAP Release 757, ©Copyright 2023 SAP SE. All rights reserved.

[ABAP - Keyword Documentation](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abenabap.htm) →  [ABAP - Programming Language](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abenabap_reference.htm) →  [Processing Internal Data](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abenabap_data_working.htm) →  [Internal Tables (itab)](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abenitab.htm) → 

 [![](Mail.gif?object=Mail.gif&sap-language=EN "Feedback mail for displayed topic") Mail Feedback](mailto:f1_help@sap.com?subject=Feedback on ABAP Documentation&body=Document: itab - Performance Notes, ABENITAB_PERFO, 757%0D%0A%0D%0AError:%0D%0A%0D%0A%0D%0A%0D%
0ASuggestion for improvement:)

itab - Performance Notes

-   [Table Sharing](#abenitab-perfo-1-------initial-memory-requirement---@ITOC@@ABENITAB_PERFO_2)
-   [Index Administration](#abenitab-perfo-3-------block-processing-of-table-lines---@ITOC@@ABENITAB_PERFO_4)
-   [Selective Data Transport](#abenitab-perfo-5-------using-secondary-keys---@ITOC@@ABENITAB_PERFO_6)
-   [Deleting Table Lines](#abenitab-perfo-7-------free-key-specified-for-sorted-tables-and-hashed-tables---@ITOC@@ABENITAB_PERFO_8)
-   [Sorting](#abenitab-perfo-9---table-sharing-----when-assignments-are-made-between-internal-tables-of-the-same-type-whose-line-type-does-not-contain-any-table-types--only-the-internal-administration-functions-are-passed-to-the--table-body--https---help-sap-com-doc-abapdocu-757-index-htm-7-57-en-us-abentable-body-glosry-htm--glossary-entry---for-performance-reasons---table-sharing--https---help-sap-com-doc-abapdocu-757-index-htm-7-57-en-us-abentable-sharing-glosry-htm--glossary-entry---is-revoked-only-when-write-access-to-one-of-the-tables-involved-is-initiated--the-actual-copy-process-then-takes-place---initial-memory-requirement-----internal-tables-are--dynamic-data-objects--https---help-sap-com-doc-abapdocu-757-index-htm-7-57-en-us-abendynamic-data-object-glosry-htm--glossary-entry---whose-area-in-the-memory-is-extended-block-by-block--the-size-of-the-first-block-in-the-memory-is-called--initial-memory-requirement--https---help-sap-com-doc-abapdocu-757-index-htm-7-57-en-us-abeninitial-mem-req-glosry-htm--glossary-entry---and-can-be-affected-in-the-declaration-of-an-internal-table-using-the-additions--initial-size--https---help-sap-com-doc-abapdocu-757-index-htm-7-57-en-us-abaptypes-itab-htm--and-the-obsolete--occurs--https---help-sap-com-doc-abapdocu-757-index-htm-7-57-en-us-abapdata-occurs-htm----it-is-usually-up-to-the-system-to-determine-the-size-of-the-first-block--initial-size-is-not-used-or-specified-with-the-value-0--in-this-case--a-suitable-block-size-is-chosen-the-first-time-lines-are-added-to-an-internal-table---specifying-a-concrete-value-greater-than-0-after-initial-size-is-only-practical-if-it-is-known-in-advance-how-many-entries-are-to-be-made-in-the-table--and-the-first-block-is-therefore-to-be-created-with-the-most-suitable-dimensions--this-can-be-particularly-important-for-internal-tables-that-are-components-of-other-internal-tables--and-which-only-contain-a-few-lines--no-more-than-around-5----to-avoid-excessive-memory-demands--the-system-ignores-values-that-produce-memory-demands-greater-than-the-constant-block-size---index-administration-----in-an--index-table--https---help-sap-com-doc-abapdocu-757-index-htm-7-57-en-us-abenindex-table-glosry-htm--glossary-entry----the-logical-order-of-the-table-entries-is-not-generally-consistent-with-the-physical-order-of-the-entries-in-the-main-memory--in-this-case--the-logical-order-is-no-longer-administrated-by-a-physical-index--but-by-a-logical-index--the-same-basically-applies-to-the--secondary-table-indexes--https---help-sap-com-doc-abapdocu-757-index-htm-7-57-en-us-abensecondary-table-index-glosry-htm--glossary-entry---used-to-manage--secondary--https---help-sap-com-doc-abapdocu-757-index-htm-7-57-en-us-abensecondary-table-key-glosry-htm--glossary-entry----sorted-keys--https---help-sap-com-doc-abapdocu-757-index-htm-7-57-en-us-abensorted-key-glosry-htm--glossary-entry-----use-of-the-logical-index-produces-additional-memory-requirements--and-index-maintenance-places-a-high-demand-on-resources--time-and-memory--when-inserting-or-deleting-table-lines--the-resource-requirements-increase-proportionally-with-the-number-of-remaining-lines-after-the-insertion-or-deletion-position--for-very-large-internal-tables--this-can-result-in-considerable-demands-on-performance-at-runtime---the-logical-index-is-only-created-when-it-is-needed--that-is--when-a-line-is-inserted-in-front-of-another-line--if-the-order-of-the-table-lines-is-changed--or-a-line-other-than-the-last-line-is-deleted--a-logical-index-is-not-required-if-an-internal-table-is-filled-using-only--append--https---help-sap-com-doc-abapdocu-757-index-htm-7-57-en-us-abapappend-htm---and-if-only-its-last-line-or-lines-is-are-deleted-using--delete--https---help-sap-com-doc-abapdocu-757-index-htm-7-57-en-us-abapdelete-itab-htm----hint--in-contrast-to-filling-a-table-with--insert--https---help-sap-com-doc-abapdocu-757-index-htm-7-57-en-us-abapinsert-itab-htm---appending-lines-with--append--https---help-sap-com-doc-abapdocu-757-index-htm-7-57-en-us-abapappend-htm--does-not-require-any-resources-for-index-maintenance--it-is-therefore-preferable-to-use-append-instead-of-insert-to-create-a--standard-table--https---help-sap-com-doc-abapdocu-757-index-htm-7-57-en-us-abenstandard-table-glosry-htm--glossary-entry----this-is-possible-if-the-order-of-the-entries-is-not-important--or-if-entries-can-be-appended-in-the-correct-order---block-processing-of-table-lines-----if-entire-line-areas-of-a-table-can-be-processed-at-once--this-should-not-be-done-line-by-line--but-using-block-operations--block-operations-are-possible-using-the-from-and-to-additions-of-the-statements--insert--https---help-sap-com-doc-abapdocu-757-index-htm-7-57-en-us-abapinsert-itab-htm----append--https---help-sap-com-doc-abapdocu-757-index-htm-7-57-en-us-abapappend-htm--and--delete--https---help-sap-com-doc-abapdocu-757-index-htm-7-57-en-us-abapdelete-itab-htm---block-operations-are-also-more-efficient-than-single-record-operations-when-reading-from-or-modifying-database-tables-with--abap-sql--https---help-sap-com-doc-abapdocu-757-index-htm-7-57-en-us-abenabap-sql-glosry-htm--glossary-entry---statements-with-the-additions-from---appending---to-table---selective-data-transport-----if--when-reading-table-lines-using--read-table--https---help-sap-com-doc-abapdocu-757-index-htm-7-57-en-us-abapread-table-htm--or--loop-at--https---help-sap-com-doc-abapdocu-757-index-htm-7-57-en-us-abaploop-at-itab-htm---a-work-area-is-used-or-table-lines-can-be-changed-using--modify--https---help-sap-com-doc-abapdocu-757-index-htm-7-57-en-us-abapmodify-itab-htm--instead-of-direct-access--the-transporting-addition-can-be-used-to-prevent-unnecessary-assignments-of-table-components-to-the-work-area--this-can-lead-to-a-noticeable-improvement-in-performance--particularly-if-table-like-components-are-excluded-from-processing---using-secondary-keys-----the--use-of-secondary-table-keys--https---help-sap-com-doc-abapdocu-757-index-htm-7-57-en-us-abenitab-key-secondary-usage-htm--should-be-planned-and-executed-carefully-and-sparingly--the-time-gained-when-accessing-individual-lines-should-not-be-lost-again-by-the-increased-memory-and-time-requirements-for-managing-the-secondary-keys--secondary-keys-are-generally-recommended-for-internal-tables-that-are-filled-once-and-rarely-changed-during-program-execution---example--the-program-demo--secondary--keys-demonstrates-how-a-secondary-table-key-is-specified-and-the-resulting-performance-gain---deleting-table-lines-----when-lines-are-deleted-from-an-internal-table--administration-costs-are-incurred-for-all-table-keys-and-table-indexes--the-primary-key-and-all-unique-secondary-keys-are-updated-directly--but-non-unique-secondary-keys-are-updated-only-if-the-line-to-be-deleted-is-included-in-the-updated-part-of-an-associated-index---lazy-update--https---help-sap-com-doc-abapdocu-757-index-htm-7-57-en-us-abenlazy-update-glosry-htm--glossary-entry------it-should-be-noted-that--particularly-for-standard-tables--the-mean-runtime-of-the-statement--delete--https---help-sap-com-doc-abapdocu-757-index-htm-7-57-en-us-abapdelete-itab-htm--always-depends-linearly-on-the-number-of-table-lines--even-when-secondary-keys-are-specified-using--with-table-key--https---help-sap-com-doc-abapdocu-757-index-htm-7-57-en-us-abapdelete-itab-key-htm--or--using-key--https---help-sap-com-doc-abapdocu-757-index-htm-7-57-en-us-abapdelete-itab-key-htm---this-is-because-a-linear-search-is-required-to-update-the-primary-index--even-though-the-line-to-be-deleted-can-itself-be-found-quickly---deleting-lines-in-internal-tables-using--delete--https---help-sap-com-doc-abapdocu-757-index-htm-7-57-en-us-abapdelete-itab-htm--does-not-usually-release-any-memory-in-the-internal-table--statements-such-as--clear--https---help-sap-com-doc-abapdocu-757-index-htm-7-57-en-us-abapclear-htm--or--free--https---help-sap-com-doc-abapdocu-757-index-htm-7-57-en-us-abapfree-dataobject-htm--must-be-used-to-release-memory-in-internal-tables---free-key-specified-for-sorted-tables-and-hashed-tables-----when-using-the--read--https---help-sap-com-doc-abapdocu-757-index-htm-7-57-en-us-abapread-table-htm--statement-with-a-specified-free-key-of-the-form--with-key------https---help-sap-com-doc-abapdocu-757-index-htm-7-57-en-us-abapread-table-free-htm---the-search-is-optimized-in-all-cases-where-this-is-possible--that-is-------in--sorted-tables--https---help-sap-com-doc-abapdocu-757-index-htm-7-57-en-us-abensorted-table-glosry-htm--glossary-entry----if-any-initial-section-of-the--table-key--https---help-sap-com-doc-abapdocu-757-index-htm-7-57-en-us-abentable-key-glosry-htm--glossary-entry---or-the-complete-table-key-is-covered-by-the-specified-key------in--hashed-tables--https---help-sap-com-doc-abapdocu-757-index-htm-7-57-en-us-abenhashed-table-glosry-htm--glossary-entry----if-the-complete-table-key-is-covered---if-part-of-a-free-key-meets-these-conditions--this-partial-key-is-first-used-to-search-for-an-entry--in-sorted-tables--this-is-done-using-a-binary-search-with-a-logarithmic-consumption-of-resources--and-in-hashed-tables-using-a-hash-algorithm--that-is--with-constant-resource-consumption--if-an-entry-is-found--the-system-checks-whether-the-rest-of-the-key-conditions-are-also-met--this-means-that-over-specific-keys-in-particular-are-optimized---hint--see-also--optimization-of-the-where-condition--https---help-sap-com-doc-abapdocu-757-index-htm-7-57-en-us-abenitab-where-optimization-htm----sorting-----for-textual-sorting-of-an-internal-table-in-accordance-with-the-current--text-environment--https---help-sap-com-doc-abapdocu-757-index-htm-7-57-en-us-abentext-environment-glosry-htm--glossary-entry----it-can-be-more-efficient-to-use-the-statement--convert-text-into-sortable-code--https---help-sap-com-doc-abapdocu-757-index-htm-7-57-en-us-abapconvert-text-htm--instead-of--sort-as-text--https---help-sap-com-doc-abapdocu-757-index-htm-7-57-en-us-abapsort-itab-htm--in-the-following-cases-------if-an-internal-table-is-sorted-by-locale-and-then-searched-binarily-using-the-statement-read-table-or-using-a--table-expression--https---help-sap-com-doc-abapdocu-757-index-htm-7-57-en-us-abentable-expressions-htm-------an-internal-table-must-be-sorted-more-than-once------indexes-for-database-tables-should-be-structured-in-accordance-with-a-locale---continue--itab---optimizing-the-where-condition--https---help-sap-com-doc-abapdocu-757-index-htm-7-57-en-us-abenitab-where-optimization-htm--------abenitab-where-optimization-htm------title---hint--description------if-the-lines-selected-using-where-are-modified-or-deleted-using-modify-https---help-sap-com-doc-abapdocu-757-index-htm-7-57-en-us-abapmodify-itab-htm--or-delete-https---help-sap-com-doc-abapdocu-757-index-htm-7-57-en-us-abapdelete-itab-htm--and-not-just-read-using-loop-at-https---help-sap-com--version---7-57--category---general--type---abap-reference--sourceurl---https---help-sap-com-doc-abapdocu-757-index-htm-7-57-en-us-abenitab-where-optimization-htm--abapfile---abenitab-where-optimization-htm--keywords----select----update----delete----loop----do----if----case----try----catch----data----types----internal-table----abenitab----where----optimization---------------as-abap-release-757---copyright-2023-sap-se--all-rights-reserved----abap---keyword-documentation--https---help-sap-com-doc-abapdocu-757-index-htm-7-57-en-us-abenabap-htm------abap---programming-language--https---help-sap-com-doc-abapdocu-757-index-htm-7-57-en-us-abenabap-reference-htm------processing-internal-data--https---help-sap-com-doc-abapdocu-757-index-htm-7-57-en-us-abenabap-data-working-htm------internal-tables--itab---https---help-sap-com-doc-abapdocu-757-index-htm-7-57-en-us-abenitab-htm------itab---performance-notes--https---help-sap-com-doc-abapdocu-757-index-htm-7-57-en-us-abenitab-perfo-htm------------mail-gif-object-mail-gif-sap-language-en--feedback-mail-for-displayed-topic---mail-feedback--mailto-f1-helpsap.com?subject=Feedback on ABAP Documentation&body=Document: itab - Optimizing the WHERE Condition, ABENITAB_WHERE_OPTIMIZATION, 757%0D%0A%0D%0AEr
ror:%0D%0A%0D%0A%0D%0A%0D%0ASuggestion for improvement:)

itab - Optimizing the WHERE Condition

The statements [LOOP AT](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abaploop_at_itab.htm), [DELETE](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abapdelete_itab.htm), and [MODIFY](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abapmodify_itab.htm) can be specified together with a WHERE condition that selects specific lines of the internal table. Searches in a [standard table](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abenstandard_table_glosry.htm "Glossary Entry") using the [primary table key](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abenprimary_table_key_glosry.htm "Glossary Entry") are always linear and cannot be optimized. Searches using a [sorted key](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abensorted_key_glosry.htm "Glossary Entry") or a [hash key](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abenhash_key_glosry.htm "Glossary Entry"), however, can be optimized in certain circumstances. These keys are used for:

-   accessing a [sorted table](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abensorted_table_glosry.htm "Glossary Entry") using its primary key.
-   accessing a [hashed table](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abenhashed_table_glosry.htm "Glossary Entry") using its primary key.
-   accessing a table of any table type using a [secondary table key](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abensecondary_table_key_glosry.htm "Glossary Entry") specified by USING KEY.

The optimization takes place by mapping all [relational expressions](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abenrelational_expression_glosry.htm "Glossary Entry") or a group of the relational expressions in the WHERE condition to a specified key. This specified key performs a corresponding optimized key access (binary search or hash algorithm as in the statement [READ TABLE](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abapread_table.htm) or a [table expression](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abentable_expressions.htm)), to find one or more lines. The found line or lines are then checked using those remaining relational expressions from the WHERE condition that were not mapped to the specified key.

Prerequisites for the optimization are therefore:

-   The relational expressions of the WHERE condition can be transformed to a specified key.
-   The corresponding key access returns the same results as the evaluation of this part of the logical expression would. This is guaranteed only for compatible data types, since in the case of incompatible data types:
    -   the content of the specified data objects is converted to the data type of the columns before the evaluation in the case of key accesses.
    -   The [comparison rules](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abenlogexp_rules.htm) for incompatible data types apply when evaluating a [comparison expression](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abencomparison_expression_glosry.htm "Glossary Entry"). Here, all the data types involved play a part in determining which operand is converted into which comparison type.

If there are no or insufficient relational expressions to meet both of these prerequisites, no optimization is possible and the behavior is as follows:

-   If a sorted table or a hashed table is accessed using the primary table key, all lines of the internal table are checked as in a standard table.
-   If the table is read using a secondary table key, that is, if said key is specified after USING KEY, a syntax error or syntax check warning, or an exception is raised. Access using a secondary table key must always be executed in an optimized way.

The following sections describe exactly when an access can be optimized.

-   [Prerequisites for the Optimization of Hash Keys](#abenitab-where-optimization-1-------prerequisites-for-the-optimization-of-sorted-keys---@ITOC@@ABENITAB_WHERE_OPTIMIZATION_2)
-   [Requirements Made on the Operands](#@@ITOC@@ABENITAB_WHERE_OPTIMIZATION_3)

Hint

If the lines selected using WHERE are modified or deleted using [MODIFY](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abapmodify_itab.htm) or [DELETE](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abapdelete_itab.htm) and not just read using [LOOP AT](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abaploop_at_itab.htm), further update costs are incurred in addition to the search for the lines. When deleting lines from standard tables, it should be noted that searches using a secondary key optimize the selection of lines to be deleted, but not the update required for the primary key, which is usually performed using a linear search.

Prerequisites for the Optimization of Hash Keys   

In the case of [hash key](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abenhash_key_glosry.htm "Glossary Entry") accesses, there must be exactly one relational expression combined using AND for each component of the key. This expression is either

-   a [comparison expression](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abencomparison_expression_glosry.htm "Glossary Entry") with the comparison operator \= (or EQ), whose operands meet the requirements above or
-   a [predicate expression](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abenpredicate_expression_glosry.htm "Glossary Entry") IS INITIAL without the addition NOT.

These relational expressions construct the part of the logical expression used for the key access. This part must not contain duplicate key components. The remainder of the logical expression can contain any number of relational expressions combined using AND. Optimization may not be possible, however, if the Boolean operators NOT or OR are used. Key components may be used in the relational expressions not used for the key access.

Hint

Relational expressions other than comparisons using \= (or EQ) or predicate expressions IS INITIAL are not part of the key access. This applies particularly to the tabular comparison operator [IN range\_tab](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abenlogexp_select_option.htm), even if it can be traced back to optimizable comparisons.

Example

In the following example, the first two WHERE conditions can be optimized as key accesses with the secondary table key key. This is because:

1.  The optimizable conditions for b, d, and e cover the entire key.
2.  The optimizable conditions b, d, and e cover the entire key and a is a condition on a non-key column that is not involved in the part of the WHERE condition required for the optimization.
3.  The optimizable conditions b, d, and e cover the entire key and the other two conditions on the key columns b and d are not optimizable and are hence not involved in the part of the WHERE condition required for the optimization.

The next six WHERE conditions cannot be optimized and produce syntax errors. This is because:

1.  The key component d is not specified.
2.  A key component is combined using OR instead of AND.
3.  Two non-optimizable comparison operators are used.
4.  An operand of type i is used in the comparison b of type c, which does not meet the requirements made on the operands.
5.  The Boolean operator NOT is used in front of a key component.
6.  A further comparison is combined using OR.
7.  A further comparison is negated using NOT.
    
    DATA: BEGIN OF line,
            a TYPE c LENGTH 3,
            b TYPE c LENGTH 3,
            c TYPE c LENGTH 3,
            d TYPE c LENGTH 3,
            e TYPE c LENGTH 3,
            f TYPE c LENGTH 3,
          END OF line.
    DATA itab LIKE STANDARD TABLE OF line
                   WITH UNIQUE HASHED KEY key COMPONENTS b e d.
    DATA b\_tab LIKE RANGE OF line-b.
    LOOP AT itab INTO line USING KEY key
         WHERE b = '...' AND d = '...' AND e IS INITIAL.
    ENDLOOP.
    LOOP AT itab INTO line USING KEY key
         WHERE a = '...' AND b = '...' AND d = '...' AND e IS INITIAL.
    ENDLOOP.
    LOOP AT itab INTO line USING KEY key
         WHERE  b = '...' AND d = '...' AND e IS INITIAL AND
                b IN b\_tab AND d <> '...'.
    ENDLOOP.
    LOOP AT itab INTO line USING KEY key
         WHERE b = '...' AND e IS INITIAL.                     "syntax error
    ENDLOOP.
    LOOP AT itab INTO line USING KEY key
         WHERE b = '...' OR d = '...' AND e IS INITIAL OR      "syntax error
    ENDLOOP.
    LOOP AT itab INTO line USING KEY key
         WHERE b = '...' AND d <> '...' AND e IS NOT INITIAL.  "syntax error
    ENDLOOP.
    LOOP AT itab INTO line USING KEY key
         WHERE b = 333 AND d = '...' AND e IS INITIAL.         "syntax error
    ENDLOOP.
    LOOP AT itab INTO line USING KEY key
         WHERE b = '...'  AND NOT d = '...' AND e IS INITIAL.  "syntax error
    ENDLOOP.
    LOOP AT itab INTO line USING KEY key
         WHERE b = '...' AND d = '...' AND e IS INITIAL OR     "syntax error
               a = '...'.
    ENDLOOP.
    LOOP AT itab INTO line USING KEY key
         WHERE b = '...' AND d = '...' AND e IS INITIAL AND    "syntax error
               NOT a = '...'.
    ENDLOOP.
    

Prerequisites for the Optimization of Sorted Keys   

In the case of reads using a [sorted key](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abensorted_key_glosry.htm "Glossary Entry"), the same applies as to a hash key. The only difference is that only an initial section of the key consisting of at least one component needs to be covered rather than the entire key.

The internal table is accessed in part sequentially. The starting point for the processing of the table is determined by a binary search using the subconditions that cover the table key completely or partially. From the starting point onwards, the table is only processed for as long as these subconditions remain fulfilled.

Example

In the following example, the first five WHERE conditions can be optimized as key accesses with the secondary table key key. This is because:

1.  b is an initial part of the key.
2.  b is an initial part of the key and a is an independent condition.
3.  b and e are an initial part of the key.
4.  b, e, and d are an initial part of the key and the order in the WHERE condition is ignored.
5.  b is an initial part of the key and in this case, d is an independent condition, even though it is part of the key.

The next five WHERE conditions cannot be optimized and produce syntax errors. This is because:

1.  e is not an initial part of the key.
2.  No inequality comparison takes place.
3.  A comparison in a ranges table is specified.
4.  The Boolean operator NOT is used.
5.  An additional OR relationship is used.
    
    DATA: BEGIN OF line,
            a TYPE c LENGTH 3,
            b TYPE c LENGTH 3,
            c TYPE c LENGTH 3,
            d TYPE c LENGTH 3,
            e TYPE c LENGTH 3,
            f TYPE c LENGTH 3,
          END OF line.
    DATA itab LIKE STANDARD TABLE OF line
                   WITH UNIQUE SORTED KEY key COMPONENTS b e d.
    DATA b\_tab LIKE RANGE OF line-b.
    LOOP AT itab INTO line USING KEY key
                 WHERE b = '...'.
    ENDLOOP.
    LOOP AT itab INTO line USING KEY key
                 WHERE a = '...' AND b IS INITIAL.
    ENDLOOP.
    LOOP AT itab INTO line USING KEY key
                 WHERE b = '...' AND e = '...'.
    ENDLOOP.
    LOOP AT itab INTO line USING KEY key
                 WHERE b = '...' AND d IS INITIAL AND e = '...'.
    ENDLOOP.
    LOOP AT itab INTO line USING KEY key
                 WHERE b = '...' AND d <> '...'.
    ENDLOOP.
    LOOP AT itab INTO line USING KEY key
                 WHERE e = '...'.                    "syntax error
    ENDLOOP.
    LOOP AT itab INTO line USING KEY key
                 WHERE b <> '...'.                   "syntax error
    ENDLOOP.
    LOOP AT itab INTO line USING KEY key
                 WHERE b IN b\_tab.                   "syntax error
    ENDLOOP.
    LOOP AT itab INTO line USING KEY key
                 WHERE b = '...'  AND NOT e = '...'. "syntax error
    ENDLOOP.
    LOOP AT itab INTO line USING KEY key             "syntax error
                 WHERE b = '...'  AND ( d = '...' OR e IS INITIAL ).
    ENDLOOP.
    

Requirements Made on the Operands   

The part of the logical expression that can be mapped to a key access must select the same lines as a statement [READ TABLE](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abapread_table.htm) or a corresponding [table expression](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abentable_expressions.htm) that specifies the corresponding components as keys.

-   When comparing incompatible data objects, the WHERE condition is subject to the same [comparison rules](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abenlogexp_rules.htm) for incompatible data types. Here, the data types involved determine which operand is converted to which comparison type.
-   If the additions [WITH TABLE KEY](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abapread_table_key.htm) and [WITH KEY](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abapread_table_free.htm) of the statement READ or [KEY](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abentable_exp_itab_line.htm) in a table expression are used, however, the content of the specified data objects is always converted to the data type of the columns before the comparison.

If this produces differing results, an optimization is not possible. Due to the complexity of the comparison rules, particularly for [elementary data types](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abenlogexp_rules_operands.htm), it is not a good idea to construct a set of rules detailing exactly when the comparison type matches the data type of the left operand. Generally speaking,

-   only fully compatible operands are optimizable,
-   in some cases, elementary operands with different data types can be optimized, if the value ranges or lengths are suitable. For example, a comparison of a column with the type of a floating point number with an operand of type integer or of a column of c with a similar operand, if its length is less than the length of the column.

For this reason, it is advisable to use only pairs of [compatible](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abencompatible_glosry.htm "Glossary Entry") operands in the WHERE condition. This guarantees that the differences in behavior of the WHERE condition and the specified key do not affect the result.

Example

The following example is largely similar to the example in the section WHERE log\_exp in [LOOP AT itab](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abaploop_at_itab_cond.htm). In that case, access takes place using the primary key and no optimization. Here, however, access takes place using a secondary table key and a syntax check warning is produced and an exception raised when the program is executed. The number of lines in the internal table determines whether the exception is raised.

DATA text\_short TYPE c LENGTH 2.
DATA text\_long  TYPE c LENGTH 4.
DATA itab LIKE TABLE OF text\_short
          WITH UNIQUE HASHED KEY key COMPONENTS table\_line.
itab = VALUE #( ( 'AA' )
                ( 'BB' )
                ( 'CC' )
                ( 'DD' )
                ( 'EE' )
                ( 'FF' )
                ( 'GG' )
                ( 'HH' )
                ( 'II' )
                ( 'JJ' )
                ( 'KK' )
                ( 'LL' )
                ( 'MM' ) ).
text\_short = 'AA'.
text\_long  = 'AAXX'.
LOOP AT itab INTO text\_short USING KEY key
             WHERE table\_line = text\_long.
ENDLOOP.
cl\_demo\_output=>write( |LOOP: { sy-subrc }| ).
"Statement
READ TABLE itab INTO text\_short WITH TABLE KEY key
                                COMPONENTS table\_line = text\_long.
cl\_demo\_output=>write( |READ: { sy-subrc }| ).
"Expression
TRY.
    text\_short = itab\[ KEY key COMPONENTS table\_line = text\_long \].
  catch CX\_SY\_ITAB\_LINE\_NOT\_FOUND.
    ...
ENDTRY.
cl\_demo\_output=>display( |Expression: { text\_short }| ).


---


## ABAP - Keyword Documentation / ABAP - Programming Language / Processing Internal Data / Internal Tables (itab) / itab - Processing Statements / DELETE itab / DELETE itab, itab_line

**Files**: 5 | **Difficulty**: intermediate

# ABAP - Keyword Documentation / ABAP - Programming Language / Processing Internal Data / Internal Tables (itab) / itab - Performance Notes

Included pages: 2


### abenitab_perfo.htm

---
title: "Table Sharing"
description: |
  When assignments are made between internal tables of the same type whose line type does not contain any table types, only the internal administration functions are passed to the table body(https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abentable_body_glosry.htm 'Glossary Entry') for pe
version: "7.57"
category: "data-structures"
type: "abap-reference"
sourceUrl: "https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abenitab_perfo.htm"
abapFile: "abenitab_perfo.htm"
keywords: ["select", "insert", "update", "delete", "loop", "do", "if", "case", "try", "data", "types", "internal-table", "abenitab", "perfo"]
---

* * *

AS ABAP Release 757, ©Copyright 2023 SAP SE. All rights reserved.

[ABAP - Keyword Documentation](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abenabap.htm) →  [ABAP - Programming Language](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abenabap_reference.htm) →  [Processing Internal Data](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abenabap_data_working.htm) →  [Internal Tables (itab)](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abenitab.htm) → 

 [![](Mail.gif?object=Mail.gif&sap-language=EN "Feedback mail for displayed topic") Mail Feedback](mailto:f1_help@sap.com?subject=Feedback on ABAP Documentation&body=Document: itab - Performance Notes, ABENITAB_PERFO, 757%0D%0A%0D%0AError:%0D%0A%0D%0A%0D%0A%0D%
0ASuggestion for improvement:)

itab - Performance Notes

-   [Table Sharing](#abenitab-perfo-1-------initial-memory-requirement---@ITOC@@ABENITAB_PERFO_2)
-   [Index Administration](#abenitab-perfo-3-------block-processing-of-table-lines---@ITOC@@ABENITAB_PERFO_4)
-   [Selective Data Transport](#abenitab-perfo-5-------using-secondary-keys---@ITOC@@ABENITAB_PERFO_6)
-   [Deleting Table Lines](#abenitab-perfo-7-------free-key-specified-for-sorted-tables-and-hashed-tables---@ITOC@@ABENITAB_PERFO_8)
-   [Sorting](#abenitab-perfo-9---table-sharing-----when-assignments-are-made-between-internal-tables-of-the-same-type-whose-line-type-does-not-contain-any-table-types--only-the-internal-administration-functions-are-passed-to-the--table-body--https---help-sap-com-doc-abapdocu-757-index-htm-7-57-en-us-abentable-body-glosry-htm--glossary-entry---for-performance-reasons---table-sharing--https---help-sap-com-doc-abapdocu-757-index-htm-7-57-en-us-abentable-sharing-glosry-htm--glossary-entry---is-revoked-only-when-write-access-to-one-of-the-tables-involved-is-initiated--the-actual-copy-process-then-takes-place---initial-memory-requirement-----internal-tables-are--dynamic-data-objects--https---help-sap-com-doc-abapdocu-757-index-htm-7-57-en-us-abendynamic-data-object-glosry-htm--glossary-entry---whose-area-in-the-memory-is-extended-block-by-block--the-size-of-the-first-block-in-the-memory-is-called--initial-memory-requirement--https---help-sap-com-doc-abapdocu-757-index-htm-7-57-en-us-abeninitial-mem-req-glosry-htm--glossary-entry---and-can-be-affected-in-the-declaration-of-an-internal-table-using-the-additions--initial-size--https---help-sap-com-doc-abapdocu-757-index-htm-7-57-en-us-abaptypes-itab-htm--and-the-obsolete--occurs--https---help-sap-com-doc-abapdocu-757-index-htm-7-57-en-us-abapdata-occurs-htm----it-is-usually-up-to-the-system-to-determine-the-size-of-the-first-block--initial-size-is-not-used-or-specified-with-the-value-0--in-this-case--a-suitable-block-size-is-chosen-the-first-time-lines-are-added-to-an-internal-table---specifying-a-concrete-value-greater-than-0-after-initial-size-is-only-practical-if-it-is-known-in-advance-how-many-entries-are-to-be-made-in-the-table--and-the-first-block-is-therefore-to-be-created-with-the-most-suitable-dimensions--this-can-be-particularly-important-for-internal-tables-that-are-components-of-other-internal-tables--and-which-only-contain-a-few-lines--no-more-than-around-5----to-avoid-excessive-memory-demands--the-system-ignores-values-that-produce-memory-demands-greater-than-the-constant-block-size---index-administration-----in-an--index-table--https---help-sap-com-doc-abapdocu-757-index-htm-7-57-en-us-abenindex-table-glosry-htm--glossary-entry----the-logical-order-of-the-table-entries-is-not-generally-consistent-with-the-physical-order-of-the-entries-in-the-main-memory--in-this-case--the-logical-order-is-no-longer-administrated-by-a-physical-index--but-by-a-logical-index--the-same-basically-applies-to-the--secondary-table-indexes--https---help-sap-com-doc-abapdocu-757-index-htm-7-57-en-us-abensecondary-table-index-glosry-htm--glossary-entry---used-to-manage--secondary--https---help-sap-com-doc-abapdocu-757-index-htm-7-57-en-us-abensecondary-table-key-glosry-htm--glossary-entry----sorted-keys--https---help-sap-com-doc-abapdocu-757-index-htm-7-57-en-us-abensorted-key-glosry-htm--glossary-entry-----use-of-the-logical-index-produces-additional-memory-requirements--and-index-maintenance-places-a-high-demand-on-resources--time-and-memory--when-inserting-or-deleting-table-lines--the-resource-requirements-increase-proportionally-with-the-number-of-remaining-lines-after-the-insertion-or-deletion-position--for-very-large-internal-tables--this-can-result-in-considerable-demands-on-performance-at-runtime---the-logical-index-is-only-created-when-it-is-needed--that-is--when-a-line-is-inserted-in-front-of-another-line--if-the-order-of-the-table-lines-is-changed--or-a-line-other-than-the-last-line-is-deleted--a-logical-index-is-not-required-if-an-internal-table-is-filled-using-only--append--https---help-sap-com-doc-abapdocu-757-index-htm-7-57-en-us-abapappend-htm---and-if-only-its-last-line-or-lines-is-are-deleted-using--delete--https---help-sap-com-doc-abapdocu-757-index-htm-7-57-en-us-abapdelete-itab-htm----hint--in-contrast-to-filling-a-table-with--insert--https---help-sap-com-doc-abapdocu-757-index-htm-7-57-en-us-abapinsert-itab-htm---appending-lines-with--append--https---help-sap-com-doc-abapdocu-757-index-htm-7-57-en-us-abapappend-htm--does-not-require-any-resources-for-index-maintenance--it-is-therefore-preferable-to-use-append-instead-of-insert-to-create-a--standard-table--https---help-sap-com-doc-abapdocu-757-index-htm-7-57-en-us-abenstandard-table-glosry-htm--glossary-entry----this-is-possible-if-the-order-of-the-entries-is-not-important--or-if-entries-can-be-appended-in-the-correct-order---block-processing-of-table-lines-----if-entire-line-areas-of-a-table-can-be-processed-at-once--this-should-not-be-done-line-by-line--but-using-block-operations--block-operations-are-possible-using-the-from-and-to-additions-of-the-statements--insert--https---help-sap-com-doc-abapdocu-757-index-htm-7-57-en-us-abapinsert-itab-htm----append--https---help-sap-com-doc-abapdocu-757-index-htm-7-57-en-us-abapappend-htm--and--delete--https---help-sap-com-doc-abapdocu-757-index-htm-7-57-en-us-abapdelete-itab-htm---block-operations-are-also-more-efficient-than-single-record-operations-when-reading-from-or-modifying-database-tables-with--abap-sql--https---help-sap-com-doc-abapdocu-757-index-htm-7-57-en-us-abenabap-sql-glosry-htm--glossary-entry---statements-with-the-additions-from---appending---to-table---selective-data-transport-----if--when-reading-table-lines-using--read-table--https---help-sap-com-doc-abapdocu-757-index-htm-7-57-en-us-abapread-table-htm--or--loop-at--https---help-sap-com-doc-abapdocu-757-index-htm-7-57-en-us-abaploop-at-itab-htm---a-work-area-is-used-or-table-lines-can-be-changed-using--modify--https---help-sap-com-doc-abapdocu-757-index-htm-7-57-en-us-abapmodify-itab-htm--instead-of-direct-access--the-transporting-addition-can-be-used-to-prevent-unnecessary-assignments-of-table-components-to-the-work-area--this-can-lead-to-a-noticeable-improvement-in-performance--particularly-if-table-like-components-are-excluded-from-processing---using-secondary-keys-----the--use-of-secondary-table-keys--https---help-sap-com-doc-abapdocu-757-index-htm-7-57-en-us-abenitab-key-secondary-usage-htm--should-be-planned-and-executed-carefully-and-sparingly--the-time-gained-when-accessing-individual-lines-should-not-be-lost-again-by-the-increased-memory-and-time-requirements-for-managing-the-secondary-keys--secondary-keys-are-generally-recommended-for-internal-tables-that-are-filled-once-and-rarely-changed-during-program-execution---example--the-program-demo--secondary--keys-demonstrates-how-a-secondary-table-key-is-specified-and-the-resulting-performance-gain---deleting-table-lines-----when-lines-are-deleted-from-an-internal-table--administration-costs-are-incurred-for-all-table-keys-and-table-indexes--the-primary-key-and-all-unique-secondary-keys-are-updated-directly--but-non-unique-secondary-keys-are-updated-only-if-the-line-to-be-deleted-is-included-in-the-updated-part-of-an-associated-index---lazy-update--https---help-sap-com-doc-abapdocu-757-index-htm-7-57-en-us-abenlazy-update-glosry-htm--glossary-entry------it-should-be-noted-that--particularly-for-standard-tables--the-mean-runtime-of-the-statement--delete--https---help-sap-com-doc-abapdocu-757-index-htm-7-57-en-us-abapdelete-itab-htm--always-depends-linearly-on-the-number-of-table-lines--even-when-secondary-keys-are-specified-using--with-table-key--https---help-sap-com-doc-abapdocu-757-index-htm-7-57-en-us-abapdelete-itab-key-htm--or--using-key--https---help-sap-com-doc-abapdocu-757-index-htm-7-57-en-us-abapdelete-itab-key-htm---this-is-because-a-linear-search-is-required-to-update-the-primary-index--even-though-the-line-to-be-deleted-can-itself-be-found-quickly---deleting-lines-in-internal-tables-using--delete--https---help-sap-com-doc-abapdocu-757-index-htm-7-57-en-us-abapdelete-itab-htm--does-not-usually-release-any-memory-in-the-internal-table--statements-such-as--clear--https---help-sap-com-doc-abapdocu-757-index-htm-7-57-en-us-abapclear-htm--or--free--https---help-sap-com-doc-abapdocu-757-index-htm-7-57-en-us-abapfree-dataobject-htm--must-be-used-to-release-memory-in-internal-tables---free-key-specified-for-sorted-tables-and-hashed-tables-----when-using-the--read--https---help-sap-com-doc-abapdocu-757-index-htm-7-57-en-us-abapread-table-htm--statement-with-a-specified-free-key-of-the-form--with-key------https---help-sap-com-doc-abapdocu-757-index-htm-7-57-en-us-abapread-table-free-htm---the-search-is-optimized-in-all-cases-where-this-is-possible--that-is-------in--sorted-tables--https---help-sap-com-doc-abapdocu-757-index-htm-7-57-en-us-abensorted-table-glosry-htm--glossary-entry----if-any-initial-section-of-the--table-key--https---help-sap-com-doc-abapdocu-757-index-htm-7-57-en-us-abentable-key-glosry-htm--glossary-entry---or-the-complete-table-key-is-covered-by-the-specified-key------in--hashed-tables--https---help-sap-com-doc-abapdocu-757-index-htm-7-57-en-us-abenhashed-table-glosry-htm--glossary-entry----if-the-complete-table-key-is-covered---if-part-of-a-free-key-meets-these-conditions--this-partial-key-is-first-used-to-search-for-an-entry--in-sorted-tables--this-is-done-using-a-binary-search-with-a-logarithmic-consumption-of-resources--and-in-hashed-tables-using-a-hash-algorithm--that-is--with-constant-resource-consumption--if-an-entry-is-found--the-system-checks-whether-the-rest-of-the-key-conditions-are-also-met--this-means-that-over-specific-keys-in-particular-are-optimized---hint--see-also--optimization-of-the-where-condition--https---help-sap-com-doc-abapdocu-757-index-htm-7-57-en-us-abenitab-where-optimization-htm----sorting-----for-textual-sorting-of-an-internal-table-in-accordance-with-the-current--text-environment--https---help-sap-com-doc-abapdocu-757-index-htm-7-57-en-us-abentext-environment-glosry-htm--glossary-entry----it-can-be-more-efficient-to-use-the-statement--convert-text-into-sortable-code--https---help-sap-com-doc-abapdocu-757-index-htm-7-57-en-us-abapconvert-text-htm--instead-of--sort-as-text--https---help-sap-com-doc-abapdocu-757-index-htm-7-57-en-us-abapsort-itab-htm--in-the-following-cases-------if-an-internal-table-is-sorted-by-locale-and-then-searched-binarily-using-the-statement-read-table-or-using-a--table-expression--https---help-sap-com-doc-abapdocu-757-index-htm-7-57-en-us-abentable-expressions-htm-------an-internal-table-must-be-sorted-more-than-once------indexes-for-database-tables-should-be-structured-in-accordance-with-a-locale---continue--itab---optimizing-the-where-condition--https---help-sap-com-doc-abapdocu-757-index-htm-7-57-en-us-abenitab-where-optimization-htm--------abenitab-where-optimization-htm------title---hint--description------if-the-lines-selected-using-where-are-modified-or-deleted-using-modify-https---help-sap-com-doc-abapdocu-757-index-htm-7-57-en-us-abapmodify-itab-htm--or-delete-https---help-sap-com-doc-abapdocu-757-index-htm-7-57-en-us-abapdelete-itab-htm--and-not-just-read-using-loop-at-https---help-sap-com--version---7-57--category---general--type---abap-reference--sourceurl---https---help-sap-com-doc-abapdocu-757-index-htm-7-57-en-us-abenitab-where-optimization-htm--abapfile---abenitab-where-optimization-htm--keywords----select----update----delete----loop----do----if----case----try----catch----data----types----internal-table----abenitab----where----optimization---------------as-abap-release-757---copyright-2023-sap-se--all-rights-reserved----abap---keyword-documentation--https---help-sap-com-doc-abapdocu-757-index-htm-7-57-en-us-abenabap-htm------abap---programming-language--https---help-sap-com-doc-abapdocu-757-index-htm-7-57-en-us-abenabap-reference-htm------processing-internal-data--https---help-sap-com-doc-abapdocu-757-index-htm-7-57-en-us-abenabap-data-working-htm------internal-tables--itab---https---help-sap-com-doc-abapdocu-757-index-htm-7-57-en-us-abenitab-htm------itab---performance-notes--https---help-sap-com-doc-abapdocu-757-index-htm-7-57-en-us-abenitab-perfo-htm------------mail-gif-object-mail-gif-sap-language-en--feedback-mail-for-displayed-topic---mail-feedback--mailto-f1-helpsap.com?subject=Feedback on ABAP Documentation&body=Document: itab - Optimizing the WHERE Condition, ABENITAB_WHERE_OPTIMIZATION, 757%0D%0A%0D%0AEr
ror:%0D%0A%0D%0A%0D%0A%0D%0ASuggestion for improvement:)

itab - Optimizing the WHERE Condition

The statements [LOOP AT](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abaploop_at_itab.htm), [DELETE](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abapdelete_itab.htm), and [MODIFY](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abapmodify_itab.htm) can be specified together with a WHERE condition that selects specific lines of the internal table. Searches in a [standard table](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abenstandard_table_glosry.htm "Glossary Entry") using the [primary table key](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abenprimary_table_key_glosry.htm "Glossary Entry") are always linear and cannot be optimized. Searches using a [sorted key](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abensorted_key_glosry.htm "Glossary Entry") or a [hash key](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abenhash_key_glosry.htm "Glossary Entry"), however, can be optimized in certain circumstances. These keys are used for:

-   accessing a [sorted table](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abensorted_table_glosry.htm "Glossary Entry") using its primary key.
-   accessing a [hashed table](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abenhashed_table_glosry.htm "Glossary Entry") using its primary key.
-   accessing a table of any table type using a [secondary table key](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abensecondary_table_key_glosry.htm "Glossary Entry") specified by USING KEY.

The optimization takes place by mapping all [relational expressions](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abenrelational_expression_glosry.htm "Glossary Entry") or a group of the relational expressions in the WHERE condition to a specified key. This specified key performs a corresponding optimized key access (binary search or hash algorithm as in the statement [READ TABLE](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abapread_table.htm) or a [table expression](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abentable_expressions.htm)), to find one or more lines. The found line or lines are then checked using those remaining relational expressions from the WHERE condition that were not mapped to the specified key.

Prerequisites for the optimization are therefore:

-   The relational expressions of the WHERE condition can be transformed to a specified key.
-   The corresponding key access returns the same results as the evaluation of this part of the logical expression would. This is guaranteed only for compatible data types, since in the case of incompatible data types:
    -   the content of the specified data objects is converted to the data type of the columns before the evaluation in the case of key accesses.
    -   The [comparison rules](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abenlogexp_rules.htm) for incompatible data types apply when evaluating a [comparison expression](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abencomparison_expression_glosry.htm "Glossary Entry"). Here, all the data types involved play a part in determining which operand is converted into which comparison type.

If there are no or insufficient relational expressions to meet both of these prerequisites, no optimization is possible and the behavior is as follows:

-   If a sorted table or a hashed table is accessed using the primary table key, all lines of the internal table are checked as in a standard table.
-   If the table is read using a secondary table key, that is, if said key is specified after USING KEY, a syntax error or syntax check warning, or an exception is raised. Access using a secondary table key must always be executed in an optimized way.

The following sections describe exactly when an access can be optimized.

-   [Prerequisites for the Optimization of Hash Keys](#abenitab-where-optimization-1-------prerequisites-for-the-optimization-of-sorted-keys---@ITOC@@ABENITAB_WHERE_OPTIMIZATION_2)
-   [Requirements Made on the Operands](#@@ITOC@@ABENITAB_WHERE_OPTIMIZATION_3)

Hint

If the lines selected using WHERE are modified or deleted using [MODIFY](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abapmodify_itab.htm) or [DELETE](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abapdelete_itab.htm) and not just read using [LOOP AT](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abaploop_at_itab.htm), further update costs are incurred in addition to the search for the lines. When deleting lines from standard tables, it should be noted that searches using a secondary key optimize the selection of lines to be deleted, but not the update required for the primary key, which is usually performed using a linear search.

Prerequisites for the Optimization of Hash Keys   

In the case of [hash key](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abenhash_key_glosry.htm "Glossary Entry") accesses, there must be exactly one relational expression combined using AND for each component of the key. This expression is either

-   a [comparison expression](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abencomparison_expression_glosry.htm "Glossary Entry") with the comparison operator \= (or EQ), whose operands meet the requirements above or
-   a [predicate expression](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abenpredicate_expression_glosry.htm "Glossary Entry") IS INITIAL without the addition NOT.

These relational expressions construct the part of the logical expression used for the key access. This part must not contain duplicate key components. The remainder of the logical expression can contain any number of relational expressions combined using AND. Optimization may not be possible, however, if the Boolean operators NOT or OR are used. Key components may be used in the relational expressions not used for the key access.

Hint

Relational expressions other than comparisons using \= (or EQ) or predicate expressions IS INITIAL are not part of the key access. This applies particularly to the tabular comparison operator [IN range\_tab](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abenlogexp_select_option.htm), even if it can be traced back to optimizable comparisons.

Example

In the following example, the first two WHERE conditions can be optimized as key accesses with the secondary table key key. This is because:

1.  The optimizable conditions for b, d, and e cover the entire key.
2.  The optimizable conditions b, d, and e cover the entire key and a is a condition on a non-key column that is not involved in the part of the WHERE condition required for the optimization.
3.  The optimizable conditions b, d, and e cover the entire key and the other two conditions on the key columns b and d are not optimizable and are hence not involved in the part of the WHERE condition required for the optimization.

The next six WHERE conditions cannot be optimized and produce syntax errors. This is because:

1.  The key component d is not specified.
2.  A key component is combined using OR instead of AND.
3.  Two non-optimizable comparison operators are used.
4.  An operand of type i is used in the comparison b of type c, which does not meet the requirements made on the operands.
5.  The Boolean operator NOT is used in front of a key component.
6.  A further comparison is combined using OR.
7.  A further comparison is negated using NOT.
    
    DATA: BEGIN OF line,
            a TYPE c LENGTH 3,
            b TYPE c LENGTH 3,
            c TYPE c LENGTH 3,
            d TYPE c LENGTH 3,
            e TYPE c LENGTH 3,
            f TYPE c LENGTH 3,
          END OF line.
    DATA itab LIKE STANDARD TABLE OF line
                   WITH UNIQUE HASHED KEY key COMPONENTS b e d.
    DATA b\_tab LIKE RANGE OF line-b.
    LOOP AT itab INTO line USING KEY key
         WHERE b = '...' AND d = '...' AND e IS INITIAL.
    ENDLOOP.
    LOOP AT itab INTO line USING KEY key
         WHERE a = '...' AND b = '...' AND d = '...' AND e IS INITIAL.
    ENDLOOP.
    LOOP AT itab INTO line USING KEY key
         WHERE  b = '...' AND d = '...' AND e IS INITIAL AND
                b IN b\_tab AND d <> '...'.
    ENDLOOP.
    LOOP AT itab INTO line USING KEY key
         WHERE b = '...' AND e IS INITIAL.                     "syntax error
    ENDLOOP.
    LOOP AT itab INTO line USING KEY key
         WHERE b = '...' OR d = '...' AND e IS INITIAL OR      "syntax error
    ENDLOOP.
    LOOP AT itab INTO line USING KEY key
         WHERE b = '...' AND d <> '...' AND e IS NOT INITIAL.  "syntax error
    ENDLOOP.
    LOOP AT itab INTO line USING KEY key
         WHERE b = 333 AND d = '...' AND e IS INITIAL.         "syntax error
    ENDLOOP.
    LOOP AT itab INTO line USING KEY key
         WHERE b = '...'  AND NOT d = '...' AND e IS INITIAL.  "syntax error
    ENDLOOP.
    LOOP AT itab INTO line USING KEY key
         WHERE b = '...' AND d = '...' AND e IS INITIAL OR     "syntax error
               a = '...'.
    ENDLOOP.
    LOOP AT itab INTO line USING KEY key
         WHERE b = '...' AND d = '...' AND e IS INITIAL AND    "syntax error
               NOT a = '...'.
    ENDLOOP.
    

Prerequisites for the Optimization of Sorted Keys   

In the case of reads using a [sorted key](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abensorted_key_glosry.htm "Glossary Entry"), the same applies as to a hash key. The only difference is that only an initial section of the key consisting of at least one component needs to be covered rather than the entire key.

The internal table is accessed in part sequentially. The starting point for the processing of the table is determined by a binary search using the subconditions that cover the table key completely or partially. From the starting point onwards, the table is only processed for as long as these subconditions remain fulfilled.

Example

In the following example, the first five WHERE conditions can be optimized as key accesses with the secondary table key key. This is because:

1.  b is an initial part of the key.
2.  b is an initial part of the key and a is an independent condition.
3.  b and e are an initial part of the key.
4.  b, e, and d are an initial part of the key and the order in the WHERE condition is ignored.
5.  b is an initial part of the key and in this case, d is an independent condition, even though it is part of the key.

The next five WHERE conditions cannot be optimized and produce syntax errors. This is because:

1.  e is not an initial part of the key.
2.  No inequality comparison takes place.
3.  A comparison in a ranges table is specified.
4.  The Boolean operator NOT is used.
5.  An additional OR relationship is used.
    
    DATA: BEGIN OF line,
            a TYPE c LENGTH 3,
            b TYPE c LENGTH 3,
            c TYPE c LENGTH 3,
            d TYPE c LENGTH 3,
            e TYPE c LENGTH 3,
            f TYPE c LENGTH 3,
          END OF line.
    DATA itab LIKE STANDARD TABLE OF line
                   WITH UNIQUE SORTED KEY key COMPONENTS b e d.
    DATA b\_tab LIKE RANGE OF line-b.
    LOOP AT itab INTO line USING KEY key
                 WHERE b = '...'.
    ENDLOOP.
    LOOP AT itab INTO line USING KEY key
                 WHERE a = '...' AND b IS INITIAL.
    ENDLOOP.
    LOOP AT itab INTO line USING KEY key
                 WHERE b = '...' AND e = '...'.
    ENDLOOP.
    LOOP AT itab INTO line USING KEY key
                 WHERE b = '...' AND d IS INITIAL AND e = '...'.
    ENDLOOP.
    LOOP AT itab INTO line USING KEY key
                 WHERE b = '...' AND d <> '...'.
    ENDLOOP.
    LOOP AT itab INTO line USING KEY key
                 WHERE e = '...'.                    "syntax error
    ENDLOOP.
    LOOP AT itab INTO line USING KEY key
                 WHERE b <> '...'.                   "syntax error
    ENDLOOP.
    LOOP AT itab INTO line USING KEY key
                 WHERE b IN b\_tab.                   "syntax error
    ENDLOOP.
    LOOP AT itab INTO line USING KEY key
                 WHERE b = '...'  AND NOT e = '...'. "syntax error
    ENDLOOP.
    LOOP AT itab INTO line USING KEY key             "syntax error
                 WHERE b = '...'  AND ( d = '...' OR e IS INITIAL ).
    ENDLOOP.
    

Requirements Made on the Operands   

The part of the logical expression that can be mapped to a key access must select the same lines as a statement [READ TABLE](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abapread_table.htm) or a corresponding [table expression](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abentable_expressions.htm) that specifies the corresponding components as keys.

-   When comparing incompatible data objects, the WHERE condition is subject to the same [comparison rules](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abenlogexp_rules.htm) for incompatible data types. Here, the data types involved determine which operand is converted to which comparison type.
-   If the additions [WITH TABLE KEY](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abapread_table_key.htm) and [WITH KEY](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abapread_table_free.htm) of the statement READ or [KEY](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abentable_exp_itab_line.htm) in a table expression are used, however, the content of the specified data objects is always converted to the data type of the columns before the comparison.

If this produces differing results, an optimization is not possible. Due to the complexity of the comparison rules, particularly for [elementary data types](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abenlogexp_rules_operands.htm), it is not a good idea to construct a set of rules detailing exactly when the comparison type matches the data type of the left operand. Generally speaking,

-   only fully compatible operands are optimizable,
-   in some cases, elementary operands with different data types can be optimized, if the value ranges or lengths are suitable. For example, a comparison of a column with the type of a floating point number with an operand of type integer or of a column of c with a similar operand, if its length is less than the length of the column.

For this reason, it is advisable to use only pairs of [compatible](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abencompatible_glosry.htm "Glossary Entry") operands in the WHERE condition. This guarantees that the differences in behavior of the WHERE condition and the specified key do not affect the result.

Example

The following example is largely similar to the example in the section WHERE log\_exp in [LOOP AT itab](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abaploop_at_itab_cond.htm). In that case, access takes place using the primary key and no optimization. Here, however, access takes place using a secondary table key and a syntax check warning is produced and an exception raised when the program is executed. The number of lines in the internal table determines whether the exception is raised.

DATA text\_short TYPE c LENGTH 2.
DATA text\_long  TYPE c LENGTH 4.
DATA itab LIKE TABLE OF text\_short
          WITH UNIQUE HASHED KEY key COMPONENTS table\_line.
itab = VALUE #( ( 'AA' )
                ( 'BB' )
                ( 'CC' )
                ( 'DD' )
                ( 'EE' )
                ( 'FF' )
                ( 'GG' )
                ( 'HH' )
                ( 'II' )
                ( 'JJ' )
                ( 'KK' )
                ( 'LL' )
                ( 'MM' ) ).
text\_short = 'AA'.
text\_long  = 'AAXX'.
LOOP AT itab INTO text\_short USING KEY key
             WHERE table\_line = text\_long.
ENDLOOP.
cl\_demo\_output=>write( |LOOP: { sy-subrc }| ).
"Statement
READ TABLE itab INTO text\_short WITH TABLE KEY key
                                COMPONENTS table\_line = text\_long.
cl\_demo\_output=>write( |READ: { sy-subrc }| ).
"Expression
TRY.
    text\_short = itab\[ KEY key COMPONENTS table\_line = text\_long \].
  catch CX\_SY\_ITAB\_LINE\_NOT\_FOUND.
    ...
ENDTRY.
cl\_demo\_output=>display( |Expression: { text\_short }| ).


---


## ABAP - Keyword Documentation / ABAP - Programming Language / Processing Internal Data / Internal Tables (itab) / itab - Processing Statements / DELETE itab / DELETE itab, itab_lines

**Files**: 2 | **Difficulty**: intermediate

# ABAP - Keyword Documentation / ABAP - Programming Language / Processing Internal Data / Internal Tables (itab) / itab - Performance Notes

Included pages: 2


### abenitab_perfo.htm

---
title: "Table Sharing"
description: |
  When assignments are made between internal tables of the same type whose line type does not contain any table types, only the internal administration functions are passed to the table body(https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abentable_body_glosry.htm 'Glossary Entry') for pe
version: "7.57"
category: "data-structures"
type: "abap-reference"
sourceUrl: "https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abenitab_perfo.htm"
abapFile: "abenitab_perfo.htm"
keywords: ["select", "insert", "update", "delete", "loop", "do", "if", "case", "try", "data", "types", "internal-table", "abenitab", "perfo"]
---

* * *

AS ABAP Release 757, ©Copyright 2023 SAP SE. All rights reserved.

[ABAP - Keyword Documentation](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abenabap.htm) →  [ABAP - Programming Language](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abenabap_reference.htm) →  [Processing Internal Data](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abenabap_data_working.htm) →  [Internal Tables (itab)](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abenitab.htm) → 

 [![](Mail.gif?object=Mail.gif&sap-language=EN "Feedback mail for displayed topic") Mail Feedback](mailto:f1_help@sap.com?subject=Feedback on ABAP Documentation&body=Document: itab - Performance Notes, ABENITAB_PERFO, 757%0D%0A%0D%0AError:%0D%0A%0D%0A%0D%0A%0D%
0ASuggestion for improvement:)

itab - Performance Notes

-   [Table Sharing](#abenitab-perfo-1-------initial-memory-requirement---@ITOC@@ABENITAB_PERFO_2)
-   [Index Administration](#abenitab-perfo-3-------block-processing-of-table-lines---@ITOC@@ABENITAB_PERFO_4)
-   [Selective Data Transport](#abenitab-perfo-5-------using-secondary-keys---@ITOC@@ABENITAB_PERFO_6)
-   [Deleting Table Lines](#abenitab-perfo-7-------free-key-specified-for-sorted-tables-and-hashed-tables---@ITOC@@ABENITAB_PERFO_8)
-   [Sorting](#abenitab-perfo-9---table-sharing-----when-assignments-are-made-between-internal-tables-of-the-same-type-whose-line-type-does-not-contain-any-table-types--only-the-internal-administration-functions-are-passed-to-the--table-body--https---help-sap-com-doc-abapdocu-757-index-htm-7-57-en-us-abentable-body-glosry-htm--glossary-entry---for-performance-reasons---table-sharing--https---help-sap-com-doc-abapdocu-757-index-htm-7-57-en-us-abentable-sharing-glosry-htm--glossary-entry---is-revoked-only-when-write-access-to-one-of-the-tables-involved-is-initiated--the-actual-copy-process-then-takes-place---initial-memory-requirement-----internal-tables-are--dynamic-data-objects--https---help-sap-com-doc-abapdocu-757-index-htm-7-57-en-us-abendynamic-data-object-glosry-htm--glossary-entry---whose-area-in-the-memory-is-extended-block-by-block--the-size-of-the-first-block-in-the-memory-is-called--initial-memory-requirement--https---help-sap-com-doc-abapdocu-757-index-htm-7-57-en-us-abeninitial-mem-req-glosry-htm--glossary-entry---and-can-be-affected-in-the-declaration-of-an-internal-table-using-the-additions--initial-size--https---help-sap-com-doc-abapdocu-757-index-htm-7-57-en-us-abaptypes-itab-htm--and-the-obsolete--occurs--https---help-sap-com-doc-abapdocu-757-index-htm-7-57-en-us-abapdata-occurs-htm----it-is-usually-up-to-the-system-to-determine-the-size-of-the-first-block--initial-size-is-not-used-or-specified-with-the-value-0--in-this-case--a-suitable-block-size-is-chosen-the-first-time-lines-are-added-to-an-internal-table---specifying-a-concrete-value-greater-than-0-after-initial-size-is-only-practical-if-it-is-known-in-advance-how-many-entries-are-to-be-made-in-the-table--and-the-first-block-is-therefore-to-be-created-with-the-most-suitable-dimensions--this-can-be-particularly-important-for-internal-tables-that-are-components-of-other-internal-tables--and-which-only-contain-a-few-lines--no-more-than-around-5----to-avoid-excessive-memory-demands--the-system-ignores-values-that-produce-memory-demands-greater-than-the-constant-block-size---index-administration-----in-an--index-table--https---help-sap-com-doc-abapdocu-757-index-htm-7-57-en-us-abenindex-table-glosry-htm--glossary-entry----the-logical-order-of-the-table-entries-is-not-generally-consistent-with-the-physical-order-of-the-entries-in-the-main-memory--in-this-case--the-logical-order-is-no-longer-administrated-by-a-physical-index--but-by-a-logical-index--the-same-basically-applies-to-the--secondary-table-indexes--https---help-sap-com-doc-abapdocu-757-index-htm-7-57-en-us-abensecondary-table-index-glosry-htm--glossary-entry---used-to-manage--secondary--https---help-sap-com-doc-abapdocu-757-index-htm-7-57-en-us-abensecondary-table-key-glosry-htm--glossary-entry----sorted-keys--https---help-sap-com-doc-abapdocu-757-index-htm-7-57-en-us-abensorted-key-glosry-htm--glossary-entry-----use-of-the-logical-index-produces-additional-memory-requirements--and-index-maintenance-places-a-high-demand-on-resources--time-and-memory--when-inserting-or-deleting-table-lines--the-resource-requirements-increase-proportionally-with-the-number-of-remaining-lines-after-the-insertion-or-deletion-position--for-very-large-internal-tables--this-can-result-in-considerable-demands-on-performance-at-runtime---the-logical-index-is-only-created-when-it-is-needed--that-is--when-a-line-is-inserted-in-front-of-another-line--if-the-order-of-the-table-lines-is-changed--or-a-line-other-than-the-last-line-is-deleted--a-logical-index-is-not-required-if-an-internal-table-is-filled-using-only--append--https---help-sap-com-doc-abapdocu-757-index-htm-7-57-en-us-abapappend-htm---and-if-only-its-last-line-or-lines-is-are-deleted-using--delete--https---help-sap-com-doc-abapdocu-757-index-htm-7-57-en-us-abapdelete-itab-htm----hint--in-contrast-to-filling-a-table-with--insert--https---help-sap-com-doc-abapdocu-757-index-htm-7-57-en-us-abapinsert-itab-htm---appending-lines-with--append--https---help-sap-com-doc-abapdocu-757-index-htm-7-57-en-us-abapappend-htm--does-not-require-any-resources-for-index-maintenance--it-is-therefore-preferable-to-use-append-instead-of-insert-to-create-a--standard-table--https---help-sap-com-doc-abapdocu-757-index-htm-7-57-en-us-abenstandard-table-glosry-htm--glossary-entry----this-is-possible-if-the-order-of-the-entries-is-not-important--or-if-entries-can-be-appended-in-the-correct-order---block-processing-of-table-lines-----if-entire-line-areas-of-a-table-can-be-processed-at-once--this-should-not-be-done-line-by-line--but-using-block-operations--block-operations-are-possible-using-the-from-and-to-additions-of-the-statements--insert--https---help-sap-com-doc-abapdocu-757-index-htm-7-57-en-us-abapinsert-itab-htm----append--https---help-sap-com-doc-abapdocu-757-index-htm-7-57-en-us-abapappend-htm--and--delete--https---help-sap-com-doc-abapdocu-757-index-htm-7-57-en-us-abapdelete-itab-htm---block-operations-are-also-more-efficient-than-single-record-operations-when-reading-from-or-modifying-database-tables-with--abap-sql--https---help-sap-com-doc-abapdocu-757-index-htm-7-57-en-us-abenabap-sql-glosry-htm--glossary-entry---statements-with-the-additions-from---appending---to-table---selective-data-transport-----if--when-reading-table-lines-using--read-table--https---help-sap-com-doc-abapdocu-757-index-htm-7-57-en-us-abapread-table-htm--or--loop-at--https---help-sap-com-doc-abapdocu-757-index-htm-7-57-en-us-abaploop-at-itab-htm---a-work-area-is-used-or-table-lines-can-be-changed-using--modify--https---help-sap-com-doc-abapdocu-757-index-htm-7-57-en-us-abapmodify-itab-htm--instead-of-direct-access--the-transporting-addition-can-be-used-to-prevent-unnecessary-assignments-of-table-components-to-the-work-area--this-can-lead-to-a-noticeable-improvement-in-performance--particularly-if-table-like-components-are-excluded-from-processing---using-secondary-keys-----the--use-of-secondary-table-keys--https---help-sap-com-doc-abapdocu-757-index-htm-7-57-en-us-abenitab-key-secondary-usage-htm--should-be-planned-and-executed-carefully-and-sparingly--the-time-gained-when-accessing-individual-lines-should-not-be-lost-again-by-the-increased-memory-and-time-requirements-for-managing-the-secondary-keys--secondary-keys-are-generally-recommended-for-internal-tables-that-are-filled-once-and-rarely-changed-during-program-execution---example--the-program-demo--secondary--keys-demonstrates-how-a-secondary-table-key-is-specified-and-the-resulting-performance-gain---deleting-table-lines-----when-lines-are-deleted-from-an-internal-table--administration-costs-are-incurred-for-all-table-keys-and-table-indexes--the-primary-key-and-all-unique-secondary-keys-are-updated-directly--but-non-unique-secondary-keys-are-updated-only-if-the-line-to-be-deleted-is-included-in-the-updated-part-of-an-associated-index---lazy-update--https---help-sap-com-doc-abapdocu-757-index-htm-7-57-en-us-abenlazy-update-glosry-htm--glossary-entry------it-should-be-noted-that--particularly-for-standard-tables--the-mean-runtime-of-the-statement--delete--https---help-sap-com-doc-abapdocu-757-index-htm-7-57-en-us-abapdelete-itab-htm--always-depends-linearly-on-the-number-of-table-lines--even-when-secondary-keys-are-specified-using--with-table-key--https---help-sap-com-doc-abapdocu-757-index-htm-7-57-en-us-abapdelete-itab-key-htm--or--using-key--https---help-sap-com-doc-abapdocu-757-index-htm-7-57-en-us-abapdelete-itab-key-htm---this-is-because-a-linear-search-is-required-to-update-the-primary-index--even-though-the-line-to-be-deleted-can-itself-be-found-quickly---deleting-lines-in-internal-tables-using--delete--https---help-sap-com-doc-abapdocu-757-index-htm-7-57-en-us-abapdelete-itab-htm--does-not-usually-release-any-memory-in-the-internal-table--statements-such-as--clear--https---help-sap-com-doc-abapdocu-757-index-htm-7-57-en-us-abapclear-htm--or--free--https---help-sap-com-doc-abapdocu-757-index-htm-7-57-en-us-abapfree-dataobject-htm--must-be-used-to-release-memory-in-internal-tables---free-key-specified-for-sorted-tables-and-hashed-tables-----when-using-the--read--https---help-sap-com-doc-abapdocu-757-index-htm-7-57-en-us-abapread-table-htm--statement-with-a-specified-free-key-of-the-form--with-key------https---help-sap-com-doc-abapdocu-757-index-htm-7-57-en-us-abapread-table-free-htm---the-search-is-optimized-in-all-cases-where-this-is-possible--that-is-------in--sorted-tables--https---help-sap-com-doc-abapdocu-757-index-htm-7-57-en-us-abensorted-table-glosry-htm--glossary-entry----if-any-initial-section-of-the--table-key--https---help-sap-com-doc-abapdocu-757-index-htm-7-57-en-us-abentable-key-glosry-htm--glossary-entry---or-the-complete-table-key-is-covered-by-the-specified-key------in--hashed-tables--https---help-sap-com-doc-abapdocu-757-index-htm-7-57-en-us-abenhashed-table-glosry-htm--glossary-entry----if-the-complete-table-key-is-covered---if-part-of-a-free-key-meets-these-conditions--this-partial-key-is-first-used-to-search-for-an-entry--in-sorted-tables--this-is-done-using-a-binary-search-with-a-logarithmic-consumption-of-resources--and-in-hashed-tables-using-a-hash-algorithm--that-is--with-constant-resource-consumption--if-an-entry-is-found--the-system-checks-whether-the-rest-of-the-key-conditions-are-also-met--this-means-that-over-specific-keys-in-particular-are-optimized---hint--see-also--optimization-of-the-where-condition--https---help-sap-com-doc-abapdocu-757-index-htm-7-57-en-us-abenitab-where-optimization-htm----sorting-----for-textual-sorting-of-an-internal-table-in-accordance-with-the-current--text-environment--https---help-sap-com-doc-abapdocu-757-index-htm-7-57-en-us-abentext-environment-glosry-htm--glossary-entry----it-can-be-more-efficient-to-use-the-statement--convert-text-into-sortable-code--https---help-sap-com-doc-abapdocu-757-index-htm-7-57-en-us-abapconvert-text-htm--instead-of--sort-as-text--https---help-sap-com-doc-abapdocu-757-index-htm-7-57-en-us-abapsort-itab-htm--in-the-following-cases-------if-an-internal-table-is-sorted-by-locale-and-then-searched-binarily-using-the-statement-read-table-or-using-a--table-expression--https---help-sap-com-doc-abapdocu-757-index-htm-7-57-en-us-abentable-expressions-htm-------an-internal-table-must-be-sorted-more-than-once------indexes-for-database-tables-should-be-structured-in-accordance-with-a-locale---continue--itab---optimizing-the-where-condition--https---help-sap-com-doc-abapdocu-757-index-htm-7-57-en-us-abenitab-where-optimization-htm--------abenitab-where-optimization-htm------title---hint--description------if-the-lines-selected-using-where-are-modified-or-deleted-using-modify-https---help-sap-com-doc-abapdocu-757-index-htm-7-57-en-us-abapmodify-itab-htm--or-delete-https---help-sap-com-doc-abapdocu-757-index-htm-7-57-en-us-abapdelete-itab-htm--and-not-just-read-using-loop-at-https---help-sap-com--version---7-57--category---general--type---abap-reference--sourceurl---https---help-sap-com-doc-abapdocu-757-index-htm-7-57-en-us-abenitab-where-optimization-htm--abapfile---abenitab-where-optimization-htm--keywords----select----update----delete----loop----do----if----case----try----catch----data----types----internal-table----abenitab----where----optimization---------------as-abap-release-757---copyright-2023-sap-se--all-rights-reserved----abap---keyword-documentation--https---help-sap-com-doc-abapdocu-757-index-htm-7-57-en-us-abenabap-htm------abap---programming-language--https---help-sap-com-doc-abapdocu-757-index-htm-7-57-en-us-abenabap-reference-htm------processing-internal-data--https---help-sap-com-doc-abapdocu-757-index-htm-7-57-en-us-abenabap-data-working-htm------internal-tables--itab---https---help-sap-com-doc-abapdocu-757-index-htm-7-57-en-us-abenitab-htm------itab---performance-notes--https---help-sap-com-doc-abapdocu-757-index-htm-7-57-en-us-abenitab-perfo-htm------------mail-gif-object-mail-gif-sap-language-en--feedback-mail-for-displayed-topic---mail-feedback--mailto-f1-helpsap.com?subject=Feedback on ABAP Documentation&body=Document: itab - Optimizing the WHERE Condition, ABENITAB_WHERE_OPTIMIZATION, 757%0D%0A%0D%0AEr
ror:%0D%0A%0D%0A%0D%0A%0D%0ASuggestion for improvement:)

itab - Optimizing the WHERE Condition

The statements [LOOP AT](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abaploop_at_itab.htm), [DELETE](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abapdelete_itab.htm), and [MODIFY](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abapmodify_itab.htm) can be specified together with a WHERE condition that selects specific lines of the internal table. Searches in a [standard table](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abenstandard_table_glosry.htm "Glossary Entry") using the [primary table key](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abenprimary_table_key_glosry.htm "Glossary Entry") are always linear and cannot be optimized. Searches using a [sorted key](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abensorted_key_glosry.htm "Glossary Entry") or a [hash key](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abenhash_key_glosry.htm "Glossary Entry"), however, can be optimized in certain circumstances. These keys are used for:

-   accessing a [sorted table](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abensorted_table_glosry.htm "Glossary Entry") using its primary key.
-   accessing a [hashed table](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abenhashed_table_glosry.htm "Glossary Entry") using its primary key.
-   accessing a table of any table type using a [secondary table key](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abensecondary_table_key_glosry.htm "Glossary Entry") specified by USING KEY.

The optimization takes place by mapping all [relational expressions](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abenrelational_expression_glosry.htm "Glossary Entry") or a group of the relational expressions in the WHERE condition to a specified key. This specified key performs a corresponding optimized key access (binary search or hash algorithm as in the statement [READ TABLE](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abapread_table.htm) or a [table expression](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abentable_expressions.htm)), to find one or more lines. The found line or lines are then checked using those remaining relational expressions from the WHERE condition that were not mapped to the specified key.

Prerequisites for the optimization are therefore:

-   The relational expressions of the WHERE condition can be transformed to a specified key.
-   The corresponding key access returns the same results as the evaluation of this part of the logical expression would. This is guaranteed only for compatible data types, since in the case of incompatible data types:
    -   the content of the specified data objects is converted to the data type of the columns before the evaluation in the case of key accesses.
    -   The [comparison rules](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abenlogexp_rules.htm) for incompatible data types apply when evaluating a [comparison expression](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abencomparison_expression_glosry.htm "Glossary Entry"). Here, all the data types involved play a part in determining which operand is converted into which comparison type.

If there are no or insufficient relational expressions to meet both of these prerequisites, no optimization is possible and the behavior is as follows:

-   If a sorted table or a hashed table is accessed using the primary table key, all lines of the internal table are checked as in a standard table.
-   If the table is read using a secondary table key, that is, if said key is specified after USING KEY, a syntax error or syntax check warning, or an exception is raised. Access using a secondary table key must always be executed in an optimized way.

The following sections describe exactly when an access can be optimized.

-   [Prerequisites for the Optimization of Hash Keys](#abenitab-where-optimization-1-------prerequisites-for-the-optimization-of-sorted-keys---@ITOC@@ABENITAB_WHERE_OPTIMIZATION_2)
-   [Requirements Made on the Operands](#@@ITOC@@ABENITAB_WHERE_OPTIMIZATION_3)

Hint

If the lines selected using WHERE are modified or deleted using [MODIFY](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abapmodify_itab.htm) or [DELETE](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abapdelete_itab.htm) and not just read using [LOOP AT](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abaploop_at_itab.htm), further update costs are incurred in addition to the search for the lines. When deleting lines from standard tables, it should be noted that searches using a secondary key optimize the selection of lines to be deleted, but not the update required for the primary key, which is usually performed using a linear search.

Prerequisites for the Optimization of Hash Keys   

In the case of [hash key](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abenhash_key_glosry.htm "Glossary Entry") accesses, there must be exactly one relational expression combined using AND for each component of the key. This expression is either

-   a [comparison expression](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abencomparison_expression_glosry.htm "Glossary Entry") with the comparison operator \= (or EQ), whose operands meet the requirements above or
-   a [predicate expression](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abenpredicate_expression_glosry.htm "Glossary Entry") IS INITIAL without the addition NOT.

These relational expressions construct the part of the logical expression used for the key access. This part must not contain duplicate key components. The remainder of the logical expression can contain any number of relational expressions combined using AND. Optimization may not be possible, however, if the Boolean operators NOT or OR are used. Key components may be used in the relational expressions not used for the key access.

Hint

Relational expressions other than comparisons using \= (or EQ) or predicate expressions IS INITIAL are not part of the key access. This applies particularly to the tabular comparison operator [IN range\_tab](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abenlogexp_select_option.htm), even if it can be traced back to optimizable comparisons.

Example

In the following example, the first two WHERE conditions can be optimized as key accesses with the secondary table key key. This is because:

1.  The optimizable conditions for b, d, and e cover the entire key.
2.  The optimizable conditions b, d, and e cover the entire key and a is a condition on a non-key column that is not involved in the part of the WHERE condition required for the optimization.
3.  The optimizable conditions b, d, and e cover the entire key and the other two conditions on the key columns b and d are not optimizable and are hence not involved in the part of the WHERE condition required for the optimization.

The next six WHERE conditions cannot be optimized and produce syntax errors. This is because:

1.  The key component d is not specified.
2.  A key component is combined using OR instead of AND.
3.  Two non-optimizable comparison operators are used.
4.  An operand of type i is used in the comparison b of type c, which does not meet the requirements made on the operands.
5.  The Boolean operator NOT is used in front of a key component.
6.  A further comparison is combined using OR.
7.  A further comparison is negated using NOT.
    
    DATA: BEGIN OF line,
            a TYPE c LENGTH 3,
            b TYPE c LENGTH 3,
            c TYPE c LENGTH 3,
            d TYPE c LENGTH 3,
            e TYPE c LENGTH 3,
            f TYPE c LENGTH 3,
          END OF line.
    DATA itab LIKE STANDARD TABLE OF line
                   WITH UNIQUE HASHED KEY key COMPONENTS b e d.
    DATA b\_tab LIKE RANGE OF line-b.
    LOOP AT itab INTO line USING KEY key
         WHERE b = '...' AND d = '...' AND e IS INITIAL.
    ENDLOOP.
    LOOP AT itab INTO line USING KEY key
         WHERE a = '...' AND b = '...' AND d = '...' AND e IS INITIAL.
    ENDLOOP.
    LOOP AT itab INTO line USING KEY key
         WHERE  b = '...' AND d = '...' AND e IS INITIAL AND
                b IN b\_tab AND d <> '...'.
    ENDLOOP.
    LOOP AT itab INTO line USING KEY key
         WHERE b = '...' AND e IS INITIAL.                     "syntax error
    ENDLOOP.
    LOOP AT itab INTO line USING KEY key
         WHERE b = '...' OR d = '...' AND e IS INITIAL OR      "syntax error
    ENDLOOP.
    LOOP AT itab INTO line USING KEY key
         WHERE b = '...' AND d <> '...' AND e IS NOT INITIAL.  "syntax error
    ENDLOOP.
    LOOP AT itab INTO line USING KEY key
         WHERE b = 333 AND d = '...' AND e IS INITIAL.         "syntax error
    ENDLOOP.
    LOOP AT itab INTO line USING KEY key
         WHERE b = '...'  AND NOT d = '...' AND e IS INITIAL.  "syntax error
    ENDLOOP.
    LOOP AT itab INTO line USING KEY key
         WHERE b = '...' AND d = '...' AND e IS INITIAL OR     "syntax error
               a = '...'.
    ENDLOOP.
    LOOP AT itab INTO line USING KEY key
         WHERE b = '...' AND d = '...' AND e IS INITIAL AND    "syntax error
               NOT a = '...'.
    ENDLOOP.
    

Prerequisites for the Optimization of Sorted Keys   

In the case of reads using a [sorted key](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abensorted_key_glosry.htm "Glossary Entry"), the same applies as to a hash key. The only difference is that only an initial section of the key consisting of at least one component needs to be covered rather than the entire key.

The internal table is accessed in part sequentially. The starting point for the processing of the table is determined by a binary search using the subconditions that cover the table key completely or partially. From the starting point onwards, the table is only processed for as long as these subconditions remain fulfilled.

Example

In the following example, the first five WHERE conditions can be optimized as key accesses with the secondary table key key. This is because:

1.  b is an initial part of the key.
2.  b is an initial part of the key and a is an independent condition.
3.  b and e are an initial part of the key.
4.  b, e, and d are an initial part of the key and the order in the WHERE condition is ignored.
5.  b is an initial part of the key and in this case, d is an independent condition, even though it is part of the key.

The next five WHERE conditions cannot be optimized and produce syntax errors. This is because:

1.  e is not an initial part of the key.
2.  No inequality comparison takes place.
3.  A comparison in a ranges table is specified.
4.  The Boolean operator NOT is used.
5.  An additional OR relationship is used.
    
    DATA: BEGIN OF line,
            a TYPE c LENGTH 3,
            b TYPE c LENGTH 3,
            c TYPE c LENGTH 3,
            d TYPE c LENGTH 3,
            e TYPE c LENGTH 3,
            f TYPE c LENGTH 3,
          END OF line.
    DATA itab LIKE STANDARD TABLE OF line
                   WITH UNIQUE SORTED KEY key COMPONENTS b e d.
    DATA b\_tab LIKE RANGE OF line-b.
    LOOP AT itab INTO line USING KEY key
                 WHERE b = '...'.
    ENDLOOP.
    LOOP AT itab INTO line USING KEY key
                 WHERE a = '...' AND b IS INITIAL.
    ENDLOOP.
    LOOP AT itab INTO line USING KEY key
                 WHERE b = '...' AND e = '...'.
    ENDLOOP.
    LOOP AT itab INTO line USING KEY key
                 WHERE b = '...' AND d IS INITIAL AND e = '...'.
    ENDLOOP.
    LOOP AT itab INTO line USING KEY key
                 WHERE b = '...' AND d <> '...'.
    ENDLOOP.
    LOOP AT itab INTO line USING KEY key
                 WHERE e = '...'.                    "syntax error
    ENDLOOP.
    LOOP AT itab INTO line USING KEY key
                 WHERE b <> '...'.                   "syntax error
    ENDLOOP.
    LOOP AT itab INTO line USING KEY key
                 WHERE b IN b\_tab.                   "syntax error
    ENDLOOP.
    LOOP AT itab INTO line USING KEY key
                 WHERE b = '...'  AND NOT e = '...'. "syntax error
    ENDLOOP.
    LOOP AT itab INTO line USING KEY key             "syntax error
                 WHERE b = '...'  AND ( d = '...' OR e IS INITIAL ).
    ENDLOOP.
    

Requirements Made on the Operands   

The part of the logical expression that can be mapped to a key access must select the same lines as a statement [READ TABLE](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abapread_table.htm) or a corresponding [table expression](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abentable_expressions.htm) that specifies the corresponding components as keys.

-   When comparing incompatible data objects, the WHERE condition is subject to the same [comparison rules](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abenlogexp_rules.htm) for incompatible data types. Here, the data types involved determine which operand is converted to which comparison type.
-   If the additions [WITH TABLE KEY](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abapread_table_key.htm) and [WITH KEY](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abapread_table_free.htm) of the statement READ or [KEY](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abentable_exp_itab_line.htm) in a table expression are used, however, the content of the specified data objects is always converted to the data type of the columns before the comparison.

If this produces differing results, an optimization is not possible. Due to the complexity of the comparison rules, particularly for [elementary data types](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abenlogexp_rules_operands.htm), it is not a good idea to construct a set of rules detailing exactly when the comparison type matches the data type of the left operand. Generally speaking,

-   only fully compatible operands are optimizable,
-   in some cases, elementary operands with different data types can be optimized, if the value ranges or lengths are suitable. For example, a comparison of a column with the type of a floating point number with an operand of type integer or of a column of c with a similar operand, if its length is less than the length of the column.

For this reason, it is advisable to use only pairs of [compatible](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abencompatible_glosry.htm "Glossary Entry") operands in the WHERE condition. This guarantees that the differences in behavior of the WHERE condition and the specified key do not affect the result.

Example

The following example is largely similar to the example in the section WHERE log\_exp in [LOOP AT itab](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abaploop_at_itab_cond.htm). In that case, access takes place using the primary key and no optimization. Here, however, access takes place using a secondary table key and a syntax check warning is produced and an exception raised when the program is executed. The number of lines in the internal table determines whether the exception is raised.

DATA text\_short TYPE c LENGTH 2.
DATA text\_long  TYPE c LENGTH 4.
DATA itab LIKE TABLE OF text\_short
          WITH UNIQUE HASHED KEY key COMPONENTS table\_line.
itab = VALUE #( ( 'AA' )
                ( 'BB' )
                ( 'CC' )
                ( 'DD' )
                ( 'EE' )
                ( 'FF' )
                ( 'GG' )
                ( 'HH' )
                ( 'II' )
                ( 'JJ' )
                ( 'KK' )
                ( 'LL' )
                ( 'MM' ) ).
text\_short = 'AA'.
text\_long  = 'AAXX'.
LOOP AT itab INTO text\_short USING KEY key
             WHERE table\_line = text\_long.
ENDLOOP.
cl\_demo\_output=>write( |LOOP: { sy-subrc }| ).
"Statement
READ TABLE itab INTO text\_short WITH TABLE KEY key
                                COMPONENTS table\_line = text\_long.
cl\_demo\_output=>write( |READ: { sy-subrc }| ).
"Expression
TRY.
    text\_short = itab\[ KEY key COMPONENTS table\_line = text\_long \].
  catch CX\_SY\_ITAB\_LINE\_NOT\_FOUND.
    ...
ENDTRY.
cl\_demo\_output=>display( |Expression: { text\_short }| ).


---


## ABAP - Keyword Documentation / ABAP - Programming Language / Processing Internal Data / Internal Tables (itab) / itab - Processing Statements / DELETE itab / DELETE itab, duplicates

**Files**: 2 | **Difficulty**: intermediate

# ABAP - Keyword Documentation / ABAP - Programming Language / Processing Internal Data / Internal Tables (itab) / itab - Performance Notes

Included pages: 2


### abenitab_perfo.htm

---
title: "Table Sharing"
description: |
  When assignments are made between internal tables of the same type whose line type does not contain any table types, only the internal administration functions are passed to the table body(https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abentable_body_glosry.htm 'Glossary Entry') for pe
version: "7.57"
category: "data-structures"
type: "abap-reference"
sourceUrl: "https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abenitab_perfo.htm"
abapFile: "abenitab_perfo.htm"
keywords: ["select", "insert", "update", "delete", "loop", "do", "if", "case", "try", "data", "types", "internal-table", "abenitab", "perfo"]
---

* * *

AS ABAP Release 757, ©Copyright 2023 SAP SE. All rights reserved.

[ABAP - Keyword Documentation](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abenabap.htm) →  [ABAP - Programming Language](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abenabap_reference.htm) →  [Processing Internal Data](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abenabap_data_working.htm) →  [Internal Tables (itab)](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abenitab.htm) → 

 [![](Mail.gif?object=Mail.gif&sap-language=EN "Feedback mail for displayed topic") Mail Feedback](mailto:f1_help@sap.com?subject=Feedback on ABAP Documentation&body=Document: itab - Performance Notes, ABENITAB_PERFO, 757%0D%0A%0D%0AError:%0D%0A%0D%0A%0D%0A%0D%
0ASuggestion for improvement:)

itab - Performance Notes

-   [Table Sharing](#abenitab-perfo-1-------initial-memory-requirement---@ITOC@@ABENITAB_PERFO_2)
-   [Index Administration](#abenitab-perfo-3-------block-processing-of-table-lines---@ITOC@@ABENITAB_PERFO_4)
-   [Selective Data Transport](#abenitab-perfo-5-------using-secondary-keys---@ITOC@@ABENITAB_PERFO_6)
-   [Deleting Table Lines](#abenitab-perfo-7-------free-key-specified-for-sorted-tables-and-hashed-tables---@ITOC@@ABENITAB_PERFO_8)
-   [Sorting](#abenitab-perfo-9---table-sharing-----when-assignments-are-made-between-internal-tables-of-the-same-type-whose-line-type-does-not-contain-any-table-types--only-the-internal-administration-functions-are-passed-to-the--table-body--https---help-sap-com-doc-abapdocu-757-index-htm-7-57-en-us-abentable-body-glosry-htm--glossary-entry---for-performance-reasons---table-sharing--https---help-sap-com-doc-abapdocu-757-index-htm-7-57-en-us-abentable-sharing-glosry-htm--glossary-entry---is-revoked-only-when-write-access-to-one-of-the-tables-involved-is-initiated--the-actual-copy-process-then-takes-place---initial-memory-requirement-----internal-tables-are--dynamic-data-objects--https---help-sap-com-doc-abapdocu-757-index-htm-7-57-en-us-abendynamic-data-object-glosry-htm--glossary-entry---whose-area-in-the-memory-is-extended-block-by-block--the-size-of-the-first-block-in-the-memory-is-called--initial-memory-requirement--https---help-sap-com-doc-abapdocu-757-index-htm-7-57-en-us-abeninitial-mem-req-glosry-htm--glossary-entry---and-can-be-affected-in-the-declaration-of-an-internal-table-using-the-additions--initial-size--https---help-sap-com-doc-abapdocu-757-index-htm-7-57-en-us-abaptypes-itab-htm--and-the-obsolete--occurs--https---help-sap-com-doc-abapdocu-757-index-htm-7-57-en-us-abapdata-occurs-htm----it-is-usually-up-to-the-system-to-determine-the-size-of-the-first-block--initial-size-is-not-used-or-specified-with-the-value-0--in-this-case--a-suitable-block-size-is-chosen-the-first-time-lines-are-added-to-an-internal-table---specifying-a-concrete-value-greater-than-0-after-initial-size-is-only-practical-if-it-is-known-in-advance-how-many-entries-are-to-be-made-in-the-table--and-the-first-block-is-therefore-to-be-created-with-the-most-suitable-dimensions--this-can-be-particularly-important-for-internal-tables-that-are-components-of-other-internal-tables--and-which-only-contain-a-few-lines--no-more-than-around-5----to-avoid-excessive-memory-demands--the-system-ignores-values-that-produce-memory-demands-greater-than-the-constant-block-size---index-administration-----in-an--index-table--https---help-sap-com-doc-abapdocu-757-index-htm-7-57-en-us-abenindex-table-glosry-htm--glossary-entry----the-logical-order-of-the-table-entries-is-not-generally-consistent-with-the-physical-order-of-the-entries-in-the-main-memory--in-this-case--the-logical-order-is-no-longer-administrated-by-a-physical-index--but-by-a-logical-index--the-same-basically-applies-to-the--secondary-table-indexes--https---help-sap-com-doc-abapdocu-757-index-htm-7-57-en-us-abensecondary-table-index-glosry-htm--glossary-entry---used-to-manage--secondary--https---help-sap-com-doc-abapdocu-757-index-htm-7-57-en-us-abensecondary-table-key-glosry-htm--glossary-entry----sorted-keys--https---help-sap-com-doc-abapdocu-757-index-htm-7-57-en-us-abensorted-key-glosry-htm--glossary-entry-----use-of-the-logical-index-produces-additional-memory-requirements--and-index-maintenance-places-a-high-demand-on-resources--time-and-memory--when-inserting-or-deleting-table-lines--the-resource-requirements-increase-proportionally-with-the-number-of-remaining-lines-after-the-insertion-or-deletion-position--for-very-large-internal-tables--this-can-result-in-considerable-demands-on-performance-at-runtime---the-logical-index-is-only-created-when-it-is-needed--that-is--when-a-line-is-inserted-in-front-of-another-line--if-the-order-of-the-table-lines-is-changed--or-a-line-other-than-the-last-line-is-deleted--a-logical-index-is-not-required-if-an-internal-table-is-filled-using-only--append--https---help-sap-com-doc-abapdocu-757-index-htm-7-57-en-us-abapappend-htm---and-if-only-its-last-line-or-lines-is-are-deleted-using--delete--https---help-sap-com-doc-abapdocu-757-index-htm-7-57-en-us-abapdelete-itab-htm----hint--in-contrast-to-filling-a-table-with--insert--https---help-sap-com-doc-abapdocu-757-index-htm-7-57-en-us-abapinsert-itab-htm---appending-lines-with--append--https---help-sap-com-doc-abapdocu-757-index-htm-7-57-en-us-abapappend-htm--does-not-require-any-resources-for-index-maintenance--it-is-therefore-preferable-to-use-append-instead-of-insert-to-create-a--standard-table--https---help-sap-com-doc-abapdocu-757-index-htm-7-57-en-us-abenstandard-table-glosry-htm--glossary-entry----this-is-possible-if-the-order-of-the-entries-is-not-important--or-if-entries-can-be-appended-in-the-correct-order---block-processing-of-table-lines-----if-entire-line-areas-of-a-table-can-be-processed-at-once--this-should-not-be-done-line-by-line--but-using-block-operations--block-operations-are-possible-using-the-from-and-to-additions-of-the-statements--insert--https---help-sap-com-doc-abapdocu-757-index-htm-7-57-en-us-abapinsert-itab-htm----append--https---help-sap-com-doc-abapdocu-757-index-htm-7-57-en-us-abapappend-htm--and--delete--https---help-sap-com-doc-abapdocu-757-index-htm-7-57-en-us-abapdelete-itab-htm---block-operations-are-also-more-efficient-than-single-record-operations-when-reading-from-or-modifying-database-tables-with--abap-sql--https---help-sap-com-doc-abapdocu-757-index-htm-7-57-en-us-abenabap-sql-glosry-htm--glossary-entry---statements-with-the-additions-from---appending---to-table---selective-data-transport-----if--when-reading-table-lines-using--read-table--https---help-sap-com-doc-abapdocu-757-index-htm-7-57-en-us-abapread-table-htm--or--loop-at--https---help-sap-com-doc-abapdocu-757-index-htm-7-57-en-us-abaploop-at-itab-htm---a-work-area-is-used-or-table-lines-can-be-changed-using--modify--https---help-sap-com-doc-abapdocu-757-index-htm-7-57-en-us-abapmodify-itab-htm--instead-of-direct-access--the-transporting-addition-can-be-used-to-prevent-unnecessary-assignments-of-table-components-to-the-work-area--this-can-lead-to-a-noticeable-improvement-in-performance--particularly-if-table-like-components-are-excluded-from-processing---using-secondary-keys-----the--use-of-secondary-table-keys--https---help-sap-com-doc-abapdocu-757-index-htm-7-57-en-us-abenitab-key-secondary-usage-htm--should-be-planned-and-executed-carefully-and-sparingly--the-time-gained-when-accessing-individual-lines-should-not-be-lost-again-by-the-increased-memory-and-time-requirements-for-managing-the-secondary-keys--secondary-keys-are-generally-recommended-for-internal-tables-that-are-filled-once-and-rarely-changed-during-program-execution---example--the-program-demo--secondary--keys-demonstrates-how-a-secondary-table-key-is-specified-and-the-resulting-performance-gain---deleting-table-lines-----when-lines-are-deleted-from-an-internal-table--administration-costs-are-incurred-for-all-table-keys-and-table-indexes--the-primary-key-and-all-unique-secondary-keys-are-updated-directly--but-non-unique-secondary-keys-are-updated-only-if-the-line-to-be-deleted-is-included-in-the-updated-part-of-an-associated-index---lazy-update--https---help-sap-com-doc-abapdocu-757-index-htm-7-57-en-us-abenlazy-update-glosry-htm--glossary-entry------it-should-be-noted-that--particularly-for-standard-tables--the-mean-runtime-of-the-statement--delete--https---help-sap-com-doc-abapdocu-757-index-htm-7-57-en-us-abapdelete-itab-htm--always-depends-linearly-on-the-number-of-table-lines--even-when-secondary-keys-are-specified-using--with-table-key--https---help-sap-com-doc-abapdocu-757-index-htm-7-57-en-us-abapdelete-itab-key-htm--or--using-key--https---help-sap-com-doc-abapdocu-757-index-htm-7-57-en-us-abapdelete-itab-key-htm---this-is-because-a-linear-search-is-required-to-update-the-primary-index--even-though-the-line-to-be-deleted-can-itself-be-found-quickly---deleting-lines-in-internal-tables-using--delete--https---help-sap-com-doc-abapdocu-757-index-htm-7-57-en-us-abapdelete-itab-htm--does-not-usually-release-any-memory-in-the-internal-table--statements-such-as--clear--https---help-sap-com-doc-abapdocu-757-index-htm-7-57-en-us-abapclear-htm--or--free--https---help-sap-com-doc-abapdocu-757-index-htm-7-57-en-us-abapfree-dataobject-htm--must-be-used-to-release-memory-in-internal-tables---free-key-specified-for-sorted-tables-and-hashed-tables-----when-using-the--read--https---help-sap-com-doc-abapdocu-757-index-htm-7-57-en-us-abapread-table-htm--statement-with-a-specified-free-key-of-the-form--with-key------https---help-sap-com-doc-abapdocu-757-index-htm-7-57-en-us-abapread-table-free-htm---the-search-is-optimized-in-all-cases-where-this-is-possible--that-is-------in--sorted-tables--https---help-sap-com-doc-abapdocu-757-index-htm-7-57-en-us-abensorted-table-glosry-htm--glossary-entry----if-any-initial-section-of-the--table-key--https---help-sap-com-doc-abapdocu-757-index-htm-7-57-en-us-abentable-key-glosry-htm--glossary-entry---or-the-complete-table-key-is-covered-by-the-specified-key------in--hashed-tables--https---help-sap-com-doc-abapdocu-757-index-htm-7-57-en-us-abenhashed-table-glosry-htm--glossary-entry----if-the-complete-table-key-is-covered---if-part-of-a-free-key-meets-these-conditions--this-partial-key-is-first-used-to-search-for-an-entry--in-sorted-tables--this-is-done-using-a-binary-search-with-a-logarithmic-consumption-of-resources--and-in-hashed-tables-using-a-hash-algorithm--that-is--with-constant-resource-consumption--if-an-entry-is-found--the-system-checks-whether-the-rest-of-the-key-conditions-are-also-met--this-means-that-over-specific-keys-in-particular-are-optimized---hint--see-also--optimization-of-the-where-condition--https---help-sap-com-doc-abapdocu-757-index-htm-7-57-en-us-abenitab-where-optimization-htm----sorting-----for-textual-sorting-of-an-internal-table-in-accordance-with-the-current--text-environment--https---help-sap-com-doc-abapdocu-757-index-htm-7-57-en-us-abentext-environment-glosry-htm--glossary-entry----it-can-be-more-efficient-to-use-the-statement--convert-text-into-sortable-code--https---help-sap-com-doc-abapdocu-757-index-htm-7-57-en-us-abapconvert-text-htm--instead-of--sort-as-text--https---help-sap-com-doc-abapdocu-757-index-htm-7-57-en-us-abapsort-itab-htm--in-the-following-cases-------if-an-internal-table-is-sorted-by-locale-and-then-searched-binarily-using-the-statement-read-table-or-using-a--table-expression--https---help-sap-com-doc-abapdocu-757-index-htm-7-57-en-us-abentable-expressions-htm-------an-internal-table-must-be-sorted-more-than-once------indexes-for-database-tables-should-be-structured-in-accordance-with-a-locale---continue--itab---optimizing-the-where-condition--https---help-sap-com-doc-abapdocu-757-index-htm-7-57-en-us-abenitab-where-optimization-htm--------abenitab-where-optimization-htm------title---hint--description------if-the-lines-selected-using-where-are-modified-or-deleted-using-modify-https---help-sap-com-doc-abapdocu-757-index-htm-7-57-en-us-abapmodify-itab-htm--or-delete-https---help-sap-com-doc-abapdocu-757-index-htm-7-57-en-us-abapdelete-itab-htm--and-not-just-read-using-loop-at-https---help-sap-com--version---7-57--category---general--type---abap-reference--sourceurl---https---help-sap-com-doc-abapdocu-757-index-htm-7-57-en-us-abenitab-where-optimization-htm--abapfile---abenitab-where-optimization-htm--keywords----select----update----delete----loop----do----if----case----try----catch----data----types----internal-table----abenitab----where----optimization---------------as-abap-release-757---copyright-2023-sap-se--all-rights-reserved----abap---keyword-documentation--https---help-sap-com-doc-abapdocu-757-index-htm-7-57-en-us-abenabap-htm------abap---programming-language--https---help-sap-com-doc-abapdocu-757-index-htm-7-57-en-us-abenabap-reference-htm------processing-internal-data--https---help-sap-com-doc-abapdocu-757-index-htm-7-57-en-us-abenabap-data-working-htm------internal-tables--itab---https---help-sap-com-doc-abapdocu-757-index-htm-7-57-en-us-abenitab-htm------itab---performance-notes--https---help-sap-com-doc-abapdocu-757-index-htm-7-57-en-us-abenitab-perfo-htm------------mail-gif-object-mail-gif-sap-language-en--feedback-mail-for-displayed-topic---mail-feedback--mailto-f1-helpsap.com?subject=Feedback on ABAP Documentation&body=Document: itab - Optimizing the WHERE Condition, ABENITAB_WHERE_OPTIMIZATION, 757%0D%0A%0D%0AEr
ror:%0D%0A%0D%0A%0D%0A%0D%0ASuggestion for improvement:)

itab - Optimizing the WHERE Condition

The statements [LOOP AT](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abaploop_at_itab.htm), [DELETE](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abapdelete_itab.htm), and [MODIFY](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abapmodify_itab.htm) can be specified together with a WHERE condition that selects specific lines of the internal table. Searches in a [standard table](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abenstandard_table_glosry.htm "Glossary Entry") using the [primary table key](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abenprimary_table_key_glosry.htm "Glossary Entry") are always linear and cannot be optimized. Searches using a [sorted key](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abensorted_key_glosry.htm "Glossary Entry") or a [hash key](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abenhash_key_glosry.htm "Glossary Entry"), however, can be optimized in certain circumstances. These keys are used for:

-   accessing a [sorted table](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abensorted_table_glosry.htm "Glossary Entry") using its primary key.
-   accessing a [hashed table](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abenhashed_table_glosry.htm "Glossary Entry") using its primary key.
-   accessing a table of any table type using a [secondary table key](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abensecondary_table_key_glosry.htm "Glossary Entry") specified by USING KEY.

The optimization takes place by mapping all [relational expressions](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abenrelational_expression_glosry.htm "Glossary Entry") or a group of the relational expressions in the WHERE condition to a specified key. This specified key performs a corresponding optimized key access (binary search or hash algorithm as in the statement [READ TABLE](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abapread_table.htm) or a [table expression](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abentable_expressions.htm)), to find one or more lines. The found line or lines are then checked using those remaining relational expressions from the WHERE condition that were not mapped to the specified key.

Prerequisites for the optimization are therefore:

-   The relational expressions of the WHERE condition can be transformed to a specified key.
-   The corresponding key access returns the same results as the evaluation of this part of the logical expression would. This is guaranteed only for compatible data types, since in the case of incompatible data types:
    -   the content of the specified data objects is converted to the data type of the columns before the evaluation in the case of key accesses.
    -   The [comparison rules](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abenlogexp_rules.htm) for incompatible data types apply when evaluating a [comparison expression](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abencomparison_expression_glosry.htm "Glossary Entry"). Here, all the data types involved play a part in determining which operand is converted into which comparison type.

If there are no or insufficient relational expressions to meet both of these prerequisites, no optimization is possible and the behavior is as follows:

-   If a sorted table or a hashed table is accessed using the primary table key, all lines of the internal table are checked as in a standard table.
-   If the table is read using a secondary table key, that is, if said key is specified after USING KEY, a syntax error or syntax check warning, or an exception is raised. Access using a secondary table key must always be executed in an optimized way.

The following sections describe exactly when an access can be optimized.

-   [Prerequisites for the Optimization of Hash Keys](#abenitab-where-optimization-1-------prerequisites-for-the-optimization-of-sorted-keys---@ITOC@@ABENITAB_WHERE_OPTIMIZATION_2)
-   [Requirements Made on the Operands](#@@ITOC@@ABENITAB_WHERE_OPTIMIZATION_3)

Hint

If the lines selected using WHERE are modified or deleted using [MODIFY](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abapmodify_itab.htm) or [DELETE](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abapdelete_itab.htm) and not just read using [LOOP AT](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abaploop_at_itab.htm), further update costs are incurred in addition to the search for the lines. When deleting lines from standard tables, it should be noted that searches using a secondary key optimize the selection of lines to be deleted, but not the update required for the primary key, which is usually performed using a linear search.

Prerequisites for the Optimization of Hash Keys   

In the case of [hash key](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abenhash_key_glosry.htm "Glossary Entry") accesses, there must be exactly one relational expression combined using AND for each component of the key. This expression is either

-   a [comparison expression](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abencomparison_expression_glosry.htm "Glossary Entry") with the comparison operator \= (or EQ), whose operands meet the requirements above or
-   a [predicate expression](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abenpredicate_expression_glosry.htm "Glossary Entry") IS INITIAL without the addition NOT.

These relational expressions construct the part of the logical expression used for the key access. This part must not contain duplicate key components. The remainder of the logical expression can contain any number of relational expressions combined using AND. Optimization may not be possible, however, if the Boolean operators NOT or OR are used. Key components may be used in the relational expressions not used for the key access.

Hint

Relational expressions other than comparisons using \= (or EQ) or predicate expressions IS INITIAL are not part of the key access. This applies particularly to the tabular comparison operator [IN range\_tab](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abenlogexp_select_option.htm), even if it can be traced back to optimizable comparisons.

Example

In the following example, the first two WHERE conditions can be optimized as key accesses with the secondary table key key. This is because:

1.  The optimizable conditions for b, d, and e cover the entire key.
2.  The optimizable conditions b, d, and e cover the entire key and a is a condition on a non-key column that is not involved in the part of the WHERE condition required for the optimization.
3.  The optimizable conditions b, d, and e cover the entire key and the other two conditions on the key columns b and d are not optimizable and are hence not involved in the part of the WHERE condition required for the optimization.

The next six WHERE conditions cannot be optimized and produce syntax errors. This is because:

1.  The key component d is not specified.
2.  A key component is combined using OR instead of AND.
3.  Two non-optimizable comparison operators are used.
4.  An operand of type i is used in the comparison b of type c, which does not meet the requirements made on the operands.
5.  The Boolean operator NOT is used in front of a key component.
6.  A further comparison is combined using OR.
7.  A further comparison is negated using NOT.
    
    DATA: BEGIN OF line,
            a TYPE c LENGTH 3,
            b TYPE c LENGTH 3,
            c TYPE c LENGTH 3,
            d TYPE c LENGTH 3,
            e TYPE c LENGTH 3,
            f TYPE c LENGTH 3,
          END OF line.
    DATA itab LIKE STANDARD TABLE OF line
                   WITH UNIQUE HASHED KEY key COMPONENTS b e d.
    DATA b\_tab LIKE RANGE OF line-b.
    LOOP AT itab INTO line USING KEY key
         WHERE b = '...' AND d = '...' AND e IS INITIAL.
    ENDLOOP.
    LOOP AT itab INTO line USING KEY key
         WHERE a = '...' AND b = '...' AND d = '...' AND e IS INITIAL.
    ENDLOOP.
    LOOP AT itab INTO line USING KEY key
         WHERE  b = '...' AND d = '...' AND e IS INITIAL AND
                b IN b\_tab AND d <> '...'.
    ENDLOOP.
    LOOP AT itab INTO line USING KEY key
         WHERE b = '...' AND e IS INITIAL.                     "syntax error
    ENDLOOP.
    LOOP AT itab INTO line USING KEY key
         WHERE b = '...' OR d = '...' AND e IS INITIAL OR      "syntax error
    ENDLOOP.
    LOOP AT itab INTO line USING KEY key
         WHERE b = '...' AND d <> '...' AND e IS NOT INITIAL.  "syntax error
    ENDLOOP.
    LOOP AT itab INTO line USING KEY key
         WHERE b = 333 AND d = '...' AND e IS INITIAL.         "syntax error
    ENDLOOP.
    LOOP AT itab INTO line USING KEY key
         WHERE b = '...'  AND NOT d = '...' AND e IS INITIAL.  "syntax error
    ENDLOOP.
    LOOP AT itab INTO line USING KEY key
         WHERE b = '...' AND d = '...' AND e IS INITIAL OR     "syntax error
               a = '...'.
    ENDLOOP.
    LOOP AT itab INTO line USING KEY key
         WHERE b = '...' AND d = '...' AND e IS INITIAL AND    "syntax error
               NOT a = '...'.
    ENDLOOP.
    

Prerequisites for the Optimization of Sorted Keys   

In the case of reads using a [sorted key](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abensorted_key_glosry.htm "Glossary Entry"), the same applies as to a hash key. The only difference is that only an initial section of the key consisting of at least one component needs to be covered rather than the entire key.

The internal table is accessed in part sequentially. The starting point for the processing of the table is determined by a binary search using the subconditions that cover the table key completely or partially. From the starting point onwards, the table is only processed for as long as these subconditions remain fulfilled.

Example

In the following example, the first five WHERE conditions can be optimized as key accesses with the secondary table key key. This is because:

1.  b is an initial part of the key.
2.  b is an initial part of the key and a is an independent condition.
3.  b and e are an initial part of the key.
4.  b, e, and d are an initial part of the key and the order in the WHERE condition is ignored.
5.  b is an initial part of the key and in this case, d is an independent condition, even though it is part of the key.

The next five WHERE conditions cannot be optimized and produce syntax errors. This is because:

1.  e is not an initial part of the key.
2.  No inequality comparison takes place.
3.  A comparison in a ranges table is specified.
4.  The Boolean operator NOT is used.
5.  An additional OR relationship is used.
    
    DATA: BEGIN OF line,
            a TYPE c LENGTH 3,
            b TYPE c LENGTH 3,
            c TYPE c LENGTH 3,
            d TYPE c LENGTH 3,
            e TYPE c LENGTH 3,
            f TYPE c LENGTH 3,
          END OF line.
    DATA itab LIKE STANDARD TABLE OF line
                   WITH UNIQUE SORTED KEY key COMPONENTS b e d.
    DATA b\_tab LIKE RANGE OF line-b.
    LOOP AT itab INTO line USING KEY key
                 WHERE b = '...'.
    ENDLOOP.
    LOOP AT itab INTO line USING KEY key
                 WHERE a = '...' AND b IS INITIAL.
    ENDLOOP.
    LOOP AT itab INTO line USING KEY key
                 WHERE b = '...' AND e = '...'.
    ENDLOOP.
    LOOP AT itab INTO line USING KEY key
                 WHERE b = '...' AND d IS INITIAL AND e = '...'.
    ENDLOOP.
    LOOP AT itab INTO line USING KEY key
                 WHERE b = '...' AND d <> '...'.
    ENDLOOP.
    LOOP AT itab INTO line USING KEY key
                 WHERE e = '...'.                    "syntax error
    ENDLOOP.
    LOOP AT itab INTO line USING KEY key
                 WHERE b <> '...'.                   "syntax error
    ENDLOOP.
    LOOP AT itab INTO line USING KEY key
                 WHERE b IN b\_tab.                   "syntax error
    ENDLOOP.
    LOOP AT itab INTO line USING KEY key
                 WHERE b = '...'  AND NOT e = '...'. "syntax error
    ENDLOOP.
    LOOP AT itab INTO line USING KEY key             "syntax error
                 WHERE b = '...'  AND ( d = '...' OR e IS INITIAL ).
    ENDLOOP.
    

Requirements Made on the Operands   

The part of the logical expression that can be mapped to a key access must select the same lines as a statement [READ TABLE](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abapread_table.htm) or a corresponding [table expression](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abentable_expressions.htm) that specifies the corresponding components as keys.

-   When comparing incompatible data objects, the WHERE condition is subject to the same [comparison rules](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abenlogexp_rules.htm) for incompatible data types. Here, the data types involved determine which operand is converted to which comparison type.
-   If the additions [WITH TABLE KEY](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abapread_table_key.htm) and [WITH KEY](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abapread_table_free.htm) of the statement READ or [KEY](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abentable_exp_itab_line.htm) in a table expression are used, however, the content of the specified data objects is always converted to the data type of the columns before the comparison.

If this produces differing results, an optimization is not possible. Due to the complexity of the comparison rules, particularly for [elementary data types](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abenlogexp_rules_operands.htm), it is not a good idea to construct a set of rules detailing exactly when the comparison type matches the data type of the left operand. Generally speaking,

-   only fully compatible operands are optimizable,
-   in some cases, elementary operands with different data types can be optimized, if the value ranges or lengths are suitable. For example, a comparison of a column with the type of a floating point number with an operand of type integer or of a column of c with a similar operand, if its length is less than the length of the column.

For this reason, it is advisable to use only pairs of [compatible](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abencompatible_glosry.htm "Glossary Entry") operands in the WHERE condition. This guarantees that the differences in behavior of the WHERE condition and the specified key do not affect the result.

Example

The following example is largely similar to the example in the section WHERE log\_exp in [LOOP AT itab](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abaploop_at_itab_cond.htm). In that case, access takes place using the primary key and no optimization. Here, however, access takes place using a secondary table key and a syntax check warning is produced and an exception raised when the program is executed. The number of lines in the internal table determines whether the exception is raised.

DATA text\_short TYPE c LENGTH 2.
DATA text\_long  TYPE c LENGTH 4.
DATA itab LIKE TABLE OF text\_short
          WITH UNIQUE HASHED KEY key COMPONENTS table\_line.
itab = VALUE #( ( 'AA' )
                ( 'BB' )
                ( 'CC' )
                ( 'DD' )
                ( 'EE' )
                ( 'FF' )
                ( 'GG' )
                ( 'HH' )
                ( 'II' )
                ( 'JJ' )
                ( 'KK' )
                ( 'LL' )
                ( 'MM' ) ).
text\_short = 'AA'.
text\_long  = 'AAXX'.
LOOP AT itab INTO text\_short USING KEY key
             WHERE table\_line = text\_long.
ENDLOOP.
cl\_demo\_output=>write( |LOOP: { sy-subrc }| ).
"Statement
READ TABLE itab INTO text\_short WITH TABLE KEY key
                                COMPONENTS table\_line = text\_long.
cl\_demo\_output=>write( |READ: { sy-subrc }| ).
"Expression
TRY.
    text\_short = itab\[ KEY key COMPONENTS table\_line = text\_long \].
  catch CX\_SY\_ITAB\_LINE\_NOT\_FOUND.
    ...
ENDTRY.
cl\_demo\_output=>display( |Expression: { text\_short }| ).


---


## ABAP - Keyword Documentation / ABAP - Programming Language / Processing Internal Data / Internal Tables (itab) / itab - Processing Statements / SORT itab

**Files**: 5 | **Difficulty**: intermediate

# ABAP - Keyword Documentation / ABAP - Programming Language / Processing Internal Data / Internal Tables (itab) / itab - Performance Notes

Included pages: 2


### abenitab_perfo.htm

---
title: "Table Sharing"
description: |
  When assignments are made between internal tables of the same type whose line type does not contain any table types, only the internal administration functions are passed to the table body(https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abentable_body_glosry.htm 'Glossary Entry') for pe
version: "7.57"
category: "data-structures"
type: "abap-reference"
sourceUrl: "https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abenitab_perfo.htm"
abapFile: "abenitab_perfo.htm"
keywords: ["select", "insert", "update", "delete", "loop", "do", "if", "case", "try", "data", "types", "internal-table", "abenitab", "perfo"]
---

* * *

AS ABAP Release 757, ©Copyright 2023 SAP SE. All rights reserved.

[ABAP - Keyword Documentation](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abenabap.htm) →  [ABAP - Programming Language](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abenabap_reference.htm) →  [Processing Internal Data](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abenabap_data_working.htm) →  [Internal Tables (itab)](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abenitab.htm) → 

 [![](Mail.gif?object=Mail.gif&sap-language=EN "Feedback mail for displayed topic") Mail Feedback](mailto:f1_help@sap.com?subject=Feedback on ABAP Documentation&body=Document: itab - Performance Notes, ABENITAB_PERFO, 757%0D%0A%0D%0AError:%0D%0A%0D%0A%0D%0A%0D%
0ASuggestion for improvement:)

itab - Performance Notes

-   [Table Sharing](#abenitab-perfo-1-------initial-memory-requirement---@ITOC@@ABENITAB_PERFO_2)
-   [Index Administration](#abenitab-perfo-3-------block-processing-of-table-lines---@ITOC@@ABENITAB_PERFO_4)
-   [Selective Data Transport](#abenitab-perfo-5-------using-secondary-keys---@ITOC@@ABENITAB_PERFO_6)
-   [Deleting Table Lines](#abenitab-perfo-7-------free-key-specified-for-sorted-tables-and-hashed-tables---@ITOC@@ABENITAB_PERFO_8)
-   [Sorting](#abenitab-perfo-9---table-sharing-----when-assignments-are-made-between-internal-tables-of-the-same-type-whose-line-type-does-not-contain-any-table-types--only-the-internal-administration-functions-are-passed-to-the--table-body--https---help-sap-com-doc-abapdocu-757-index-htm-7-57-en-us-abentable-body-glosry-htm--glossary-entry---for-performance-reasons---table-sharing--https---help-sap-com-doc-abapdocu-757-index-htm-7-57-en-us-abentable-sharing-glosry-htm--glossary-entry---is-revoked-only-when-write-access-to-one-of-the-tables-involved-is-initiated--the-actual-copy-process-then-takes-place---initial-memory-requirement-----internal-tables-are--dynamic-data-objects--https---help-sap-com-doc-abapdocu-757-index-htm-7-57-en-us-abendynamic-data-object-glosry-htm--glossary-entry---whose-area-in-the-memory-is-extended-block-by-block--the-size-of-the-first-block-in-the-memory-is-called--initial-memory-requirement--https---help-sap-com-doc-abapdocu-757-index-htm-7-57-en-us-abeninitial-mem-req-glosry-htm--glossary-entry---and-can-be-affected-in-the-declaration-of-an-internal-table-using-the-additions--initial-size--https---help-sap-com-doc-abapdocu-757-index-htm-7-57-en-us-abaptypes-itab-htm--and-the-obsolete--occurs--https---help-sap-com-doc-abapdocu-757-index-htm-7-57-en-us-abapdata-occurs-htm----it-is-usually-up-to-the-system-to-determine-the-size-of-the-first-block--initial-size-is-not-used-or-specified-with-the-value-0--in-this-case--a-suitable-block-size-is-chosen-the-first-time-lines-are-added-to-an-internal-table---specifying-a-concrete-value-greater-than-0-after-initial-size-is-only-practical-if-it-is-known-in-advance-how-many-entries-are-to-be-made-in-the-table--and-the-first-block-is-therefore-to-be-created-with-the-most-suitable-dimensions--this-can-be-particularly-important-for-internal-tables-that-are-components-of-other-internal-tables--and-which-only-contain-a-few-lines--no-more-than-around-5----to-avoid-excessive-memory-demands--the-system-ignores-values-that-produce-memory-demands-greater-than-the-constant-block-size---index-administration-----in-an--index-table--https---help-sap-com-doc-abapdocu-757-index-htm-7-57-en-us-abenindex-table-glosry-htm--glossary-entry----the-logical-order-of-the-table-entries-is-not-generally-consistent-with-the-physical-order-of-the-entries-in-the-main-memory--in-this-case--the-logical-order-is-no-longer-administrated-by-a-physical-index--but-by-a-logical-index--the-same-basically-applies-to-the--secondary-table-indexes--https---help-sap-com-doc-abapdocu-757-index-htm-7-57-en-us-abensecondary-table-index-glosry-htm--glossary-entry---used-to-manage--secondary--https---help-sap-com-doc-abapdocu-757-index-htm-7-57-en-us-abensecondary-table-key-glosry-htm--glossary-entry----sorted-keys--https---help-sap-com-doc-abapdocu-757-index-htm-7-57-en-us-abensorted-key-glosry-htm--glossary-entry-----use-of-the-logical-index-produces-additional-memory-requirements--and-index-maintenance-places-a-high-demand-on-resources--time-and-memory--when-inserting-or-deleting-table-lines--the-resource-requirements-increase-proportionally-with-the-number-of-remaining-lines-after-the-insertion-or-deletion-position--for-very-large-internal-tables--this-can-result-in-considerable-demands-on-performance-at-runtime---the-logical-index-is-only-created-when-it-is-needed--that-is--when-a-line-is-inserted-in-front-of-another-line--if-the-order-of-the-table-lines-is-changed--or-a-line-other-than-the-last-line-is-deleted--a-logical-index-is-not-required-if-an-internal-table-is-filled-using-only--append--https---help-sap-com-doc-abapdocu-757-index-htm-7-57-en-us-abapappend-htm---and-if-only-its-last-line-or-lines-is-are-deleted-using--delete--https---help-sap-com-doc-abapdocu-757-index-htm-7-57-en-us-abapdelete-itab-htm----hint--in-contrast-to-filling-a-table-with--insert--https---help-sap-com-doc-abapdocu-757-index-htm-7-57-en-us-abapinsert-itab-htm---appending-lines-with--append--https---help-sap-com-doc-abapdocu-757-index-htm-7-57-en-us-abapappend-htm--does-not-require-any-resources-for-index-maintenance--it-is-therefore-preferable-to-use-append-instead-of-insert-to-create-a--standard-table--https---help-sap-com-doc-abapdocu-757-index-htm-7-57-en-us-abenstandard-table-glosry-htm--glossary-entry----this-is-possible-if-the-order-of-the-entries-is-not-important--or-if-entries-can-be-appended-in-the-correct-order---block-processing-of-table-lines-----if-entire-line-areas-of-a-table-can-be-processed-at-once--this-should-not-be-done-line-by-line--but-using-block-operations--block-operations-are-possible-using-the-from-and-to-additions-of-the-statements--insert--https---help-sap-com-doc-abapdocu-757-index-htm-7-57-en-us-abapinsert-itab-htm----append--https---help-sap-com-doc-abapdocu-757-index-htm-7-57-en-us-abapappend-htm--and--delete--https---help-sap-com-doc-abapdocu-757-index-htm-7-57-en-us-abapdelete-itab-htm---block-operations-are-also-more-efficient-than-single-record-operations-when-reading-from-or-modifying-database-tables-with--abap-sql--https---help-sap-com-doc-abapdocu-757-index-htm-7-57-en-us-abenabap-sql-glosry-htm--glossary-entry---statements-with-the-additions-from---appending---to-table---selective-data-transport-----if--when-reading-table-lines-using--read-table--https---help-sap-com-doc-abapdocu-757-index-htm-7-57-en-us-abapread-table-htm--or--loop-at--https---help-sap-com-doc-abapdocu-757-index-htm-7-57-en-us-abaploop-at-itab-htm---a-work-area-is-used-or-table-lines-can-be-changed-using--modify--https---help-sap-com-doc-abapdocu-757-index-htm-7-57-en-us-abapmodify-itab-htm--instead-of-direct-access--the-transporting-addition-can-be-used-to-prevent-unnecessary-assignments-of-table-components-to-the-work-area--this-can-lead-to-a-noticeable-improvement-in-performance--particularly-if-table-like-components-are-excluded-from-processing---using-secondary-keys-----the--use-of-secondary-table-keys--https---help-sap-com-doc-abapdocu-757-index-htm-7-57-en-us-abenitab-key-secondary-usage-htm--should-be-planned-and-executed-carefully-and-sparingly--the-time-gained-when-accessing-individual-lines-should-not-be-lost-again-by-the-increased-memory-and-time-requirements-for-managing-the-secondary-keys--secondary-keys-are-generally-recommended-for-internal-tables-that-are-filled-once-and-rarely-changed-during-program-execution---example--the-program-demo--secondary--keys-demonstrates-how-a-secondary-table-key-is-specified-and-the-resulting-performance-gain---deleting-table-lines-----when-lines-are-deleted-from-an-internal-table--administration-costs-are-incurred-for-all-table-keys-and-table-indexes--the-primary-key-and-all-unique-secondary-keys-are-updated-directly--but-non-unique-secondary-keys-are-updated-only-if-the-line-to-be-deleted-is-included-in-the-updated-part-of-an-associated-index---lazy-update--https---help-sap-com-doc-abapdocu-757-index-htm-7-57-en-us-abenlazy-update-glosry-htm--glossary-entry------it-should-be-noted-that--particularly-for-standard-tables--the-mean-runtime-of-the-statement--delete--https---help-sap-com-doc-abapdocu-757-index-htm-7-57-en-us-abapdelete-itab-htm--always-depends-linearly-on-the-number-of-table-lines--even-when-secondary-keys-are-specified-using--with-table-key--https---help-sap-com-doc-abapdocu-757-index-htm-7-57-en-us-abapdelete-itab-key-htm--or--using-key--https---help-sap-com-doc-abapdocu-757-index-htm-7-57-en-us-abapdelete-itab-key-htm---this-is-because-a-linear-search-is-required-to-update-the-primary-index--even-though-the-line-to-be-deleted-can-itself-be-found-quickly---deleting-lines-in-internal-tables-using--delete--https---help-sap-com-doc-abapdocu-757-index-htm-7-57-en-us-abapdelete-itab-htm--does-not-usually-release-any-memory-in-the-internal-table--statements-such-as--clear--https---help-sap-com-doc-abapdocu-757-index-htm-7-57-en-us-abapclear-htm--or--free--https---help-sap-com-doc-abapdocu-757-index-htm-7-57-en-us-abapfree-dataobject-htm--must-be-used-to-release-memory-in-internal-tables---free-key-specified-for-sorted-tables-and-hashed-tables-----when-using-the--read--https---help-sap-com-doc-abapdocu-757-index-htm-7-57-en-us-abapread-table-htm--statement-with-a-specified-free-key-of-the-form--with-key------https---help-sap-com-doc-abapdocu-757-index-htm-7-57-en-us-abapread-table-free-htm---the-search-is-optimized-in-all-cases-where-this-is-possible--that-is-------in--sorted-tables--https---help-sap-com-doc-abapdocu-757-index-htm-7-57-en-us-abensorted-table-glosry-htm--glossary-entry----if-any-initial-section-of-the--table-key--https---help-sap-com-doc-abapdocu-757-index-htm-7-57-en-us-abentable-key-glosry-htm--glossary-entry---or-the-complete-table-key-is-covered-by-the-specified-key------in--hashed-tables--https---help-sap-com-doc-abapdocu-757-index-htm-7-57-en-us-abenhashed-table-glosry-htm--glossary-entry----if-the-complete-table-key-is-covered---if-part-of-a-free-key-meets-these-conditions--this-partial-key-is-first-used-to-search-for-an-entry--in-sorted-tables--this-is-done-using-a-binary-search-with-a-logarithmic-consumption-of-resources--and-in-hashed-tables-using-a-hash-algorithm--that-is--with-constant-resource-consumption--if-an-entry-is-found--the-system-checks-whether-the-rest-of-the-key-conditions-are-also-met--this-means-that-over-specific-keys-in-particular-are-optimized---hint--see-also--optimization-of-the-where-condition--https---help-sap-com-doc-abapdocu-757-index-htm-7-57-en-us-abenitab-where-optimization-htm----sorting-----for-textual-sorting-of-an-internal-table-in-accordance-with-the-current--text-environment--https---help-sap-com-doc-abapdocu-757-index-htm-7-57-en-us-abentext-environment-glosry-htm--glossary-entry----it-can-be-more-efficient-to-use-the-statement--convert-text-into-sortable-code--https---help-sap-com-doc-abapdocu-757-index-htm-7-57-en-us-abapconvert-text-htm--instead-of--sort-as-text--https---help-sap-com-doc-abapdocu-757-index-htm-7-57-en-us-abapsort-itab-htm--in-the-following-cases-------if-an-internal-table-is-sorted-by-locale-and-then-searched-binarily-using-the-statement-read-table-or-using-a--table-expression--https---help-sap-com-doc-abapdocu-757-index-htm-7-57-en-us-abentable-expressions-htm-------an-internal-table-must-be-sorted-more-than-once------indexes-for-database-tables-should-be-structured-in-accordance-with-a-locale---continue--itab---optimizing-the-where-condition--https---help-sap-com-doc-abapdocu-757-index-htm-7-57-en-us-abenitab-where-optimization-htm--------abenitab-where-optimization-htm------title---hint--description------if-the-lines-selected-using-where-are-modified-or-deleted-using-modify-https---help-sap-com-doc-abapdocu-757-index-htm-7-57-en-us-abapmodify-itab-htm--or-delete-https---help-sap-com-doc-abapdocu-757-index-htm-7-57-en-us-abapdelete-itab-htm--and-not-just-read-using-loop-at-https---help-sap-com--version---7-57--category---general--type---abap-reference--sourceurl---https---help-sap-com-doc-abapdocu-757-index-htm-7-57-en-us-abenitab-where-optimization-htm--abapfile---abenitab-where-optimization-htm--keywords----select----update----delete----loop----do----if----case----try----catch----data----types----internal-table----abenitab----where----optimization---------------as-abap-release-757---copyright-2023-sap-se--all-rights-reserved----abap---keyword-documentation--https---help-sap-com-doc-abapdocu-757-index-htm-7-57-en-us-abenabap-htm------abap---programming-language--https---help-sap-com-doc-abapdocu-757-index-htm-7-57-en-us-abenabap-reference-htm------processing-internal-data--https---help-sap-com-doc-abapdocu-757-index-htm-7-57-en-us-abenabap-data-working-htm------internal-tables--itab---https---help-sap-com-doc-abapdocu-757-index-htm-7-57-en-us-abenitab-htm------itab---performance-notes--https---help-sap-com-doc-abapdocu-757-index-htm-7-57-en-us-abenitab-perfo-htm------------mail-gif-object-mail-gif-sap-language-en--feedback-mail-for-displayed-topic---mail-feedback--mailto-f1-helpsap.com?subject=Feedback on ABAP Documentation&body=Document: itab - Optimizing the WHERE Condition, ABENITAB_WHERE_OPTIMIZATION, 757%0D%0A%0D%0AEr
ror:%0D%0A%0D%0A%0D%0A%0D%0ASuggestion for improvement:)

itab - Optimizing the WHERE Condition

The statements [LOOP AT](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abaploop_at_itab.htm), [DELETE](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abapdelete_itab.htm), and [MODIFY](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abapmodify_itab.htm) can be specified together with a WHERE condition that selects specific lines of the internal table. Searches in a [standard table](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abenstandard_table_glosry.htm "Glossary Entry") using the [primary table key](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abenprimary_table_key_glosry.htm "Glossary Entry") are always linear and cannot be optimized. Searches using a [sorted key](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abensorted_key_glosry.htm "Glossary Entry") or a [hash key](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abenhash_key_glosry.htm "Glossary Entry"), however, can be optimized in certain circumstances. These keys are used for:

-   accessing a [sorted table](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abensorted_table_glosry.htm "Glossary Entry") using its primary key.
-   accessing a [hashed table](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abenhashed_table_glosry.htm "Glossary Entry") using its primary key.
-   accessing a table of any table type using a [secondary table key](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abensecondary_table_key_glosry.htm "Glossary Entry") specified by USING KEY.

The optimization takes place by mapping all [relational expressions](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abenrelational_expression_glosry.htm "Glossary Entry") or a group of the relational expressions in the WHERE condition to a specified key. This specified key performs a corresponding optimized key access (binary search or hash algorithm as in the statement [READ TABLE](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abapread_table.htm) or a [table expression](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abentable_expressions.htm)), to find one or more lines. The found line or lines are then checked using those remaining relational expressions from the WHERE condition that were not mapped to the specified key.

Prerequisites for the optimization are therefore:

-   The relational expressions of the WHERE condition can be transformed to a specified key.
-   The corresponding key access returns the same results as the evaluation of this part of the logical expression would. This is guaranteed only for compatible data types, since in the case of incompatible data types:
    -   the content of the specified data objects is converted to the data type of the columns before the evaluation in the case of key accesses.
    -   The [comparison rules](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abenlogexp_rules.htm) for incompatible data types apply when evaluating a [comparison expression](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abencomparison_expression_glosry.htm "Glossary Entry"). Here, all the data types involved play a part in determining which operand is converted into which comparison type.

If there are no or insufficient relational expressions to meet both of these prerequisites, no optimization is possible and the behavior is as follows:

-   If a sorted table or a hashed table is accessed using the primary table key, all lines of the internal table are checked as in a standard table.
-   If the table is read using a secondary table key, that is, if said key is specified after USING KEY, a syntax error or syntax check warning, or an exception is raised. Access using a secondary table key must always be executed in an optimized way.

The following sections describe exactly when an access can be optimized.

-   [Prerequisites for the Optimization of Hash Keys](#abenitab-where-optimization-1-------prerequisites-for-the-optimization-of-sorted-keys---@ITOC@@ABENITAB_WHERE_OPTIMIZATION_2)
-   [Requirements Made on the Operands](#@@ITOC@@ABENITAB_WHERE_OPTIMIZATION_3)

Hint

If the lines selected using WHERE are modified or deleted using [MODIFY](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abapmodify_itab.htm) or [DELETE](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abapdelete_itab.htm) and not just read using [LOOP AT](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abaploop_at_itab.htm), further update costs are incurred in addition to the search for the lines. When deleting lines from standard tables, it should be noted that searches using a secondary key optimize the selection of lines to be deleted, but not the update required for the primary key, which is usually performed using a linear search.

Prerequisites for the Optimization of Hash Keys   

In the case of [hash key](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abenhash_key_glosry.htm "Glossary Entry") accesses, there must be exactly one relational expression combined using AND for each component of the key. This expression is either

-   a [comparison expression](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abencomparison_expression_glosry.htm "Glossary Entry") with the comparison operator \= (or EQ), whose operands meet the requirements above or
-   a [predicate expression](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abenpredicate_expression_glosry.htm "Glossary Entry") IS INITIAL without the addition NOT.

These relational expressions construct the part of the logical expression used for the key access. This part must not contain duplicate key components. The remainder of the logical expression can contain any number of relational expressions combined using AND. Optimization may not be possible, however, if the Boolean operators NOT or OR are used. Key components may be used in the relational expressions not used for the key access.

Hint

Relational expressions other than comparisons using \= (or EQ) or predicate expressions IS INITIAL are not part of the key access. This applies particularly to the tabular comparison operator [IN range\_tab](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abenlogexp_select_option.htm), even if it can be traced back to optimizable comparisons.

Example

In the following example, the first two WHERE conditions can be optimized as key accesses with the secondary table key key. This is because:

1.  The optimizable conditions for b, d, and e cover the entire key.
2.  The optimizable conditions b, d, and e cover the entire key and a is a condition on a non-key column that is not involved in the part of the WHERE condition required for the optimization.
3.  The optimizable conditions b, d, and e cover the entire key and the other two conditions on the key columns b and d are not optimizable and are hence not involved in the part of the WHERE condition required for the optimization.

The next six WHERE conditions cannot be optimized and produce syntax errors. This is because:

1.  The key component d is not specified.
2.  A key component is combined using OR instead of AND.
3.  Two non-optimizable comparison operators are used.
4.  An operand of type i is used in the comparison b of type c, which does not meet the requirements made on the operands.
5.  The Boolean operator NOT is used in front of a key component.
6.  A further comparison is combined using OR.
7.  A further comparison is negated using NOT.
    
    DATA: BEGIN OF line,
            a TYPE c LENGTH 3,
            b TYPE c LENGTH 3,
            c TYPE c LENGTH 3,
            d TYPE c LENGTH 3,
            e TYPE c LENGTH 3,
            f TYPE c LENGTH 3,
          END OF line.
    DATA itab LIKE STANDARD TABLE OF line
                   WITH UNIQUE HASHED KEY key COMPONENTS b e d.
    DATA b\_tab LIKE RANGE OF line-b.
    LOOP AT itab INTO line USING KEY key
         WHERE b = '...' AND d = '...' AND e IS INITIAL.
    ENDLOOP.
    LOOP AT itab INTO line USING KEY key
         WHERE a = '...' AND b = '...' AND d = '...' AND e IS INITIAL.
    ENDLOOP.
    LOOP AT itab INTO line USING KEY key
         WHERE  b = '...' AND d = '...' AND e IS INITIAL AND
                b IN b\_tab AND d <> '...'.
    ENDLOOP.
    LOOP AT itab INTO line USING KEY key
         WHERE b = '...' AND e IS INITIAL.                     "syntax error
    ENDLOOP.
    LOOP AT itab INTO line USING KEY key
         WHERE b = '...' OR d = '...' AND e IS INITIAL OR      "syntax error
    ENDLOOP.
    LOOP AT itab INTO line USING KEY key
         WHERE b = '...' AND d <> '...' AND e IS NOT INITIAL.  "syntax error
    ENDLOOP.
    LOOP AT itab INTO line USING KEY key
         WHERE b = 333 AND d = '...' AND e IS INITIAL.         "syntax error
    ENDLOOP.
    LOOP AT itab INTO line USING KEY key
         WHERE b = '...'  AND NOT d = '...' AND e IS INITIAL.  "syntax error
    ENDLOOP.
    LOOP AT itab INTO line USING KEY key
         WHERE b = '...' AND d = '...' AND e IS INITIAL OR     "syntax error
               a = '...'.
    ENDLOOP.
    LOOP AT itab INTO line USING KEY key
         WHERE b = '...' AND d = '...' AND e IS INITIAL AND    "syntax error
               NOT a = '...'.
    ENDLOOP.
    

Prerequisites for the Optimization of Sorted Keys   

In the case of reads using a [sorted key](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abensorted_key_glosry.htm "Glossary Entry"), the same applies as to a hash key. The only difference is that only an initial section of the key consisting of at least one component needs to be covered rather than the entire key.

The internal table is accessed in part sequentially. The starting point for the processing of the table is determined by a binary search using the subconditions that cover the table key completely or partially. From the starting point onwards, the table is only processed for as long as these subconditions remain fulfilled.

Example

In the following example, the first five WHERE conditions can be optimized as key accesses with the secondary table key key. This is because:

1.  b is an initial part of the key.
2.  b is an initial part of the key and a is an independent condition.
3.  b and e are an initial part of the key.
4.  b, e, and d are an initial part of the key and the order in the WHERE condition is ignored.
5.  b is an initial part of the key and in this case, d is an independent condition, even though it is part of the key.

The next five WHERE conditions cannot be optimized and produce syntax errors. This is because:

1.  e is not an initial part of the key.
2.  No inequality comparison takes place.
3.  A comparison in a ranges table is specified.
4.  The Boolean operator NOT is used.
5.  An additional OR relationship is used.
    
    DATA: BEGIN OF line,
            a TYPE c LENGTH 3,
            b TYPE c LENGTH 3,
            c TYPE c LENGTH 3,
            d TYPE c LENGTH 3,
            e TYPE c LENGTH 3,
            f TYPE c LENGTH 3,
          END OF line.
    DATA itab LIKE STANDARD TABLE OF line
                   WITH UNIQUE SORTED KEY key COMPONENTS b e d.
    DATA b\_tab LIKE RANGE OF line-b.
    LOOP AT itab INTO line USING KEY key
                 WHERE b = '...'.
    ENDLOOP.
    LOOP AT itab INTO line USING KEY key
                 WHERE a = '...' AND b IS INITIAL.
    ENDLOOP.
    LOOP AT itab INTO line USING KEY key
                 WHERE b = '...' AND e = '...'.
    ENDLOOP.
    LOOP AT itab INTO line USING KEY key
                 WHERE b = '...' AND d IS INITIAL AND e = '...'.
    ENDLOOP.
    LOOP AT itab INTO line USING KEY key
                 WHERE b = '...' AND d <> '...'.
    ENDLOOP.
    LOOP AT itab INTO line USING KEY key
                 WHERE e = '...'.                    "syntax error
    ENDLOOP.
    LOOP AT itab INTO line USING KEY key
                 WHERE b <> '...'.                   "syntax error
    ENDLOOP.
    LOOP AT itab INTO line USING KEY key
                 WHERE b IN b\_tab.                   "syntax error
    ENDLOOP.
    LOOP AT itab INTO line USING KEY key
                 WHERE b = '...'  AND NOT e = '...'. "syntax error
    ENDLOOP.
    LOOP AT itab INTO line USING KEY key             "syntax error
                 WHERE b = '...'  AND ( d = '...' OR e IS INITIAL ).
    ENDLOOP.
    

Requirements Made on the Operands   

The part of the logical expression that can be mapped to a key access must select the same lines as a statement [READ TABLE](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abapread_table.htm) or a corresponding [table expression](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abentable_expressions.htm) that specifies the corresponding components as keys.

-   When comparing incompatible data objects, the WHERE condition is subject to the same [comparison rules](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abenlogexp_rules.htm) for incompatible data types. Here, the data types involved determine which operand is converted to which comparison type.
-   If the additions [WITH TABLE KEY](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abapread_table_key.htm) and [WITH KEY](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abapread_table_free.htm) of the statement READ or [KEY](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abentable_exp_itab_line.htm) in a table expression are used, however, the content of the specified data objects is always converted to the data type of the columns before the comparison.

If this produces differing results, an optimization is not possible. Due to the complexity of the comparison rules, particularly for [elementary data types](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abenlogexp_rules_operands.htm), it is not a good idea to construct a set of rules detailing exactly when the comparison type matches the data type of the left operand. Generally speaking,

-   only fully compatible operands are optimizable,
-   in some cases, elementary operands with different data types can be optimized, if the value ranges or lengths are suitable. For example, a comparison of a column with the type of a floating point number with an operand of type integer or of a column of c with a similar operand, if its length is less than the length of the column.

For this reason, it is advisable to use only pairs of [compatible](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abencompatible_glosry.htm "Glossary Entry") operands in the WHERE condition. This guarantees that the differences in behavior of the WHERE condition and the specified key do not affect the result.

Example

The following example is largely similar to the example in the section WHERE log\_exp in [LOOP AT itab](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abaploop_at_itab_cond.htm). In that case, access takes place using the primary key and no optimization. Here, however, access takes place using a secondary table key and a syntax check warning is produced and an exception raised when the program is executed. The number of lines in the internal table determines whether the exception is raised.

DATA text\_short TYPE c LENGTH 2.
DATA text\_long  TYPE c LENGTH 4.
DATA itab LIKE TABLE OF text\_short
          WITH UNIQUE HASHED KEY key COMPONENTS table\_line.
itab = VALUE #( ( 'AA' )
                ( 'BB' )
                ( 'CC' )
                ( 'DD' )
                ( 'EE' )
                ( 'FF' )
                ( 'GG' )
                ( 'HH' )
                ( 'II' )
                ( 'JJ' )
                ( 'KK' )
                ( 'LL' )
                ( 'MM' ) ).
text\_short = 'AA'.
text\_long  = 'AAXX'.
LOOP AT itab INTO text\_short USING KEY key
             WHERE table\_line = text\_long.
ENDLOOP.
cl\_demo\_output=>write( |LOOP: { sy-subrc }| ).
"Statement
READ TABLE itab INTO text\_short WITH TABLE KEY key
                                COMPONENTS table\_line = text\_long.
cl\_demo\_output=>write( |READ: { sy-subrc }| ).
"Expression
TRY.
    text\_short = itab\[ KEY key COMPONENTS table\_line = text\_long \].
  catch CX\_SY\_ITAB\_LINE\_NOT\_FOUND.
    ...
ENDTRY.
cl\_demo\_output=>display( |Expression: { text\_short }| ).


---


## ABAP - Keyword Documentation / ABAP - Programming Language / Processing Internal Data / Internal Tables (itab) / itab - Processing Statements / FIND IN TABLE itab

**Files**: 3 | **Difficulty**: intermediate

# ABAP - Keyword Documentation / ABAP - Programming Language / Processing Internal Data / Internal Tables (itab) / itab - Performance Notes

Included pages: 2


### abenitab_perfo.htm

---
title: "Table Sharing"
description: |
  When assignments are made between internal tables of the same type whose line type does not contain any table types, only the internal administration functions are passed to the table body(https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abentable_body_glosry.htm 'Glossary Entry') for pe
version: "7.57"
category: "data-structures"
type: "abap-reference"
sourceUrl: "https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abenitab_perfo.htm"
abapFile: "abenitab_perfo.htm"
keywords: ["select", "insert", "update", "delete", "loop", "do", "if", "case", "try", "data", "types", "internal-table", "abenitab", "perfo"]
---

* * *

AS ABAP Release 757, ©Copyright 2023 SAP SE. All rights reserved.

[ABAP - Keyword Documentation](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abenabap.htm) →  [ABAP - Programming Language](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abenabap_reference.htm) →  [Processing Internal Data](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abenabap_data_working.htm) →  [Internal Tables (itab)](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abenitab.htm) → 

 [![](Mail.gif?object=Mail.gif&sap-language=EN "Feedback mail for displayed topic") Mail Feedback](mailto:f1_help@sap.com?subject=Feedback on ABAP Documentation&body=Document: itab - Performance Notes, ABENITAB_PERFO, 757%0D%0A%0D%0AError:%0D%0A%0D%0A%0D%0A%0D%
0ASuggestion for improvement:)

itab - Performance Notes

-   [Table Sharing](#abenitab-perfo-1-------initial-memory-requirement---@ITOC@@ABENITAB_PERFO_2)
-   [Index Administration](#abenitab-perfo-3-------block-processing-of-table-lines---@ITOC@@ABENITAB_PERFO_4)
-   [Selective Data Transport](#abenitab-perfo-5-------using-secondary-keys---@ITOC@@ABENITAB_PERFO_6)
-   [Deleting Table Lines](#abenitab-perfo-7-------free-key-specified-for-sorted-tables-and-hashed-tables---@ITOC@@ABENITAB_PERFO_8)
-   [Sorting](#abenitab-perfo-9---table-sharing-----when-assignments-are-made-between-internal-tables-of-the-same-type-whose-line-type-does-not-contain-any-table-types--only-the-internal-administration-functions-are-passed-to-the--table-body--https---help-sap-com-doc-abapdocu-757-index-htm-7-57-en-us-abentable-body-glosry-htm--glossary-entry---for-performance-reasons---table-sharing--https---help-sap-com-doc-abapdocu-757-index-htm-7-57-en-us-abentable-sharing-glosry-htm--glossary-entry---is-revoked-only-when-write-access-to-one-of-the-tables-involved-is-initiated--the-actual-copy-process-then-takes-place---initial-memory-requirement-----internal-tables-are--dynamic-data-objects--https---help-sap-com-doc-abapdocu-757-index-htm-7-57-en-us-abendynamic-data-object-glosry-htm--glossary-entry---whose-area-in-the-memory-is-extended-block-by-block--the-size-of-the-first-block-in-the-memory-is-called--initial-memory-requirement--https---help-sap-com-doc-abapdocu-757-index-htm-7-57-en-us-abeninitial-mem-req-glosry-htm--glossary-entry---and-can-be-affected-in-the-declaration-of-an-internal-table-using-the-additions--initial-size--https---help-sap-com-doc-abapdocu-757-index-htm-7-57-en-us-abaptypes-itab-htm--and-the-obsolete--occurs--https---help-sap-com-doc-abapdocu-757-index-htm-7-57-en-us-abapdata-occurs-htm----it-is-usually-up-to-the-system-to-determine-the-size-of-the-first-block--initial-size-is-not-used-or-specified-with-the-value-0--in-this-case--a-suitable-block-size-is-chosen-the-first-time-lines-are-added-to-an-internal-table---specifying-a-concrete-value-greater-than-0-after-initial-size-is-only-practical-if-it-is-known-in-advance-how-many-entries-are-to-be-made-in-the-table--and-the-first-block-is-therefore-to-be-created-with-the-most-suitable-dimensions--this-can-be-particularly-important-for-internal-tables-that-are-components-of-other-internal-tables--and-which-only-contain-a-few-lines--no-more-than-around-5----to-avoid-excessive-memory-demands--the-system-ignores-values-that-produce-memory-demands-greater-than-the-constant-block-size---index-administration-----in-an--index-table--https---help-sap-com-doc-abapdocu-757-index-htm-7-57-en-us-abenindex-table-glosry-htm--glossary-entry----the-logical-order-of-the-table-entries-is-not-generally-consistent-with-the-physical-order-of-the-entries-in-the-main-memory--in-this-case--the-logical-order-is-no-longer-administrated-by-a-physical-index--but-by-a-logical-index--the-same-basically-applies-to-the--secondary-table-indexes--https---help-sap-com-doc-abapdocu-757-index-htm-7-57-en-us-abensecondary-table-index-glosry-htm--glossary-entry---used-to-manage--secondary--https---help-sap-com-doc-abapdocu-757-index-htm-7-57-en-us-abensecondary-table-key-glosry-htm--glossary-entry----sorted-keys--https---help-sap-com-doc-abapdocu-757-index-htm-7-57-en-us-abensorted-key-glosry-htm--glossary-entry-----use-of-the-logical-index-produces-additional-memory-requirements--and-index-maintenance-places-a-high-demand-on-resources--time-and-memory--when-inserting-or-deleting-table-lines--the-resource-requirements-increase-proportionally-with-the-number-of-remaining-lines-after-the-insertion-or-deletion-position--for-very-large-internal-tables--this-can-result-in-considerable-demands-on-performance-at-runtime---the-logical-index-is-only-created-when-it-is-needed--that-is--when-a-line-is-inserted-in-front-of-another-line--if-the-order-of-the-table-lines-is-changed--or-a-line-other-than-the-last-line-is-deleted--a-logical-index-is-not-required-if-an-internal-table-is-filled-using-only--append--https---help-sap-com-doc-abapdocu-757-index-htm-7-57-en-us-abapappend-htm---and-if-only-its-last-line-or-lines-is-are-deleted-using--delete--https---help-sap-com-doc-abapdocu-757-index-htm-7-57-en-us-abapdelete-itab-htm----hint--in-contrast-to-filling-a-table-with--insert--https---help-sap-com-doc-abapdocu-757-index-htm-7-57-en-us-abapinsert-itab-htm---appending-lines-with--append--https---help-sap-com-doc-abapdocu-757-index-htm-7-57-en-us-abapappend-htm--does-not-require-any-resources-for-index-maintenance--it-is-therefore-preferable-to-use-append-instead-of-insert-to-create-a--standard-table--https---help-sap-com-doc-abapdocu-757-index-htm-7-57-en-us-abenstandard-table-glosry-htm--glossary-entry----this-is-possible-if-the-order-of-the-entries-is-not-important--or-if-entries-can-be-appended-in-the-correct-order---block-processing-of-table-lines-----if-entire-line-areas-of-a-table-can-be-processed-at-once--this-should-not-be-done-line-by-line--but-using-block-operations--block-operations-are-possible-using-the-from-and-to-additions-of-the-statements--insert--https---help-sap-com-doc-abapdocu-757-index-htm-7-57-en-us-abapinsert-itab-htm----append--https---help-sap-com-doc-abapdocu-757-index-htm-7-57-en-us-abapappend-htm--and--delete--https---help-sap-com-doc-abapdocu-757-index-htm-7-57-en-us-abapdelete-itab-htm---block-operations-are-also-more-efficient-than-single-record-operations-when-reading-from-or-modifying-database-tables-with--abap-sql--https---help-sap-com-doc-abapdocu-757-index-htm-7-57-en-us-abenabap-sql-glosry-htm--glossary-entry---statements-with-the-additions-from---appending---to-table---selective-data-transport-----if--when-reading-table-lines-using--read-table--https---help-sap-com-doc-abapdocu-757-index-htm-7-57-en-us-abapread-table-htm--or--loop-at--https---help-sap-com-doc-abapdocu-757-index-htm-7-57-en-us-abaploop-at-itab-htm---a-work-area-is-used-or-table-lines-can-be-changed-using--modify--https---help-sap-com-doc-abapdocu-757-index-htm-7-57-en-us-abapmodify-itab-htm--instead-of-direct-access--the-transporting-addition-can-be-used-to-prevent-unnecessary-assignments-of-table-components-to-the-work-area--this-can-lead-to-a-noticeable-improvement-in-performance--particularly-if-table-like-components-are-excluded-from-processing---using-secondary-keys-----the--use-of-secondary-table-keys--https---help-sap-com-doc-abapdocu-757-index-htm-7-57-en-us-abenitab-key-secondary-usage-htm--should-be-planned-and-executed-carefully-and-sparingly--the-time-gained-when-accessing-individual-lines-should-not-be-lost-again-by-the-increased-memory-and-time-requirements-for-managing-the-secondary-keys--secondary-keys-are-generally-recommended-for-internal-tables-that-are-filled-once-and-rarely-changed-during-program-execution---example--the-program-demo--secondary--keys-demonstrates-how-a-secondary-table-key-is-specified-and-the-resulting-performance-gain---deleting-table-lines-----when-lines-are-deleted-from-an-internal-table--administration-costs-are-incurred-for-all-table-keys-and-table-indexes--the-primary-key-and-all-unique-secondary-keys-are-updated-directly--but-non-unique-secondary-keys-are-updated-only-if-the-line-to-be-deleted-is-included-in-the-updated-part-of-an-associated-index---lazy-update--https---help-sap-com-doc-abapdocu-757-index-htm-7-57-en-us-abenlazy-update-glosry-htm--glossary-entry------it-should-be-noted-that--particularly-for-standard-tables--the-mean-runtime-of-the-statement--delete--https---help-sap-com-doc-abapdocu-757-index-htm-7-57-en-us-abapdelete-itab-htm--always-depends-linearly-on-the-number-of-table-lines--even-when-secondary-keys-are-specified-using--with-table-key--https---help-sap-com-doc-abapdocu-757-index-htm-7-57-en-us-abapdelete-itab-key-htm--or--using-key--https---help-sap-com-doc-abapdocu-757-index-htm-7-57-en-us-abapdelete-itab-key-htm---this-is-because-a-linear-search-is-required-to-update-the-primary-index--even-though-the-line-to-be-deleted-can-itself-be-found-quickly---deleting-lines-in-internal-tables-using--delete--https---help-sap-com-doc-abapdocu-757-index-htm-7-57-en-us-abapdelete-itab-htm--does-not-usually-release-any-memory-in-the-internal-table--statements-such-as--clear--https---help-sap-com-doc-abapdocu-757-index-htm-7-57-en-us-abapclear-htm--or--free--https---help-sap-com-doc-abapdocu-757-index-htm-7-57-en-us-abapfree-dataobject-htm--must-be-used-to-release-memory-in-internal-tables---free-key-specified-for-sorted-tables-and-hashed-tables-----when-using-the--read--https---help-sap-com-doc-abapdocu-757-index-htm-7-57-en-us-abapread-table-htm--statement-with-a-specified-free-key-of-the-form--with-key------https---help-sap-com-doc-abapdocu-757-index-htm-7-57-en-us-abapread-table-free-htm---the-search-is-optimized-in-all-cases-where-this-is-possible--that-is-------in--sorted-tables--https---help-sap-com-doc-abapdocu-757-index-htm-7-57-en-us-abensorted-table-glosry-htm--glossary-entry----if-any-initial-section-of-the--table-key--https---help-sap-com-doc-abapdocu-757-index-htm-7-57-en-us-abentable-key-glosry-htm--glossary-entry---or-the-complete-table-key-is-covered-by-the-specified-key------in--hashed-tables--https---help-sap-com-doc-abapdocu-757-index-htm-7-57-en-us-abenhashed-table-glosry-htm--glossary-entry----if-the-complete-table-key-is-covered---if-part-of-a-free-key-meets-these-conditions--this-partial-key-is-first-used-to-search-for-an-entry--in-sorted-tables--this-is-done-using-a-binary-search-with-a-logarithmic-consumption-of-resources--and-in-hashed-tables-using-a-hash-algorithm--that-is--with-constant-resource-consumption--if-an-entry-is-found--the-system-checks-whether-the-rest-of-the-key-conditions-are-also-met--this-means-that-over-specific-keys-in-particular-are-optimized---hint--see-also--optimization-of-the-where-condition--https---help-sap-com-doc-abapdocu-757-index-htm-7-57-en-us-abenitab-where-optimization-htm----sorting-----for-textual-sorting-of-an-internal-table-in-accordance-with-the-current--text-environment--https---help-sap-com-doc-abapdocu-757-index-htm-7-57-en-us-abentext-environment-glosry-htm--glossary-entry----it-can-be-more-efficient-to-use-the-statement--convert-text-into-sortable-code--https---help-sap-com-doc-abapdocu-757-index-htm-7-57-en-us-abapconvert-text-htm--instead-of--sort-as-text--https---help-sap-com-doc-abapdocu-757-index-htm-7-57-en-us-abapsort-itab-htm--in-the-following-cases-------if-an-internal-table-is-sorted-by-locale-and-then-searched-binarily-using-the-statement-read-table-or-using-a--table-expression--https---help-sap-com-doc-abapdocu-757-index-htm-7-57-en-us-abentable-expressions-htm-------an-internal-table-must-be-sorted-more-than-once------indexes-for-database-tables-should-be-structured-in-accordance-with-a-locale---continue--itab---optimizing-the-where-condition--https---help-sap-com-doc-abapdocu-757-index-htm-7-57-en-us-abenitab-where-optimization-htm--------abenitab-where-optimization-htm------title---hint--description------if-the-lines-selected-using-where-are-modified-or-deleted-using-modify-https---help-sap-com-doc-abapdocu-757-index-htm-7-57-en-us-abapmodify-itab-htm--or-delete-https---help-sap-com-doc-abapdocu-757-index-htm-7-57-en-us-abapdelete-itab-htm--and-not-just-read-using-loop-at-https---help-sap-com--version---7-57--category---general--type---abap-reference--sourceurl---https---help-sap-com-doc-abapdocu-757-index-htm-7-57-en-us-abenitab-where-optimization-htm--abapfile---abenitab-where-optimization-htm--keywords----select----update----delete----loop----do----if----case----try----catch----data----types----internal-table----abenitab----where----optimization---------------as-abap-release-757---copyright-2023-sap-se--all-rights-reserved----abap---keyword-documentation--https---help-sap-com-doc-abapdocu-757-index-htm-7-57-en-us-abenabap-htm------abap---programming-language--https---help-sap-com-doc-abapdocu-757-index-htm-7-57-en-us-abenabap-reference-htm------processing-internal-data--https---help-sap-com-doc-abapdocu-757-index-htm-7-57-en-us-abenabap-data-working-htm------internal-tables--itab---https---help-sap-com-doc-abapdocu-757-index-htm-7-57-en-us-abenitab-htm------itab---performance-notes--https---help-sap-com-doc-abapdocu-757-index-htm-7-57-en-us-abenitab-perfo-htm------------mail-gif-object-mail-gif-sap-language-en--feedback-mail-for-displayed-topic---mail-feedback--mailto-f1-helpsap.com?subject=Feedback on ABAP Documentation&body=Document: itab - Optimizing the WHERE Condition, ABENITAB_WHERE_OPTIMIZATION, 757%0D%0A%0D%0AEr
ror:%0D%0A%0D%0A%0D%0A%0D%0ASuggestion for improvement:)

itab - Optimizing the WHERE Condition

The statements [LOOP AT](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abaploop_at_itab.htm), [DELETE](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abapdelete_itab.htm), and [MODIFY](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abapmodify_itab.htm) can be specified together with a WHERE condition that selects specific lines of the internal table. Searches in a [standard table](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abenstandard_table_glosry.htm "Glossary Entry") using the [primary table key](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abenprimary_table_key_glosry.htm "Glossary Entry") are always linear and cannot be optimized. Searches using a [sorted key](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abensorted_key_glosry.htm "Glossary Entry") or a [hash key](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abenhash_key_glosry.htm "Glossary Entry"), however, can be optimized in certain circumstances. These keys are used for:

-   accessing a [sorted table](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abensorted_table_glosry.htm "Glossary Entry") using its primary key.
-   accessing a [hashed table](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abenhashed_table_glosry.htm "Glossary Entry") using its primary key.
-   accessing a table of any table type using a [secondary table key](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abensecondary_table_key_glosry.htm "Glossary Entry") specified by USING KEY.

The optimization takes place by mapping all [relational expressions](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abenrelational_expression_glosry.htm "Glossary Entry") or a group of the relational expressions in the WHERE condition to a specified key. This specified key performs a corresponding optimized key access (binary search or hash algorithm as in the statement [READ TABLE](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abapread_table.htm) or a [table expression](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abentable_expressions.htm)), to find one or more lines. The found line or lines are then checked using those remaining relational expressions from the WHERE condition that were not mapped to the specified key.

Prerequisites for the optimization are therefore:

-   The relational expressions of the WHERE condition can be transformed to a specified key.
-   The corresponding key access returns the same results as the evaluation of this part of the logical expression would. This is guaranteed only for compatible data types, since in the case of incompatible data types:
    -   the content of the specified data objects is converted to the data type of the columns before the evaluation in the case of key accesses.
    -   The [comparison rules](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abenlogexp_rules.htm) for incompatible data types apply when evaluating a [comparison expression](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abencomparison_expression_glosry.htm "Glossary Entry"). Here, all the data types involved play a part in determining which operand is converted into which comparison type.

If there are no or insufficient relational expressions to meet both of these prerequisites, no optimization is possible and the behavior is as follows:

-   If a sorted table or a hashed table is accessed using the primary table key, all lines of the internal table are checked as in a standard table.
-   If the table is read using a secondary table key, that is, if said key is specified after USING KEY, a syntax error or syntax check warning, or an exception is raised. Access using a secondary table key must always be executed in an optimized way.

The following sections describe exactly when an access can be optimized.

-   [Prerequisites for the Optimization of Hash Keys](#abenitab-where-optimization-1-------prerequisites-for-the-optimization-of-sorted-keys---@ITOC@@ABENITAB_WHERE_OPTIMIZATION_2)
-   [Requirements Made on the Operands](#@@ITOC@@ABENITAB_WHERE_OPTIMIZATION_3)

Hint

If the lines selected using WHERE are modified or deleted using [MODIFY](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abapmodify_itab.htm) or [DELETE](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abapdelete_itab.htm) and not just read using [LOOP AT](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abaploop_at_itab.htm), further update costs are incurred in addition to the search for the lines. When deleting lines from standard tables, it should be noted that searches using a secondary key optimize the selection of lines to be deleted, but not the update required for the primary key, which is usually performed using a linear search.

Prerequisites for the Optimization of Hash Keys   

In the case of [hash key](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abenhash_key_glosry.htm "Glossary Entry") accesses, there must be exactly one relational expression combined using AND for each component of the key. This expression is either

-   a [comparison expression](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abencomparison_expression_glosry.htm "Glossary Entry") with the comparison operator \= (or EQ), whose operands meet the requirements above or
-   a [predicate expression](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abenpredicate_expression_glosry.htm "Glossary Entry") IS INITIAL without the addition NOT.

These relational expressions construct the part of the logical expression used for the key access. This part must not contain duplicate key components. The remainder of the logical expression can contain any number of relational expressions combined using AND. Optimization may not be possible, however, if the Boolean operators NOT or OR are used. Key components may be used in the relational expressions not used for the key access.

Hint

Relational expressions other than comparisons using \= (or EQ) or predicate expressions IS INITIAL are not part of the key access. This applies particularly to the tabular comparison operator [IN range\_tab](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abenlogexp_select_option.htm), even if it can be traced back to optimizable comparisons.

Example

In the following example, the first two WHERE conditions can be optimized as key accesses with the secondary table key key. This is because:

1.  The optimizable conditions for b, d, and e cover the entire key.
2.  The optimizable conditions b, d, and e cover the entire key and a is a condition on a non-key column that is not involved in the part of the WHERE condition required for the optimization.
3.  The optimizable conditions b, d, and e cover the entire key and the other two conditions on the key columns b and d are not optimizable and are hence not involved in the part of the WHERE condition required for the optimization.

The next six WHERE conditions cannot be optimized and produce syntax errors. This is because:

1.  The key component d is not specified.
2.  A key component is combined using OR instead of AND.
3.  Two non-optimizable comparison operators are used.
4.  An operand of type i is used in the comparison b of type c, which does not meet the requirements made on the operands.
5.  The Boolean operator NOT is used in front of a key component.
6.  A further comparison is combined using OR.
7.  A further comparison is negated using NOT.
    
    DATA: BEGIN OF line,
            a TYPE c LENGTH 3,
            b TYPE c LENGTH 3,
            c TYPE c LENGTH 3,
            d TYPE c LENGTH 3,
            e TYPE c LENGTH 3,
            f TYPE c LENGTH 3,
          END OF line.
    DATA itab LIKE STANDARD TABLE OF line
                   WITH UNIQUE HASHED KEY key COMPONENTS b e d.
    DATA b\_tab LIKE RANGE OF line-b.
    LOOP AT itab INTO line USING KEY key
         WHERE b = '...' AND d = '...' AND e IS INITIAL.
    ENDLOOP.
    LOOP AT itab INTO line USING KEY key
         WHERE a = '...' AND b = '...' AND d = '...' AND e IS INITIAL.
    ENDLOOP.
    LOOP AT itab INTO line USING KEY key
         WHERE  b = '...' AND d = '...' AND e IS INITIAL AND
                b IN b\_tab AND d <> '...'.
    ENDLOOP.
    LOOP AT itab INTO line USING KEY key
         WHERE b = '...' AND e IS INITIAL.                     "syntax error
    ENDLOOP.
    LOOP AT itab INTO line USING KEY key
         WHERE b = '...' OR d = '...' AND e IS INITIAL OR      "syntax error
    ENDLOOP.
    LOOP AT itab INTO line USING KEY key
         WHERE b = '...' AND d <> '...' AND e IS NOT INITIAL.  "syntax error
    ENDLOOP.
    LOOP AT itab INTO line USING KEY key
         WHERE b = 333 AND d = '...' AND e IS INITIAL.         "syntax error
    ENDLOOP.
    LOOP AT itab INTO line USING KEY key
         WHERE b = '...'  AND NOT d = '...' AND e IS INITIAL.  "syntax error
    ENDLOOP.
    LOOP AT itab INTO line USING KEY key
         WHERE b = '...' AND d = '...' AND e IS INITIAL OR     "syntax error
               a = '...'.
    ENDLOOP.
    LOOP AT itab INTO line USING KEY key
         WHERE b = '...' AND d = '...' AND e IS INITIAL AND    "syntax error
               NOT a = '...'.
    ENDLOOP.
    

Prerequisites for the Optimization of Sorted Keys   

In the case of reads using a [sorted key](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abensorted_key_glosry.htm "Glossary Entry"), the same applies as to a hash key. The only difference is that only an initial section of the key consisting of at least one component needs to be covered rather than the entire key.

The internal table is accessed in part sequentially. The starting point for the processing of the table is determined by a binary search using the subconditions that cover the table key completely or partially. From the starting point onwards, the table is only processed for as long as these subconditions remain fulfilled.

Example

In the following example, the first five WHERE conditions can be optimized as key accesses with the secondary table key key. This is because:

1.  b is an initial part of the key.
2.  b is an initial part of the key and a is an independent condition.
3.  b and e are an initial part of the key.
4.  b, e, and d are an initial part of the key and the order in the WHERE condition is ignored.
5.  b is an initial part of the key and in this case, d is an independent condition, even though it is part of the key.

The next five WHERE conditions cannot be optimized and produce syntax errors. This is because:

1.  e is not an initial part of the key.
2.  No inequality comparison takes place.
3.  A comparison in a ranges table is specified.
4.  The Boolean operator NOT is used.
5.  An additional OR relationship is used.
    
    DATA: BEGIN OF line,
            a TYPE c LENGTH 3,
            b TYPE c LENGTH 3,
            c TYPE c LENGTH 3,
            d TYPE c LENGTH 3,
            e TYPE c LENGTH 3,
            f TYPE c LENGTH 3,
          END OF line.
    DATA itab LIKE STANDARD TABLE OF line
                   WITH UNIQUE SORTED KEY key COMPONENTS b e d.
    DATA b\_tab LIKE RANGE OF line-b.
    LOOP AT itab INTO line USING KEY key
                 WHERE b = '...'.
    ENDLOOP.
    LOOP AT itab INTO line USING KEY key
                 WHERE a = '...' AND b IS INITIAL.
    ENDLOOP.
    LOOP AT itab INTO line USING KEY key
                 WHERE b = '...' AND e = '...'.
    ENDLOOP.
    LOOP AT itab INTO line USING KEY key
                 WHERE b = '...' AND d IS INITIAL AND e = '...'.
    ENDLOOP.
    LOOP AT itab INTO line USING KEY key
                 WHERE b = '...' AND d <> '...'.
    ENDLOOP.
    LOOP AT itab INTO line USING KEY key
                 WHERE e = '...'.                    "syntax error
    ENDLOOP.
    LOOP AT itab INTO line USING KEY key
                 WHERE b <> '...'.                   "syntax error
    ENDLOOP.
    LOOP AT itab INTO line USING KEY key
                 WHERE b IN b\_tab.                   "syntax error
    ENDLOOP.
    LOOP AT itab INTO line USING KEY key
                 WHERE b = '...'  AND NOT e = '...'. "syntax error
    ENDLOOP.
    LOOP AT itab INTO line USING KEY key             "syntax error
                 WHERE b = '...'  AND ( d = '...' OR e IS INITIAL ).
    ENDLOOP.
    

Requirements Made on the Operands   

The part of the logical expression that can be mapped to a key access must select the same lines as a statement [READ TABLE](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abapread_table.htm) or a corresponding [table expression](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abentable_expressions.htm) that specifies the corresponding components as keys.

-   When comparing incompatible data objects, the WHERE condition is subject to the same [comparison rules](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abenlogexp_rules.htm) for incompatible data types. Here, the data types involved determine which operand is converted to which comparison type.
-   If the additions [WITH TABLE KEY](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abapread_table_key.htm) and [WITH KEY](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abapread_table_free.htm) of the statement READ or [KEY](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abentable_exp_itab_line.htm) in a table expression are used, however, the content of the specified data objects is always converted to the data type of the columns before the comparison.

If this produces differing results, an optimization is not possible. Due to the complexity of the comparison rules, particularly for [elementary data types](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abenlogexp_rules_operands.htm), it is not a good idea to construct a set of rules detailing exactly when the comparison type matches the data type of the left operand. Generally speaking,

-   only fully compatible operands are optimizable,
-   in some cases, elementary operands with different data types can be optimized, if the value ranges or lengths are suitable. For example, a comparison of a column with the type of a floating point number with an operand of type integer or of a column of c with a similar operand, if its length is less than the length of the column.

For this reason, it is advisable to use only pairs of [compatible](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abencompatible_glosry.htm "Glossary Entry") operands in the WHERE condition. This guarantees that the differences in behavior of the WHERE condition and the specified key do not affect the result.

Example

The following example is largely similar to the example in the section WHERE log\_exp in [LOOP AT itab](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abaploop_at_itab_cond.htm). In that case, access takes place using the primary key and no optimization. Here, however, access takes place using a secondary table key and a syntax check warning is produced and an exception raised when the program is executed. The number of lines in the internal table determines whether the exception is raised.

DATA text\_short TYPE c LENGTH 2.
DATA text\_long  TYPE c LENGTH 4.
DATA itab LIKE TABLE OF text\_short
          WITH UNIQUE HASHED KEY key COMPONENTS table\_line.
itab = VALUE #( ( 'AA' )
                ( 'BB' )
                ( 'CC' )
                ( 'DD' )
                ( 'EE' )
                ( 'FF' )
                ( 'GG' )
                ( 'HH' )
                ( 'II' )
                ( 'JJ' )
                ( 'KK' )
                ( 'LL' )
                ( 'MM' ) ).
text\_short = 'AA'.
text\_long  = 'AAXX'.
LOOP AT itab INTO text\_short USING KEY key
             WHERE table\_line = text\_long.
ENDLOOP.
cl\_demo\_output=>write( |LOOP: { sy-subrc }| ).
"Statement
READ TABLE itab INTO text\_short WITH TABLE KEY key
                                COMPONENTS table\_line = text\_long.
cl\_demo\_output=>write( |READ: { sy-subrc }| ).
"Expression
TRY.
    text\_short = itab\[ KEY key COMPONENTS table\_line = text\_long \].
  catch CX\_SY\_ITAB\_LINE\_NOT\_FOUND.
    ...
ENDTRY.
cl\_demo\_output=>display( |Expression: { text\_short }| ).


---


## ABAP - Keyword Documentation / ABAP - Programming Language / Processing Internal Data / Internal Tables (itab) / itab - Processing Statements / REPLACE IN TABLE itab

**Files**: 3 | **Difficulty**: intermediate

# ABAP - Keyword Documentation / ABAP - Programming Language / Processing Internal Data / Internal Tables (itab) / itab - Performance Notes

Included pages: 2


### abenitab_perfo.htm

---
title: "Table Sharing"
description: |
  When assignments are made between internal tables of the same type whose line type does not contain any table types, only the internal administration functions are passed to the table body(https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abentable_body_glosry.htm 'Glossary Entry') for pe
version: "7.57"
category: "data-structures"
type: "abap-reference"
sourceUrl: "https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abenitab_perfo.htm"
abapFile: "abenitab_perfo.htm"
keywords: ["select", "insert", "update", "delete", "loop", "do", "if", "case", "try", "data", "types", "internal-table", "abenitab", "perfo"]
---

* * *

AS ABAP Release 757, ©Copyright 2023 SAP SE. All rights reserved.

[ABAP - Keyword Documentation](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abenabap.htm) →  [ABAP - Programming Language](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abenabap_reference.htm) →  [Processing Internal Data](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abenabap_data_working.htm) →  [Internal Tables (itab)](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abenitab.htm) → 

 [![](Mail.gif?object=Mail.gif&sap-language=EN "Feedback mail for displayed topic") Mail Feedback](mailto:f1_help@sap.com?subject=Feedback on ABAP Documentation&body=Document: itab - Performance Notes, ABENITAB_PERFO, 757%0D%0A%0D%0AError:%0D%0A%0D%0A%0D%0A%0D%
0ASuggestion for improvement:)

itab - Performance Notes

-   [Table Sharing](#abenitab-perfo-1-------initial-memory-requirement---@ITOC@@ABENITAB_PERFO_2)
-   [Index Administration](#abenitab-perfo-3-------block-processing-of-table-lines---@ITOC@@ABENITAB_PERFO_4)
-   [Selective Data Transport](#abenitab-perfo-5-------using-secondary-keys---@ITOC@@ABENITAB_PERFO_6)
-   [Deleting Table Lines](#abenitab-perfo-7-------free-key-specified-for-sorted-tables-and-hashed-tables---@ITOC@@ABENITAB_PERFO_8)
-   [Sorting](#abenitab-perfo-9---table-sharing-----when-assignments-are-made-between-internal-tables-of-the-same-type-whose-line-type-does-not-contain-any-table-types--only-the-internal-administration-functions-are-passed-to-the--table-body--https---help-sap-com-doc-abapdocu-757-index-htm-7-57-en-us-abentable-body-glosry-htm--glossary-entry---for-performance-reasons---table-sharing--https---help-sap-com-doc-abapdocu-757-index-htm-7-57-en-us-abentable-sharing-glosry-htm--glossary-entry---is-revoked-only-when-write-access-to-one-of-the-tables-involved-is-initiated--the-actual-copy-process-then-takes-place---initial-memory-requirement-----internal-tables-are--dynamic-data-objects--https---help-sap-com-doc-abapdocu-757-index-htm-7-57-en-us-abendynamic-data-object-glosry-htm--glossary-entry---whose-area-in-the-memory-is-extended-block-by-block--the-size-of-the-first-block-in-the-memory-is-called--initial-memory-requirement--https---help-sap-com-doc-abapdocu-757-index-htm-7-57-en-us-abeninitial-mem-req-glosry-htm--glossary-entry---and-can-be-affected-in-the-declaration-of-an-internal-table-using-the-additions--initial-size--https---help-sap-com-doc-abapdocu-757-index-htm-7-57-en-us-abaptypes-itab-htm--and-the-obsolete--occurs--https---help-sap-com-doc-abapdocu-757-index-htm-7-57-en-us-abapdata-occurs-htm----it-is-usually-up-to-the-system-to-determine-the-size-of-the-first-block--initial-size-is-not-used-or-specified-with-the-value-0--in-this-case--a-suitable-block-size-is-chosen-the-first-time-lines-are-added-to-an-internal-table---specifying-a-concrete-value-greater-than-0-after-initial-size-is-only-practical-if-it-is-known-in-advance-how-many-entries-are-to-be-made-in-the-table--and-the-first-block-is-therefore-to-be-created-with-the-most-suitable-dimensions--this-can-be-particularly-important-for-internal-tables-that-are-components-of-other-internal-tables--and-which-only-contain-a-few-lines--no-more-than-around-5----to-avoid-excessive-memory-demands--the-system-ignores-values-that-produce-memory-demands-greater-than-the-constant-block-size---index-administration-----in-an--index-table--https---help-sap-com-doc-abapdocu-757-index-htm-7-57-en-us-abenindex-table-glosry-htm--glossary-entry----the-logical-order-of-the-table-entries-is-not-generally-consistent-with-the-physical-order-of-the-entries-in-the-main-memory--in-this-case--the-logical-order-is-no-longer-administrated-by-a-physical-index--but-by-a-logical-index--the-same-basically-applies-to-the--secondary-table-indexes--https---help-sap-com-doc-abapdocu-757-index-htm-7-57-en-us-abensecondary-table-index-glosry-htm--glossary-entry---used-to-manage--secondary--https---help-sap-com-doc-abapdocu-757-index-htm-7-57-en-us-abensecondary-table-key-glosry-htm--glossary-entry----sorted-keys--https---help-sap-com-doc-abapdocu-757-index-htm-7-57-en-us-abensorted-key-glosry-htm--glossary-entry-----use-of-the-logical-index-produces-additional-memory-requirements--and-index-maintenance-places-a-high-demand-on-resources--time-and-memory--when-inserting-or-deleting-table-lines--the-resource-requirements-increase-proportionally-with-the-number-of-remaining-lines-after-the-insertion-or-deletion-position--for-very-large-internal-tables--this-can-result-in-considerable-demands-on-performance-at-runtime---the-logical-index-is-only-created-when-it-is-needed--that-is--when-a-line-is-inserted-in-front-of-another-line--if-the-order-of-the-table-lines-is-changed--or-a-line-other-than-the-last-line-is-deleted--a-logical-index-is-not-required-if-an-internal-table-is-filled-using-only--append--https---help-sap-com-doc-abapdocu-757-index-htm-7-57-en-us-abapappend-htm---and-if-only-its-last-line-or-lines-is-are-deleted-using--delete--https---help-sap-com-doc-abapdocu-757-index-htm-7-57-en-us-abapdelete-itab-htm----hint--in-contrast-to-filling-a-table-with--insert--https---help-sap-com-doc-abapdocu-757-index-htm-7-57-en-us-abapinsert-itab-htm---appending-lines-with--append--https---help-sap-com-doc-abapdocu-757-index-htm-7-57-en-us-abapappend-htm--does-not-require-any-resources-for-index-maintenance--it-is-therefore-preferable-to-use-append-instead-of-insert-to-create-a--standard-table--https---help-sap-com-doc-abapdocu-757-index-htm-7-57-en-us-abenstandard-table-glosry-htm--glossary-entry----this-is-possible-if-the-order-of-the-entries-is-not-important--or-if-entries-can-be-appended-in-the-correct-order---block-processing-of-table-lines-----if-entire-line-areas-of-a-table-can-be-processed-at-once--this-should-not-be-done-line-by-line--but-using-block-operations--block-operations-are-possible-using-the-from-and-to-additions-of-the-statements--insert--https---help-sap-com-doc-abapdocu-757-index-htm-7-57-en-us-abapinsert-itab-htm----append--https---help-sap-com-doc-abapdocu-757-index-htm-7-57-en-us-abapappend-htm--and--delete--https---help-sap-com-doc-abapdocu-757-index-htm-7-57-en-us-abapdelete-itab-htm---block-operations-are-also-more-efficient-than-single-record-operations-when-reading-from-or-modifying-database-tables-with--abap-sql--https---help-sap-com-doc-abapdocu-757-index-htm-7-57-en-us-abenabap-sql-glosry-htm--glossary-entry---statements-with-the-additions-from---appending---to-table---selective-data-transport-----if--when-reading-table-lines-using--read-table--https---help-sap-com-doc-abapdocu-757-index-htm-7-57-en-us-abapread-table-htm--or--loop-at--https---help-sap-com-doc-abapdocu-757-index-htm-7-57-en-us-abaploop-at-itab-htm---a-work-area-is-used-or-table-lines-can-be-changed-using--modify--https---help-sap-com-doc-abapdocu-757-index-htm-7-57-en-us-abapmodify-itab-htm--instead-of-direct-access--the-transporting-addition-can-be-used-to-prevent-unnecessary-assignments-of-table-components-to-the-work-area--this-can-lead-to-a-noticeable-improvement-in-performance--particularly-if-table-like-components-are-excluded-from-processing---using-secondary-keys-----the--use-of-secondary-table-keys--https---help-sap-com-doc-abapdocu-757-index-htm-7-57-en-us-abenitab-key-secondary-usage-htm--should-be-planned-and-executed-carefully-and-sparingly--the-time-gained-when-accessing-individual-lines-should-not-be-lost-again-by-the-increased-memory-and-time-requirements-for-managing-the-secondary-keys--secondary-keys-are-generally-recommended-for-internal-tables-that-are-filled-once-and-rarely-changed-during-program-execution---example--the-program-demo--secondary--keys-demonstrates-how-a-secondary-table-key-is-specified-and-the-resulting-performance-gain---deleting-table-lines-----when-lines-are-deleted-from-an-internal-table--administration-costs-are-incurred-for-all-table-keys-and-table-indexes--the-primary-key-and-all-unique-secondary-keys-are-updated-directly--but-non-unique-secondary-keys-are-updated-only-if-the-line-to-be-deleted-is-included-in-the-updated-part-of-an-associated-index---lazy-update--https---help-sap-com-doc-abapdocu-757-index-htm-7-57-en-us-abenlazy-update-glosry-htm--glossary-entry------it-should-be-noted-that--particularly-for-standard-tables--the-mean-runtime-of-the-statement--delete--https---help-sap-com-doc-abapdocu-757-index-htm-7-57-en-us-abapdelete-itab-htm--always-depends-linearly-on-the-number-of-table-lines--even-when-secondary-keys-are-specified-using--with-table-key--https---help-sap-com-doc-abapdocu-757-index-htm-7-57-en-us-abapdelete-itab-key-htm--or--using-key--https---help-sap-com-doc-abapdocu-757-index-htm-7-57-en-us-abapdelete-itab-key-htm---this-is-because-a-linear-search-is-required-to-update-the-primary-index--even-though-the-line-to-be-deleted-can-itself-be-found-quickly---deleting-lines-in-internal-tables-using--delete--https---help-sap-com-doc-abapdocu-757-index-htm-7-57-en-us-abapdelete-itab-htm--does-not-usually-release-any-memory-in-the-internal-table--statements-such-as--clear--https---help-sap-com-doc-abapdocu-757-index-htm-7-57-en-us-abapclear-htm--or--free--https---help-sap-com-doc-abapdocu-757-index-htm-7-57-en-us-abapfree-dataobject-htm--must-be-used-to-release-memory-in-internal-tables---free-key-specified-for-sorted-tables-and-hashed-tables-----when-using-the--read--https---help-sap-com-doc-abapdocu-757-index-htm-7-57-en-us-abapread-table-htm--statement-with-a-specified-free-key-of-the-form--with-key------https---help-sap-com-doc-abapdocu-757-index-htm-7-57-en-us-abapread-table-free-htm---the-search-is-optimized-in-all-cases-where-this-is-possible--that-is-------in--sorted-tables--https---help-sap-com-doc-abapdocu-757-index-htm-7-57-en-us-abensorted-table-glosry-htm--glossary-entry----if-any-initial-section-of-the--table-key--https---help-sap-com-doc-abapdocu-757-index-htm-7-57-en-us-abentable-key-glosry-htm--glossary-entry---or-the-complete-table-key-is-covered-by-the-specified-key------in--hashed-tables--https---help-sap-com-doc-abapdocu-757-index-htm-7-57-en-us-abenhashed-table-glosry-htm--glossary-entry----if-the-complete-table-key-is-covered---if-part-of-a-free-key-meets-these-conditions--this-partial-key-is-first-used-to-search-for-an-entry--in-sorted-tables--this-is-done-using-a-binary-search-with-a-logarithmic-consumption-of-resources--and-in-hashed-tables-using-a-hash-algorithm--that-is--with-constant-resource-consumption--if-an-entry-is-found--the-system-checks-whether-the-rest-of-the-key-conditions-are-also-met--this-means-that-over-specific-keys-in-particular-are-optimized---hint--see-also--optimization-of-the-where-condition--https---help-sap-com-doc-abapdocu-757-index-htm-7-57-en-us-abenitab-where-optimization-htm----sorting-----for-textual-sorting-of-an-internal-table-in-accordance-with-the-current--text-environment--https---help-sap-com-doc-abapdocu-757-index-htm-7-57-en-us-abentext-environment-glosry-htm--glossary-entry----it-can-be-more-efficient-to-use-the-statement--convert-text-into-sortable-code--https---help-sap-com-doc-abapdocu-757-index-htm-7-57-en-us-abapconvert-text-htm--instead-of--sort-as-text--https---help-sap-com-doc-abapdocu-757-index-htm-7-57-en-us-abapsort-itab-htm--in-the-following-cases-------if-an-internal-table-is-sorted-by-locale-and-then-searched-binarily-using-the-statement-read-table-or-using-a--table-expression--https---help-sap-com-doc-abapdocu-757-index-htm-7-57-en-us-abentable-expressions-htm-------an-internal-table-must-be-sorted-more-than-once------indexes-for-database-tables-should-be-structured-in-accordance-with-a-locale---continue--itab---optimizing-the-where-condition--https---help-sap-com-doc-abapdocu-757-index-htm-7-57-en-us-abenitab-where-optimization-htm--------abenitab-where-optimization-htm------title---hint--description------if-the-lines-selected-using-where-are-modified-or-deleted-using-modify-https---help-sap-com-doc-abapdocu-757-index-htm-7-57-en-us-abapmodify-itab-htm--or-delete-https---help-sap-com-doc-abapdocu-757-index-htm-7-57-en-us-abapdelete-itab-htm--and-not-just-read-using-loop-at-https---help-sap-com--version---7-57--category---general--type---abap-reference--sourceurl---https---help-sap-com-doc-abapdocu-757-index-htm-7-57-en-us-abenitab-where-optimization-htm--abapfile---abenitab-where-optimization-htm--keywords----select----update----delete----loop----do----if----case----try----catch----data----types----internal-table----abenitab----where----optimization---------------as-abap-release-757---copyright-2023-sap-se--all-rights-reserved----abap---keyword-documentation--https---help-sap-com-doc-abapdocu-757-index-htm-7-57-en-us-abenabap-htm------abap---programming-language--https---help-sap-com-doc-abapdocu-757-index-htm-7-57-en-us-abenabap-reference-htm------processing-internal-data--https---help-sap-com-doc-abapdocu-757-index-htm-7-57-en-us-abenabap-data-working-htm------internal-tables--itab---https---help-sap-com-doc-abapdocu-757-index-htm-7-57-en-us-abenitab-htm------itab---performance-notes--https---help-sap-com-doc-abapdocu-757-index-htm-7-57-en-us-abenitab-perfo-htm------------mail-gif-object-mail-gif-sap-language-en--feedback-mail-for-displayed-topic---mail-feedback--mailto-f1-helpsap.com?subject=Feedback on ABAP Documentation&body=Document: itab - Optimizing the WHERE Condition, ABENITAB_WHERE_OPTIMIZATION, 757%0D%0A%0D%0AEr
ror:%0D%0A%0D%0A%0D%0A%0D%0ASuggestion for improvement:)

itab - Optimizing the WHERE Condition

The statements [LOOP AT](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abaploop_at_itab.htm), [DELETE](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abapdelete_itab.htm), and [MODIFY](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abapmodify_itab.htm) can be specified together with a WHERE condition that selects specific lines of the internal table. Searches in a [standard table](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abenstandard_table_glosry.htm "Glossary Entry") using the [primary table key](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abenprimary_table_key_glosry.htm "Glossary Entry") are always linear and cannot be optimized. Searches using a [sorted key](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abensorted_key_glosry.htm "Glossary Entry") or a [hash key](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abenhash_key_glosry.htm "Glossary Entry"), however, can be optimized in certain circumstances. These keys are used for:

-   accessing a [sorted table](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abensorted_table_glosry.htm "Glossary Entry") using its primary key.
-   accessing a [hashed table](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abenhashed_table_glosry.htm "Glossary Entry") using its primary key.
-   accessing a table of any table type using a [secondary table key](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abensecondary_table_key_glosry.htm "Glossary Entry") specified by USING KEY.

The optimization takes place by mapping all [relational expressions](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abenrelational_expression_glosry.htm "Glossary Entry") or a group of the relational expressions in the WHERE condition to a specified key. This specified key performs a corresponding optimized key access (binary search or hash algorithm as in the statement [READ TABLE](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abapread_table.htm) or a [table expression](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abentable_expressions.htm)), to find one or more lines. The found line or lines are then checked using those remaining relational expressions from the WHERE condition that were not mapped to the specified key.

Prerequisites for the optimization are therefore:

-   The relational expressions of the WHERE condition can be transformed to a specified key.
-   The corresponding key access returns the same results as the evaluation of this part of the logical expression would. This is guaranteed only for compatible data types, since in the case of incompatible data types:
    -   the content of the specified data objects is converted to the data type of the columns before the evaluation in the case of key accesses.
    -   The [comparison rules](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abenlogexp_rules.htm) for incompatible data types apply when evaluating a [comparison expression](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abencomparison_expression_glosry.htm "Glossary Entry"). Here, all the data types involved play a part in determining which operand is converted into which comparison type.

If there are no or insufficient relational expressions to meet both of these prerequisites, no optimization is possible and the behavior is as follows:

-   If a sorted table or a hashed table is accessed using the primary table key, all lines of the internal table are checked as in a standard table.
-   If the table is read using a secondary table key, that is, if said key is specified after USING KEY, a syntax error or syntax check warning, or an exception is raised. Access using a secondary table key must always be executed in an optimized way.

The following sections describe exactly when an access can be optimized.

-   [Prerequisites for the Optimization of Hash Keys](#abenitab-where-optimization-1-------prerequisites-for-the-optimization-of-sorted-keys---@ITOC@@ABENITAB_WHERE_OPTIMIZATION_2)
-   [Requirements Made on the Operands](#@@ITOC@@ABENITAB_WHERE_OPTIMIZATION_3)

Hint

If the lines selected using WHERE are modified or deleted using [MODIFY](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abapmodify_itab.htm) or [DELETE](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abapdelete_itab.htm) and not just read using [LOOP AT](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abaploop_at_itab.htm), further update costs are incurred in addition to the search for the lines. When deleting lines from standard tables, it should be noted that searches using a secondary key optimize the selection of lines to be deleted, but not the update required for the primary key, which is usually performed using a linear search.

Prerequisites for the Optimization of Hash Keys   

In the case of [hash key](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abenhash_key_glosry.htm "Glossary Entry") accesses, there must be exactly one relational expression combined using AND for each component of the key. This expression is either

-   a [comparison expression](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abencomparison_expression_glosry.htm "Glossary Entry") with the comparison operator \= (or EQ), whose operands meet the requirements above or
-   a [predicate expression](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abenpredicate_expression_glosry.htm "Glossary Entry") IS INITIAL without the addition NOT.

These relational expressions construct the part of the logical expression used for the key access. This part must not contain duplicate key components. The remainder of the logical expression can contain any number of relational expressions combined using AND. Optimization may not be possible, however, if the Boolean operators NOT or OR are used. Key components may be used in the relational expressions not used for the key access.

Hint

Relational expressions other than comparisons using \= (or EQ) or predicate expressions IS INITIAL are not part of the key access. This applies particularly to the tabular comparison operator [IN range\_tab](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abenlogexp_select_option.htm), even if it can be traced back to optimizable comparisons.

Example

In the following example, the first two WHERE conditions can be optimized as key accesses with the secondary table key key. This is because:

1.  The optimizable conditions for b, d, and e cover the entire key.
2.  The optimizable conditions b, d, and e cover the entire key and a is a condition on a non-key column that is not involved in the part of the WHERE condition required for the optimization.
3.  The optimizable conditions b, d, and e cover the entire key and the other two conditions on the key columns b and d are not optimizable and are hence not involved in the part of the WHERE condition required for the optimization.

The next six WHERE conditions cannot be optimized and produce syntax errors. This is because:

1.  The key component d is not specified.
2.  A key component is combined using OR instead of AND.
3.  Two non-optimizable comparison operators are used.
4.  An operand of type i is used in the comparison b of type c, which does not meet the requirements made on the operands.
5.  The Boolean operator NOT is used in front of a key component.
6.  A further comparison is combined using OR.
7.  A further comparison is negated using NOT.
    
    DATA: BEGIN OF line,
            a TYPE c LENGTH 3,
            b TYPE c LENGTH 3,
            c TYPE c LENGTH 3,
            d TYPE c LENGTH 3,
            e TYPE c LENGTH 3,
            f TYPE c LENGTH 3,
          END OF line.
    DATA itab LIKE STANDARD TABLE OF line
                   WITH UNIQUE HASHED KEY key COMPONENTS b e d.
    DATA b\_tab LIKE RANGE OF line-b.
    LOOP AT itab INTO line USING KEY key
         WHERE b = '...' AND d = '...' AND e IS INITIAL.
    ENDLOOP.
    LOOP AT itab INTO line USING KEY key
         WHERE a = '...' AND b = '...' AND d = '...' AND e IS INITIAL.
    ENDLOOP.
    LOOP AT itab INTO line USING KEY key
         WHERE  b = '...' AND d = '...' AND e IS INITIAL AND
                b IN b\_tab AND d <> '...'.
    ENDLOOP.
    LOOP AT itab INTO line USING KEY key
         WHERE b = '...' AND e IS INITIAL.                     "syntax error
    ENDLOOP.
    LOOP AT itab INTO line USING KEY key
         WHERE b = '...' OR d = '...' AND e IS INITIAL OR      "syntax error
    ENDLOOP.
    LOOP AT itab INTO line USING KEY key
         WHERE b = '...' AND d <> '...' AND e IS NOT INITIAL.  "syntax error
    ENDLOOP.
    LOOP AT itab INTO line USING KEY key
         WHERE b = 333 AND d = '...' AND e IS INITIAL.         "syntax error
    ENDLOOP.
    LOOP AT itab INTO line USING KEY key
         WHERE b = '...'  AND NOT d = '...' AND e IS INITIAL.  "syntax error
    ENDLOOP.
    LOOP AT itab INTO line USING KEY key
         WHERE b = '...' AND d = '...' AND e IS INITIAL OR     "syntax error
               a = '...'.
    ENDLOOP.
    LOOP AT itab INTO line USING KEY key
         WHERE b = '...' AND d = '...' AND e IS INITIAL AND    "syntax error
               NOT a = '...'.
    ENDLOOP.
    

Prerequisites for the Optimization of Sorted Keys   

In the case of reads using a [sorted key](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abensorted_key_glosry.htm "Glossary Entry"), the same applies as to a hash key. The only difference is that only an initial section of the key consisting of at least one component needs to be covered rather than the entire key.

The internal table is accessed in part sequentially. The starting point for the processing of the table is determined by a binary search using the subconditions that cover the table key completely or partially. From the starting point onwards, the table is only processed for as long as these subconditions remain fulfilled.

Example

In the following example, the first five WHERE conditions can be optimized as key accesses with the secondary table key key. This is because:

1.  b is an initial part of the key.
2.  b is an initial part of the key and a is an independent condition.
3.  b and e are an initial part of the key.
4.  b, e, and d are an initial part of the key and the order in the WHERE condition is ignored.
5.  b is an initial part of the key and in this case, d is an independent condition, even though it is part of the key.

The next five WHERE conditions cannot be optimized and produce syntax errors. This is because:

1.  e is not an initial part of the key.
2.  No inequality comparison takes place.
3.  A comparison in a ranges table is specified.
4.  The Boolean operator NOT is used.
5.  An additional OR relationship is used.
    
    DATA: BEGIN OF line,
            a TYPE c LENGTH 3,
            b TYPE c LENGTH 3,
            c TYPE c LENGTH 3,
            d TYPE c LENGTH 3,
            e TYPE c LENGTH 3,
            f TYPE c LENGTH 3,
          END OF line.
    DATA itab LIKE STANDARD TABLE OF line
                   WITH UNIQUE SORTED KEY key COMPONENTS b e d.
    DATA b\_tab LIKE RANGE OF line-b.
    LOOP AT itab INTO line USING KEY key
                 WHERE b = '...'.
    ENDLOOP.
    LOOP AT itab INTO line USING KEY key
                 WHERE a = '...' AND b IS INITIAL.
    ENDLOOP.
    LOOP AT itab INTO line USING KEY key
                 WHERE b = '...' AND e = '...'.
    ENDLOOP.
    LOOP AT itab INTO line USING KEY key
                 WHERE b = '...' AND d IS INITIAL AND e = '...'.
    ENDLOOP.
    LOOP AT itab INTO line USING KEY key
                 WHERE b = '...' AND d <> '...'.
    ENDLOOP.
    LOOP AT itab INTO line USING KEY key
                 WHERE e = '...'.                    "syntax error
    ENDLOOP.
    LOOP AT itab INTO line USING KEY key
                 WHERE b <> '...'.                   "syntax error
    ENDLOOP.
    LOOP AT itab INTO line USING KEY key
                 WHERE b IN b\_tab.                   "syntax error
    ENDLOOP.
    LOOP AT itab INTO line USING KEY key
                 WHERE b = '...'  AND NOT e = '...'. "syntax error
    ENDLOOP.
    LOOP AT itab INTO line USING KEY key             "syntax error
                 WHERE b = '...'  AND ( d = '...' OR e IS INITIAL ).
    ENDLOOP.
    

Requirements Made on the Operands   

The part of the logical expression that can be mapped to a key access must select the same lines as a statement [READ TABLE](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abapread_table.htm) or a corresponding [table expression](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abentable_expressions.htm) that specifies the corresponding components as keys.

-   When comparing incompatible data objects, the WHERE condition is subject to the same [comparison rules](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abenlogexp_rules.htm) for incompatible data types. Here, the data types involved determine which operand is converted to which comparison type.
-   If the additions [WITH TABLE KEY](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abapread_table_key.htm) and [WITH KEY](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abapread_table_free.htm) of the statement READ or [KEY](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abentable_exp_itab_line.htm) in a table expression are used, however, the content of the specified data objects is always converted to the data type of the columns before the comparison.

If this produces differing results, an optimization is not possible. Due to the complexity of the comparison rules, particularly for [elementary data types](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abenlogexp_rules_operands.htm), it is not a good idea to construct a set of rules detailing exactly when the comparison type matches the data type of the left operand. Generally speaking,

-   only fully compatible operands are optimizable,
-   in some cases, elementary operands with different data types can be optimized, if the value ranges or lengths are suitable. For example, a comparison of a column with the type of a floating point number with an operand of type integer or of a column of c with a similar operand, if its length is less than the length of the column.

For this reason, it is advisable to use only pairs of [compatible](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abencompatible_glosry.htm "Glossary Entry") operands in the WHERE condition. This guarantees that the differences in behavior of the WHERE condition and the specified key do not affect the result.

Example

The following example is largely similar to the example in the section WHERE log\_exp in [LOOP AT itab](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abaploop_at_itab_cond.htm). In that case, access takes place using the primary key and no optimization. Here, however, access takes place using a secondary table key and a syntax check warning is produced and an exception raised when the program is executed. The number of lines in the internal table determines whether the exception is raised.

DATA text\_short TYPE c LENGTH 2.
DATA text\_long  TYPE c LENGTH 4.
DATA itab LIKE TABLE OF text\_short
          WITH UNIQUE HASHED KEY key COMPONENTS table\_line.
itab = VALUE #( ( 'AA' )
                ( 'BB' )
                ( 'CC' )
                ( 'DD' )
                ( 'EE' )
                ( 'FF' )
                ( 'GG' )
                ( 'HH' )
                ( 'II' )
                ( 'JJ' )
                ( 'KK' )
                ( 'LL' )
                ( 'MM' ) ).
text\_short = 'AA'.
text\_long  = 'AAXX'.
LOOP AT itab INTO text\_short USING KEY key
             WHERE table\_line = text\_long.
ENDLOOP.
cl\_demo\_output=>write( |LOOP: { sy-subrc }| ).
"Statement
READ TABLE itab INTO text\_short WITH TABLE KEY key
                                COMPONENTS table\_line = text\_long.
cl\_demo\_output=>write( |READ: { sy-subrc }| ).
"Expression
TRY.
    text\_short = itab\[ KEY key COMPONENTS table\_line = text\_long \].
  catch CX\_SY\_ITAB\_LINE\_NOT\_FOUND.
    ...
ENDTRY.
cl\_demo\_output=>display( |Expression: { text\_short }| ).


---


## ABAP - Keyword Documentation / ABAP - Programming Language / Processing Internal Data / Internal Tables (itab) / itab - Processing Statements / itab - Interval Join

**Files**: 4 | **Difficulty**: intermediate

# ABAP - Keyword Documentation / ABAP - Programming Language / Processing Internal Data / Internal Tables (itab) / itab - Performance Notes

Included pages: 2


### abenitab_perfo.htm

---
title: "Table Sharing"
description: |
  When assignments are made between internal tables of the same type whose line type does not contain any table types, only the internal administration functions are passed to the table body(https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abentable_body_glosry.htm 'Glossary Entry') for pe
version: "7.57"
category: "data-structures"
type: "abap-reference"
sourceUrl: "https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abenitab_perfo.htm"
abapFile: "abenitab_perfo.htm"
keywords: ["select", "insert", "update", "delete", "loop", "do", "if", "case", "try", "data", "types", "internal-table", "abenitab", "perfo"]
---

* * *

AS ABAP Release 757, ©Copyright 2023 SAP SE. All rights reserved.

[ABAP - Keyword Documentation](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abenabap.htm) →  [ABAP - Programming Language](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abenabap_reference.htm) →  [Processing Internal Data](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abenabap_data_working.htm) →  [Internal Tables (itab)](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abenitab.htm) → 

 [![](Mail.gif?object=Mail.gif&sap-language=EN "Feedback mail for displayed topic") Mail Feedback](mailto:f1_help@sap.com?subject=Feedback on ABAP Documentation&body=Document: itab - Performance Notes, ABENITAB_PERFO, 757%0D%0A%0D%0AError:%0D%0A%0D%0A%0D%0A%0D%
0ASuggestion for improvement:)

itab - Performance Notes

-   [Table Sharing](#abenitab-perfo-1-------initial-memory-requirement---@ITOC@@ABENITAB_PERFO_2)
-   [Index Administration](#abenitab-perfo-3-------block-processing-of-table-lines---@ITOC@@ABENITAB_PERFO_4)
-   [Selective Data Transport](#abenitab-perfo-5-------using-secondary-keys---@ITOC@@ABENITAB_PERFO_6)
-   [Deleting Table Lines](#abenitab-perfo-7-------free-key-specified-for-sorted-tables-and-hashed-tables---@ITOC@@ABENITAB_PERFO_8)
-   [Sorting](#abenitab-perfo-9---table-sharing-----when-assignments-are-made-between-internal-tables-of-the-same-type-whose-line-type-does-not-contain-any-table-types--only-the-internal-administration-functions-are-passed-to-the--table-body--https---help-sap-com-doc-abapdocu-757-index-htm-7-57-en-us-abentable-body-glosry-htm--glossary-entry---for-performance-reasons---table-sharing--https---help-sap-com-doc-abapdocu-757-index-htm-7-57-en-us-abentable-sharing-glosry-htm--glossary-entry---is-revoked-only-when-write-access-to-one-of-the-tables-involved-is-initiated--the-actual-copy-process-then-takes-place---initial-memory-requirement-----internal-tables-are--dynamic-data-objects--https---help-sap-com-doc-abapdocu-757-index-htm-7-57-en-us-abendynamic-data-object-glosry-htm--glossary-entry---whose-area-in-the-memory-is-extended-block-by-block--the-size-of-the-first-block-in-the-memory-is-called--initial-memory-requirement--https---help-sap-com-doc-abapdocu-757-index-htm-7-57-en-us-abeninitial-mem-req-glosry-htm--glossary-entry---and-can-be-affected-in-the-declaration-of-an-internal-table-using-the-additions--initial-size--https---help-sap-com-doc-abapdocu-757-index-htm-7-57-en-us-abaptypes-itab-htm--and-the-obsolete--occurs--https---help-sap-com-doc-abapdocu-757-index-htm-7-57-en-us-abapdata-occurs-htm----it-is-usually-up-to-the-system-to-determine-the-size-of-the-first-block--initial-size-is-not-used-or-specified-with-the-value-0--in-this-case--a-suitable-block-size-is-chosen-the-first-time-lines-are-added-to-an-internal-table---specifying-a-concrete-value-greater-than-0-after-initial-size-is-only-practical-if-it-is-known-in-advance-how-many-entries-are-to-be-made-in-the-table--and-the-first-block-is-therefore-to-be-created-with-the-most-suitable-dimensions--this-can-be-particularly-important-for-internal-tables-that-are-components-of-other-internal-tables--and-which-only-contain-a-few-lines--no-more-than-around-5----to-avoid-excessive-memory-demands--the-system-ignores-values-that-produce-memory-demands-greater-than-the-constant-block-size---index-administration-----in-an--index-table--https---help-sap-com-doc-abapdocu-757-index-htm-7-57-en-us-abenindex-table-glosry-htm--glossary-entry----the-logical-order-of-the-table-entries-is-not-generally-consistent-with-the-physical-order-of-the-entries-in-the-main-memory--in-this-case--the-logical-order-is-no-longer-administrated-by-a-physical-index--but-by-a-logical-index--the-same-basically-applies-to-the--secondary-table-indexes--https---help-sap-com-doc-abapdocu-757-index-htm-7-57-en-us-abensecondary-table-index-glosry-htm--glossary-entry---used-to-manage--secondary--https---help-sap-com-doc-abapdocu-757-index-htm-7-57-en-us-abensecondary-table-key-glosry-htm--glossary-entry----sorted-keys--https---help-sap-com-doc-abapdocu-757-index-htm-7-57-en-us-abensorted-key-glosry-htm--glossary-entry-----use-of-the-logical-index-produces-additional-memory-requirements--and-index-maintenance-places-a-high-demand-on-resources--time-and-memory--when-inserting-or-deleting-table-lines--the-resource-requirements-increase-proportionally-with-the-number-of-remaining-lines-after-the-insertion-or-deletion-position--for-very-large-internal-tables--this-can-result-in-considerable-demands-on-performance-at-runtime---the-logical-index-is-only-created-when-it-is-needed--that-is--when-a-line-is-inserted-in-front-of-another-line--if-the-order-of-the-table-lines-is-changed--or-a-line-other-than-the-last-line-is-deleted--a-logical-index-is-not-required-if-an-internal-table-is-filled-using-only--append--https---help-sap-com-doc-abapdocu-757-index-htm-7-57-en-us-abapappend-htm---and-if-only-its-last-line-or-lines-is-are-deleted-using--delete--https---help-sap-com-doc-abapdocu-757-index-htm-7-57-en-us-abapdelete-itab-htm----hint--in-contrast-to-filling-a-table-with--insert--https---help-sap-com-doc-abapdocu-757-index-htm-7-57-en-us-abapinsert-itab-htm---appending-lines-with--append--https---help-sap-com-doc-abapdocu-757-index-htm-7-57-en-us-abapappend-htm--does-not-require-any-resources-for-index-maintenance--it-is-therefore-preferable-to-use-append-instead-of-insert-to-create-a--standard-table--https---help-sap-com-doc-abapdocu-757-index-htm-7-57-en-us-abenstandard-table-glosry-htm--glossary-entry----this-is-possible-if-the-order-of-the-entries-is-not-important--or-if-entries-can-be-appended-in-the-correct-order---block-processing-of-table-lines-----if-entire-line-areas-of-a-table-can-be-processed-at-once--this-should-not-be-done-line-by-line--but-using-block-operations--block-operations-are-possible-using-the-from-and-to-additions-of-the-statements--insert--https---help-sap-com-doc-abapdocu-757-index-htm-7-57-en-us-abapinsert-itab-htm----append--https---help-sap-com-doc-abapdocu-757-index-htm-7-57-en-us-abapappend-htm--and--delete--https---help-sap-com-doc-abapdocu-757-index-htm-7-57-en-us-abapdelete-itab-htm---block-operations-are-also-more-efficient-than-single-record-operations-when-reading-from-or-modifying-database-tables-with--abap-sql--https---help-sap-com-doc-abapdocu-757-index-htm-7-57-en-us-abenabap-sql-glosry-htm--glossary-entry---statements-with-the-additions-from---appending---to-table---selective-data-transport-----if--when-reading-table-lines-using--read-table--https---help-sap-com-doc-abapdocu-757-index-htm-7-57-en-us-abapread-table-htm--or--loop-at--https---help-sap-com-doc-abapdocu-757-index-htm-7-57-en-us-abaploop-at-itab-htm---a-work-area-is-used-or-table-lines-can-be-changed-using--modify--https---help-sap-com-doc-abapdocu-757-index-htm-7-57-en-us-abapmodify-itab-htm--instead-of-direct-access--the-transporting-addition-can-be-used-to-prevent-unnecessary-assignments-of-table-components-to-the-work-area--this-can-lead-to-a-noticeable-improvement-in-performance--particularly-if-table-like-components-are-excluded-from-processing---using-secondary-keys-----the--use-of-secondary-table-keys--https---help-sap-com-doc-abapdocu-757-index-htm-7-57-en-us-abenitab-key-secondary-usage-htm--should-be-planned-and-executed-carefully-and-sparingly--the-time-gained-when-accessing-individual-lines-should-not-be-lost-again-by-the-increased-memory-and-time-requirements-for-managing-the-secondary-keys--secondary-keys-are-generally-recommended-for-internal-tables-that-are-filled-once-and-rarely-changed-during-program-execution---example--the-program-demo--secondary--keys-demonstrates-how-a-secondary-table-key-is-specified-and-the-resulting-performance-gain---deleting-table-lines-----when-lines-are-deleted-from-an-internal-table--administration-costs-are-incurred-for-all-table-keys-and-table-indexes--the-primary-key-and-all-unique-secondary-keys-are-updated-directly--but-non-unique-secondary-keys-are-updated-only-if-the-line-to-be-deleted-is-included-in-the-updated-part-of-an-associated-index---lazy-update--https---help-sap-com-doc-abapdocu-757-index-htm-7-57-en-us-abenlazy-update-glosry-htm--glossary-entry------it-should-be-noted-that--particularly-for-standard-tables--the-mean-runtime-of-the-statement--delete--https---help-sap-com-doc-abapdocu-757-index-htm-7-57-en-us-abapdelete-itab-htm--always-depends-linearly-on-the-number-of-table-lines--even-when-secondary-keys-are-specified-using--with-table-key--https---help-sap-com-doc-abapdocu-757-index-htm-7-57-en-us-abapdelete-itab-key-htm--or--using-key--https---help-sap-com-doc-abapdocu-757-index-htm-7-57-en-us-abapdelete-itab-key-htm---this-is-because-a-linear-search-is-required-to-update-the-primary-index--even-though-the-line-to-be-deleted-can-itself-be-found-quickly---deleting-lines-in-internal-tables-using--delete--https---help-sap-com-doc-abapdocu-757-index-htm-7-57-en-us-abapdelete-itab-htm--does-not-usually-release-any-memory-in-the-internal-table--statements-such-as--clear--https---help-sap-com-doc-abapdocu-757-index-htm-7-57-en-us-abapclear-htm--or--free--https---help-sap-com-doc-abapdocu-757-index-htm-7-57-en-us-abapfree-dataobject-htm--must-be-used-to-release-memory-in-internal-tables---free-key-specified-for-sorted-tables-and-hashed-tables-----when-using-the--read--https---help-sap-com-doc-abapdocu-757-index-htm-7-57-en-us-abapread-table-htm--statement-with-a-specified-free-key-of-the-form--with-key------https---help-sap-com-doc-abapdocu-757-index-htm-7-57-en-us-abapread-table-free-htm---the-search-is-optimized-in-all-cases-where-this-is-possible--that-is-------in--sorted-tables--https---help-sap-com-doc-abapdocu-757-index-htm-7-57-en-us-abensorted-table-glosry-htm--glossary-entry----if-any-initial-section-of-the--table-key--https---help-sap-com-doc-abapdocu-757-index-htm-7-57-en-us-abentable-key-glosry-htm--glossary-entry---or-the-complete-table-key-is-covered-by-the-specified-key------in--hashed-tables--https---help-sap-com-doc-abapdocu-757-index-htm-7-57-en-us-abenhashed-table-glosry-htm--glossary-entry----if-the-complete-table-key-is-covered---if-part-of-a-free-key-meets-these-conditions--this-partial-key-is-first-used-to-search-for-an-entry--in-sorted-tables--this-is-done-using-a-binary-search-with-a-logarithmic-consumption-of-resources--and-in-hashed-tables-using-a-hash-algorithm--that-is--with-constant-resource-consumption--if-an-entry-is-found--the-system-checks-whether-the-rest-of-the-key-conditions-are-also-met--this-means-that-over-specific-keys-in-particular-are-optimized---hint--see-also--optimization-of-the-where-condition--https---help-sap-com-doc-abapdocu-757-index-htm-7-57-en-us-abenitab-where-optimization-htm----sorting-----for-textual-sorting-of-an-internal-table-in-accordance-with-the-current--text-environment--https---help-sap-com-doc-abapdocu-757-index-htm-7-57-en-us-abentext-environment-glosry-htm--glossary-entry----it-can-be-more-efficient-to-use-the-statement--convert-text-into-sortable-code--https---help-sap-com-doc-abapdocu-757-index-htm-7-57-en-us-abapconvert-text-htm--instead-of--sort-as-text--https---help-sap-com-doc-abapdocu-757-index-htm-7-57-en-us-abapsort-itab-htm--in-the-following-cases-------if-an-internal-table-is-sorted-by-locale-and-then-searched-binarily-using-the-statement-read-table-or-using-a--table-expression--https---help-sap-com-doc-abapdocu-757-index-htm-7-57-en-us-abentable-expressions-htm-------an-internal-table-must-be-sorted-more-than-once------indexes-for-database-tables-should-be-structured-in-accordance-with-a-locale---continue--itab---optimizing-the-where-condition--https---help-sap-com-doc-abapdocu-757-index-htm-7-57-en-us-abenitab-where-optimization-htm--------abenitab-where-optimization-htm------title---hint--description------if-the-lines-selected-using-where-are-modified-or-deleted-using-modify-https---help-sap-com-doc-abapdocu-757-index-htm-7-57-en-us-abapmodify-itab-htm--or-delete-https---help-sap-com-doc-abapdocu-757-index-htm-7-57-en-us-abapdelete-itab-htm--and-not-just-read-using-loop-at-https---help-sap-com--version---7-57--category---general--type---abap-reference--sourceurl---https---help-sap-com-doc-abapdocu-757-index-htm-7-57-en-us-abenitab-where-optimization-htm--abapfile---abenitab-where-optimization-htm--keywords----select----update----delete----loop----do----if----case----try----catch----data----types----internal-table----abenitab----where----optimization---------------as-abap-release-757---copyright-2023-sap-se--all-rights-reserved----abap---keyword-documentation--https---help-sap-com-doc-abapdocu-757-index-htm-7-57-en-us-abenabap-htm------abap---programming-language--https---help-sap-com-doc-abapdocu-757-index-htm-7-57-en-us-abenabap-reference-htm------processing-internal-data--https---help-sap-com-doc-abapdocu-757-index-htm-7-57-en-us-abenabap-data-working-htm------internal-tables--itab---https---help-sap-com-doc-abapdocu-757-index-htm-7-57-en-us-abenitab-htm------itab---performance-notes--https---help-sap-com-doc-abapdocu-757-index-htm-7-57-en-us-abenitab-perfo-htm------------mail-gif-object-mail-gif-sap-language-en--feedback-mail-for-displayed-topic---mail-feedback--mailto-f1-helpsap.com?subject=Feedback on ABAP Documentation&body=Document: itab - Optimizing the WHERE Condition, ABENITAB_WHERE_OPTIMIZATION, 757%0D%0A%0D%0AEr
ror:%0D%0A%0D%0A%0D%0A%0D%0ASuggestion for improvement:)

itab - Optimizing the WHERE Condition

The statements [LOOP AT](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abaploop_at_itab.htm), [DELETE](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abapdelete_itab.htm), and [MODIFY](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abapmodify_itab.htm) can be specified together with a WHERE condition that selects specific lines of the internal table. Searches in a [standard table](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abenstandard_table_glosry.htm "Glossary Entry") using the [primary table key](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abenprimary_table_key_glosry.htm "Glossary Entry") are always linear and cannot be optimized. Searches using a [sorted key](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abensorted_key_glosry.htm "Glossary Entry") or a [hash key](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abenhash_key_glosry.htm "Glossary Entry"), however, can be optimized in certain circumstances. These keys are used for:

-   accessing a [sorted table](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abensorted_table_glosry.htm "Glossary Entry") using its primary key.
-   accessing a [hashed table](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abenhashed_table_glosry.htm "Glossary Entry") using its primary key.
-   accessing a table of any table type using a [secondary table key](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abensecondary_table_key_glosry.htm "Glossary Entry") specified by USING KEY.

The optimization takes place by mapping all [relational expressions](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abenrelational_expression_glosry.htm "Glossary Entry") or a group of the relational expressions in the WHERE condition to a specified key. This specified key performs a corresponding optimized key access (binary search or hash algorithm as in the statement [READ TABLE](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abapread_table.htm) or a [table expression](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abentable_expressions.htm)), to find one or more lines. The found line or lines are then checked using those remaining relational expressions from the WHERE condition that were not mapped to the specified key.

Prerequisites for the optimization are therefore:

-   The relational expressions of the WHERE condition can be transformed to a specified key.
-   The corresponding key access returns the same results as the evaluation of this part of the logical expression would. This is guaranteed only for compatible data types, since in the case of incompatible data types:
    -   the content of the specified data objects is converted to the data type of the columns before the evaluation in the case of key accesses.
    -   The [comparison rules](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abenlogexp_rules.htm) for incompatible data types apply when evaluating a [comparison expression](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abencomparison_expression_glosry.htm "Glossary Entry"). Here, all the data types involved play a part in determining which operand is converted into which comparison type.

If there are no or insufficient relational expressions to meet both of these prerequisites, no optimization is possible and the behavior is as follows:

-   If a sorted table or a hashed table is accessed using the primary table key, all lines of the internal table are checked as in a standard table.
-   If the table is read using a secondary table key, that is, if said key is specified after USING KEY, a syntax error or syntax check warning, or an exception is raised. Access using a secondary table key must always be executed in an optimized way.

The following sections describe exactly when an access can be optimized.

-   [Prerequisites for the Optimization of Hash Keys](#abenitab-where-optimization-1-------prerequisites-for-the-optimization-of-sorted-keys---@ITOC@@ABENITAB_WHERE_OPTIMIZATION_2)
-   [Requirements Made on the Operands](#@@ITOC@@ABENITAB_WHERE_OPTIMIZATION_3)

Hint

If the lines selected using WHERE are modified or deleted using [MODIFY](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abapmodify_itab.htm) or [DELETE](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abapdelete_itab.htm) and not just read using [LOOP AT](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abaploop_at_itab.htm), further update costs are incurred in addition to the search for the lines. When deleting lines from standard tables, it should be noted that searches using a secondary key optimize the selection of lines to be deleted, but not the update required for the primary key, which is usually performed using a linear search.

Prerequisites for the Optimization of Hash Keys   

In the case of [hash key](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abenhash_key_glosry.htm "Glossary Entry") accesses, there must be exactly one relational expression combined using AND for each component of the key. This expression is either

-   a [comparison expression](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abencomparison_expression_glosry.htm "Glossary Entry") with the comparison operator \= (or EQ), whose operands meet the requirements above or
-   a [predicate expression](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abenpredicate_expression_glosry.htm "Glossary Entry") IS INITIAL without the addition NOT.

These relational expressions construct the part of the logical expression used for the key access. This part must not contain duplicate key components. The remainder of the logical expression can contain any number of relational expressions combined using AND. Optimization may not be possible, however, if the Boolean operators NOT or OR are used. Key components may be used in the relational expressions not used for the key access.

Hint

Relational expressions other than comparisons using \= (or EQ) or predicate expressions IS INITIAL are not part of the key access. This applies particularly to the tabular comparison operator [IN range\_tab](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abenlogexp_select_option.htm), even if it can be traced back to optimizable comparisons.

Example

In the following example, the first two WHERE conditions can be optimized as key accesses with the secondary table key key. This is because:

1.  The optimizable conditions for b, d, and e cover the entire key.
2.  The optimizable conditions b, d, and e cover the entire key and a is a condition on a non-key column that is not involved in the part of the WHERE condition required for the optimization.
3.  The optimizable conditions b, d, and e cover the entire key and the other two conditions on the key columns b and d are not optimizable and are hence not involved in the part of the WHERE condition required for the optimization.

The next six WHERE conditions cannot be optimized and produce syntax errors. This is because:

1.  The key component d is not specified.
2.  A key component is combined using OR instead of AND.
3.  Two non-optimizable comparison operators are used.
4.  An operand of type i is used in the comparison b of type c, which does not meet the requirements made on the operands.
5.  The Boolean operator NOT is used in front of a key component.
6.  A further comparison is combined using OR.
7.  A further comparison is negated using NOT.
    
    DATA: BEGIN OF line,
            a TYPE c LENGTH 3,
            b TYPE c LENGTH 3,
            c TYPE c LENGTH 3,
            d TYPE c LENGTH 3,
            e TYPE c LENGTH 3,
            f TYPE c LENGTH 3,
          END OF line.
    DATA itab LIKE STANDARD TABLE OF line
                   WITH UNIQUE HASHED KEY key COMPONENTS b e d.
    DATA b\_tab LIKE RANGE OF line-b.
    LOOP AT itab INTO line USING KEY key
         WHERE b = '...' AND d = '...' AND e IS INITIAL.
    ENDLOOP.
    LOOP AT itab INTO line USING KEY key
         WHERE a = '...' AND b = '...' AND d = '...' AND e IS INITIAL.
    ENDLOOP.
    LOOP AT itab INTO line USING KEY key
         WHERE  b = '...' AND d = '...' AND e IS INITIAL AND
                b IN b\_tab AND d <> '...'.
    ENDLOOP.
    LOOP AT itab INTO line USING KEY key
         WHERE b = '...' AND e IS INITIAL.                     "syntax error
    ENDLOOP.
    LOOP AT itab INTO line USING KEY key
         WHERE b = '...' OR d = '...' AND e IS INITIAL OR      "syntax error
    ENDLOOP.
    LOOP AT itab INTO line USING KEY key
         WHERE b = '...' AND d <> '...' AND e IS NOT INITIAL.  "syntax error
    ENDLOOP.
    LOOP AT itab INTO line USING KEY key
         WHERE b = 333 AND d = '...' AND e IS INITIAL.         "syntax error
    ENDLOOP.
    LOOP AT itab INTO line USING KEY key
         WHERE b = '...'  AND NOT d = '...' AND e IS INITIAL.  "syntax error
    ENDLOOP.
    LOOP AT itab INTO line USING KEY key
         WHERE b = '...' AND d = '...' AND e IS INITIAL OR     "syntax error
               a = '...'.
    ENDLOOP.
    LOOP AT itab INTO line USING KEY key
         WHERE b = '...' AND d = '...' AND e IS INITIAL AND    "syntax error
               NOT a = '...'.
    ENDLOOP.
    

Prerequisites for the Optimization of Sorted Keys   

In the case of reads using a [sorted key](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abensorted_key_glosry.htm "Glossary Entry"), the same applies as to a hash key. The only difference is that only an initial section of the key consisting of at least one component needs to be covered rather than the entire key.

The internal table is accessed in part sequentially. The starting point for the processing of the table is determined by a binary search using the subconditions that cover the table key completely or partially. From the starting point onwards, the table is only processed for as long as these subconditions remain fulfilled.

Example

In the following example, the first five WHERE conditions can be optimized as key accesses with the secondary table key key. This is because:

1.  b is an initial part of the key.
2.  b is an initial part of the key and a is an independent condition.
3.  b and e are an initial part of the key.
4.  b, e, and d are an initial part of the key and the order in the WHERE condition is ignored.
5.  b is an initial part of the key and in this case, d is an independent condition, even though it is part of the key.

The next five WHERE conditions cannot be optimized and produce syntax errors. This is because:

1.  e is not an initial part of the key.
2.  No inequality comparison takes place.
3.  A comparison in a ranges table is specified.
4.  The Boolean operator NOT is used.
5.  An additional OR relationship is used.
    
    DATA: BEGIN OF line,
            a TYPE c LENGTH 3,
            b TYPE c LENGTH 3,
            c TYPE c LENGTH 3,
            d TYPE c LENGTH 3,
            e TYPE c LENGTH 3,
            f TYPE c LENGTH 3,
          END OF line.
    DATA itab LIKE STANDARD TABLE OF line
                   WITH UNIQUE SORTED KEY key COMPONENTS b e d.
    DATA b\_tab LIKE RANGE OF line-b.
    LOOP AT itab INTO line USING KEY key
                 WHERE b = '...'.
    ENDLOOP.
    LOOP AT itab INTO line USING KEY key
                 WHERE a = '...' AND b IS INITIAL.
    ENDLOOP.
    LOOP AT itab INTO line USING KEY key
                 WHERE b = '...' AND e = '...'.
    ENDLOOP.
    LOOP AT itab INTO line USING KEY key
                 WHERE b = '...' AND d IS INITIAL AND e = '...'.
    ENDLOOP.
    LOOP AT itab INTO line USING KEY key
                 WHERE b = '...' AND d <> '...'.
    ENDLOOP.
    LOOP AT itab INTO line USING KEY key
                 WHERE e = '...'.                    "syntax error
    ENDLOOP.
    LOOP AT itab INTO line USING KEY key
                 WHERE b <> '...'.                   "syntax error
    ENDLOOP.
    LOOP AT itab INTO line USING KEY key
                 WHERE b IN b\_tab.                   "syntax error
    ENDLOOP.
    LOOP AT itab INTO line USING KEY key
                 WHERE b = '...'  AND NOT e = '...'. "syntax error
    ENDLOOP.
    LOOP AT itab INTO line USING KEY key             "syntax error
                 WHERE b = '...'  AND ( d = '...' OR e IS INITIAL ).
    ENDLOOP.
    

Requirements Made on the Operands   

The part of the logical expression that can be mapped to a key access must select the same lines as a statement [READ TABLE](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abapread_table.htm) or a corresponding [table expression](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abentable_expressions.htm) that specifies the corresponding components as keys.

-   When comparing incompatible data objects, the WHERE condition is subject to the same [comparison rules](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abenlogexp_rules.htm) for incompatible data types. Here, the data types involved determine which operand is converted to which comparison type.
-   If the additions [WITH TABLE KEY](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abapread_table_key.htm) and [WITH KEY](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abapread_table_free.htm) of the statement READ or [KEY](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abentable_exp_itab_line.htm) in a table expression are used, however, the content of the specified data objects is always converted to the data type of the columns before the comparison.

If this produces differing results, an optimization is not possible. Due to the complexity of the comparison rules, particularly for [elementary data types](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abenlogexp_rules_operands.htm), it is not a good idea to construct a set of rules detailing exactly when the comparison type matches the data type of the left operand. Generally speaking,

-   only fully compatible operands are optimizable,
-   in some cases, elementary operands with different data types can be optimized, if the value ranges or lengths are suitable. For example, a comparison of a column with the type of a floating point number with an operand of type integer or of a column of c with a similar operand, if its length is less than the length of the column.

For this reason, it is advisable to use only pairs of [compatible](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abencompatible_glosry.htm "Glossary Entry") operands in the WHERE condition. This guarantees that the differences in behavior of the WHERE condition and the specified key do not affect the result.

Example

The following example is largely similar to the example in the section WHERE log\_exp in [LOOP AT itab](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abaploop_at_itab_cond.htm). In that case, access takes place using the primary key and no optimization. Here, however, access takes place using a secondary table key and a syntax check warning is produced and an exception raised when the program is executed. The number of lines in the internal table determines whether the exception is raised.

DATA text\_short TYPE c LENGTH 2.
DATA text\_long  TYPE c LENGTH 4.
DATA itab LIKE TABLE OF text\_short
          WITH UNIQUE HASHED KEY key COMPONENTS table\_line.
itab = VALUE #( ( 'AA' )
                ( 'BB' )
                ( 'CC' )
                ( 'DD' )
                ( 'EE' )
                ( 'FF' )
                ( 'GG' )
                ( 'HH' )
                ( 'II' )
                ( 'JJ' )
                ( 'KK' )
                ( 'LL' )
                ( 'MM' ) ).
text\_short = 'AA'.
text\_long  = 'AAXX'.
LOOP AT itab INTO text\_short USING KEY key
             WHERE table\_line = text\_long.
ENDLOOP.
cl\_demo\_output=>write( |LOOP: { sy-subrc }| ).
"Statement
READ TABLE itab INTO text\_short WITH TABLE KEY key
                                COMPONENTS table\_line = text\_long.
cl\_demo\_output=>write( |READ: { sy-subrc }| ).
"Expression
TRY.
    text\_short = itab\[ KEY key COMPONENTS table\_line = text\_long \].
  catch CX\_SY\_ITAB\_LINE\_NOT\_FOUND.
    ...
ENDTRY.
cl\_demo\_output=>display( |Expression: { text\_short }| ).


---


## ABAP - Keyword Documentation / ABAP - Programming Language / Processing Internal Data / Internal Tables (itab) / itab - Expressions and Functions / itab - Table Expressions (table_exp) / table_exp - itab_line

**Files**: 2 | **Difficulty**: intermediate

# ABAP - Keyword Documentation / ABAP - Programming Language / Processing Internal Data / Internal Tables (itab) / itab - Performance Notes

Included pages: 2


### abenitab_perfo.htm

---
title: "Table Sharing"
description: |
  When assignments are made between internal tables of the same type whose line type does not contain any table types, only the internal administration functions are passed to the table body(https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abentable_body_glosry.htm 'Glossary Entry') for pe
version: "7.57"
category: "data-structures"
type: "abap-reference"
sourceUrl: "https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abenitab_perfo.htm"
abapFile: "abenitab_perfo.htm"
keywords: ["select", "insert", "update", "delete", "loop", "do", "if", "case", "try", "data", "types", "internal-table", "abenitab", "perfo"]
---

* * *

AS ABAP Release 757, ©Copyright 2023 SAP SE. All rights reserved.

[ABAP - Keyword Documentation](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abenabap.htm) →  [ABAP - Programming Language](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abenabap_reference.htm) →  [Processing Internal Data](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abenabap_data_working.htm) →  [Internal Tables (itab)](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abenitab.htm) → 

 [![](Mail.gif?object=Mail.gif&sap-language=EN "Feedback mail for displayed topic") Mail Feedback](mailto:f1_help@sap.com?subject=Feedback on ABAP Documentation&body=Document: itab - Performance Notes, ABENITAB_PERFO, 757%0D%0A%0D%0AError:%0D%0A%0D%0A%0D%0A%0D%
0ASuggestion for improvement:)

itab - Performance Notes

-   [Table Sharing](#abenitab-perfo-1-------initial-memory-requirement---@ITOC@@ABENITAB_PERFO_2)
-   [Index Administration](#abenitab-perfo-3-------block-processing-of-table-lines---@ITOC@@ABENITAB_PERFO_4)
-   [Selective Data Transport](#abenitab-perfo-5-------using-secondary-keys---@ITOC@@ABENITAB_PERFO_6)
-   [Deleting Table Lines](#abenitab-perfo-7-------free-key-specified-for-sorted-tables-and-hashed-tables---@ITOC@@ABENITAB_PERFO_8)
-   [Sorting](#abenitab-perfo-9---table-sharing-----when-assignments-are-made-between-internal-tables-of-the-same-type-whose-line-type-does-not-contain-any-table-types--only-the-internal-administration-functions-are-passed-to-the--table-body--https---help-sap-com-doc-abapdocu-757-index-htm-7-57-en-us-abentable-body-glosry-htm--glossary-entry---for-performance-reasons---table-sharing--https---help-sap-com-doc-abapdocu-757-index-htm-7-57-en-us-abentable-sharing-glosry-htm--glossary-entry---is-revoked-only-when-write-access-to-one-of-the-tables-involved-is-initiated--the-actual-copy-process-then-takes-place---initial-memory-requirement-----internal-tables-are--dynamic-data-objects--https---help-sap-com-doc-abapdocu-757-index-htm-7-57-en-us-abendynamic-data-object-glosry-htm--glossary-entry---whose-area-in-the-memory-is-extended-block-by-block--the-size-of-the-first-block-in-the-memory-is-called--initial-memory-requirement--https---help-sap-com-doc-abapdocu-757-index-htm-7-57-en-us-abeninitial-mem-req-glosry-htm--glossary-entry---and-can-be-affected-in-the-declaration-of-an-internal-table-using-the-additions--initial-size--https---help-sap-com-doc-abapdocu-757-index-htm-7-57-en-us-abaptypes-itab-htm--and-the-obsolete--occurs--https---help-sap-com-doc-abapdocu-757-index-htm-7-57-en-us-abapdata-occurs-htm----it-is-usually-up-to-the-system-to-determine-the-size-of-the-first-block--initial-size-is-not-used-or-specified-with-the-value-0--in-this-case--a-suitable-block-size-is-chosen-the-first-time-lines-are-added-to-an-internal-table---specifying-a-concrete-value-greater-than-0-after-initial-size-is-only-practical-if-it-is-known-in-advance-how-many-entries-are-to-be-made-in-the-table--and-the-first-block-is-therefore-to-be-created-with-the-most-suitable-dimensions--this-can-be-particularly-important-for-internal-tables-that-are-components-of-other-internal-tables--and-which-only-contain-a-few-lines--no-more-than-around-5----to-avoid-excessive-memory-demands--the-system-ignores-values-that-produce-memory-demands-greater-than-the-constant-block-size---index-administration-----in-an--index-table--https---help-sap-com-doc-abapdocu-757-index-htm-7-57-en-us-abenindex-table-glosry-htm--glossary-entry----the-logical-order-of-the-table-entries-is-not-generally-consistent-with-the-physical-order-of-the-entries-in-the-main-memory--in-this-case--the-logical-order-is-no-longer-administrated-by-a-physical-index--but-by-a-logical-index--the-same-basically-applies-to-the--secondary-table-indexes--https---help-sap-com-doc-abapdocu-757-index-htm-7-57-en-us-abensecondary-table-index-glosry-htm--glossary-entry---used-to-manage--secondary--https---help-sap-com-doc-abapdocu-757-index-htm-7-57-en-us-abensecondary-table-key-glosry-htm--glossary-entry----sorted-keys--https---help-sap-com-doc-abapdocu-757-index-htm-7-57-en-us-abensorted-key-glosry-htm--glossary-entry-----use-of-the-logical-index-produces-additional-memory-requirements--and-index-maintenance-places-a-high-demand-on-resources--time-and-memory--when-inserting-or-deleting-table-lines--the-resource-requirements-increase-proportionally-with-the-number-of-remaining-lines-after-the-insertion-or-deletion-position--for-very-large-internal-tables--this-can-result-in-considerable-demands-on-performance-at-runtime---the-logical-index-is-only-created-when-it-is-needed--that-is--when-a-line-is-inserted-in-front-of-another-line--if-the-order-of-the-table-lines-is-changed--or-a-line-other-than-the-last-line-is-deleted--a-logical-index-is-not-required-if-an-internal-table-is-filled-using-only--append--https---help-sap-com-doc-abapdocu-757-index-htm-7-57-en-us-abapappend-htm---and-if-only-its-last-line-or-lines-is-are-deleted-using--delete--https---help-sap-com-doc-abapdocu-757-index-htm-7-57-en-us-abapdelete-itab-htm----hint--in-contrast-to-filling-a-table-with--insert--https---help-sap-com-doc-abapdocu-757-index-htm-7-57-en-us-abapinsert-itab-htm---appending-lines-with--append--https---help-sap-com-doc-abapdocu-757-index-htm-7-57-en-us-abapappend-htm--does-not-require-any-resources-for-index-maintenance--it-is-therefore-preferable-to-use-append-instead-of-insert-to-create-a--standard-table--https---help-sap-com-doc-abapdocu-757-index-htm-7-57-en-us-abenstandard-table-glosry-htm--glossary-entry----this-is-possible-if-the-order-of-the-entries-is-not-important--or-if-entries-can-be-appended-in-the-correct-order---block-processing-of-table-lines-----if-entire-line-areas-of-a-table-can-be-processed-at-once--this-should-not-be-done-line-by-line--but-using-block-operations--block-operations-are-possible-using-the-from-and-to-additions-of-the-statements--insert--https---help-sap-com-doc-abapdocu-757-index-htm-7-57-en-us-abapinsert-itab-htm----append--https---help-sap-com-doc-abapdocu-757-index-htm-7-57-en-us-abapappend-htm--and--delete--https---help-sap-com-doc-abapdocu-757-index-htm-7-57-en-us-abapdelete-itab-htm---block-operations-are-also-more-efficient-than-single-record-operations-when-reading-from-or-modifying-database-tables-with--abap-sql--https---help-sap-com-doc-abapdocu-757-index-htm-7-57-en-us-abenabap-sql-glosry-htm--glossary-entry---statements-with-the-additions-from---appending---to-table---selective-data-transport-----if--when-reading-table-lines-using--read-table--https---help-sap-com-doc-abapdocu-757-index-htm-7-57-en-us-abapread-table-htm--or--loop-at--https---help-sap-com-doc-abapdocu-757-index-htm-7-57-en-us-abaploop-at-itab-htm---a-work-area-is-used-or-table-lines-can-be-changed-using--modify--https---help-sap-com-doc-abapdocu-757-index-htm-7-57-en-us-abapmodify-itab-htm--instead-of-direct-access--the-transporting-addition-can-be-used-to-prevent-unnecessary-assignments-of-table-components-to-the-work-area--this-can-lead-to-a-noticeable-improvement-in-performance--particularly-if-table-like-components-are-excluded-from-processing---using-secondary-keys-----the--use-of-secondary-table-keys--https---help-sap-com-doc-abapdocu-757-index-htm-7-57-en-us-abenitab-key-secondary-usage-htm--should-be-planned-and-executed-carefully-and-sparingly--the-time-gained-when-accessing-individual-lines-should-not-be-lost-again-by-the-increased-memory-and-time-requirements-for-managing-the-secondary-keys--secondary-keys-are-generally-recommended-for-internal-tables-that-are-filled-once-and-rarely-changed-during-program-execution---example--the-program-demo--secondary--keys-demonstrates-how-a-secondary-table-key-is-specified-and-the-resulting-performance-gain---deleting-table-lines-----when-lines-are-deleted-from-an-internal-table--administration-costs-are-incurred-for-all-table-keys-and-table-indexes--the-primary-key-and-all-unique-secondary-keys-are-updated-directly--but-non-unique-secondary-keys-are-updated-only-if-the-line-to-be-deleted-is-included-in-the-updated-part-of-an-associated-index---lazy-update--https---help-sap-com-doc-abapdocu-757-index-htm-7-57-en-us-abenlazy-update-glosry-htm--glossary-entry------it-should-be-noted-that--particularly-for-standard-tables--the-mean-runtime-of-the-statement--delete--https---help-sap-com-doc-abapdocu-757-index-htm-7-57-en-us-abapdelete-itab-htm--always-depends-linearly-on-the-number-of-table-lines--even-when-secondary-keys-are-specified-using--with-table-key--https---help-sap-com-doc-abapdocu-757-index-htm-7-57-en-us-abapdelete-itab-key-htm--or--using-key--https---help-sap-com-doc-abapdocu-757-index-htm-7-57-en-us-abapdelete-itab-key-htm---this-is-because-a-linear-search-is-required-to-update-the-primary-index--even-though-the-line-to-be-deleted-can-itself-be-found-quickly---deleting-lines-in-internal-tables-using--delete--https---help-sap-com-doc-abapdocu-757-index-htm-7-57-en-us-abapdelete-itab-htm--does-not-usually-release-any-memory-in-the-internal-table--statements-such-as--clear--https---help-sap-com-doc-abapdocu-757-index-htm-7-57-en-us-abapclear-htm--or--free--https---help-sap-com-doc-abapdocu-757-index-htm-7-57-en-us-abapfree-dataobject-htm--must-be-used-to-release-memory-in-internal-tables---free-key-specified-for-sorted-tables-and-hashed-tables-----when-using-the--read--https---help-sap-com-doc-abapdocu-757-index-htm-7-57-en-us-abapread-table-htm--statement-with-a-specified-free-key-of-the-form--with-key------https---help-sap-com-doc-abapdocu-757-index-htm-7-57-en-us-abapread-table-free-htm---the-search-is-optimized-in-all-cases-where-this-is-possible--that-is-------in--sorted-tables--https---help-sap-com-doc-abapdocu-757-index-htm-7-57-en-us-abensorted-table-glosry-htm--glossary-entry----if-any-initial-section-of-the--table-key--https---help-sap-com-doc-abapdocu-757-index-htm-7-57-en-us-abentable-key-glosry-htm--glossary-entry---or-the-complete-table-key-is-covered-by-the-specified-key------in--hashed-tables--https---help-sap-com-doc-abapdocu-757-index-htm-7-57-en-us-abenhashed-table-glosry-htm--glossary-entry----if-the-complete-table-key-is-covered---if-part-of-a-free-key-meets-these-conditions--this-partial-key-is-first-used-to-search-for-an-entry--in-sorted-tables--this-is-done-using-a-binary-search-with-a-logarithmic-consumption-of-resources--and-in-hashed-tables-using-a-hash-algorithm--that-is--with-constant-resource-consumption--if-an-entry-is-found--the-system-checks-whether-the-rest-of-the-key-conditions-are-also-met--this-means-that-over-specific-keys-in-particular-are-optimized---hint--see-also--optimization-of-the-where-condition--https---help-sap-com-doc-abapdocu-757-index-htm-7-57-en-us-abenitab-where-optimization-htm----sorting-----for-textual-sorting-of-an-internal-table-in-accordance-with-the-current--text-environment--https---help-sap-com-doc-abapdocu-757-index-htm-7-57-en-us-abentext-environment-glosry-htm--glossary-entry----it-can-be-more-efficient-to-use-the-statement--convert-text-into-sortable-code--https---help-sap-com-doc-abapdocu-757-index-htm-7-57-en-us-abapconvert-text-htm--instead-of--sort-as-text--https---help-sap-com-doc-abapdocu-757-index-htm-7-57-en-us-abapsort-itab-htm--in-the-following-cases-------if-an-internal-table-is-sorted-by-locale-and-then-searched-binarily-using-the-statement-read-table-or-using-a--table-expression--https---help-sap-com-doc-abapdocu-757-index-htm-7-57-en-us-abentable-expressions-htm-------an-internal-table-must-be-sorted-more-than-once------indexes-for-database-tables-should-be-structured-in-accordance-with-a-locale---continue--itab---optimizing-the-where-condition--https---help-sap-com-doc-abapdocu-757-index-htm-7-57-en-us-abenitab-where-optimization-htm--------abenitab-where-optimization-htm------title---hint--description------if-the-lines-selected-using-where-are-modified-or-deleted-using-modify-https---help-sap-com-doc-abapdocu-757-index-htm-7-57-en-us-abapmodify-itab-htm--or-delete-https---help-sap-com-doc-abapdocu-757-index-htm-7-57-en-us-abapdelete-itab-htm--and-not-just-read-using-loop-at-https---help-sap-com--version---7-57--category---general--type---abap-reference--sourceurl---https---help-sap-com-doc-abapdocu-757-index-htm-7-57-en-us-abenitab-where-optimization-htm--abapfile---abenitab-where-optimization-htm--keywords----select----update----delete----loop----do----if----case----try----catch----data----types----internal-table----abenitab----where----optimization---------------as-abap-release-757---copyright-2023-sap-se--all-rights-reserved----abap---keyword-documentation--https---help-sap-com-doc-abapdocu-757-index-htm-7-57-en-us-abenabap-htm------abap---programming-language--https---help-sap-com-doc-abapdocu-757-index-htm-7-57-en-us-abenabap-reference-htm------processing-internal-data--https---help-sap-com-doc-abapdocu-757-index-htm-7-57-en-us-abenabap-data-working-htm------internal-tables--itab---https---help-sap-com-doc-abapdocu-757-index-htm-7-57-en-us-abenitab-htm------itab---performance-notes--https---help-sap-com-doc-abapdocu-757-index-htm-7-57-en-us-abenitab-perfo-htm------------mail-gif-object-mail-gif-sap-language-en--feedback-mail-for-displayed-topic---mail-feedback--mailto-f1-helpsap.com?subject=Feedback on ABAP Documentation&body=Document: itab - Optimizing the WHERE Condition, ABENITAB_WHERE_OPTIMIZATION, 757%0D%0A%0D%0AEr
ror:%0D%0A%0D%0A%0D%0A%0D%0ASuggestion for improvement:)

itab - Optimizing the WHERE Condition

The statements [LOOP AT](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abaploop_at_itab.htm), [DELETE](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abapdelete_itab.htm), and [MODIFY](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abapmodify_itab.htm) can be specified together with a WHERE condition that selects specific lines of the internal table. Searches in a [standard table](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abenstandard_table_glosry.htm "Glossary Entry") using the [primary table key](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abenprimary_table_key_glosry.htm "Glossary Entry") are always linear and cannot be optimized. Searches using a [sorted key](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abensorted_key_glosry.htm "Glossary Entry") or a [hash key](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abenhash_key_glosry.htm "Glossary Entry"), however, can be optimized in certain circumstances. These keys are used for:

-   accessing a [sorted table](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abensorted_table_glosry.htm "Glossary Entry") using its primary key.
-   accessing a [hashed table](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abenhashed_table_glosry.htm "Glossary Entry") using its primary key.
-   accessing a table of any table type using a [secondary table key](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abensecondary_table_key_glosry.htm "Glossary Entry") specified by USING KEY.

The optimization takes place by mapping all [relational expressions](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abenrelational_expression_glosry.htm "Glossary Entry") or a group of the relational expressions in the WHERE condition to a specified key. This specified key performs a corresponding optimized key access (binary search or hash algorithm as in the statement [READ TABLE](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abapread_table.htm) or a [table expression](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abentable_expressions.htm)), to find one or more lines. The found line or lines are then checked using those remaining relational expressions from the WHERE condition that were not mapped to the specified key.

Prerequisites for the optimization are therefore:

-   The relational expressions of the WHERE condition can be transformed to a specified key.
-   The corresponding key access returns the same results as the evaluation of this part of the logical expression would. This is guaranteed only for compatible data types, since in the case of incompatible data types:
    -   the content of the specified data objects is converted to the data type of the columns before the evaluation in the case of key accesses.
    -   The [comparison rules](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abenlogexp_rules.htm) for incompatible data types apply when evaluating a [comparison expression](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abencomparison_expression_glosry.htm "Glossary Entry"). Here, all the data types involved play a part in determining which operand is converted into which comparison type.

If there are no or insufficient relational expressions to meet both of these prerequisites, no optimization is possible and the behavior is as follows:

-   If a sorted table or a hashed table is accessed using the primary table key, all lines of the internal table are checked as in a standard table.
-   If the table is read using a secondary table key, that is, if said key is specified after USING KEY, a syntax error or syntax check warning, or an exception is raised. Access using a secondary table key must always be executed in an optimized way.

The following sections describe exactly when an access can be optimized.

-   [Prerequisites for the Optimization of Hash Keys](#abenitab-where-optimization-1-------prerequisites-for-the-optimization-of-sorted-keys---@ITOC@@ABENITAB_WHERE_OPTIMIZATION_2)
-   [Requirements Made on the Operands](#@@ITOC@@ABENITAB_WHERE_OPTIMIZATION_3)

Hint

If the lines selected using WHERE are modified or deleted using [MODIFY](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abapmodify_itab.htm) or [DELETE](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abapdelete_itab.htm) and not just read using [LOOP AT](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abaploop_at_itab.htm), further update costs are incurred in addition to the search for the lines. When deleting lines from standard tables, it should be noted that searches using a secondary key optimize the selection of lines to be deleted, but not the update required for the primary key, which is usually performed using a linear search.

Prerequisites for the Optimization of Hash Keys   

In the case of [hash key](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abenhash_key_glosry.htm "Glossary Entry") accesses, there must be exactly one relational expression combined using AND for each component of the key. This expression is either

-   a [comparison expression](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abencomparison_expression_glosry.htm "Glossary Entry") with the comparison operator \= (or EQ), whose operands meet the requirements above or
-   a [predicate expression](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abenpredicate_expression_glosry.htm "Glossary Entry") IS INITIAL without the addition NOT.

These relational expressions construct the part of the logical expression used for the key access. This part must not contain duplicate key components. The remainder of the logical expression can contain any number of relational expressions combined using AND. Optimization may not be possible, however, if the Boolean operators NOT or OR are used. Key components may be used in the relational expressions not used for the key access.

Hint

Relational expressions other than comparisons using \= (or EQ) or predicate expressions IS INITIAL are not part of the key access. This applies particularly to the tabular comparison operator [IN range\_tab](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abenlogexp_select_option.htm), even if it can be traced back to optimizable comparisons.

Example

In the following example, the first two WHERE conditions can be optimized as key accesses with the secondary table key key. This is because:

1.  The optimizable conditions for b, d, and e cover the entire key.
2.  The optimizable conditions b, d, and e cover the entire key and a is a condition on a non-key column that is not involved in the part of the WHERE condition required for the optimization.
3.  The optimizable conditions b, d, and e cover the entire key and the other two conditions on the key columns b and d are not optimizable and are hence not involved in the part of the WHERE condition required for the optimization.

The next six WHERE conditions cannot be optimized and produce syntax errors. This is because:

1.  The key component d is not specified.
2.  A key component is combined using OR instead of AND.
3.  Two non-optimizable comparison operators are used.
4.  An operand of type i is used in the comparison b of type c, which does not meet the requirements made on the operands.
5.  The Boolean operator NOT is used in front of a key component.
6.  A further comparison is combined using OR.
7.  A further comparison is negated using NOT.
    
    DATA: BEGIN OF line,
            a TYPE c LENGTH 3,
            b TYPE c LENGTH 3,
            c TYPE c LENGTH 3,
            d TYPE c LENGTH 3,
            e TYPE c LENGTH 3,
            f TYPE c LENGTH 3,
          END OF line.
    DATA itab LIKE STANDARD TABLE OF line
                   WITH UNIQUE HASHED KEY key COMPONENTS b e d.
    DATA b\_tab LIKE RANGE OF line-b.
    LOOP AT itab INTO line USING KEY key
         WHERE b = '...' AND d = '...' AND e IS INITIAL.
    ENDLOOP.
    LOOP AT itab INTO line USING KEY key
         WHERE a = '...' AND b = '...' AND d = '...' AND e IS INITIAL.
    ENDLOOP.
    LOOP AT itab INTO line USING KEY key
         WHERE  b = '...' AND d = '...' AND e IS INITIAL AND
                b IN b\_tab AND d <> '...'.
    ENDLOOP.
    LOOP AT itab INTO line USING KEY key
         WHERE b = '...' AND e IS INITIAL.                     "syntax error
    ENDLOOP.
    LOOP AT itab INTO line USING KEY key
         WHERE b = '...' OR d = '...' AND e IS INITIAL OR      "syntax error
    ENDLOOP.
    LOOP AT itab INTO line USING KEY key
         WHERE b = '...' AND d <> '...' AND e IS NOT INITIAL.  "syntax error
    ENDLOOP.
    LOOP AT itab INTO line USING KEY key
         WHERE b = 333 AND d = '...' AND e IS INITIAL.         "syntax error
    ENDLOOP.
    LOOP AT itab INTO line USING KEY key
         WHERE b = '...'  AND NOT d = '...' AND e IS INITIAL.  "syntax error
    ENDLOOP.
    LOOP AT itab INTO line USING KEY key
         WHERE b = '...' AND d = '...' AND e IS INITIAL OR     "syntax error
               a = '...'.
    ENDLOOP.
    LOOP AT itab INTO line USING KEY key
         WHERE b = '...' AND d = '...' AND e IS INITIAL AND    "syntax error
               NOT a = '...'.
    ENDLOOP.
    

Prerequisites for the Optimization of Sorted Keys   

In the case of reads using a [sorted key](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abensorted_key_glosry.htm "Glossary Entry"), the same applies as to a hash key. The only difference is that only an initial section of the key consisting of at least one component needs to be covered rather than the entire key.

The internal table is accessed in part sequentially. The starting point for the processing of the table is determined by a binary search using the subconditions that cover the table key completely or partially. From the starting point onwards, the table is only processed for as long as these subconditions remain fulfilled.

Example

In the following example, the first five WHERE conditions can be optimized as key accesses with the secondary table key key. This is because:

1.  b is an initial part of the key.
2.  b is an initial part of the key and a is an independent condition.
3.  b and e are an initial part of the key.
4.  b, e, and d are an initial part of the key and the order in the WHERE condition is ignored.
5.  b is an initial part of the key and in this case, d is an independent condition, even though it is part of the key.

The next five WHERE conditions cannot be optimized and produce syntax errors. This is because:

1.  e is not an initial part of the key.
2.  No inequality comparison takes place.
3.  A comparison in a ranges table is specified.
4.  The Boolean operator NOT is used.
5.  An additional OR relationship is used.
    
    DATA: BEGIN OF line,
            a TYPE c LENGTH 3,
            b TYPE c LENGTH 3,
            c TYPE c LENGTH 3,
            d TYPE c LENGTH 3,
            e TYPE c LENGTH 3,
            f TYPE c LENGTH 3,
          END OF line.
    DATA itab LIKE STANDARD TABLE OF line
                   WITH UNIQUE SORTED KEY key COMPONENTS b e d.
    DATA b\_tab LIKE RANGE OF line-b.
    LOOP AT itab INTO line USING KEY key
                 WHERE b = '...'.
    ENDLOOP.
    LOOP AT itab INTO line USING KEY key
                 WHERE a = '...' AND b IS INITIAL.
    ENDLOOP.
    LOOP AT itab INTO line USING KEY key
                 WHERE b = '...' AND e = '...'.
    ENDLOOP.
    LOOP AT itab INTO line USING KEY key
                 WHERE b = '...' AND d IS INITIAL AND e = '...'.
    ENDLOOP.
    LOOP AT itab INTO line USING KEY key
                 WHERE b = '...' AND d <> '...'.
    ENDLOOP.
    LOOP AT itab INTO line USING KEY key
                 WHERE e = '...'.                    "syntax error
    ENDLOOP.
    LOOP AT itab INTO line USING KEY key
                 WHERE b <> '...'.                   "syntax error
    ENDLOOP.
    LOOP AT itab INTO line USING KEY key
                 WHERE b IN b\_tab.                   "syntax error
    ENDLOOP.
    LOOP AT itab INTO line USING KEY key
                 WHERE b = '...'  AND NOT e = '...'. "syntax error
    ENDLOOP.
    LOOP AT itab INTO line USING KEY key             "syntax error
                 WHERE b = '...'  AND ( d = '...' OR e IS INITIAL ).
    ENDLOOP.
    

Requirements Made on the Operands   

The part of the logical expression that can be mapped to a key access must select the same lines as a statement [READ TABLE](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abapread_table.htm) or a corresponding [table expression](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abentable_expressions.htm) that specifies the corresponding components as keys.

-   When comparing incompatible data objects, the WHERE condition is subject to the same [comparison rules](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abenlogexp_rules.htm) for incompatible data types. Here, the data types involved determine which operand is converted to which comparison type.
-   If the additions [WITH TABLE KEY](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abapread_table_key.htm) and [WITH KEY](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abapread_table_free.htm) of the statement READ or [KEY](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abentable_exp_itab_line.htm) in a table expression are used, however, the content of the specified data objects is always converted to the data type of the columns before the comparison.

If this produces differing results, an optimization is not possible. Due to the complexity of the comparison rules, particularly for [elementary data types](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abenlogexp_rules_operands.htm), it is not a good idea to construct a set of rules detailing exactly when the comparison type matches the data type of the left operand. Generally speaking,

-   only fully compatible operands are optimizable,
-   in some cases, elementary operands with different data types can be optimized, if the value ranges or lengths are suitable. For example, a comparison of a column with the type of a floating point number with an operand of type integer or of a column of c with a similar operand, if its length is less than the length of the column.

For this reason, it is advisable to use only pairs of [compatible](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abencompatible_glosry.htm "Glossary Entry") operands in the WHERE condition. This guarantees that the differences in behavior of the WHERE condition and the specified key do not affect the result.

Example

The following example is largely similar to the example in the section WHERE log\_exp in [LOOP AT itab](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abaploop_at_itab_cond.htm). In that case, access takes place using the primary key and no optimization. Here, however, access takes place using a secondary table key and a syntax check warning is produced and an exception raised when the program is executed. The number of lines in the internal table determines whether the exception is raised.

DATA text\_short TYPE c LENGTH 2.
DATA text\_long  TYPE c LENGTH 4.
DATA itab LIKE TABLE OF text\_short
          WITH UNIQUE HASHED KEY key COMPONENTS table\_line.
itab = VALUE #( ( 'AA' )
                ( 'BB' )
                ( 'CC' )
                ( 'DD' )
                ( 'EE' )
                ( 'FF' )
                ( 'GG' )
                ( 'HH' )
                ( 'II' )
                ( 'JJ' )
                ( 'KK' )
                ( 'LL' )
                ( 'MM' ) ).
text\_short = 'AA'.
text\_long  = 'AAXX'.
LOOP AT itab INTO text\_short USING KEY key
             WHERE table\_line = text\_long.
ENDLOOP.
cl\_demo\_output=>write( |LOOP: { sy-subrc }| ).
"Statement
READ TABLE itab INTO text\_short WITH TABLE KEY key
                                COMPONENTS table\_line = text\_long.
cl\_demo\_output=>write( |READ: { sy-subrc }| ).
"Expression
TRY.
    text\_short = itab\[ KEY key COMPONENTS table\_line = text\_long \].
  catch CX\_SY\_ITAB\_LINE\_NOT\_FOUND.
    ...
ENDTRY.
cl\_demo\_output=>display( |Expression: { text\_short }| ).


---


## ABAP - Keyword Documentation / ABAP - Programming Language / Processing Internal Data / Internal Tables (itab) / itab - Expressions and Functions / itab - Table Expressions (table_exp) / table_exp - Result

**Files**: 2 | **Difficulty**: intermediate

# ABAP - Keyword Documentation / ABAP - Programming Language / Processing Internal Data / Internal Tables (itab) / itab - Performance Notes

Included pages: 2


### abenitab_perfo.htm

---
title: "Table Sharing"
description: |
  When assignments are made between internal tables of the same type whose line type does not contain any table types, only the internal administration functions are passed to the table body(https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abentable_body_glosry.htm 'Glossary Entry') for pe
version: "7.57"
category: "data-structures"
type: "abap-reference"
sourceUrl: "https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abenitab_perfo.htm"
abapFile: "abenitab_perfo.htm"
keywords: ["select", "insert", "update", "delete", "loop", "do", "if", "case", "try", "data", "types", "internal-table", "abenitab", "perfo"]
---

* * *

AS ABAP Release 757, ©Copyright 2023 SAP SE. All rights reserved.

[ABAP - Keyword Documentation](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abenabap.htm) →  [ABAP - Programming Language](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abenabap_reference.htm) →  [Processing Internal Data](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abenabap_data_working.htm) →  [Internal Tables (itab)](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abenitab.htm) → 

 [![](Mail.gif?object=Mail.gif&sap-language=EN "Feedback mail for displayed topic") Mail Feedback](mailto:f1_help@sap.com?subject=Feedback on ABAP Documentation&body=Document: itab - Performance Notes, ABENITAB_PERFO, 757%0D%0A%0D%0AError:%0D%0A%0D%0A%0D%0A%0D%
0ASuggestion for improvement:)

itab - Performance Notes

-   [Table Sharing](#abenitab-perfo-1-------initial-memory-requirement---@ITOC@@ABENITAB_PERFO_2)
-   [Index Administration](#abenitab-perfo-3-------block-processing-of-table-lines---@ITOC@@ABENITAB_PERFO_4)
-   [Selective Data Transport](#abenitab-perfo-5-------using-secondary-keys---@ITOC@@ABENITAB_PERFO_6)
-   [Deleting Table Lines](#abenitab-perfo-7-------free-key-specified-for-sorted-tables-and-hashed-tables---@ITOC@@ABENITAB_PERFO_8)
-   [Sorting](#abenitab-perfo-9---table-sharing-----when-assignments-are-made-between-internal-tables-of-the-same-type-whose-line-type-does-not-contain-any-table-types--only-the-internal-administration-functions-are-passed-to-the--table-body--https---help-sap-com-doc-abapdocu-757-index-htm-7-57-en-us-abentable-body-glosry-htm--glossary-entry---for-performance-reasons---table-sharing--https---help-sap-com-doc-abapdocu-757-index-htm-7-57-en-us-abentable-sharing-glosry-htm--glossary-entry---is-revoked-only-when-write-access-to-one-of-the-tables-involved-is-initiated--the-actual-copy-process-then-takes-place---initial-memory-requirement-----internal-tables-are--dynamic-data-objects--https---help-sap-com-doc-abapdocu-757-index-htm-7-57-en-us-abendynamic-data-object-glosry-htm--glossary-entry---whose-area-in-the-memory-is-extended-block-by-block--the-size-of-the-first-block-in-the-memory-is-called--initial-memory-requirement--https---help-sap-com-doc-abapdocu-757-index-htm-7-57-en-us-abeninitial-mem-req-glosry-htm--glossary-entry---and-can-be-affected-in-the-declaration-of-an-internal-table-using-the-additions--initial-size--https---help-sap-com-doc-abapdocu-757-index-htm-7-57-en-us-abaptypes-itab-htm--and-the-obsolete--occurs--https---help-sap-com-doc-abapdocu-757-index-htm-7-57-en-us-abapdata-occurs-htm----it-is-usually-up-to-the-system-to-determine-the-size-of-the-first-block--initial-size-is-not-used-or-specified-with-the-value-0--in-this-case--a-suitable-block-size-is-chosen-the-first-time-lines-are-added-to-an-internal-table---specifying-a-concrete-value-greater-than-0-after-initial-size-is-only-practical-if-it-is-known-in-advance-how-many-entries-are-to-be-made-in-the-table--and-the-first-block-is-therefore-to-be-created-with-the-most-suitable-dimensions--this-can-be-particularly-important-for-internal-tables-that-are-components-of-other-internal-tables--and-which-only-contain-a-few-lines--no-more-than-around-5----to-avoid-excessive-memory-demands--the-system-ignores-values-that-produce-memory-demands-greater-than-the-constant-block-size---index-administration-----in-an--index-table--https---help-sap-com-doc-abapdocu-757-index-htm-7-57-en-us-abenindex-table-glosry-htm--glossary-entry----the-logical-order-of-the-table-entries-is-not-generally-consistent-with-the-physical-order-of-the-entries-in-the-main-memory--in-this-case--the-logical-order-is-no-longer-administrated-by-a-physical-index--but-by-a-logical-index--the-same-basically-applies-to-the--secondary-table-indexes--https---help-sap-com-doc-abapdocu-757-index-htm-7-57-en-us-abensecondary-table-index-glosry-htm--glossary-entry---used-to-manage--secondary--https---help-sap-com-doc-abapdocu-757-index-htm-7-57-en-us-abensecondary-table-key-glosry-htm--glossary-entry----sorted-keys--https---help-sap-com-doc-abapdocu-757-index-htm-7-57-en-us-abensorted-key-glosry-htm--glossary-entry-----use-of-the-logical-index-produces-additional-memory-requirements--and-index-maintenance-places-a-high-demand-on-resources--time-and-memory--when-inserting-or-deleting-table-lines--the-resource-requirements-increase-proportionally-with-the-number-of-remaining-lines-after-the-insertion-or-deletion-position--for-very-large-internal-tables--this-can-result-in-considerable-demands-on-performance-at-runtime---the-logical-index-is-only-created-when-it-is-needed--that-is--when-a-line-is-inserted-in-front-of-another-line--if-the-order-of-the-table-lines-is-changed--or-a-line-other-than-the-last-line-is-deleted--a-logical-index-is-not-required-if-an-internal-table-is-filled-using-only--append--https---help-sap-com-doc-abapdocu-757-index-htm-7-57-en-us-abapappend-htm---and-if-only-its-last-line-or-lines-is-are-deleted-using--delete--https---help-sap-com-doc-abapdocu-757-index-htm-7-57-en-us-abapdelete-itab-htm----hint--in-contrast-to-filling-a-table-with--insert--https---help-sap-com-doc-abapdocu-757-index-htm-7-57-en-us-abapinsert-itab-htm---appending-lines-with--append--https---help-sap-com-doc-abapdocu-757-index-htm-7-57-en-us-abapappend-htm--does-not-require-any-resources-for-index-maintenance--it-is-therefore-preferable-to-use-append-instead-of-insert-to-create-a--standard-table--https---help-sap-com-doc-abapdocu-757-index-htm-7-57-en-us-abenstandard-table-glosry-htm--glossary-entry----this-is-possible-if-the-order-of-the-entries-is-not-important--or-if-entries-can-be-appended-in-the-correct-order---block-processing-of-table-lines-----if-entire-line-areas-of-a-table-can-be-processed-at-once--this-should-not-be-done-line-by-line--but-using-block-operations--block-operations-are-possible-using-the-from-and-to-additions-of-the-statements--insert--https---help-sap-com-doc-abapdocu-757-index-htm-7-57-en-us-abapinsert-itab-htm----append--https---help-sap-com-doc-abapdocu-757-index-htm-7-57-en-us-abapappend-htm--and--delete--https---help-sap-com-doc-abapdocu-757-index-htm-7-57-en-us-abapdelete-itab-htm---block-operations-are-also-more-efficient-than-single-record-operations-when-reading-from-or-modifying-database-tables-with--abap-sql--https---help-sap-com-doc-abapdocu-757-index-htm-7-57-en-us-abenabap-sql-glosry-htm--glossary-entry---statements-with-the-additions-from---appending---to-table---selective-data-transport-----if--when-reading-table-lines-using--read-table--https---help-sap-com-doc-abapdocu-757-index-htm-7-57-en-us-abapread-table-htm--or--loop-at--https---help-sap-com-doc-abapdocu-757-index-htm-7-57-en-us-abaploop-at-itab-htm---a-work-area-is-used-or-table-lines-can-be-changed-using--modify--https---help-sap-com-doc-abapdocu-757-index-htm-7-57-en-us-abapmodify-itab-htm--instead-of-direct-access--the-transporting-addition-can-be-used-to-prevent-unnecessary-assignments-of-table-components-to-the-work-area--this-can-lead-to-a-noticeable-improvement-in-performance--particularly-if-table-like-components-are-excluded-from-processing---using-secondary-keys-----the--use-of-secondary-table-keys--https---help-sap-com-doc-abapdocu-757-index-htm-7-57-en-us-abenitab-key-secondary-usage-htm--should-be-planned-and-executed-carefully-and-sparingly--the-time-gained-when-accessing-individual-lines-should-not-be-lost-again-by-the-increased-memory-and-time-requirements-for-managing-the-secondary-keys--secondary-keys-are-generally-recommended-for-internal-tables-that-are-filled-once-and-rarely-changed-during-program-execution---example--the-program-demo--secondary--keys-demonstrates-how-a-secondary-table-key-is-specified-and-the-resulting-performance-gain---deleting-table-lines-----when-lines-are-deleted-from-an-internal-table--administration-costs-are-incurred-for-all-table-keys-and-table-indexes--the-primary-key-and-all-unique-secondary-keys-are-updated-directly--but-non-unique-secondary-keys-are-updated-only-if-the-line-to-be-deleted-is-included-in-the-updated-part-of-an-associated-index---lazy-update--https---help-sap-com-doc-abapdocu-757-index-htm-7-57-en-us-abenlazy-update-glosry-htm--glossary-entry------it-should-be-noted-that--particularly-for-standard-tables--the-mean-runtime-of-the-statement--delete--https---help-sap-com-doc-abapdocu-757-index-htm-7-57-en-us-abapdelete-itab-htm--always-depends-linearly-on-the-number-of-table-lines--even-when-secondary-keys-are-specified-using--with-table-key--https---help-sap-com-doc-abapdocu-757-index-htm-7-57-en-us-abapdelete-itab-key-htm--or--using-key--https---help-sap-com-doc-abapdocu-757-index-htm-7-57-en-us-abapdelete-itab-key-htm---this-is-because-a-linear-search-is-required-to-update-the-primary-index--even-though-the-line-to-be-deleted-can-itself-be-found-quickly---deleting-lines-in-internal-tables-using--delete--https---help-sap-com-doc-abapdocu-757-index-htm-7-57-en-us-abapdelete-itab-htm--does-not-usually-release-any-memory-in-the-internal-table--statements-such-as--clear--https---help-sap-com-doc-abapdocu-757-index-htm-7-57-en-us-abapclear-htm--or--free--https---help-sap-com-doc-abapdocu-757-index-htm-7-57-en-us-abapfree-dataobject-htm--must-be-used-to-release-memory-in-internal-tables---free-key-specified-for-sorted-tables-and-hashed-tables-----when-using-the--read--https---help-sap-com-doc-abapdocu-757-index-htm-7-57-en-us-abapread-table-htm--statement-with-a-specified-free-key-of-the-form--with-key------https---help-sap-com-doc-abapdocu-757-index-htm-7-57-en-us-abapread-table-free-htm---the-search-is-optimized-in-all-cases-where-this-is-possible--that-is-------in--sorted-tables--https---help-sap-com-doc-abapdocu-757-index-htm-7-57-en-us-abensorted-table-glosry-htm--glossary-entry----if-any-initial-section-of-the--table-key--https---help-sap-com-doc-abapdocu-757-index-htm-7-57-en-us-abentable-key-glosry-htm--glossary-entry---or-the-complete-table-key-is-covered-by-the-specified-key------in--hashed-tables--https---help-sap-com-doc-abapdocu-757-index-htm-7-57-en-us-abenhashed-table-glosry-htm--glossary-entry----if-the-complete-table-key-is-covered---if-part-of-a-free-key-meets-these-conditions--this-partial-key-is-first-used-to-search-for-an-entry--in-sorted-tables--this-is-done-using-a-binary-search-with-a-logarithmic-consumption-of-resources--and-in-hashed-tables-using-a-hash-algorithm--that-is--with-constant-resource-consumption--if-an-entry-is-found--the-system-checks-whether-the-rest-of-the-key-conditions-are-also-met--this-means-that-over-specific-keys-in-particular-are-optimized---hint--see-also--optimization-of-the-where-condition--https---help-sap-com-doc-abapdocu-757-index-htm-7-57-en-us-abenitab-where-optimization-htm----sorting-----for-textual-sorting-of-an-internal-table-in-accordance-with-the-current--text-environment--https---help-sap-com-doc-abapdocu-757-index-htm-7-57-en-us-abentext-environment-glosry-htm--glossary-entry----it-can-be-more-efficient-to-use-the-statement--convert-text-into-sortable-code--https---help-sap-com-doc-abapdocu-757-index-htm-7-57-en-us-abapconvert-text-htm--instead-of--sort-as-text--https---help-sap-com-doc-abapdocu-757-index-htm-7-57-en-us-abapsort-itab-htm--in-the-following-cases-------if-an-internal-table-is-sorted-by-locale-and-then-searched-binarily-using-the-statement-read-table-or-using-a--table-expression--https---help-sap-com-doc-abapdocu-757-index-htm-7-57-en-us-abentable-expressions-htm-------an-internal-table-must-be-sorted-more-than-once------indexes-for-database-tables-should-be-structured-in-accordance-with-a-locale---continue--itab---optimizing-the-where-condition--https---help-sap-com-doc-abapdocu-757-index-htm-7-57-en-us-abenitab-where-optimization-htm--------abenitab-where-optimization-htm------title---hint--description------if-the-lines-selected-using-where-are-modified-or-deleted-using-modify-https---help-sap-com-doc-abapdocu-757-index-htm-7-57-en-us-abapmodify-itab-htm--or-delete-https---help-sap-com-doc-abapdocu-757-index-htm-7-57-en-us-abapdelete-itab-htm--and-not-just-read-using-loop-at-https---help-sap-com--version---7-57--category---general--type---abap-reference--sourceurl---https---help-sap-com-doc-abapdocu-757-index-htm-7-57-en-us-abenitab-where-optimization-htm--abapfile---abenitab-where-optimization-htm--keywords----select----update----delete----loop----do----if----case----try----catch----data----types----internal-table----abenitab----where----optimization---------------as-abap-release-757---copyright-2023-sap-se--all-rights-reserved----abap---keyword-documentation--https---help-sap-com-doc-abapdocu-757-index-htm-7-57-en-us-abenabap-htm------abap---programming-language--https---help-sap-com-doc-abapdocu-757-index-htm-7-57-en-us-abenabap-reference-htm------processing-internal-data--https---help-sap-com-doc-abapdocu-757-index-htm-7-57-en-us-abenabap-data-working-htm------internal-tables--itab---https---help-sap-com-doc-abapdocu-757-index-htm-7-57-en-us-abenitab-htm------itab---performance-notes--https---help-sap-com-doc-abapdocu-757-index-htm-7-57-en-us-abenitab-perfo-htm------------mail-gif-object-mail-gif-sap-language-en--feedback-mail-for-displayed-topic---mail-feedback--mailto-f1-helpsap.com?subject=Feedback on ABAP Documentation&body=Document: itab - Optimizing the WHERE Condition, ABENITAB_WHERE_OPTIMIZATION, 757%0D%0A%0D%0AEr
ror:%0D%0A%0D%0A%0D%0A%0D%0ASuggestion for improvement:)

itab - Optimizing the WHERE Condition

The statements [LOOP AT](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abaploop_at_itab.htm), [DELETE](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abapdelete_itab.htm), and [MODIFY](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abapmodify_itab.htm) can be specified together with a WHERE condition that selects specific lines of the internal table. Searches in a [standard table](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abenstandard_table_glosry.htm "Glossary Entry") using the [primary table key](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abenprimary_table_key_glosry.htm "Glossary Entry") are always linear and cannot be optimized. Searches using a [sorted key](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abensorted_key_glosry.htm "Glossary Entry") or a [hash key](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abenhash_key_glosry.htm "Glossary Entry"), however, can be optimized in certain circumstances. These keys are used for:

-   accessing a [sorted table](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abensorted_table_glosry.htm "Glossary Entry") using its primary key.
-   accessing a [hashed table](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abenhashed_table_glosry.htm "Glossary Entry") using its primary key.
-   accessing a table of any table type using a [secondary table key](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abensecondary_table_key_glosry.htm "Glossary Entry") specified by USING KEY.

The optimization takes place by mapping all [relational expressions](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abenrelational_expression_glosry.htm "Glossary Entry") or a group of the relational expressions in the WHERE condition to a specified key. This specified key performs a corresponding optimized key access (binary search or hash algorithm as in the statement [READ TABLE](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abapread_table.htm) or a [table expression](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abentable_expressions.htm)), to find one or more lines. The found line or lines are then checked using those remaining relational expressions from the WHERE condition that were not mapped to the specified key.

Prerequisites for the optimization are therefore:

-   The relational expressions of the WHERE condition can be transformed to a specified key.
-   The corresponding key access returns the same results as the evaluation of this part of the logical expression would. This is guaranteed only for compatible data types, since in the case of incompatible data types:
    -   the content of the specified data objects is converted to the data type of the columns before the evaluation in the case of key accesses.
    -   The [comparison rules](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abenlogexp_rules.htm) for incompatible data types apply when evaluating a [comparison expression](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abencomparison_expression_glosry.htm "Glossary Entry"). Here, all the data types involved play a part in determining which operand is converted into which comparison type.

If there are no or insufficient relational expressions to meet both of these prerequisites, no optimization is possible and the behavior is as follows:

-   If a sorted table or a hashed table is accessed using the primary table key, all lines of the internal table are checked as in a standard table.
-   If the table is read using a secondary table key, that is, if said key is specified after USING KEY, a syntax error or syntax check warning, or an exception is raised. Access using a secondary table key must always be executed in an optimized way.

The following sections describe exactly when an access can be optimized.

-   [Prerequisites for the Optimization of Hash Keys](#abenitab-where-optimization-1-------prerequisites-for-the-optimization-of-sorted-keys---@ITOC@@ABENITAB_WHERE_OPTIMIZATION_2)
-   [Requirements Made on the Operands](#@@ITOC@@ABENITAB_WHERE_OPTIMIZATION_3)

Hint

If the lines selected using WHERE are modified or deleted using [MODIFY](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abapmodify_itab.htm) or [DELETE](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abapdelete_itab.htm) and not just read using [LOOP AT](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abaploop_at_itab.htm), further update costs are incurred in addition to the search for the lines. When deleting lines from standard tables, it should be noted that searches using a secondary key optimize the selection of lines to be deleted, but not the update required for the primary key, which is usually performed using a linear search.

Prerequisites for the Optimization of Hash Keys   

In the case of [hash key](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abenhash_key_glosry.htm "Glossary Entry") accesses, there must be exactly one relational expression combined using AND for each component of the key. This expression is either

-   a [comparison expression](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abencomparison_expression_glosry.htm "Glossary Entry") with the comparison operator \= (or EQ), whose operands meet the requirements above or
-   a [predicate expression](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abenpredicate_expression_glosry.htm "Glossary Entry") IS INITIAL without the addition NOT.

These relational expressions construct the part of the logical expression used for the key access. This part must not contain duplicate key components. The remainder of the logical expression can contain any number of relational expressions combined using AND. Optimization may not be possible, however, if the Boolean operators NOT or OR are used. Key components may be used in the relational expressions not used for the key access.

Hint

Relational expressions other than comparisons using \= (or EQ) or predicate expressions IS INITIAL are not part of the key access. This applies particularly to the tabular comparison operator [IN range\_tab](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abenlogexp_select_option.htm), even if it can be traced back to optimizable comparisons.

Example

In the following example, the first two WHERE conditions can be optimized as key accesses with the secondary table key key. This is because:

1.  The optimizable conditions for b, d, and e cover the entire key.
2.  The optimizable conditions b, d, and e cover the entire key and a is a condition on a non-key column that is not involved in the part of the WHERE condition required for the optimization.
3.  The optimizable conditions b, d, and e cover the entire key and the other two conditions on the key columns b and d are not optimizable and are hence not involved in the part of the WHERE condition required for the optimization.

The next six WHERE conditions cannot be optimized and produce syntax errors. This is because:

1.  The key component d is not specified.
2.  A key component is combined using OR instead of AND.
3.  Two non-optimizable comparison operators are used.
4.  An operand of type i is used in the comparison b of type c, which does not meet the requirements made on the operands.
5.  The Boolean operator NOT is used in front of a key component.
6.  A further comparison is combined using OR.
7.  A further comparison is negated using NOT.
    
    DATA: BEGIN OF line,
            a TYPE c LENGTH 3,
            b TYPE c LENGTH 3,
            c TYPE c LENGTH 3,
            d TYPE c LENGTH 3,
            e TYPE c LENGTH 3,
            f TYPE c LENGTH 3,
          END OF line.
    DATA itab LIKE STANDARD TABLE OF line
                   WITH UNIQUE HASHED KEY key COMPONENTS b e d.
    DATA b\_tab LIKE RANGE OF line-b.
    LOOP AT itab INTO line USING KEY key
         WHERE b = '...' AND d = '...' AND e IS INITIAL.
    ENDLOOP.
    LOOP AT itab INTO line USING KEY key
         WHERE a = '...' AND b = '...' AND d = '...' AND e IS INITIAL.
    ENDLOOP.
    LOOP AT itab INTO line USING KEY key
         WHERE  b = '...' AND d = '...' AND e IS INITIAL AND
                b IN b\_tab AND d <> '...'.
    ENDLOOP.
    LOOP AT itab INTO line USING KEY key
         WHERE b = '...' AND e IS INITIAL.                     "syntax error
    ENDLOOP.
    LOOP AT itab INTO line USING KEY key
         WHERE b = '...' OR d = '...' AND e IS INITIAL OR      "syntax error
    ENDLOOP.
    LOOP AT itab INTO line USING KEY key
         WHERE b = '...' AND d <> '...' AND e IS NOT INITIAL.  "syntax error
    ENDLOOP.
    LOOP AT itab INTO line USING KEY key
         WHERE b = 333 AND d = '...' AND e IS INITIAL.         "syntax error
    ENDLOOP.
    LOOP AT itab INTO line USING KEY key
         WHERE b = '...'  AND NOT d = '...' AND e IS INITIAL.  "syntax error
    ENDLOOP.
    LOOP AT itab INTO line USING KEY key
         WHERE b = '...' AND d = '...' AND e IS INITIAL OR     "syntax error
               a = '...'.
    ENDLOOP.
    LOOP AT itab INTO line USING KEY key
         WHERE b = '...' AND d = '...' AND e IS INITIAL AND    "syntax error
               NOT a = '...'.
    ENDLOOP.
    

Prerequisites for the Optimization of Sorted Keys   

In the case of reads using a [sorted key](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abensorted_key_glosry.htm "Glossary Entry"), the same applies as to a hash key. The only difference is that only an initial section of the key consisting of at least one component needs to be covered rather than the entire key.

The internal table is accessed in part sequentially. The starting point for the processing of the table is determined by a binary search using the subconditions that cover the table key completely or partially. From the starting point onwards, the table is only processed for as long as these subconditions remain fulfilled.

Example

In the following example, the first five WHERE conditions can be optimized as key accesses with the secondary table key key. This is because:

1.  b is an initial part of the key.
2.  b is an initial part of the key and a is an independent condition.
3.  b and e are an initial part of the key.
4.  b, e, and d are an initial part of the key and the order in the WHERE condition is ignored.
5.  b is an initial part of the key and in this case, d is an independent condition, even though it is part of the key.

The next five WHERE conditions cannot be optimized and produce syntax errors. This is because:

1.  e is not an initial part of the key.
2.  No inequality comparison takes place.
3.  A comparison in a ranges table is specified.
4.  The Boolean operator NOT is used.
5.  An additional OR relationship is used.
    
    DATA: BEGIN OF line,
            a TYPE c LENGTH 3,
            b TYPE c LENGTH 3,
            c TYPE c LENGTH 3,
            d TYPE c LENGTH 3,
            e TYPE c LENGTH 3,
            f TYPE c LENGTH 3,
          END OF line.
    DATA itab LIKE STANDARD TABLE OF line
                   WITH UNIQUE SORTED KEY key COMPONENTS b e d.
    DATA b\_tab LIKE RANGE OF line-b.
    LOOP AT itab INTO line USING KEY key
                 WHERE b = '...'.
    ENDLOOP.
    LOOP AT itab INTO line USING KEY key
                 WHERE a = '...' AND b IS INITIAL.
    ENDLOOP.
    LOOP AT itab INTO line USING KEY key
                 WHERE b = '...' AND e = '...'.
    ENDLOOP.
    LOOP AT itab INTO line USING KEY key
                 WHERE b = '...' AND d IS INITIAL AND e = '...'.
    ENDLOOP.
    LOOP AT itab INTO line USING KEY key
                 WHERE b = '...' AND d <> '...'.
    ENDLOOP.
    LOOP AT itab INTO line USING KEY key
                 WHERE e = '...'.                    "syntax error
    ENDLOOP.
    LOOP AT itab INTO line USING KEY key
                 WHERE b <> '...'.                   "syntax error
    ENDLOOP.
    LOOP AT itab INTO line USING KEY key
                 WHERE b IN b\_tab.                   "syntax error
    ENDLOOP.
    LOOP AT itab INTO line USING KEY key
                 WHERE b = '...'  AND NOT e = '...'. "syntax error
    ENDLOOP.
    LOOP AT itab INTO line USING KEY key             "syntax error
                 WHERE b = '...'  AND ( d = '...' OR e IS INITIAL ).
    ENDLOOP.
    

Requirements Made on the Operands   

The part of the logical expression that can be mapped to a key access must select the same lines as a statement [READ TABLE](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abapread_table.htm) or a corresponding [table expression](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abentable_expressions.htm) that specifies the corresponding components as keys.

-   When comparing incompatible data objects, the WHERE condition is subject to the same [comparison rules](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abenlogexp_rules.htm) for incompatible data types. Here, the data types involved determine which operand is converted to which comparison type.
-   If the additions [WITH TABLE KEY](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abapread_table_key.htm) and [WITH KEY](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abapread_table_free.htm) of the statement READ or [KEY](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abentable_exp_itab_line.htm) in a table expression are used, however, the content of the specified data objects is always converted to the data type of the columns before the comparison.

If this produces differing results, an optimization is not possible. Due to the complexity of the comparison rules, particularly for [elementary data types](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abenlogexp_rules_operands.htm), it is not a good idea to construct a set of rules detailing exactly when the comparison type matches the data type of the left operand. Generally speaking,

-   only fully compatible operands are optimizable,
-   in some cases, elementary operands with different data types can be optimized, if the value ranges or lengths are suitable. For example, a comparison of a column with the type of a floating point number with an operand of type integer or of a column of c with a similar operand, if its length is less than the length of the column.

For this reason, it is advisable to use only pairs of [compatible](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abencompatible_glosry.htm "Glossary Entry") operands in the WHERE condition. This guarantees that the differences in behavior of the WHERE condition and the specified key do not affect the result.

Example

The following example is largely similar to the example in the section WHERE log\_exp in [LOOP AT itab](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abaploop_at_itab_cond.htm). In that case, access takes place using the primary key and no optimization. Here, however, access takes place using a secondary table key and a syntax check warning is produced and an exception raised when the program is executed. The number of lines in the internal table determines whether the exception is raised.

DATA text\_short TYPE c LENGTH 2.
DATA text\_long  TYPE c LENGTH 4.
DATA itab LIKE TABLE OF text\_short
          WITH UNIQUE HASHED KEY key COMPONENTS table\_line.
itab = VALUE #( ( 'AA' )
                ( 'BB' )
                ( 'CC' )
                ( 'DD' )
                ( 'EE' )
                ( 'FF' )
                ( 'GG' )
                ( 'HH' )
                ( 'II' )
                ( 'JJ' )
                ( 'KK' )
                ( 'LL' )
                ( 'MM' ) ).
text\_short = 'AA'.
text\_long  = 'AAXX'.
LOOP AT itab INTO text\_short USING KEY key
             WHERE table\_line = text\_long.
ENDLOOP.
cl\_demo\_output=>write( |LOOP: { sy-subrc }| ).
"Statement
READ TABLE itab INTO text\_short WITH TABLE KEY key
                                COMPONENTS table\_line = text\_long.
cl\_demo\_output=>write( |READ: { sy-subrc }| ).
"Expression
TRY.
    text\_short = itab\[ KEY key COMPONENTS table\_line = text\_long \].
  catch CX\_SY\_ITAB\_LINE\_NOT\_FOUND.
    ...
ENDTRY.
cl\_demo\_output=>display( |Expression: { text\_short }| ).


---


## ABAP - Keyword Documentation / ABAP - Programming Language / Processing Internal Data / Internal Tables (itab) / itab - Expressions and Functions / itab - Table Expressions (table_exp) / table_exp - Chainings

**Files**: 2 | **Difficulty**: intermediate

# ABAP - Keyword Documentation / ABAP - Programming Language / Processing Internal Data / Internal Tables (itab) / itab - Performance Notes

Included pages: 2


### abenitab_perfo.htm

---
title: "Table Sharing"
description: |
  When assignments are made between internal tables of the same type whose line type does not contain any table types, only the internal administration functions are passed to the table body(https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abentable_body_glosry.htm 'Glossary Entry') for pe
version: "7.57"
category: "data-structures"
type: "abap-reference"
sourceUrl: "https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abenitab_perfo.htm"
abapFile: "abenitab_perfo.htm"
keywords: ["select", "insert", "update", "delete", "loop", "do", "if", "case", "try", "data", "types", "internal-table", "abenitab", "perfo"]
---

* * *

AS ABAP Release 757, ©Copyright 2023 SAP SE. All rights reserved.

[ABAP - Keyword Documentation](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abenabap.htm) →  [ABAP - Programming Language](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abenabap_reference.htm) →  [Processing Internal Data](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abenabap_data_working.htm) →  [Internal Tables (itab)](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abenitab.htm) → 

 [![](Mail.gif?object=Mail.gif&sap-language=EN "Feedback mail for displayed topic") Mail Feedback](mailto:f1_help@sap.com?subject=Feedback on ABAP Documentation&body=Document: itab - Performance Notes, ABENITAB_PERFO, 757%0D%0A%0D%0AError:%0D%0A%0D%0A%0D%0A%0D%
0ASuggestion for improvement:)

itab - Performance Notes

-   [Table Sharing](#abenitab-perfo-1-------initial-memory-requirement---@ITOC@@ABENITAB_PERFO_2)
-   [Index Administration](#abenitab-perfo-3-------block-processing-of-table-lines---@ITOC@@ABENITAB_PERFO_4)
-   [Selective Data Transport](#abenitab-perfo-5-------using-secondary-keys---@ITOC@@ABENITAB_PERFO_6)
-   [Deleting Table Lines](#abenitab-perfo-7-------free-key-specified-for-sorted-tables-and-hashed-tables---@ITOC@@ABENITAB_PERFO_8)
-   [Sorting](#abenitab-perfo-9---table-sharing-----when-assignments-are-made-between-internal-tables-of-the-same-type-whose-line-type-does-not-contain-any-table-types--only-the-internal-administration-functions-are-passed-to-the--table-body--https---help-sap-com-doc-abapdocu-757-index-htm-7-57-en-us-abentable-body-glosry-htm--glossary-entry---for-performance-reasons---table-sharing--https---help-sap-com-doc-abapdocu-757-index-htm-7-57-en-us-abentable-sharing-glosry-htm--glossary-entry---is-revoked-only-when-write-access-to-one-of-the-tables-involved-is-initiated--the-actual-copy-process-then-takes-place---initial-memory-requirement-----internal-tables-are--dynamic-data-objects--https---help-sap-com-doc-abapdocu-757-index-htm-7-57-en-us-abendynamic-data-object-glosry-htm--glossary-entry---whose-area-in-the-memory-is-extended-block-by-block--the-size-of-the-first-block-in-the-memory-is-called--initial-memory-requirement--https---help-sap-com-doc-abapdocu-757-index-htm-7-57-en-us-abeninitial-mem-req-glosry-htm--glossary-entry---and-can-be-affected-in-the-declaration-of-an-internal-table-using-the-additions--initial-size--https---help-sap-com-doc-abapdocu-757-index-htm-7-57-en-us-abaptypes-itab-htm--and-the-obsolete--occurs--https---help-sap-com-doc-abapdocu-757-index-htm-7-57-en-us-abapdata-occurs-htm----it-is-usually-up-to-the-system-to-determine-the-size-of-the-first-block--initial-size-is-not-used-or-specified-with-the-value-0--in-this-case--a-suitable-block-size-is-chosen-the-first-time-lines-are-added-to-an-internal-table---specifying-a-concrete-value-greater-than-0-after-initial-size-is-only-practical-if-it-is-known-in-advance-how-many-entries-are-to-be-made-in-the-table--and-the-first-block-is-therefore-to-be-created-with-the-most-suitable-dimensions--this-can-be-particularly-important-for-internal-tables-that-are-components-of-other-internal-tables--and-which-only-contain-a-few-lines--no-more-than-around-5----to-avoid-excessive-memory-demands--the-system-ignores-values-that-produce-memory-demands-greater-than-the-constant-block-size---index-administration-----in-an--index-table--https---help-sap-com-doc-abapdocu-757-index-htm-7-57-en-us-abenindex-table-glosry-htm--glossary-entry----the-logical-order-of-the-table-entries-is-not-generally-consistent-with-the-physical-order-of-the-entries-in-the-main-memory--in-this-case--the-logical-order-is-no-longer-administrated-by-a-physical-index--but-by-a-logical-index--the-same-basically-applies-to-the--secondary-table-indexes--https---help-sap-com-doc-abapdocu-757-index-htm-7-57-en-us-abensecondary-table-index-glosry-htm--glossary-entry---used-to-manage--secondary--https---help-sap-com-doc-abapdocu-757-index-htm-7-57-en-us-abensecondary-table-key-glosry-htm--glossary-entry----sorted-keys--https---help-sap-com-doc-abapdocu-757-index-htm-7-57-en-us-abensorted-key-glosry-htm--glossary-entry-----use-of-the-logical-index-produces-additional-memory-requirements--and-index-maintenance-places-a-high-demand-on-resources--time-and-memory--when-inserting-or-deleting-table-lines--the-resource-requirements-increase-proportionally-with-the-number-of-remaining-lines-after-the-insertion-or-deletion-position--for-very-large-internal-tables--this-can-result-in-considerable-demands-on-performance-at-runtime---the-logical-index-is-only-created-when-it-is-needed--that-is--when-a-line-is-inserted-in-front-of-another-line--if-the-order-of-the-table-lines-is-changed--or-a-line-other-than-the-last-line-is-deleted--a-logical-index-is-not-required-if-an-internal-table-is-filled-using-only--append--https---help-sap-com-doc-abapdocu-757-index-htm-7-57-en-us-abapappend-htm---and-if-only-its-last-line-or-lines-is-are-deleted-using--delete--https---help-sap-com-doc-abapdocu-757-index-htm-7-57-en-us-abapdelete-itab-htm----hint--in-contrast-to-filling-a-table-with--insert--https---help-sap-com-doc-abapdocu-757-index-htm-7-57-en-us-abapinsert-itab-htm---appending-lines-with--append--https---help-sap-com-doc-abapdocu-757-index-htm-7-57-en-us-abapappend-htm--does-not-require-any-resources-for-index-maintenance--it-is-therefore-preferable-to-use-append-instead-of-insert-to-create-a--standard-table--https---help-sap-com-doc-abapdocu-757-index-htm-7-57-en-us-abenstandard-table-glosry-htm--glossary-entry----this-is-possible-if-the-order-of-the-entries-is-not-important--or-if-entries-can-be-appended-in-the-correct-order---block-processing-of-table-lines-----if-entire-line-areas-of-a-table-can-be-processed-at-once--this-should-not-be-done-line-by-line--but-using-block-operations--block-operations-are-possible-using-the-from-and-to-additions-of-the-statements--insert--https---help-sap-com-doc-abapdocu-757-index-htm-7-57-en-us-abapinsert-itab-htm----append--https---help-sap-com-doc-abapdocu-757-index-htm-7-57-en-us-abapappend-htm--and--delete--https---help-sap-com-doc-abapdocu-757-index-htm-7-57-en-us-abapdelete-itab-htm---block-operations-are-also-more-efficient-than-single-record-operations-when-reading-from-or-modifying-database-tables-with--abap-sql--https---help-sap-com-doc-abapdocu-757-index-htm-7-57-en-us-abenabap-sql-glosry-htm--glossary-entry---statements-with-the-additions-from---appending---to-table---selective-data-transport-----if--when-reading-table-lines-using--read-table--https---help-sap-com-doc-abapdocu-757-index-htm-7-57-en-us-abapread-table-htm--or--loop-at--https---help-sap-com-doc-abapdocu-757-index-htm-7-57-en-us-abaploop-at-itab-htm---a-work-area-is-used-or-table-lines-can-be-changed-using--modify--https---help-sap-com-doc-abapdocu-757-index-htm-7-57-en-us-abapmodify-itab-htm--instead-of-direct-access--the-transporting-addition-can-be-used-to-prevent-unnecessary-assignments-of-table-components-to-the-work-area--this-can-lead-to-a-noticeable-improvement-in-performance--particularly-if-table-like-components-are-excluded-from-processing---using-secondary-keys-----the--use-of-secondary-table-keys--https---help-sap-com-doc-abapdocu-757-index-htm-7-57-en-us-abenitab-key-secondary-usage-htm--should-be-planned-and-executed-carefully-and-sparingly--the-time-gained-when-accessing-individual-lines-should-not-be-lost-again-by-the-increased-memory-and-time-requirements-for-managing-the-secondary-keys--secondary-keys-are-generally-recommended-for-internal-tables-that-are-filled-once-and-rarely-changed-during-program-execution---example--the-program-demo--secondary--keys-demonstrates-how-a-secondary-table-key-is-specified-and-the-resulting-performance-gain---deleting-table-lines-----when-lines-are-deleted-from-an-internal-table--administration-costs-are-incurred-for-all-table-keys-and-table-indexes--the-primary-key-and-all-unique-secondary-keys-are-updated-directly--but-non-unique-secondary-keys-are-updated-only-if-the-line-to-be-deleted-is-included-in-the-updated-part-of-an-associated-index---lazy-update--https---help-sap-com-doc-abapdocu-757-index-htm-7-57-en-us-abenlazy-update-glosry-htm--glossary-entry------it-should-be-noted-that--particularly-for-standard-tables--the-mean-runtime-of-the-statement--delete--https---help-sap-com-doc-abapdocu-757-index-htm-7-57-en-us-abapdelete-itab-htm--always-depends-linearly-on-the-number-of-table-lines--even-when-secondary-keys-are-specified-using--with-table-key--https---help-sap-com-doc-abapdocu-757-index-htm-7-57-en-us-abapdelete-itab-key-htm--or--using-key--https---help-sap-com-doc-abapdocu-757-index-htm-7-57-en-us-abapdelete-itab-key-htm---this-is-because-a-linear-search-is-required-to-update-the-primary-index--even-though-the-line-to-be-deleted-can-itself-be-found-quickly---deleting-lines-in-internal-tables-using--delete--https---help-sap-com-doc-abapdocu-757-index-htm-7-57-en-us-abapdelete-itab-htm--does-not-usually-release-any-memory-in-the-internal-table--statements-such-as--clear--https---help-sap-com-doc-abapdocu-757-index-htm-7-57-en-us-abapclear-htm--or--free--https---help-sap-com-doc-abapdocu-757-index-htm-7-57-en-us-abapfree-dataobject-htm--must-be-used-to-release-memory-in-internal-tables---free-key-specified-for-sorted-tables-and-hashed-tables-----when-using-the--read--https---help-sap-com-doc-abapdocu-757-index-htm-7-57-en-us-abapread-table-htm--statement-with-a-specified-free-key-of-the-form--with-key------https---help-sap-com-doc-abapdocu-757-index-htm-7-57-en-us-abapread-table-free-htm---the-search-is-optimized-in-all-cases-where-this-is-possible--that-is-------in--sorted-tables--https---help-sap-com-doc-abapdocu-757-index-htm-7-57-en-us-abensorted-table-glosry-htm--glossary-entry----if-any-initial-section-of-the--table-key--https---help-sap-com-doc-abapdocu-757-index-htm-7-57-en-us-abentable-key-glosry-htm--glossary-entry---or-the-complete-table-key-is-covered-by-the-specified-key------in--hashed-tables--https---help-sap-com-doc-abapdocu-757-index-htm-7-57-en-us-abenhashed-table-glosry-htm--glossary-entry----if-the-complete-table-key-is-covered---if-part-of-a-free-key-meets-these-conditions--this-partial-key-is-first-used-to-search-for-an-entry--in-sorted-tables--this-is-done-using-a-binary-search-with-a-logarithmic-consumption-of-resources--and-in-hashed-tables-using-a-hash-algorithm--that-is--with-constant-resource-consumption--if-an-entry-is-found--the-system-checks-whether-the-rest-of-the-key-conditions-are-also-met--this-means-that-over-specific-keys-in-particular-are-optimized---hint--see-also--optimization-of-the-where-condition--https---help-sap-com-doc-abapdocu-757-index-htm-7-57-en-us-abenitab-where-optimization-htm----sorting-----for-textual-sorting-of-an-internal-table-in-accordance-with-the-current--text-environment--https---help-sap-com-doc-abapdocu-757-index-htm-7-57-en-us-abentext-environment-glosry-htm--glossary-entry----it-can-be-more-efficient-to-use-the-statement--convert-text-into-sortable-code--https---help-sap-com-doc-abapdocu-757-index-htm-7-57-en-us-abapconvert-text-htm--instead-of--sort-as-text--https---help-sap-com-doc-abapdocu-757-index-htm-7-57-en-us-abapsort-itab-htm--in-the-following-cases-------if-an-internal-table-is-sorted-by-locale-and-then-searched-binarily-using-the-statement-read-table-or-using-a--table-expression--https---help-sap-com-doc-abapdocu-757-index-htm-7-57-en-us-abentable-expressions-htm-------an-internal-table-must-be-sorted-more-than-once------indexes-for-database-tables-should-be-structured-in-accordance-with-a-locale---continue--itab---optimizing-the-where-condition--https---help-sap-com-doc-abapdocu-757-index-htm-7-57-en-us-abenitab-where-optimization-htm--------abenitab-where-optimization-htm------title---hint--description------if-the-lines-selected-using-where-are-modified-or-deleted-using-modify-https---help-sap-com-doc-abapdocu-757-index-htm-7-57-en-us-abapmodify-itab-htm--or-delete-https---help-sap-com-doc-abapdocu-757-index-htm-7-57-en-us-abapdelete-itab-htm--and-not-just-read-using-loop-at-https---help-sap-com--version---7-57--category---general--type---abap-reference--sourceurl---https---help-sap-com-doc-abapdocu-757-index-htm-7-57-en-us-abenitab-where-optimization-htm--abapfile---abenitab-where-optimization-htm--keywords----select----update----delete----loop----do----if----case----try----catch----data----types----internal-table----abenitab----where----optimization---------------as-abap-release-757---copyright-2023-sap-se--all-rights-reserved----abap---keyword-documentation--https---help-sap-com-doc-abapdocu-757-index-htm-7-57-en-us-abenabap-htm------abap---programming-language--https---help-sap-com-doc-abapdocu-757-index-htm-7-57-en-us-abenabap-reference-htm------processing-internal-data--https---help-sap-com-doc-abapdocu-757-index-htm-7-57-en-us-abenabap-data-working-htm------internal-tables--itab---https---help-sap-com-doc-abapdocu-757-index-htm-7-57-en-us-abenitab-htm------itab---performance-notes--https---help-sap-com-doc-abapdocu-757-index-htm-7-57-en-us-abenitab-perfo-htm------------mail-gif-object-mail-gif-sap-language-en--feedback-mail-for-displayed-topic---mail-feedback--mailto-f1-helpsap.com?subject=Feedback on ABAP Documentation&body=Document: itab - Optimizing the WHERE Condition, ABENITAB_WHERE_OPTIMIZATION, 757%0D%0A%0D%0AEr
ror:%0D%0A%0D%0A%0D%0A%0D%0ASuggestion for improvement:)

itab - Optimizing the WHERE Condition

The statements [LOOP AT](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abaploop_at_itab.htm), [DELETE](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abapdelete_itab.htm), and [MODIFY](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abapmodify_itab.htm) can be specified together with a WHERE condition that selects specific lines of the internal table. Searches in a [standard table](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abenstandard_table_glosry.htm "Glossary Entry") using the [primary table key](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abenprimary_table_key_glosry.htm "Glossary Entry") are always linear and cannot be optimized. Searches using a [sorted key](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abensorted_key_glosry.htm "Glossary Entry") or a [hash key](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abenhash_key_glosry.htm "Glossary Entry"), however, can be optimized in certain circumstances. These keys are used for:

-   accessing a [sorted table](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abensorted_table_glosry.htm "Glossary Entry") using its primary key.
-   accessing a [hashed table](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abenhashed_table_glosry.htm "Glossary Entry") using its primary key.
-   accessing a table of any table type using a [secondary table key](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abensecondary_table_key_glosry.htm "Glossary Entry") specified by USING KEY.

The optimization takes place by mapping all [relational expressions](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abenrelational_expression_glosry.htm "Glossary Entry") or a group of the relational expressions in the WHERE condition to a specified key. This specified key performs a corresponding optimized key access (binary search or hash algorithm as in the statement [READ TABLE](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abapread_table.htm) or a [table expression](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abentable_expressions.htm)), to find one or more lines. The found line or lines are then checked using those remaining relational expressions from the WHERE condition that were not mapped to the specified key.

Prerequisites for the optimization are therefore:

-   The relational expressions of the WHERE condition can be transformed to a specified key.
-   The corresponding key access returns the same results as the evaluation of this part of the logical expression would. This is guaranteed only for compatible data types, since in the case of incompatible data types:
    -   the content of the specified data objects is converted to the data type of the columns before the evaluation in the case of key accesses.
    -   The [comparison rules](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abenlogexp_rules.htm) for incompatible data types apply when evaluating a [comparison expression](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abencomparison_expression_glosry.htm "Glossary Entry"). Here, all the data types involved play a part in determining which operand is converted into which comparison type.

If there are no or insufficient relational expressions to meet both of these prerequisites, no optimization is possible and the behavior is as follows:

-   If a sorted table or a hashed table is accessed using the primary table key, all lines of the internal table are checked as in a standard table.
-   If the table is read using a secondary table key, that is, if said key is specified after USING KEY, a syntax error or syntax check warning, or an exception is raised. Access using a secondary table key must always be executed in an optimized way.

The following sections describe exactly when an access can be optimized.

-   [Prerequisites for the Optimization of Hash Keys](#abenitab-where-optimization-1-------prerequisites-for-the-optimization-of-sorted-keys---@ITOC@@ABENITAB_WHERE_OPTIMIZATION_2)
-   [Requirements Made on the Operands](#@@ITOC@@ABENITAB_WHERE_OPTIMIZATION_3)

Hint

If the lines selected using WHERE are modified or deleted using [MODIFY](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abapmodify_itab.htm) or [DELETE](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abapdelete_itab.htm) and not just read using [LOOP AT](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abaploop_at_itab.htm), further update costs are incurred in addition to the search for the lines. When deleting lines from standard tables, it should be noted that searches using a secondary key optimize the selection of lines to be deleted, but not the update required for the primary key, which is usually performed using a linear search.

Prerequisites for the Optimization of Hash Keys   

In the case of [hash key](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abenhash_key_glosry.htm "Glossary Entry") accesses, there must be exactly one relational expression combined using AND for each component of the key. This expression is either

-   a [comparison expression](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abencomparison_expression_glosry.htm "Glossary Entry") with the comparison operator \= (or EQ), whose operands meet the requirements above or
-   a [predicate expression](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abenpredicate_expression_glosry.htm "Glossary Entry") IS INITIAL without the addition NOT.

These relational expressions construct the part of the logical expression used for the key access. This part must not contain duplicate key components. The remainder of the logical expression can contain any number of relational expressions combined using AND. Optimization may not be possible, however, if the Boolean operators NOT or OR are used. Key components may be used in the relational expressions not used for the key access.

Hint

Relational expressions other than comparisons using \= (or EQ) or predicate expressions IS INITIAL are not part of the key access. This applies particularly to the tabular comparison operator [IN range\_tab](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abenlogexp_select_option.htm), even if it can be traced back to optimizable comparisons.

Example

In the following example, the first two WHERE conditions can be optimized as key accesses with the secondary table key key. This is because:

1.  The optimizable conditions for b, d, and e cover the entire key.
2.  The optimizable conditions b, d, and e cover the entire key and a is a condition on a non-key column that is not involved in the part of the WHERE condition required for the optimization.
3.  The optimizable conditions b, d, and e cover the entire key and the other two conditions on the key columns b and d are not optimizable and are hence not involved in the part of the WHERE condition required for the optimization.

The next six WHERE conditions cannot be optimized and produce syntax errors. This is because:

1.  The key component d is not specified.
2.  A key component is combined using OR instead of AND.
3.  Two non-optimizable comparison operators are used.
4.  An operand of type i is used in the comparison b of type c, which does not meet the requirements made on the operands.
5.  The Boolean operator NOT is used in front of a key component.
6.  A further comparison is combined using OR.
7.  A further comparison is negated using NOT.
    
    DATA: BEGIN OF line,
            a TYPE c LENGTH 3,
            b TYPE c LENGTH 3,
            c TYPE c LENGTH 3,
            d TYPE c LENGTH 3,
            e TYPE c LENGTH 3,
            f TYPE c LENGTH 3,
          END OF line.
    DATA itab LIKE STANDARD TABLE OF line
                   WITH UNIQUE HASHED KEY key COMPONENTS b e d.
    DATA b\_tab LIKE RANGE OF line-b.
    LOOP AT itab INTO line USING KEY key
         WHERE b = '...' AND d = '...' AND e IS INITIAL.
    ENDLOOP.
    LOOP AT itab INTO line USING KEY key
         WHERE a = '...' AND b = '...' AND d = '...' AND e IS INITIAL.
    ENDLOOP.
    LOOP AT itab INTO line USING KEY key
         WHERE  b = '...' AND d = '...' AND e IS INITIAL AND
                b IN b\_tab AND d <> '...'.
    ENDLOOP.
    LOOP AT itab INTO line USING KEY key
         WHERE b = '...' AND e IS INITIAL.                     "syntax error
    ENDLOOP.
    LOOP AT itab INTO line USING KEY key
         WHERE b = '...' OR d = '...' AND e IS INITIAL OR      "syntax error
    ENDLOOP.
    LOOP AT itab INTO line USING KEY key
         WHERE b = '...' AND d <> '...' AND e IS NOT INITIAL.  "syntax error
    ENDLOOP.
    LOOP AT itab INTO line USING KEY key
         WHERE b = 333 AND d = '...' AND e IS INITIAL.         "syntax error
    ENDLOOP.
    LOOP AT itab INTO line USING KEY key
         WHERE b = '...'  AND NOT d = '...' AND e IS INITIAL.  "syntax error
    ENDLOOP.
    LOOP AT itab INTO line USING KEY key
         WHERE b = '...' AND d = '...' AND e IS INITIAL OR     "syntax error
               a = '...'.
    ENDLOOP.
    LOOP AT itab INTO line USING KEY key
         WHERE b = '...' AND d = '...' AND e IS INITIAL AND    "syntax error
               NOT a = '...'.
    ENDLOOP.
    

Prerequisites for the Optimization of Sorted Keys   

In the case of reads using a [sorted key](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abensorted_key_glosry.htm "Glossary Entry"), the same applies as to a hash key. The only difference is that only an initial section of the key consisting of at least one component needs to be covered rather than the entire key.

The internal table is accessed in part sequentially. The starting point for the processing of the table is determined by a binary search using the subconditions that cover the table key completely or partially. From the starting point onwards, the table is only processed for as long as these subconditions remain fulfilled.

Example

In the following example, the first five WHERE conditions can be optimized as key accesses with the secondary table key key. This is because:

1.  b is an initial part of the key.
2.  b is an initial part of the key and a is an independent condition.
3.  b and e are an initial part of the key.
4.  b, e, and d are an initial part of the key and the order in the WHERE condition is ignored.
5.  b is an initial part of the key and in this case, d is an independent condition, even though it is part of the key.

The next five WHERE conditions cannot be optimized and produce syntax errors. This is because:

1.  e is not an initial part of the key.
2.  No inequality comparison takes place.
3.  A comparison in a ranges table is specified.
4.  The Boolean operator NOT is used.
5.  An additional OR relationship is used.
    
    DATA: BEGIN OF line,
            a TYPE c LENGTH 3,
            b TYPE c LENGTH 3,
            c TYPE c LENGTH 3,
            d TYPE c LENGTH 3,
            e TYPE c LENGTH 3,
            f TYPE c LENGTH 3,
          END OF line.
    DATA itab LIKE STANDARD TABLE OF line
                   WITH UNIQUE SORTED KEY key COMPONENTS b e d.
    DATA b\_tab LIKE RANGE OF line-b.
    LOOP AT itab INTO line USING KEY key
                 WHERE b = '...'.
    ENDLOOP.
    LOOP AT itab INTO line USING KEY key
                 WHERE a = '...' AND b IS INITIAL.
    ENDLOOP.
    LOOP AT itab INTO line USING KEY key
                 WHERE b = '...' AND e = '...'.
    ENDLOOP.
    LOOP AT itab INTO line USING KEY key
                 WHERE b = '...' AND d IS INITIAL AND e = '...'.
    ENDLOOP.
    LOOP AT itab INTO line USING KEY key
                 WHERE b = '...' AND d <> '...'.
    ENDLOOP.
    LOOP AT itab INTO line USING KEY key
                 WHERE e = '...'.                    "syntax error
    ENDLOOP.
    LOOP AT itab INTO line USING KEY key
                 WHERE b <> '...'.                   "syntax error
    ENDLOOP.
    LOOP AT itab INTO line USING KEY key
                 WHERE b IN b\_tab.                   "syntax error
    ENDLOOP.
    LOOP AT itab INTO line USING KEY key
                 WHERE b = '...'  AND NOT e = '...'. "syntax error
    ENDLOOP.
    LOOP AT itab INTO line USING KEY key             "syntax error
                 WHERE b = '...'  AND ( d = '...' OR e IS INITIAL ).
    ENDLOOP.
    

Requirements Made on the Operands   

The part of the logical expression that can be mapped to a key access must select the same lines as a statement [READ TABLE](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abapread_table.htm) or a corresponding [table expression](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abentable_expressions.htm) that specifies the corresponding components as keys.

-   When comparing incompatible data objects, the WHERE condition is subject to the same [comparison rules](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abenlogexp_rules.htm) for incompatible data types. Here, the data types involved determine which operand is converted to which comparison type.
-   If the additions [WITH TABLE KEY](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abapread_table_key.htm) and [WITH KEY](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abapread_table_free.htm) of the statement READ or [KEY](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abentable_exp_itab_line.htm) in a table expression are used, however, the content of the specified data objects is always converted to the data type of the columns before the comparison.

If this produces differing results, an optimization is not possible. Due to the complexity of the comparison rules, particularly for [elementary data types](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abenlogexp_rules_operands.htm), it is not a good idea to construct a set of rules detailing exactly when the comparison type matches the data type of the left operand. Generally speaking,

-   only fully compatible operands are optimizable,
-   in some cases, elementary operands with different data types can be optimized, if the value ranges or lengths are suitable. For example, a comparison of a column with the type of a floating point number with an operand of type integer or of a column of c with a similar operand, if its length is less than the length of the column.

For this reason, it is advisable to use only pairs of [compatible](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abencompatible_glosry.htm "Glossary Entry") operands in the WHERE condition. This guarantees that the differences in behavior of the WHERE condition and the specified key do not affect the result.

Example

The following example is largely similar to the example in the section WHERE log\_exp in [LOOP AT itab](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abaploop_at_itab_cond.htm). In that case, access takes place using the primary key and no optimization. Here, however, access takes place using a secondary table key and a syntax check warning is produced and an exception raised when the program is executed. The number of lines in the internal table determines whether the exception is raised.

DATA text\_short TYPE c LENGTH 2.
DATA text\_long  TYPE c LENGTH 4.
DATA itab LIKE TABLE OF text\_short
          WITH UNIQUE HASHED KEY key COMPONENTS table\_line.
itab = VALUE #( ( 'AA' )
                ( 'BB' )
                ( 'CC' )
                ( 'DD' )
                ( 'EE' )
                ( 'FF' )
                ( 'GG' )
                ( 'HH' )
                ( 'II' )
                ( 'JJ' )
                ( 'KK' )
                ( 'LL' )
                ( 'MM' ) ).
text\_short = 'AA'.
text\_long  = 'AAXX'.
LOOP AT itab INTO text\_short USING KEY key
             WHERE table\_line = text\_long.
ENDLOOP.
cl\_demo\_output=>write( |LOOP: { sy-subrc }| ).
"Statement
READ TABLE itab INTO text\_short WITH TABLE KEY key
                                COMPONENTS table\_line = text\_long.
cl\_demo\_output=>write( |READ: { sy-subrc }| ).
"Expression
TRY.
    text\_short = itab\[ KEY key COMPONENTS table\_line = text\_long \].
  catch CX\_SY\_ITAB\_LINE\_NOT\_FOUND.
    ...
ENDTRY.
cl\_demo\_output=>display( |Expression: { text\_short }| ).


---


## ABAP - Keyword Documentation / ABAP - Programming Language / Processing Internal Data / Internal Tables (itab) / itab - Expressions and Functions / itab - Table Expressions (table_exp) / table_exp - default

**Files**: 2 | **Difficulty**: intermediate

# ABAP - Keyword Documentation / ABAP - Programming Language / Processing Internal Data / Internal Tables (itab) / itab - Performance Notes

Included pages: 2


### abenitab_perfo.htm

---
title: "Table Sharing"
description: |
  When assignments are made between internal tables of the same type whose line type does not contain any table types, only the internal administration functions are passed to the table body(https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abentable_body_glosry.htm 'Glossary Entry') for pe
version: "7.57"
category: "data-structures"
type: "abap-reference"
sourceUrl: "https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abenitab_perfo.htm"
abapFile: "abenitab_perfo.htm"
keywords: ["select", "insert", "update", "delete", "loop", "do", "if", "case", "try", "data", "types", "internal-table", "abenitab", "perfo"]
---

* * *

AS ABAP Release 757, ©Copyright 2023 SAP SE. All rights reserved.

[ABAP - Keyword Documentation](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abenabap.htm) →  [ABAP - Programming Language](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abenabap_reference.htm) →  [Processing Internal Data](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abenabap_data_working.htm) →  [Internal Tables (itab)](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abenitab.htm) → 

 [![](Mail.gif?object=Mail.gif&sap-language=EN "Feedback mail for displayed topic") Mail Feedback](mailto:f1_help@sap.com?subject=Feedback on ABAP Documentation&body=Document: itab - Performance Notes, ABENITAB_PERFO, 757%0D%0A%0D%0AError:%0D%0A%0D%0A%0D%0A%0D%
0ASuggestion for improvement:)

itab - Performance Notes

-   [Table Sharing](#abenitab-perfo-1-------initial-memory-requirement---@ITOC@@ABENITAB_PERFO_2)
-   [Index Administration](#abenitab-perfo-3-------block-processing-of-table-lines---@ITOC@@ABENITAB_PERFO_4)
-   [Selective Data Transport](#abenitab-perfo-5-------using-secondary-keys---@ITOC@@ABENITAB_PERFO_6)
-   [Deleting Table Lines](#abenitab-perfo-7-------free-key-specified-for-sorted-tables-and-hashed-tables---@ITOC@@ABENITAB_PERFO_8)
-   [Sorting](#abenitab-perfo-9---table-sharing-----when-assignments-are-made-between-internal-tables-of-the-same-type-whose-line-type-does-not-contain-any-table-types--only-the-internal-administration-functions-are-passed-to-the--table-body--https---help-sap-com-doc-abapdocu-757-index-htm-7-57-en-us-abentable-body-glosry-htm--glossary-entry---for-performance-reasons---table-sharing--https---help-sap-com-doc-abapdocu-757-index-htm-7-57-en-us-abentable-sharing-glosry-htm--glossary-entry---is-revoked-only-when-write-access-to-one-of-the-tables-involved-is-initiated--the-actual-copy-process-then-takes-place---initial-memory-requirement-----internal-tables-are--dynamic-data-objects--https---help-sap-com-doc-abapdocu-757-index-htm-7-57-en-us-abendynamic-data-object-glosry-htm--glossary-entry---whose-area-in-the-memory-is-extended-block-by-block--the-size-of-the-first-block-in-the-memory-is-called--initial-memory-requirement--https---help-sap-com-doc-abapdocu-757-index-htm-7-57-en-us-abeninitial-mem-req-glosry-htm--glossary-entry---and-can-be-affected-in-the-declaration-of-an-internal-table-using-the-additions--initial-size--https---help-sap-com-doc-abapdocu-757-index-htm-7-57-en-us-abaptypes-itab-htm--and-the-obsolete--occurs--https---help-sap-com-doc-abapdocu-757-index-htm-7-57-en-us-abapdata-occurs-htm----it-is-usually-up-to-the-system-to-determine-the-size-of-the-first-block--initial-size-is-not-used-or-specified-with-the-value-0--in-this-case--a-suitable-block-size-is-chosen-the-first-time-lines-are-added-to-an-internal-table---specifying-a-concrete-value-greater-than-0-after-initial-size-is-only-practical-if-it-is-known-in-advance-how-many-entries-are-to-be-made-in-the-table--and-the-first-block-is-therefore-to-be-created-with-the-most-suitable-dimensions--this-can-be-particularly-important-for-internal-tables-that-are-components-of-other-internal-tables--and-which-only-contain-a-few-lines--no-more-than-around-5----to-avoid-excessive-memory-demands--the-system-ignores-values-that-produce-memory-demands-greater-than-the-constant-block-size---index-administration-----in-an--index-table--https---help-sap-com-doc-abapdocu-757-index-htm-7-57-en-us-abenindex-table-glosry-htm--glossary-entry----the-logical-order-of-the-table-entries-is-not-generally-consistent-with-the-physical-order-of-the-entries-in-the-main-memory--in-this-case--the-logical-order-is-no-longer-administrated-by-a-physical-index--but-by-a-logical-index--the-same-basically-applies-to-the--secondary-table-indexes--https---help-sap-com-doc-abapdocu-757-index-htm-7-57-en-us-abensecondary-table-index-glosry-htm--glossary-entry---used-to-manage--secondary--https---help-sap-com-doc-abapdocu-757-index-htm-7-57-en-us-abensecondary-table-key-glosry-htm--glossary-entry----sorted-keys--https---help-sap-com-doc-abapdocu-757-index-htm-7-57-en-us-abensorted-key-glosry-htm--glossary-entry-----use-of-the-logical-index-produces-additional-memory-requirements--and-index-maintenance-places-a-high-demand-on-resources--time-and-memory--when-inserting-or-deleting-table-lines--the-resource-requirements-increase-proportionally-with-the-number-of-remaining-lines-after-the-insertion-or-deletion-position--for-very-large-internal-tables--this-can-result-in-considerable-demands-on-performance-at-runtime---the-logical-index-is-only-created-when-it-is-needed--that-is--when-a-line-is-inserted-in-front-of-another-line--if-the-order-of-the-table-lines-is-changed--or-a-line-other-than-the-last-line-is-deleted--a-logical-index-is-not-required-if-an-internal-table-is-filled-using-only--append--https---help-sap-com-doc-abapdocu-757-index-htm-7-57-en-us-abapappend-htm---and-if-only-its-last-line-or-lines-is-are-deleted-using--delete--https---help-sap-com-doc-abapdocu-757-index-htm-7-57-en-us-abapdelete-itab-htm----hint--in-contrast-to-filling-a-table-with--insert--https---help-sap-com-doc-abapdocu-757-index-htm-7-57-en-us-abapinsert-itab-htm---appending-lines-with--append--https---help-sap-com-doc-abapdocu-757-index-htm-7-57-en-us-abapappend-htm--does-not-require-any-resources-for-index-maintenance--it-is-therefore-preferable-to-use-append-instead-of-insert-to-create-a--standard-table--https---help-sap-com-doc-abapdocu-757-index-htm-7-57-en-us-abenstandard-table-glosry-htm--glossary-entry----this-is-possible-if-the-order-of-the-entries-is-not-important--or-if-entries-can-be-appended-in-the-correct-order---block-processing-of-table-lines-----if-entire-line-areas-of-a-table-can-be-processed-at-once--this-should-not-be-done-line-by-line--but-using-block-operations--block-operations-are-possible-using-the-from-and-to-additions-of-the-statements--insert--https---help-sap-com-doc-abapdocu-757-index-htm-7-57-en-us-abapinsert-itab-htm----append--https---help-sap-com-doc-abapdocu-757-index-htm-7-57-en-us-abapappend-htm--and--delete--https---help-sap-com-doc-abapdocu-757-index-htm-7-57-en-us-abapdelete-itab-htm---block-operations-are-also-more-efficient-than-single-record-operations-when-reading-from-or-modifying-database-tables-with--abap-sql--https---help-sap-com-doc-abapdocu-757-index-htm-7-57-en-us-abenabap-sql-glosry-htm--glossary-entry---statements-with-the-additions-from---appending---to-table---selective-data-transport-----if--when-reading-table-lines-using--read-table--https---help-sap-com-doc-abapdocu-757-index-htm-7-57-en-us-abapread-table-htm--or--loop-at--https---help-sap-com-doc-abapdocu-757-index-htm-7-57-en-us-abaploop-at-itab-htm---a-work-area-is-used-or-table-lines-can-be-changed-using--modify--https---help-sap-com-doc-abapdocu-757-index-htm-7-57-en-us-abapmodify-itab-htm--instead-of-direct-access--the-transporting-addition-can-be-used-to-prevent-unnecessary-assignments-of-table-components-to-the-work-area--this-can-lead-to-a-noticeable-improvement-in-performance--particularly-if-table-like-components-are-excluded-from-processing---using-secondary-keys-----the--use-of-secondary-table-keys--https---help-sap-com-doc-abapdocu-757-index-htm-7-57-en-us-abenitab-key-secondary-usage-htm--should-be-planned-and-executed-carefully-and-sparingly--the-time-gained-when-accessing-individual-lines-should-not-be-lost-again-by-the-increased-memory-and-time-requirements-for-managing-the-secondary-keys--secondary-keys-are-generally-recommended-for-internal-tables-that-are-filled-once-and-rarely-changed-during-program-execution---example--the-program-demo--secondary--keys-demonstrates-how-a-secondary-table-key-is-specified-and-the-resulting-performance-gain---deleting-table-lines-----when-lines-are-deleted-from-an-internal-table--administration-costs-are-incurred-for-all-table-keys-and-table-indexes--the-primary-key-and-all-unique-secondary-keys-are-updated-directly--but-non-unique-secondary-keys-are-updated-only-if-the-line-to-be-deleted-is-included-in-the-updated-part-of-an-associated-index---lazy-update--https---help-sap-com-doc-abapdocu-757-index-htm-7-57-en-us-abenlazy-update-glosry-htm--glossary-entry------it-should-be-noted-that--particularly-for-standard-tables--the-mean-runtime-of-the-statement--delete--https---help-sap-com-doc-abapdocu-757-index-htm-7-57-en-us-abapdelete-itab-htm--always-depends-linearly-on-the-number-of-table-lines--even-when-secondary-keys-are-specified-using--with-table-key--https---help-sap-com-doc-abapdocu-757-index-htm-7-57-en-us-abapdelete-itab-key-htm--or--using-key--https---help-sap-com-doc-abapdocu-757-index-htm-7-57-en-us-abapdelete-itab-key-htm---this-is-because-a-linear-search-is-required-to-update-the-primary-index--even-though-the-line-to-be-deleted-can-itself-be-found-quickly---deleting-lines-in-internal-tables-using--delete--https---help-sap-com-doc-abapdocu-757-index-htm-7-57-en-us-abapdelete-itab-htm--does-not-usually-release-any-memory-in-the-internal-table--statements-such-as--clear--https---help-sap-com-doc-abapdocu-757-index-htm-7-57-en-us-abapclear-htm--or--free--https---help-sap-com-doc-abapdocu-757-index-htm-7-57-en-us-abapfree-dataobject-htm--must-be-used-to-release-memory-in-internal-tables---free-key-specified-for-sorted-tables-and-hashed-tables-----when-using-the--read--https---help-sap-com-doc-abapdocu-757-index-htm-7-57-en-us-abapread-table-htm--statement-with-a-specified-free-key-of-the-form--with-key------https---help-sap-com-doc-abapdocu-757-index-htm-7-57-en-us-abapread-table-free-htm---the-search-is-optimized-in-all-cases-where-this-is-possible--that-is-------in--sorted-tables--https---help-sap-com-doc-abapdocu-757-index-htm-7-57-en-us-abensorted-table-glosry-htm--glossary-entry----if-any-initial-section-of-the--table-key--https---help-sap-com-doc-abapdocu-757-index-htm-7-57-en-us-abentable-key-glosry-htm--glossary-entry---or-the-complete-table-key-is-covered-by-the-specified-key------in--hashed-tables--https---help-sap-com-doc-abapdocu-757-index-htm-7-57-en-us-abenhashed-table-glosry-htm--glossary-entry----if-the-complete-table-key-is-covered---if-part-of-a-free-key-meets-these-conditions--this-partial-key-is-first-used-to-search-for-an-entry--in-sorted-tables--this-is-done-using-a-binary-search-with-a-logarithmic-consumption-of-resources--and-in-hashed-tables-using-a-hash-algorithm--that-is--with-constant-resource-consumption--if-an-entry-is-found--the-system-checks-whether-the-rest-of-the-key-conditions-are-also-met--this-means-that-over-specific-keys-in-particular-are-optimized---hint--see-also--optimization-of-the-where-condition--https---help-sap-com-doc-abapdocu-757-index-htm-7-57-en-us-abenitab-where-optimization-htm----sorting-----for-textual-sorting-of-an-internal-table-in-accordance-with-the-current--text-environment--https---help-sap-com-doc-abapdocu-757-index-htm-7-57-en-us-abentext-environment-glosry-htm--glossary-entry----it-can-be-more-efficient-to-use-the-statement--convert-text-into-sortable-code--https---help-sap-com-doc-abapdocu-757-index-htm-7-57-en-us-abapconvert-text-htm--instead-of--sort-as-text--https---help-sap-com-doc-abapdocu-757-index-htm-7-57-en-us-abapsort-itab-htm--in-the-following-cases-------if-an-internal-table-is-sorted-by-locale-and-then-searched-binarily-using-the-statement-read-table-or-using-a--table-expression--https---help-sap-com-doc-abapdocu-757-index-htm-7-57-en-us-abentable-expressions-htm-------an-internal-table-must-be-sorted-more-than-once------indexes-for-database-tables-should-be-structured-in-accordance-with-a-locale---continue--itab---optimizing-the-where-condition--https---help-sap-com-doc-abapdocu-757-index-htm-7-57-en-us-abenitab-where-optimization-htm--------abenitab-where-optimization-htm------title---hint--description------if-the-lines-selected-using-where-are-modified-or-deleted-using-modify-https---help-sap-com-doc-abapdocu-757-index-htm-7-57-en-us-abapmodify-itab-htm--or-delete-https---help-sap-com-doc-abapdocu-757-index-htm-7-57-en-us-abapdelete-itab-htm--and-not-just-read-using-loop-at-https---help-sap-com--version---7-57--category---general--type---abap-reference--sourceurl---https---help-sap-com-doc-abapdocu-757-index-htm-7-57-en-us-abenitab-where-optimization-htm--abapfile---abenitab-where-optimization-htm--keywords----select----update----delete----loop----do----if----case----try----catch----data----types----internal-table----abenitab----where----optimization---------------as-abap-release-757---copyright-2023-sap-se--all-rights-reserved----abap---keyword-documentation--https---help-sap-com-doc-abapdocu-757-index-htm-7-57-en-us-abenabap-htm------abap---programming-language--https---help-sap-com-doc-abapdocu-757-index-htm-7-57-en-us-abenabap-reference-htm------processing-internal-data--https---help-sap-com-doc-abapdocu-757-index-htm-7-57-en-us-abenabap-data-working-htm------internal-tables--itab---https---help-sap-com-doc-abapdocu-757-index-htm-7-57-en-us-abenitab-htm------itab---performance-notes--https---help-sap-com-doc-abapdocu-757-index-htm-7-57-en-us-abenitab-perfo-htm------------mail-gif-object-mail-gif-sap-language-en--feedback-mail-for-displayed-topic---mail-feedback--mailto-f1-helpsap.com?subject=Feedback on ABAP Documentation&body=Document: itab - Optimizing the WHERE Condition, ABENITAB_WHERE_OPTIMIZATION, 757%0D%0A%0D%0AEr
ror:%0D%0A%0D%0A%0D%0A%0D%0ASuggestion for improvement:)

itab - Optimizing the WHERE Condition

The statements [LOOP AT](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abaploop_at_itab.htm), [DELETE](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abapdelete_itab.htm), and [MODIFY](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abapmodify_itab.htm) can be specified together with a WHERE condition that selects specific lines of the internal table. Searches in a [standard table](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abenstandard_table_glosry.htm "Glossary Entry") using the [primary table key](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abenprimary_table_key_glosry.htm "Glossary Entry") are always linear and cannot be optimized. Searches using a [sorted key](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abensorted_key_glosry.htm "Glossary Entry") or a [hash key](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abenhash_key_glosry.htm "Glossary Entry"), however, can be optimized in certain circumstances. These keys are used for:

-   accessing a [sorted table](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abensorted_table_glosry.htm "Glossary Entry") using its primary key.
-   accessing a [hashed table](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abenhashed_table_glosry.htm "Glossary Entry") using its primary key.
-   accessing a table of any table type using a [secondary table key](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abensecondary_table_key_glosry.htm "Glossary Entry") specified by USING KEY.

The optimization takes place by mapping all [relational expressions](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abenrelational_expression_glosry.htm "Glossary Entry") or a group of the relational expressions in the WHERE condition to a specified key. This specified key performs a corresponding optimized key access (binary search or hash algorithm as in the statement [READ TABLE](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abapread_table.htm) or a [table expression](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abentable_expressions.htm)), to find one or more lines. The found line or lines are then checked using those remaining relational expressions from the WHERE condition that were not mapped to the specified key.

Prerequisites for the optimization are therefore:

-   The relational expressions of the WHERE condition can be transformed to a specified key.
-   The corresponding key access returns the same results as the evaluation of this part of the logical expression would. This is guaranteed only for compatible data types, since in the case of incompatible data types:
    -   the content of the specified data objects is converted to the data type of the columns before the evaluation in the case of key accesses.
    -   The [comparison rules](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abenlogexp_rules.htm) for incompatible data types apply when evaluating a [comparison expression](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abencomparison_expression_glosry.htm "Glossary Entry"). Here, all the data types involved play a part in determining which operand is converted into which comparison type.

If there are no or insufficient relational expressions to meet both of these prerequisites, no optimization is possible and the behavior is as follows:

-   If a sorted table or a hashed table is accessed using the primary table key, all lines of the internal table are checked as in a standard table.
-   If the table is read using a secondary table key, that is, if said key is specified after USING KEY, a syntax error or syntax check warning, or an exception is raised. Access using a secondary table key must always be executed in an optimized way.

The following sections describe exactly when an access can be optimized.

-   [Prerequisites for the Optimization of Hash Keys](#abenitab-where-optimization-1-------prerequisites-for-the-optimization-of-sorted-keys---@ITOC@@ABENITAB_WHERE_OPTIMIZATION_2)
-   [Requirements Made on the Operands](#@@ITOC@@ABENITAB_WHERE_OPTIMIZATION_3)

Hint

If the lines selected using WHERE are modified or deleted using [MODIFY](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abapmodify_itab.htm) or [DELETE](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abapdelete_itab.htm) and not just read using [LOOP AT](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abaploop_at_itab.htm), further update costs are incurred in addition to the search for the lines. When deleting lines from standard tables, it should be noted that searches using a secondary key optimize the selection of lines to be deleted, but not the update required for the primary key, which is usually performed using a linear search.

Prerequisites for the Optimization of Hash Keys   

In the case of [hash key](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abenhash_key_glosry.htm "Glossary Entry") accesses, there must be exactly one relational expression combined using AND for each component of the key. This expression is either

-   a [comparison expression](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abencomparison_expression_glosry.htm "Glossary Entry") with the comparison operator \= (or EQ), whose operands meet the requirements above or
-   a [predicate expression](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abenpredicate_expression_glosry.htm "Glossary Entry") IS INITIAL without the addition NOT.

These relational expressions construct the part of the logical expression used for the key access. This part must not contain duplicate key components. The remainder of the logical expression can contain any number of relational expressions combined using AND. Optimization may not be possible, however, if the Boolean operators NOT or OR are used. Key components may be used in the relational expressions not used for the key access.

Hint

Relational expressions other than comparisons using \= (or EQ) or predicate expressions IS INITIAL are not part of the key access. This applies particularly to the tabular comparison operator [IN range\_tab](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abenlogexp_select_option.htm), even if it can be traced back to optimizable comparisons.

Example

In the following example, the first two WHERE conditions can be optimized as key accesses with the secondary table key key. This is because:

1.  The optimizable conditions for b, d, and e cover the entire key.
2.  The optimizable conditions b, d, and e cover the entire key and a is a condition on a non-key column that is not involved in the part of the WHERE condition required for the optimization.
3.  The optimizable conditions b, d, and e cover the entire key and the other two conditions on the key columns b and d are not optimizable and are hence not involved in the part of the WHERE condition required for the optimization.

The next six WHERE conditions cannot be optimized and produce syntax errors. This is because:

1.  The key component d is not specified.
2.  A key component is combined using OR instead of AND.
3.  Two non-optimizable comparison operators are used.
4.  An operand of type i is used in the comparison b of type c, which does not meet the requirements made on the operands.
5.  The Boolean operator NOT is used in front of a key component.
6.  A further comparison is combined using OR.
7.  A further comparison is negated using NOT.
    
    DATA: BEGIN OF line,
            a TYPE c LENGTH 3,
            b TYPE c LENGTH 3,
            c TYPE c LENGTH 3,
            d TYPE c LENGTH 3,
            e TYPE c LENGTH 3,
            f TYPE c LENGTH 3,
          END OF line.
    DATA itab LIKE STANDARD TABLE OF line
                   WITH UNIQUE HASHED KEY key COMPONENTS b e d.
    DATA b\_tab LIKE RANGE OF line-b.
    LOOP AT itab INTO line USING KEY key
         WHERE b = '...' AND d = '...' AND e IS INITIAL.
    ENDLOOP.
    LOOP AT itab INTO line USING KEY key
         WHERE a = '...' AND b = '...' AND d = '...' AND e IS INITIAL.
    ENDLOOP.
    LOOP AT itab INTO line USING KEY key
         WHERE  b = '...' AND d = '...' AND e IS INITIAL AND
                b IN b\_tab AND d <> '...'.
    ENDLOOP.
    LOOP AT itab INTO line USING KEY key
         WHERE b = '...' AND e IS INITIAL.                     "syntax error
    ENDLOOP.
    LOOP AT itab INTO line USING KEY key
         WHERE b = '...' OR d = '...' AND e IS INITIAL OR      "syntax error
    ENDLOOP.
    LOOP AT itab INTO line USING KEY key
         WHERE b = '...' AND d <> '...' AND e IS NOT INITIAL.  "syntax error
    ENDLOOP.
    LOOP AT itab INTO line USING KEY key
         WHERE b = 333 AND d = '...' AND e IS INITIAL.         "syntax error
    ENDLOOP.
    LOOP AT itab INTO line USING KEY key
         WHERE b = '...'  AND NOT d = '...' AND e IS INITIAL.  "syntax error
    ENDLOOP.
    LOOP AT itab INTO line USING KEY key
         WHERE b = '...' AND d = '...' AND e IS INITIAL OR     "syntax error
               a = '...'.
    ENDLOOP.
    LOOP AT itab INTO line USING KEY key
         WHERE b = '...' AND d = '...' AND e IS INITIAL AND    "syntax error
               NOT a = '...'.
    ENDLOOP.
    

Prerequisites for the Optimization of Sorted Keys   

In the case of reads using a [sorted key](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abensorted_key_glosry.htm "Glossary Entry"), the same applies as to a hash key. The only difference is that only an initial section of the key consisting of at least one component needs to be covered rather than the entire key.

The internal table is accessed in part sequentially. The starting point for the processing of the table is determined by a binary search using the subconditions that cover the table key completely or partially. From the starting point onwards, the table is only processed for as long as these subconditions remain fulfilled.

Example

In the following example, the first five WHERE conditions can be optimized as key accesses with the secondary table key key. This is because:

1.  b is an initial part of the key.
2.  b is an initial part of the key and a is an independent condition.
3.  b and e are an initial part of the key.
4.  b, e, and d are an initial part of the key and the order in the WHERE condition is ignored.
5.  b is an initial part of the key and in this case, d is an independent condition, even though it is part of the key.

The next five WHERE conditions cannot be optimized and produce syntax errors. This is because:

1.  e is not an initial part of the key.
2.  No inequality comparison takes place.
3.  A comparison in a ranges table is specified.
4.  The Boolean operator NOT is used.
5.  An additional OR relationship is used.
    
    DATA: BEGIN OF line,
            a TYPE c LENGTH 3,
            b TYPE c LENGTH 3,
            c TYPE c LENGTH 3,
            d TYPE c LENGTH 3,
            e TYPE c LENGTH 3,
            f TYPE c LENGTH 3,
          END OF line.
    DATA itab LIKE STANDARD TABLE OF line
                   WITH UNIQUE SORTED KEY key COMPONENTS b e d.
    DATA b\_tab LIKE RANGE OF line-b.
    LOOP AT itab INTO line USING KEY key
                 WHERE b = '...'.
    ENDLOOP.
    LOOP AT itab INTO line USING KEY key
                 WHERE a = '...' AND b IS INITIAL.
    ENDLOOP.
    LOOP AT itab INTO line USING KEY key
                 WHERE b = '...' AND e = '...'.
    ENDLOOP.
    LOOP AT itab INTO line USING KEY key
                 WHERE b = '...' AND d IS INITIAL AND e = '...'.
    ENDLOOP.
    LOOP AT itab INTO line USING KEY key
                 WHERE b = '...' AND d <> '...'.
    ENDLOOP.
    LOOP AT itab INTO line USING KEY key
                 WHERE e = '...'.                    "syntax error
    ENDLOOP.
    LOOP AT itab INTO line USING KEY key
                 WHERE b <> '...'.                   "syntax error
    ENDLOOP.
    LOOP AT itab INTO line USING KEY key
                 WHERE b IN b\_tab.                   "syntax error
    ENDLOOP.
    LOOP AT itab INTO line USING KEY key
                 WHERE b = '...'  AND NOT e = '...'. "syntax error
    ENDLOOP.
    LOOP AT itab INTO line USING KEY key             "syntax error
                 WHERE b = '...'  AND ( d = '...' OR e IS INITIAL ).
    ENDLOOP.
    

Requirements Made on the Operands   

The part of the logical expression that can be mapped to a key access must select the same lines as a statement [READ TABLE](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abapread_table.htm) or a corresponding [table expression](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abentable_expressions.htm) that specifies the corresponding components as keys.

-   When comparing incompatible data objects, the WHERE condition is subject to the same [comparison rules](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abenlogexp_rules.htm) for incompatible data types. Here, the data types involved determine which operand is converted to which comparison type.
-   If the additions [WITH TABLE KEY](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abapread_table_key.htm) and [WITH KEY](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abapread_table_free.htm) of the statement READ or [KEY](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abentable_exp_itab_line.htm) in a table expression are used, however, the content of the specified data objects is always converted to the data type of the columns before the comparison.

If this produces differing results, an optimization is not possible. Due to the complexity of the comparison rules, particularly for [elementary data types](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abenlogexp_rules_operands.htm), it is not a good idea to construct a set of rules detailing exactly when the comparison type matches the data type of the left operand. Generally speaking,

-   only fully compatible operands are optimizable,
-   in some cases, elementary operands with different data types can be optimized, if the value ranges or lengths are suitable. For example, a comparison of a column with the type of a floating point number with an operand of type integer or of a column of c with a similar operand, if its length is less than the length of the column.

For this reason, it is advisable to use only pairs of [compatible](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abencompatible_glosry.htm "Glossary Entry") operands in the WHERE condition. This guarantees that the differences in behavior of the WHERE condition and the specified key do not affect the result.

Example

The following example is largely similar to the example in the section WHERE log\_exp in [LOOP AT itab](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abaploop_at_itab_cond.htm). In that case, access takes place using the primary key and no optimization. Here, however, access takes place using a secondary table key and a syntax check warning is produced and an exception raised when the program is executed. The number of lines in the internal table determines whether the exception is raised.

DATA text\_short TYPE c LENGTH 2.
DATA text\_long  TYPE c LENGTH 4.
DATA itab LIKE TABLE OF text\_short
          WITH UNIQUE HASHED KEY key COMPONENTS table\_line.
itab = VALUE #( ( 'AA' )
                ( 'BB' )
                ( 'CC' )
                ( 'DD' )
                ( 'EE' )
                ( 'FF' )
                ( 'GG' )
                ( 'HH' )
                ( 'II' )
                ( 'JJ' )
                ( 'KK' )
                ( 'LL' )
                ( 'MM' ) ).
text\_short = 'AA'.
text\_long  = 'AAXX'.
LOOP AT itab INTO text\_short USING KEY key
             WHERE table\_line = text\_long.
ENDLOOP.
cl\_demo\_output=>write( |LOOP: { sy-subrc }| ).
"Statement
READ TABLE itab INTO text\_short WITH TABLE KEY key
                                COMPONENTS table\_line = text\_long.
cl\_demo\_output=>write( |READ: { sy-subrc }| ).
"Expression
TRY.
    text\_short = itab\[ KEY key COMPONENTS table\_line = text\_long \].
  catch CX\_SY\_ITAB\_LINE\_NOT\_FOUND.
    ...
ENDTRY.
cl\_demo\_output=>display( |Expression: { text\_short }| ).


---


## ABAP - Keyword Documentation / ABAP - Programming Language / Processing Internal Data / Internal Tables (itab) / itab - Expressions and Functions / itab - Table Expressions (table_exp) / table_exp - Write Positions

**Files**: 2 | **Difficulty**: intermediate

# ABAP - Keyword Documentation / ABAP - Programming Language / Processing Internal Data / Internal Tables (itab) / itab - Performance Notes

Included pages: 2


### abenitab_perfo.htm

---
title: "Table Sharing"
description: |
  When assignments are made between internal tables of the same type whose line type does not contain any table types, only the internal administration functions are passed to the table body(https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abentable_body_glosry.htm 'Glossary Entry') for pe
version: "7.57"
category: "data-structures"
type: "abap-reference"
sourceUrl: "https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abenitab_perfo.htm"
abapFile: "abenitab_perfo.htm"
keywords: ["select", "insert", "update", "delete", "loop", "do", "if", "case", "try", "data", "types", "internal-table", "abenitab", "perfo"]
---

* * *

AS ABAP Release 757, ©Copyright 2023 SAP SE. All rights reserved.

[ABAP - Keyword Documentation](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abenabap.htm) →  [ABAP - Programming Language](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abenabap_reference.htm) →  [Processing Internal Data](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abenabap_data_working.htm) →  [Internal Tables (itab)](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abenitab.htm) → 

 [![](Mail.gif?object=Mail.gif&sap-language=EN "Feedback mail for displayed topic") Mail Feedback](mailto:f1_help@sap.com?subject=Feedback on ABAP Documentation&body=Document: itab - Performance Notes, ABENITAB_PERFO, 757%0D%0A%0D%0AError:%0D%0A%0D%0A%0D%0A%0D%
0ASuggestion for improvement:)

itab - Performance Notes

-   [Table Sharing](#abenitab-perfo-1-------initial-memory-requirement---@ITOC@@ABENITAB_PERFO_2)
-   [Index Administration](#abenitab-perfo-3-------block-processing-of-table-lines---@ITOC@@ABENITAB_PERFO_4)
-   [Selective Data Transport](#abenitab-perfo-5-------using-secondary-keys---@ITOC@@ABENITAB_PERFO_6)
-   [Deleting Table Lines](#abenitab-perfo-7-------free-key-specified-for-sorted-tables-and-hashed-tables---@ITOC@@ABENITAB_PERFO_8)
-   [Sorting](#abenitab-perfo-9---table-sharing-----when-assignments-are-made-between-internal-tables-of-the-same-type-whose-line-type-does-not-contain-any-table-types--only-the-internal-administration-functions-are-passed-to-the--table-body--https---help-sap-com-doc-abapdocu-757-index-htm-7-57-en-us-abentable-body-glosry-htm--glossary-entry---for-performance-reasons---table-sharing--https---help-sap-com-doc-abapdocu-757-index-htm-7-57-en-us-abentable-sharing-glosry-htm--glossary-entry---is-revoked-only-when-write-access-to-one-of-the-tables-involved-is-initiated--the-actual-copy-process-then-takes-place---initial-memory-requirement-----internal-tables-are--dynamic-data-objects--https---help-sap-com-doc-abapdocu-757-index-htm-7-57-en-us-abendynamic-data-object-glosry-htm--glossary-entry---whose-area-in-the-memory-is-extended-block-by-block--the-size-of-the-first-block-in-the-memory-is-called--initial-memory-requirement--https---help-sap-com-doc-abapdocu-757-index-htm-7-57-en-us-abeninitial-mem-req-glosry-htm--glossary-entry---and-can-be-affected-in-the-declaration-of-an-internal-table-using-the-additions--initial-size--https---help-sap-com-doc-abapdocu-757-index-htm-7-57-en-us-abaptypes-itab-htm--and-the-obsolete--occurs--https---help-sap-com-doc-abapdocu-757-index-htm-7-57-en-us-abapdata-occurs-htm----it-is-usually-up-to-the-system-to-determine-the-size-of-the-first-block--initial-size-is-not-used-or-specified-with-the-value-0--in-this-case--a-suitable-block-size-is-chosen-the-first-time-lines-are-added-to-an-internal-table---specifying-a-concrete-value-greater-than-0-after-initial-size-is-only-practical-if-it-is-known-in-advance-how-many-entries-are-to-be-made-in-the-table--and-the-first-block-is-therefore-to-be-created-with-the-most-suitable-dimensions--this-can-be-particularly-important-for-internal-tables-that-are-components-of-other-internal-tables--and-which-only-contain-a-few-lines--no-more-than-around-5----to-avoid-excessive-memory-demands--the-system-ignores-values-that-produce-memory-demands-greater-than-the-constant-block-size---index-administration-----in-an--index-table--https---help-sap-com-doc-abapdocu-757-index-htm-7-57-en-us-abenindex-table-glosry-htm--glossary-entry----the-logical-order-of-the-table-entries-is-not-generally-consistent-with-the-physical-order-of-the-entries-in-the-main-memory--in-this-case--the-logical-order-is-no-longer-administrated-by-a-physical-index--but-by-a-logical-index--the-same-basically-applies-to-the--secondary-table-indexes--https---help-sap-com-doc-abapdocu-757-index-htm-7-57-en-us-abensecondary-table-index-glosry-htm--glossary-entry---used-to-manage--secondary--https---help-sap-com-doc-abapdocu-757-index-htm-7-57-en-us-abensecondary-table-key-glosry-htm--glossary-entry----sorted-keys--https---help-sap-com-doc-abapdocu-757-index-htm-7-57-en-us-abensorted-key-glosry-htm--glossary-entry-----use-of-the-logical-index-produces-additional-memory-requirements--and-index-maintenance-places-a-high-demand-on-resources--time-and-memory--when-inserting-or-deleting-table-lines--the-resource-requirements-increase-proportionally-with-the-number-of-remaining-lines-after-the-insertion-or-deletion-position--for-very-large-internal-tables--this-can-result-in-considerable-demands-on-performance-at-runtime---the-logical-index-is-only-created-when-it-is-needed--that-is--when-a-line-is-inserted-in-front-of-another-line--if-the-order-of-the-table-lines-is-changed--or-a-line-other-than-the-last-line-is-deleted--a-logical-index-is-not-required-if-an-internal-table-is-filled-using-only--append--https---help-sap-com-doc-abapdocu-757-index-htm-7-57-en-us-abapappend-htm---and-if-only-its-last-line-or-lines-is-are-deleted-using--delete--https---help-sap-com-doc-abapdocu-757-index-htm-7-57-en-us-abapdelete-itab-htm----hint--in-contrast-to-filling-a-table-with--insert--https---help-sap-com-doc-abapdocu-757-index-htm-7-57-en-us-abapinsert-itab-htm---appending-lines-with--append--https---help-sap-com-doc-abapdocu-757-index-htm-7-57-en-us-abapappend-htm--does-not-require-any-resources-for-index-maintenance--it-is-therefore-preferable-to-use-append-instead-of-insert-to-create-a--standard-table--https---help-sap-com-doc-abapdocu-757-index-htm-7-57-en-us-abenstandard-table-glosry-htm--glossary-entry----this-is-possible-if-the-order-of-the-entries-is-not-important--or-if-entries-can-be-appended-in-the-correct-order---block-processing-of-table-lines-----if-entire-line-areas-of-a-table-can-be-processed-at-once--this-should-not-be-done-line-by-line--but-using-block-operations--block-operations-are-possible-using-the-from-and-to-additions-of-the-statements--insert--https---help-sap-com-doc-abapdocu-757-index-htm-7-57-en-us-abapinsert-itab-htm----append--https---help-sap-com-doc-abapdocu-757-index-htm-7-57-en-us-abapappend-htm--and--delete--https---help-sap-com-doc-abapdocu-757-index-htm-7-57-en-us-abapdelete-itab-htm---block-operations-are-also-more-efficient-than-single-record-operations-when-reading-from-or-modifying-database-tables-with--abap-sql--https---help-sap-com-doc-abapdocu-757-index-htm-7-57-en-us-abenabap-sql-glosry-htm--glossary-entry---statements-with-the-additions-from---appending---to-table---selective-data-transport-----if--when-reading-table-lines-using--read-table--https---help-sap-com-doc-abapdocu-757-index-htm-7-57-en-us-abapread-table-htm--or--loop-at--https---help-sap-com-doc-abapdocu-757-index-htm-7-57-en-us-abaploop-at-itab-htm---a-work-area-is-used-or-table-lines-can-be-changed-using--modify--https---help-sap-com-doc-abapdocu-757-index-htm-7-57-en-us-abapmodify-itab-htm--instead-of-direct-access--the-transporting-addition-can-be-used-to-prevent-unnecessary-assignments-of-table-components-to-the-work-area--this-can-lead-to-a-noticeable-improvement-in-performance--particularly-if-table-like-components-are-excluded-from-processing---using-secondary-keys-----the--use-of-secondary-table-keys--https---help-sap-com-doc-abapdocu-757-index-htm-7-57-en-us-abenitab-key-secondary-usage-htm--should-be-planned-and-executed-carefully-and-sparingly--the-time-gained-when-accessing-individual-lines-should-not-be-lost-again-by-the-increased-memory-and-time-requirements-for-managing-the-secondary-keys--secondary-keys-are-generally-recommended-for-internal-tables-that-are-filled-once-and-rarely-changed-during-program-execution---example--the-program-demo--secondary--keys-demonstrates-how-a-secondary-table-key-is-specified-and-the-resulting-performance-gain---deleting-table-lines-----when-lines-are-deleted-from-an-internal-table--administration-costs-are-incurred-for-all-table-keys-and-table-indexes--the-primary-key-and-all-unique-secondary-keys-are-updated-directly--but-non-unique-secondary-keys-are-updated-only-if-the-line-to-be-deleted-is-included-in-the-updated-part-of-an-associated-index---lazy-update--https---help-sap-com-doc-abapdocu-757-index-htm-7-57-en-us-abenlazy-update-glosry-htm--glossary-entry------it-should-be-noted-that--particularly-for-standard-tables--the-mean-runtime-of-the-statement--delete--https---help-sap-com-doc-abapdocu-757-index-htm-7-57-en-us-abapdelete-itab-htm--always-depends-linearly-on-the-number-of-table-lines--even-when-secondary-keys-are-specified-using--with-table-key--https---help-sap-com-doc-abapdocu-757-index-htm-7-57-en-us-abapdelete-itab-key-htm--or--using-key--https---help-sap-com-doc-abapdocu-757-index-htm-7-57-en-us-abapdelete-itab-key-htm---this-is-because-a-linear-search-is-required-to-update-the-primary-index--even-though-the-line-to-be-deleted-can-itself-be-found-quickly---deleting-lines-in-internal-tables-using--delete--https---help-sap-com-doc-abapdocu-757-index-htm-7-57-en-us-abapdelete-itab-htm--does-not-usually-release-any-memory-in-the-internal-table--statements-such-as--clear--https---help-sap-com-doc-abapdocu-757-index-htm-7-57-en-us-abapclear-htm--or--free--https---help-sap-com-doc-abapdocu-757-index-htm-7-57-en-us-abapfree-dataobject-htm--must-be-used-to-release-memory-in-internal-tables---free-key-specified-for-sorted-tables-and-hashed-tables-----when-using-the--read--https---help-sap-com-doc-abapdocu-757-index-htm-7-57-en-us-abapread-table-htm--statement-with-a-specified-free-key-of-the-form--with-key------https---help-sap-com-doc-abapdocu-757-index-htm-7-57-en-us-abapread-table-free-htm---the-search-is-optimized-in-all-cases-where-this-is-possible--that-is-------in--sorted-tables--https---help-sap-com-doc-abapdocu-757-index-htm-7-57-en-us-abensorted-table-glosry-htm--glossary-entry----if-any-initial-section-of-the--table-key--https---help-sap-com-doc-abapdocu-757-index-htm-7-57-en-us-abentable-key-glosry-htm--glossary-entry---or-the-complete-table-key-is-covered-by-the-specified-key------in--hashed-tables--https---help-sap-com-doc-abapdocu-757-index-htm-7-57-en-us-abenhashed-table-glosry-htm--glossary-entry----if-the-complete-table-key-is-covered---if-part-of-a-free-key-meets-these-conditions--this-partial-key-is-first-used-to-search-for-an-entry--in-sorted-tables--this-is-done-using-a-binary-search-with-a-logarithmic-consumption-of-resources--and-in-hashed-tables-using-a-hash-algorithm--that-is--with-constant-resource-consumption--if-an-entry-is-found--the-system-checks-whether-the-rest-of-the-key-conditions-are-also-met--this-means-that-over-specific-keys-in-particular-are-optimized---hint--see-also--optimization-of-the-where-condition--https---help-sap-com-doc-abapdocu-757-index-htm-7-57-en-us-abenitab-where-optimization-htm----sorting-----for-textual-sorting-of-an-internal-table-in-accordance-with-the-current--text-environment--https---help-sap-com-doc-abapdocu-757-index-htm-7-57-en-us-abentext-environment-glosry-htm--glossary-entry----it-can-be-more-efficient-to-use-the-statement--convert-text-into-sortable-code--https---help-sap-com-doc-abapdocu-757-index-htm-7-57-en-us-abapconvert-text-htm--instead-of--sort-as-text--https---help-sap-com-doc-abapdocu-757-index-htm-7-57-en-us-abapsort-itab-htm--in-the-following-cases-------if-an-internal-table-is-sorted-by-locale-and-then-searched-binarily-using-the-statement-read-table-or-using-a--table-expression--https---help-sap-com-doc-abapdocu-757-index-htm-7-57-en-us-abentable-expressions-htm-------an-internal-table-must-be-sorted-more-than-once------indexes-for-database-tables-should-be-structured-in-accordance-with-a-locale---continue--itab---optimizing-the-where-condition--https---help-sap-com-doc-abapdocu-757-index-htm-7-57-en-us-abenitab-where-optimization-htm--------abenitab-where-optimization-htm------title---hint--description------if-the-lines-selected-using-where-are-modified-or-deleted-using-modify-https---help-sap-com-doc-abapdocu-757-index-htm-7-57-en-us-abapmodify-itab-htm--or-delete-https---help-sap-com-doc-abapdocu-757-index-htm-7-57-en-us-abapdelete-itab-htm--and-not-just-read-using-loop-at-https---help-sap-com--version---7-57--category---general--type---abap-reference--sourceurl---https---help-sap-com-doc-abapdocu-757-index-htm-7-57-en-us-abenitab-where-optimization-htm--abapfile---abenitab-where-optimization-htm--keywords----select----update----delete----loop----do----if----case----try----catch----data----types----internal-table----abenitab----where----optimization---------------as-abap-release-757---copyright-2023-sap-se--all-rights-reserved----abap---keyword-documentation--https---help-sap-com-doc-abapdocu-757-index-htm-7-57-en-us-abenabap-htm------abap---programming-language--https---help-sap-com-doc-abapdocu-757-index-htm-7-57-en-us-abenabap-reference-htm------processing-internal-data--https---help-sap-com-doc-abapdocu-757-index-htm-7-57-en-us-abenabap-data-working-htm------internal-tables--itab---https---help-sap-com-doc-abapdocu-757-index-htm-7-57-en-us-abenitab-htm------itab---performance-notes--https---help-sap-com-doc-abapdocu-757-index-htm-7-57-en-us-abenitab-perfo-htm------------mail-gif-object-mail-gif-sap-language-en--feedback-mail-for-displayed-topic---mail-feedback--mailto-f1-helpsap.com?subject=Feedback on ABAP Documentation&body=Document: itab - Optimizing the WHERE Condition, ABENITAB_WHERE_OPTIMIZATION, 757%0D%0A%0D%0AEr
ror:%0D%0A%0D%0A%0D%0A%0D%0ASuggestion for improvement:)

itab - Optimizing the WHERE Condition

The statements [LOOP AT](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abaploop_at_itab.htm), [DELETE](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abapdelete_itab.htm), and [MODIFY](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abapmodify_itab.htm) can be specified together with a WHERE condition that selects specific lines of the internal table. Searches in a [standard table](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abenstandard_table_glosry.htm "Glossary Entry") using the [primary table key](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abenprimary_table_key_glosry.htm "Glossary Entry") are always linear and cannot be optimized. Searches using a [sorted key](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abensorted_key_glosry.htm "Glossary Entry") or a [hash key](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abenhash_key_glosry.htm "Glossary Entry"), however, can be optimized in certain circumstances. These keys are used for:

-   accessing a [sorted table](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abensorted_table_glosry.htm "Glossary Entry") using its primary key.
-   accessing a [hashed table](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abenhashed_table_glosry.htm "Glossary Entry") using its primary key.
-   accessing a table of any table type using a [secondary table key](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abensecondary_table_key_glosry.htm "Glossary Entry") specified by USING KEY.

The optimization takes place by mapping all [relational expressions](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abenrelational_expression_glosry.htm "Glossary Entry") or a group of the relational expressions in the WHERE condition to a specified key. This specified key performs a corresponding optimized key access (binary search or hash algorithm as in the statement [READ TABLE](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abapread_table.htm) or a [table expression](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abentable_expressions.htm)), to find one or more lines. The found line or lines are then checked using those remaining relational expressions from the WHERE condition that were not mapped to the specified key.

Prerequisites for the optimization are therefore:

-   The relational expressions of the WHERE condition can be transformed to a specified key.
-   The corresponding key access returns the same results as the evaluation of this part of the logical expression would. This is guaranteed only for compatible data types, since in the case of incompatible data types:
    -   the content of the specified data objects is converted to the data type of the columns before the evaluation in the case of key accesses.
    -   The [comparison rules](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abenlogexp_rules.htm) for incompatible data types apply when evaluating a [comparison expression](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abencomparison_expression_glosry.htm "Glossary Entry"). Here, all the data types involved play a part in determining which operand is converted into which comparison type.

If there are no or insufficient relational expressions to meet both of these prerequisites, no optimization is possible and the behavior is as follows:

-   If a sorted table or a hashed table is accessed using the primary table key, all lines of the internal table are checked as in a standard table.
-   If the table is read using a secondary table key, that is, if said key is specified after USING KEY, a syntax error or syntax check warning, or an exception is raised. Access using a secondary table key must always be executed in an optimized way.

The following sections describe exactly when an access can be optimized.

-   [Prerequisites for the Optimization of Hash Keys](#abenitab-where-optimization-1-------prerequisites-for-the-optimization-of-sorted-keys---@ITOC@@ABENITAB_WHERE_OPTIMIZATION_2)
-   [Requirements Made on the Operands](#@@ITOC@@ABENITAB_WHERE_OPTIMIZATION_3)

Hint

If the lines selected using WHERE are modified or deleted using [MODIFY](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abapmodify_itab.htm) or [DELETE](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abapdelete_itab.htm) and not just read using [LOOP AT](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abaploop_at_itab.htm), further update costs are incurred in addition to the search for the lines. When deleting lines from standard tables, it should be noted that searches using a secondary key optimize the selection of lines to be deleted, but not the update required for the primary key, which is usually performed using a linear search.

Prerequisites for the Optimization of Hash Keys   

In the case of [hash key](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abenhash_key_glosry.htm "Glossary Entry") accesses, there must be exactly one relational expression combined using AND for each component of the key. This expression is either

-   a [comparison expression](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abencomparison_expression_glosry.htm "Glossary Entry") with the comparison operator \= (or EQ), whose operands meet the requirements above or
-   a [predicate expression](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abenpredicate_expression_glosry.htm "Glossary Entry") IS INITIAL without the addition NOT.

These relational expressions construct the part of the logical expression used for the key access. This part must not contain duplicate key components. The remainder of the logical expression can contain any number of relational expressions combined using AND. Optimization may not be possible, however, if the Boolean operators NOT or OR are used. Key components may be used in the relational expressions not used for the key access.

Hint

Relational expressions other than comparisons using \= (or EQ) or predicate expressions IS INITIAL are not part of the key access. This applies particularly to the tabular comparison operator [IN range\_tab](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abenlogexp_select_option.htm), even if it can be traced back to optimizable comparisons.

Example

In the following example, the first two WHERE conditions can be optimized as key accesses with the secondary table key key. This is because:

1.  The optimizable conditions for b, d, and e cover the entire key.
2.  The optimizable conditions b, d, and e cover the entire key and a is a condition on a non-key column that is not involved in the part of the WHERE condition required for the optimization.
3.  The optimizable conditions b, d, and e cover the entire key and the other two conditions on the key columns b and d are not optimizable and are hence not involved in the part of the WHERE condition required for the optimization.

The next six WHERE conditions cannot be optimized and produce syntax errors. This is because:

1.  The key component d is not specified.
2.  A key component is combined using OR instead of AND.
3.  Two non-optimizable comparison operators are used.
4.  An operand of type i is used in the comparison b of type c, which does not meet the requirements made on the operands.
5.  The Boolean operator NOT is used in front of a key component.
6.  A further comparison is combined using OR.
7.  A further comparison is negated using NOT.
    
    DATA: BEGIN OF line,
            a TYPE c LENGTH 3,
            b TYPE c LENGTH 3,
            c TYPE c LENGTH 3,
            d TYPE c LENGTH 3,
            e TYPE c LENGTH 3,
            f TYPE c LENGTH 3,
          END OF line.
    DATA itab LIKE STANDARD TABLE OF line
                   WITH UNIQUE HASHED KEY key COMPONENTS b e d.
    DATA b\_tab LIKE RANGE OF line-b.
    LOOP AT itab INTO line USING KEY key
         WHERE b = '...' AND d = '...' AND e IS INITIAL.
    ENDLOOP.
    LOOP AT itab INTO line USING KEY key
         WHERE a = '...' AND b = '...' AND d = '...' AND e IS INITIAL.
    ENDLOOP.
    LOOP AT itab INTO line USING KEY key
         WHERE  b = '...' AND d = '...' AND e IS INITIAL AND
                b IN b\_tab AND d <> '...'.
    ENDLOOP.
    LOOP AT itab INTO line USING KEY key
         WHERE b = '...' AND e IS INITIAL.                     "syntax error
    ENDLOOP.
    LOOP AT itab INTO line USING KEY key
         WHERE b = '...' OR d = '...' AND e IS INITIAL OR      "syntax error
    ENDLOOP.
    LOOP AT itab INTO line USING KEY key
         WHERE b = '...' AND d <> '...' AND e IS NOT INITIAL.  "syntax error
    ENDLOOP.
    LOOP AT itab INTO line USING KEY key
         WHERE b = 333 AND d = '...' AND e IS INITIAL.         "syntax error
    ENDLOOP.
    LOOP AT itab INTO line USING KEY key
         WHERE b = '...'  AND NOT d = '...' AND e IS INITIAL.  "syntax error
    ENDLOOP.
    LOOP AT itab INTO line USING KEY key
         WHERE b = '...' AND d = '...' AND e IS INITIAL OR     "syntax error
               a = '...'.
    ENDLOOP.
    LOOP AT itab INTO line USING KEY key
         WHERE b = '...' AND d = '...' AND e IS INITIAL AND    "syntax error
               NOT a = '...'.
    ENDLOOP.
    

Prerequisites for the Optimization of Sorted Keys   

In the case of reads using a [sorted key](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abensorted_key_glosry.htm "Glossary Entry"), the same applies as to a hash key. The only difference is that only an initial section of the key consisting of at least one component needs to be covered rather than the entire key.

The internal table is accessed in part sequentially. The starting point for the processing of the table is determined by a binary search using the subconditions that cover the table key completely or partially. From the starting point onwards, the table is only processed for as long as these subconditions remain fulfilled.

Example

In the following example, the first five WHERE conditions can be optimized as key accesses with the secondary table key key. This is because:

1.  b is an initial part of the key.
2.  b is an initial part of the key and a is an independent condition.
3.  b and e are an initial part of the key.
4.  b, e, and d are an initial part of the key and the order in the WHERE condition is ignored.
5.  b is an initial part of the key and in this case, d is an independent condition, even though it is part of the key.

The next five WHERE conditions cannot be optimized and produce syntax errors. This is because:

1.  e is not an initial part of the key.
2.  No inequality comparison takes place.
3.  A comparison in a ranges table is specified.
4.  The Boolean operator NOT is used.
5.  An additional OR relationship is used.
    
    DATA: BEGIN OF line,
            a TYPE c LENGTH 3,
            b TYPE c LENGTH 3,
            c TYPE c LENGTH 3,
            d TYPE c LENGTH 3,
            e TYPE c LENGTH 3,
            f TYPE c LENGTH 3,
          END OF line.
    DATA itab LIKE STANDARD TABLE OF line
                   WITH UNIQUE SORTED KEY key COMPONENTS b e d.
    DATA b\_tab LIKE RANGE OF line-b.
    LOOP AT itab INTO line USING KEY key
                 WHERE b = '...'.
    ENDLOOP.
    LOOP AT itab INTO line USING KEY key
                 WHERE a = '...' AND b IS INITIAL.
    ENDLOOP.
    LOOP AT itab INTO line USING KEY key
                 WHERE b = '...' AND e = '...'.
    ENDLOOP.
    LOOP AT itab INTO line USING KEY key
                 WHERE b = '...' AND d IS INITIAL AND e = '...'.
    ENDLOOP.
    LOOP AT itab INTO line USING KEY key
                 WHERE b = '...' AND d <> '...'.
    ENDLOOP.
    LOOP AT itab INTO line USING KEY key
                 WHERE e = '...'.                    "syntax error
    ENDLOOP.
    LOOP AT itab INTO line USING KEY key
                 WHERE b <> '...'.                   "syntax error
    ENDLOOP.
    LOOP AT itab INTO line USING KEY key
                 WHERE b IN b\_tab.                   "syntax error
    ENDLOOP.
    LOOP AT itab INTO line USING KEY key
                 WHERE b = '...'  AND NOT e = '...'. "syntax error
    ENDLOOP.
    LOOP AT itab INTO line USING KEY key             "syntax error
                 WHERE b = '...'  AND ( d = '...' OR e IS INITIAL ).
    ENDLOOP.
    

Requirements Made on the Operands   

The part of the logical expression that can be mapped to a key access must select the same lines as a statement [READ TABLE](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abapread_table.htm) or a corresponding [table expression](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abentable_expressions.htm) that specifies the corresponding components as keys.

-   When comparing incompatible data objects, the WHERE condition is subject to the same [comparison rules](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abenlogexp_rules.htm) for incompatible data types. Here, the data types involved determine which operand is converted to which comparison type.
-   If the additions [WITH TABLE KEY](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abapread_table_key.htm) and [WITH KEY](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abapread_table_free.htm) of the statement READ or [KEY](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abentable_exp_itab_line.htm) in a table expression are used, however, the content of the specified data objects is always converted to the data type of the columns before the comparison.

If this produces differing results, an optimization is not possible. Due to the complexity of the comparison rules, particularly for [elementary data types](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abenlogexp_rules_operands.htm), it is not a good idea to construct a set of rules detailing exactly when the comparison type matches the data type of the left operand. Generally speaking,

-   only fully compatible operands are optimizable,
-   in some cases, elementary operands with different data types can be optimized, if the value ranges or lengths are suitable. For example, a comparison of a column with the type of a floating point number with an operand of type integer or of a column of c with a similar operand, if its length is less than the length of the column.

For this reason, it is advisable to use only pairs of [compatible](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abencompatible_glosry.htm "Glossary Entry") operands in the WHERE condition. This guarantees that the differences in behavior of the WHERE condition and the specified key do not affect the result.

Example

The following example is largely similar to the example in the section WHERE log\_exp in [LOOP AT itab](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abaploop_at_itab_cond.htm). In that case, access takes place using the primary key and no optimization. Here, however, access takes place using a secondary table key and a syntax check warning is produced and an exception raised when the program is executed. The number of lines in the internal table determines whether the exception is raised.

DATA text\_short TYPE c LENGTH 2.
DATA text\_long  TYPE c LENGTH 4.
DATA itab LIKE TABLE OF text\_short
          WITH UNIQUE HASHED KEY key COMPONENTS table\_line.
itab = VALUE #( ( 'AA' )
                ( 'BB' )
                ( 'CC' )
                ( 'DD' )
                ( 'EE' )
                ( 'FF' )
                ( 'GG' )
                ( 'HH' )
                ( 'II' )
                ( 'JJ' )
                ( 'KK' )
                ( 'LL' )
                ( 'MM' ) ).
text\_short = 'AA'.
text\_long  = 'AAXX'.
LOOP AT itab INTO text\_short USING KEY key
             WHERE table\_line = text\_long.
ENDLOOP.
cl\_demo\_output=>write( |LOOP: { sy-subrc }| ).
"Statement
READ TABLE itab INTO text\_short WITH TABLE KEY key
                                COMPONENTS table\_line = text\_long.
cl\_demo\_output=>write( |READ: { sy-subrc }| ).
"Expression
TRY.
    text\_short = itab\[ KEY key COMPONENTS table\_line = text\_long \].
  catch CX\_SY\_ITAB\_LINE\_NOT\_FOUND.
    ...
ENDTRY.
cl\_demo\_output=>display( |Expression: { text\_short }| ).


---


## ABAP - Keyword Documentation / ABAP - Programming Language / Processing Internal Data / Internal Tables (itab) / itab - Expressions and Functions / itab - Table Functions (table_func)

**Files**: 5 | **Difficulty**: intermediate

# ABAP - Keyword Documentation / ABAP - Programming Language / Processing Internal Data / Internal Tables (itab) / itab - Performance Notes

Included pages: 2


### abenitab_perfo.htm

---
title: "Table Sharing"
description: |
  When assignments are made between internal tables of the same type whose line type does not contain any table types, only the internal administration functions are passed to the table body(https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abentable_body_glosry.htm 'Glossary Entry') for pe
version: "7.57"
category: "data-structures"
type: "abap-reference"
sourceUrl: "https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abenitab_perfo.htm"
abapFile: "abenitab_perfo.htm"
keywords: ["select", "insert", "update", "delete", "loop", "do", "if", "case", "try", "data", "types", "internal-table", "abenitab", "perfo"]
---

* * *

AS ABAP Release 757, ©Copyright 2023 SAP SE. All rights reserved.

[ABAP - Keyword Documentation](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abenabap.htm) →  [ABAP - Programming Language](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abenabap_reference.htm) →  [Processing Internal Data](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abenabap_data_working.htm) →  [Internal Tables (itab)](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abenitab.htm) → 

 [![](Mail.gif?object=Mail.gif&sap-language=EN "Feedback mail for displayed topic") Mail Feedback](mailto:f1_help@sap.com?subject=Feedback on ABAP Documentation&body=Document: itab - Performance Notes, ABENITAB_PERFO, 757%0D%0A%0D%0AError:%0D%0A%0D%0A%0D%0A%0D%
0ASuggestion for improvement:)

itab - Performance Notes

-   [Table Sharing](#abenitab-perfo-1-------initial-memory-requirement---@ITOC@@ABENITAB_PERFO_2)
-   [Index Administration](#abenitab-perfo-3-------block-processing-of-table-lines---@ITOC@@ABENITAB_PERFO_4)
-   [Selective Data Transport](#abenitab-perfo-5-------using-secondary-keys---@ITOC@@ABENITAB_PERFO_6)
-   [Deleting Table Lines](#abenitab-perfo-7-------free-key-specified-for-sorted-tables-and-hashed-tables---@ITOC@@ABENITAB_PERFO_8)
-   [Sorting](#abenitab-perfo-9---table-sharing-----when-assignments-are-made-between-internal-tables-of-the-same-type-whose-line-type-does-not-contain-any-table-types--only-the-internal-administration-functions-are-passed-to-the--table-body--https---help-sap-com-doc-abapdocu-757-index-htm-7-57-en-us-abentable-body-glosry-htm--glossary-entry---for-performance-reasons---table-sharing--https---help-sap-com-doc-abapdocu-757-index-htm-7-57-en-us-abentable-sharing-glosry-htm--glossary-entry---is-revoked-only-when-write-access-to-one-of-the-tables-involved-is-initiated--the-actual-copy-process-then-takes-place---initial-memory-requirement-----internal-tables-are--dynamic-data-objects--https---help-sap-com-doc-abapdocu-757-index-htm-7-57-en-us-abendynamic-data-object-glosry-htm--glossary-entry---whose-area-in-the-memory-is-extended-block-by-block--the-size-of-the-first-block-in-the-memory-is-called--initial-memory-requirement--https---help-sap-com-doc-abapdocu-757-index-htm-7-57-en-us-abeninitial-mem-req-glosry-htm--glossary-entry---and-can-be-affected-in-the-declaration-of-an-internal-table-using-the-additions--initial-size--https---help-sap-com-doc-abapdocu-757-index-htm-7-57-en-us-abaptypes-itab-htm--and-the-obsolete--occurs--https---help-sap-com-doc-abapdocu-757-index-htm-7-57-en-us-abapdata-occurs-htm----it-is-usually-up-to-the-system-to-determine-the-size-of-the-first-block--initial-size-is-not-used-or-specified-with-the-value-0--in-this-case--a-suitable-block-size-is-chosen-the-first-time-lines-are-added-to-an-internal-table---specifying-a-concrete-value-greater-than-0-after-initial-size-is-only-practical-if-it-is-known-in-advance-how-many-entries-are-to-be-made-in-the-table--and-the-first-block-is-therefore-to-be-created-with-the-most-suitable-dimensions--this-can-be-particularly-important-for-internal-tables-that-are-components-of-other-internal-tables--and-which-only-contain-a-few-lines--no-more-than-around-5----to-avoid-excessive-memory-demands--the-system-ignores-values-that-produce-memory-demands-greater-than-the-constant-block-size---index-administration-----in-an--index-table--https---help-sap-com-doc-abapdocu-757-index-htm-7-57-en-us-abenindex-table-glosry-htm--glossary-entry----the-logical-order-of-the-table-entries-is-not-generally-consistent-with-the-physical-order-of-the-entries-in-the-main-memory--in-this-case--the-logical-order-is-no-longer-administrated-by-a-physical-index--but-by-a-logical-index--the-same-basically-applies-to-the--secondary-table-indexes--https---help-sap-com-doc-abapdocu-757-index-htm-7-57-en-us-abensecondary-table-index-glosry-htm--glossary-entry---used-to-manage--secondary--https---help-sap-com-doc-abapdocu-757-index-htm-7-57-en-us-abensecondary-table-key-glosry-htm--glossary-entry----sorted-keys--https---help-sap-com-doc-abapdocu-757-index-htm-7-57-en-us-abensorted-key-glosry-htm--glossary-entry-----use-of-the-logical-index-produces-additional-memory-requirements--and-index-maintenance-places-a-high-demand-on-resources--time-and-memory--when-inserting-or-deleting-table-lines--the-resource-requirements-increase-proportionally-with-the-number-of-remaining-lines-after-the-insertion-or-deletion-position--for-very-large-internal-tables--this-can-result-in-considerable-demands-on-performance-at-runtime---the-logical-index-is-only-created-when-it-is-needed--that-is--when-a-line-is-inserted-in-front-of-another-line--if-the-order-of-the-table-lines-is-changed--or-a-line-other-than-the-last-line-is-deleted--a-logical-index-is-not-required-if-an-internal-table-is-filled-using-only--append--https---help-sap-com-doc-abapdocu-757-index-htm-7-57-en-us-abapappend-htm---and-if-only-its-last-line-or-lines-is-are-deleted-using--delete--https---help-sap-com-doc-abapdocu-757-index-htm-7-57-en-us-abapdelete-itab-htm----hint--in-contrast-to-filling-a-table-with--insert--https---help-sap-com-doc-abapdocu-757-index-htm-7-57-en-us-abapinsert-itab-htm---appending-lines-with--append--https---help-sap-com-doc-abapdocu-757-index-htm-7-57-en-us-abapappend-htm--does-not-require-any-resources-for-index-maintenance--it-is-therefore-preferable-to-use-append-instead-of-insert-to-create-a--standard-table--https---help-sap-com-doc-abapdocu-757-index-htm-7-57-en-us-abenstandard-table-glosry-htm--glossary-entry----this-is-possible-if-the-order-of-the-entries-is-not-important--or-if-entries-can-be-appended-in-the-correct-order---block-processing-of-table-lines-----if-entire-line-areas-of-a-table-can-be-processed-at-once--this-should-not-be-done-line-by-line--but-using-block-operations--block-operations-are-possible-using-the-from-and-to-additions-of-the-statements--insert--https---help-sap-com-doc-abapdocu-757-index-htm-7-57-en-us-abapinsert-itab-htm----append--https---help-sap-com-doc-abapdocu-757-index-htm-7-57-en-us-abapappend-htm--and--delete--https---help-sap-com-doc-abapdocu-757-index-htm-7-57-en-us-abapdelete-itab-htm---block-operations-are-also-more-efficient-than-single-record-operations-when-reading-from-or-modifying-database-tables-with--abap-sql--https---help-sap-com-doc-abapdocu-757-index-htm-7-57-en-us-abenabap-sql-glosry-htm--glossary-entry---statements-with-the-additions-from---appending---to-table---selective-data-transport-----if--when-reading-table-lines-using--read-table--https---help-sap-com-doc-abapdocu-757-index-htm-7-57-en-us-abapread-table-htm--or--loop-at--https---help-sap-com-doc-abapdocu-757-index-htm-7-57-en-us-abaploop-at-itab-htm---a-work-area-is-used-or-table-lines-can-be-changed-using--modify--https---help-sap-com-doc-abapdocu-757-index-htm-7-57-en-us-abapmodify-itab-htm--instead-of-direct-access--the-transporting-addition-can-be-used-to-prevent-unnecessary-assignments-of-table-components-to-the-work-area--this-can-lead-to-a-noticeable-improvement-in-performance--particularly-if-table-like-components-are-excluded-from-processing---using-secondary-keys-----the--use-of-secondary-table-keys--https---help-sap-com-doc-abapdocu-757-index-htm-7-57-en-us-abenitab-key-secondary-usage-htm--should-be-planned-and-executed-carefully-and-sparingly--the-time-gained-when-accessing-individual-lines-should-not-be-lost-again-by-the-increased-memory-and-time-requirements-for-managing-the-secondary-keys--secondary-keys-are-generally-recommended-for-internal-tables-that-are-filled-once-and-rarely-changed-during-program-execution---example--the-program-demo--secondary--keys-demonstrates-how-a-secondary-table-key-is-specified-and-the-resulting-performance-gain---deleting-table-lines-----when-lines-are-deleted-from-an-internal-table--administration-costs-are-incurred-for-all-table-keys-and-table-indexes--the-primary-key-and-all-unique-secondary-keys-are-updated-directly--but-non-unique-secondary-keys-are-updated-only-if-the-line-to-be-deleted-is-included-in-the-updated-part-of-an-associated-index---lazy-update--https---help-sap-com-doc-abapdocu-757-index-htm-7-57-en-us-abenlazy-update-glosry-htm--glossary-entry------it-should-be-noted-that--particularly-for-standard-tables--the-mean-runtime-of-the-statement--delete--https---help-sap-com-doc-abapdocu-757-index-htm-7-57-en-us-abapdelete-itab-htm--always-depends-linearly-on-the-number-of-table-lines--even-when-secondary-keys-are-specified-using--with-table-key--https---help-sap-com-doc-abapdocu-757-index-htm-7-57-en-us-abapdelete-itab-key-htm--or--using-key--https---help-sap-com-doc-abapdocu-757-index-htm-7-57-en-us-abapdelete-itab-key-htm---this-is-because-a-linear-search-is-required-to-update-the-primary-index--even-though-the-line-to-be-deleted-can-itself-be-found-quickly---deleting-lines-in-internal-tables-using--delete--https---help-sap-com-doc-abapdocu-757-index-htm-7-57-en-us-abapdelete-itab-htm--does-not-usually-release-any-memory-in-the-internal-table--statements-such-as--clear--https---help-sap-com-doc-abapdocu-757-index-htm-7-57-en-us-abapclear-htm--or--free--https---help-sap-com-doc-abapdocu-757-index-htm-7-57-en-us-abapfree-dataobject-htm--must-be-used-to-release-memory-in-internal-tables---free-key-specified-for-sorted-tables-and-hashed-tables-----when-using-the--read--https---help-sap-com-doc-abapdocu-757-index-htm-7-57-en-us-abapread-table-htm--statement-with-a-specified-free-key-of-the-form--with-key------https---help-sap-com-doc-abapdocu-757-index-htm-7-57-en-us-abapread-table-free-htm---the-search-is-optimized-in-all-cases-where-this-is-possible--that-is-------in--sorted-tables--https---help-sap-com-doc-abapdocu-757-index-htm-7-57-en-us-abensorted-table-glosry-htm--glossary-entry----if-any-initial-section-of-the--table-key--https---help-sap-com-doc-abapdocu-757-index-htm-7-57-en-us-abentable-key-glosry-htm--glossary-entry---or-the-complete-table-key-is-covered-by-the-specified-key------in--hashed-tables--https---help-sap-com-doc-abapdocu-757-index-htm-7-57-en-us-abenhashed-table-glosry-htm--glossary-entry----if-the-complete-table-key-is-covered---if-part-of-a-free-key-meets-these-conditions--this-partial-key-is-first-used-to-search-for-an-entry--in-sorted-tables--this-is-done-using-a-binary-search-with-a-logarithmic-consumption-of-resources--and-in-hashed-tables-using-a-hash-algorithm--that-is--with-constant-resource-consumption--if-an-entry-is-found--the-system-checks-whether-the-rest-of-the-key-conditions-are-also-met--this-means-that-over-specific-keys-in-particular-are-optimized---hint--see-also--optimization-of-the-where-condition--https---help-sap-com-doc-abapdocu-757-index-htm-7-57-en-us-abenitab-where-optimization-htm----sorting-----for-textual-sorting-of-an-internal-table-in-accordance-with-the-current--text-environment--https---help-sap-com-doc-abapdocu-757-index-htm-7-57-en-us-abentext-environment-glosry-htm--glossary-entry----it-can-be-more-efficient-to-use-the-statement--convert-text-into-sortable-code--https---help-sap-com-doc-abapdocu-757-index-htm-7-57-en-us-abapconvert-text-htm--instead-of--sort-as-text--https---help-sap-com-doc-abapdocu-757-index-htm-7-57-en-us-abapsort-itab-htm--in-the-following-cases-------if-an-internal-table-is-sorted-by-locale-and-then-searched-binarily-using-the-statement-read-table-or-using-a--table-expression--https---help-sap-com-doc-abapdocu-757-index-htm-7-57-en-us-abentable-expressions-htm-------an-internal-table-must-be-sorted-more-than-once------indexes-for-database-tables-should-be-structured-in-accordance-with-a-locale---continue--itab---optimizing-the-where-condition--https---help-sap-com-doc-abapdocu-757-index-htm-7-57-en-us-abenitab-where-optimization-htm--------abenitab-where-optimization-htm------title---hint--description------if-the-lines-selected-using-where-are-modified-or-deleted-using-modify-https---help-sap-com-doc-abapdocu-757-index-htm-7-57-en-us-abapmodify-itab-htm--or-delete-https---help-sap-com-doc-abapdocu-757-index-htm-7-57-en-us-abapdelete-itab-htm--and-not-just-read-using-loop-at-https---help-sap-com--version---7-57--category---general--type---abap-reference--sourceurl---https---help-sap-com-doc-abapdocu-757-index-htm-7-57-en-us-abenitab-where-optimization-htm--abapfile---abenitab-where-optimization-htm--keywords----select----update----delete----loop----do----if----case----try----catch----data----types----internal-table----abenitab----where----optimization---------------as-abap-release-757---copyright-2023-sap-se--all-rights-reserved----abap---keyword-documentation--https---help-sap-com-doc-abapdocu-757-index-htm-7-57-en-us-abenabap-htm------abap---programming-language--https---help-sap-com-doc-abapdocu-757-index-htm-7-57-en-us-abenabap-reference-htm------processing-internal-data--https---help-sap-com-doc-abapdocu-757-index-htm-7-57-en-us-abenabap-data-working-htm------internal-tables--itab---https---help-sap-com-doc-abapdocu-757-index-htm-7-57-en-us-abenitab-htm------itab---performance-notes--https---help-sap-com-doc-abapdocu-757-index-htm-7-57-en-us-abenitab-perfo-htm------------mail-gif-object-mail-gif-sap-language-en--feedback-mail-for-displayed-topic---mail-feedback--mailto-f1-helpsap.com?subject=Feedback on ABAP Documentation&body=Document: itab - Optimizing the WHERE Condition, ABENITAB_WHERE_OPTIMIZATION, 757%0D%0A%0D%0AEr
ror:%0D%0A%0D%0A%0D%0A%0D%0ASuggestion for improvement:)

itab - Optimizing the WHERE Condition

The statements [LOOP AT](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abaploop_at_itab.htm), [DELETE](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abapdelete_itab.htm), and [MODIFY](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abapmodify_itab.htm) can be specified together with a WHERE condition that selects specific lines of the internal table. Searches in a [standard table](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abenstandard_table_glosry.htm "Glossary Entry") using the [primary table key](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abenprimary_table_key_glosry.htm "Glossary Entry") are always linear and cannot be optimized. Searches using a [sorted key](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abensorted_key_glosry.htm "Glossary Entry") or a [hash key](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abenhash_key_glosry.htm "Glossary Entry"), however, can be optimized in certain circumstances. These keys are used for:

-   accessing a [sorted table](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abensorted_table_glosry.htm "Glossary Entry") using its primary key.
-   accessing a [hashed table](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abenhashed_table_glosry.htm "Glossary Entry") using its primary key.
-   accessing a table of any table type using a [secondary table key](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abensecondary_table_key_glosry.htm "Glossary Entry") specified by USING KEY.

The optimization takes place by mapping all [relational expressions](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abenrelational_expression_glosry.htm "Glossary Entry") or a group of the relational expressions in the WHERE condition to a specified key. This specified key performs a corresponding optimized key access (binary search or hash algorithm as in the statement [READ TABLE](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abapread_table.htm) or a [table expression](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abentable_expressions.htm)), to find one or more lines. The found line or lines are then checked using those remaining relational expressions from the WHERE condition that were not mapped to the specified key.

Prerequisites for the optimization are therefore:

-   The relational expressions of the WHERE condition can be transformed to a specified key.
-   The corresponding key access returns the same results as the evaluation of this part of the logical expression would. This is guaranteed only for compatible data types, since in the case of incompatible data types:
    -   the content of the specified data objects is converted to the data type of the columns before the evaluation in the case of key accesses.
    -   The [comparison rules](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abenlogexp_rules.htm) for incompatible data types apply when evaluating a [comparison expression](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abencomparison_expression_glosry.htm "Glossary Entry"). Here, all the data types involved play a part in determining which operand is converted into which comparison type.

If there are no or insufficient relational expressions to meet both of these prerequisites, no optimization is possible and the behavior is as follows:

-   If a sorted table or a hashed table is accessed using the primary table key, all lines of the internal table are checked as in a standard table.
-   If the table is read using a secondary table key, that is, if said key is specified after USING KEY, a syntax error or syntax check warning, or an exception is raised. Access using a secondary table key must always be executed in an optimized way.

The following sections describe exactly when an access can be optimized.

-   [Prerequisites for the Optimization of Hash Keys](#abenitab-where-optimization-1-------prerequisites-for-the-optimization-of-sorted-keys---@ITOC@@ABENITAB_WHERE_OPTIMIZATION_2)
-   [Requirements Made on the Operands](#@@ITOC@@ABENITAB_WHERE_OPTIMIZATION_3)

Hint

If the lines selected using WHERE are modified or deleted using [MODIFY](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abapmodify_itab.htm) or [DELETE](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abapdelete_itab.htm) and not just read using [LOOP AT](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abaploop_at_itab.htm), further update costs are incurred in addition to the search for the lines. When deleting lines from standard tables, it should be noted that searches using a secondary key optimize the selection of lines to be deleted, but not the update required for the primary key, which is usually performed using a linear search.

Prerequisites for the Optimization of Hash Keys   

In the case of [hash key](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abenhash_key_glosry.htm "Glossary Entry") accesses, there must be exactly one relational expression combined using AND for each component of the key. This expression is either

-   a [comparison expression](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abencomparison_expression_glosry.htm "Glossary Entry") with the comparison operator \= (or EQ), whose operands meet the requirements above or
-   a [predicate expression](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abenpredicate_expression_glosry.htm "Glossary Entry") IS INITIAL without the addition NOT.

These relational expressions construct the part of the logical expression used for the key access. This part must not contain duplicate key components. The remainder of the logical expression can contain any number of relational expressions combined using AND. Optimization may not be possible, however, if the Boolean operators NOT or OR are used. Key components may be used in the relational expressions not used for the key access.

Hint

Relational expressions other than comparisons using \= (or EQ) or predicate expressions IS INITIAL are not part of the key access. This applies particularly to the tabular comparison operator [IN range\_tab](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abenlogexp_select_option.htm), even if it can be traced back to optimizable comparisons.

Example

In the following example, the first two WHERE conditions can be optimized as key accesses with the secondary table key key. This is because:

1.  The optimizable conditions for b, d, and e cover the entire key.
2.  The optimizable conditions b, d, and e cover the entire key and a is a condition on a non-key column that is not involved in the part of the WHERE condition required for the optimization.
3.  The optimizable conditions b, d, and e cover the entire key and the other two conditions on the key columns b and d are not optimizable and are hence not involved in the part of the WHERE condition required for the optimization.

The next six WHERE conditions cannot be optimized and produce syntax errors. This is because:

1.  The key component d is not specified.
2.  A key component is combined using OR instead of AND.
3.  Two non-optimizable comparison operators are used.
4.  An operand of type i is used in the comparison b of type c, which does not meet the requirements made on the operands.
5.  The Boolean operator NOT is used in front of a key component.
6.  A further comparison is combined using OR.
7.  A further comparison is negated using NOT.
    
    DATA: BEGIN OF line,
            a TYPE c LENGTH 3,
            b TYPE c LENGTH 3,
            c TYPE c LENGTH 3,
            d TYPE c LENGTH 3,
            e TYPE c LENGTH 3,
            f TYPE c LENGTH 3,
          END OF line.
    DATA itab LIKE STANDARD TABLE OF line
                   WITH UNIQUE HASHED KEY key COMPONENTS b e d.
    DATA b\_tab LIKE RANGE OF line-b.
    LOOP AT itab INTO line USING KEY key
         WHERE b = '...' AND d = '...' AND e IS INITIAL.
    ENDLOOP.
    LOOP AT itab INTO line USING KEY key
         WHERE a = '...' AND b = '...' AND d = '...' AND e IS INITIAL.
    ENDLOOP.
    LOOP AT itab INTO line USING KEY key
         WHERE  b = '...' AND d = '...' AND e IS INITIAL AND
                b IN b\_tab AND d <> '...'.
    ENDLOOP.
    LOOP AT itab INTO line USING KEY key
         WHERE b = '...' AND e IS INITIAL.                     "syntax error
    ENDLOOP.
    LOOP AT itab INTO line USING KEY key
         WHERE b = '...' OR d = '...' AND e IS INITIAL OR      "syntax error
    ENDLOOP.
    LOOP AT itab INTO line USING KEY key
         WHERE b = '...' AND d <> '...' AND e IS NOT INITIAL.  "syntax error
    ENDLOOP.
    LOOP AT itab INTO line USING KEY key
         WHERE b = 333 AND d = '...' AND e IS INITIAL.         "syntax error
    ENDLOOP.
    LOOP AT itab INTO line USING KEY key
         WHERE b = '...'  AND NOT d = '...' AND e IS INITIAL.  "syntax error
    ENDLOOP.
    LOOP AT itab INTO line USING KEY key
         WHERE b = '...' AND d = '...' AND e IS INITIAL OR     "syntax error
               a = '...'.
    ENDLOOP.
    LOOP AT itab INTO line USING KEY key
         WHERE b = '...' AND d = '...' AND e IS INITIAL AND    "syntax error
               NOT a = '...'.
    ENDLOOP.
    

Prerequisites for the Optimization of Sorted Keys   

In the case of reads using a [sorted key](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abensorted_key_glosry.htm "Glossary Entry"), the same applies as to a hash key. The only difference is that only an initial section of the key consisting of at least one component needs to be covered rather than the entire key.

The internal table is accessed in part sequentially. The starting point for the processing of the table is determined by a binary search using the subconditions that cover the table key completely or partially. From the starting point onwards, the table is only processed for as long as these subconditions remain fulfilled.

Example

In the following example, the first five WHERE conditions can be optimized as key accesses with the secondary table key key. This is because:

1.  b is an initial part of the key.
2.  b is an initial part of the key and a is an independent condition.
3.  b and e are an initial part of the key.
4.  b, e, and d are an initial part of the key and the order in the WHERE condition is ignored.
5.  b is an initial part of the key and in this case, d is an independent condition, even though it is part of the key.

The next five WHERE conditions cannot be optimized and produce syntax errors. This is because:

1.  e is not an initial part of the key.
2.  No inequality comparison takes place.
3.  A comparison in a ranges table is specified.
4.  The Boolean operator NOT is used.
5.  An additional OR relationship is used.
    
    DATA: BEGIN OF line,
            a TYPE c LENGTH 3,
            b TYPE c LENGTH 3,
            c TYPE c LENGTH 3,
            d TYPE c LENGTH 3,
            e TYPE c LENGTH 3,
            f TYPE c LENGTH 3,
          END OF line.
    DATA itab LIKE STANDARD TABLE OF line
                   WITH UNIQUE SORTED KEY key COMPONENTS b e d.
    DATA b\_tab LIKE RANGE OF line-b.
    LOOP AT itab INTO line USING KEY key
                 WHERE b = '...'.
    ENDLOOP.
    LOOP AT itab INTO line USING KEY key
                 WHERE a = '...' AND b IS INITIAL.
    ENDLOOP.
    LOOP AT itab INTO line USING KEY key
                 WHERE b = '...' AND e = '...'.
    ENDLOOP.
    LOOP AT itab INTO line USING KEY key
                 WHERE b = '...' AND d IS INITIAL AND e = '...'.
    ENDLOOP.
    LOOP AT itab INTO line USING KEY key
                 WHERE b = '...' AND d <> '...'.
    ENDLOOP.
    LOOP AT itab INTO line USING KEY key
                 WHERE e = '...'.                    "syntax error
    ENDLOOP.
    LOOP AT itab INTO line USING KEY key
                 WHERE b <> '...'.                   "syntax error
    ENDLOOP.
    LOOP AT itab INTO line USING KEY key
                 WHERE b IN b\_tab.                   "syntax error
    ENDLOOP.
    LOOP AT itab INTO line USING KEY key
                 WHERE b = '...'  AND NOT e = '...'. "syntax error
    ENDLOOP.
    LOOP AT itab INTO line USING KEY key             "syntax error
                 WHERE b = '...'  AND ( d = '...' OR e IS INITIAL ).
    ENDLOOP.
    

Requirements Made on the Operands   

The part of the logical expression that can be mapped to a key access must select the same lines as a statement [READ TABLE](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abapread_table.htm) or a corresponding [table expression](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abentable_expressions.htm) that specifies the corresponding components as keys.

-   When comparing incompatible data objects, the WHERE condition is subject to the same [comparison rules](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abenlogexp_rules.htm) for incompatible data types. Here, the data types involved determine which operand is converted to which comparison type.
-   If the additions [WITH TABLE KEY](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abapread_table_key.htm) and [WITH KEY](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abapread_table_free.htm) of the statement READ or [KEY](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abentable_exp_itab_line.htm) in a table expression are used, however, the content of the specified data objects is always converted to the data type of the columns before the comparison.

If this produces differing results, an optimization is not possible. Due to the complexity of the comparison rules, particularly for [elementary data types](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abenlogexp_rules_operands.htm), it is not a good idea to construct a set of rules detailing exactly when the comparison type matches the data type of the left operand. Generally speaking,

-   only fully compatible operands are optimizable,
-   in some cases, elementary operands with different data types can be optimized, if the value ranges or lengths are suitable. For example, a comparison of a column with the type of a floating point number with an operand of type integer or of a column of c with a similar operand, if its length is less than the length of the column.

For this reason, it is advisable to use only pairs of [compatible](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abencompatible_glosry.htm "Glossary Entry") operands in the WHERE condition. This guarantees that the differences in behavior of the WHERE condition and the specified key do not affect the result.

Example

The following example is largely similar to the example in the section WHERE log\_exp in [LOOP AT itab](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abaploop_at_itab_cond.htm). In that case, access takes place using the primary key and no optimization. Here, however, access takes place using a secondary table key and a syntax check warning is produced and an exception raised when the program is executed. The number of lines in the internal table determines whether the exception is raised.

DATA text\_short TYPE c LENGTH 2.
DATA text\_long  TYPE c LENGTH 4.
DATA itab LIKE TABLE OF text\_short
          WITH UNIQUE HASHED KEY key COMPONENTS table\_line.
itab = VALUE #( ( 'AA' )
                ( 'BB' )
                ( 'CC' )
                ( 'DD' )
                ( 'EE' )
                ( 'FF' )
                ( 'GG' )
                ( 'HH' )
                ( 'II' )
                ( 'JJ' )
                ( 'KK' )
                ( 'LL' )
                ( 'MM' ) ).
text\_short = 'AA'.
text\_long  = 'AAXX'.
LOOP AT itab INTO text\_short USING KEY key
             WHERE table\_line = text\_long.
ENDLOOP.
cl\_demo\_output=>write( |LOOP: { sy-subrc }| ).
"Statement
READ TABLE itab INTO text\_short WITH TABLE KEY key
                                COMPONENTS table\_line = text\_long.
cl\_demo\_output=>write( |READ: { sy-subrc }| ).
"Expression
TRY.
    text\_short = itab\[ KEY key COMPONENTS table\_line = text\_long \].
  catch CX\_SY\_ITAB\_LINE\_NOT\_FOUND.
    ...
ENDTRY.
cl\_demo\_output=>display( |Expression: { text\_short }| ).


---


## ABAP - Keyword Documentation / ABAP - Programming Language / Processing Internal Data / Internal Tables (itab) / itab - Expressions and Functions / FOR, Table Iterations / itab - Examples of Table Comprehensions

**Files**: 7 | **Difficulty**: intermediate

# ABAP - Keyword Documentation / ABAP - Programming Language / Processing Internal Data / Internal Tables (itab) / itab - Performance Notes

Included pages: 2


### abenitab_perfo.htm

---
title: "Table Sharing"
description: |
  When assignments are made between internal tables of the same type whose line type does not contain any table types, only the internal administration functions are passed to the table body(https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abentable_body_glosry.htm 'Glossary Entry') for pe
version: "7.57"
category: "data-structures"
type: "abap-reference"
sourceUrl: "https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abenitab_perfo.htm"
abapFile: "abenitab_perfo.htm"
keywords: ["select", "insert", "update", "delete", "loop", "do", "if", "case", "try", "data", "types", "internal-table", "abenitab", "perfo"]
---

* * *

AS ABAP Release 757, ©Copyright 2023 SAP SE. All rights reserved.

[ABAP - Keyword Documentation](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abenabap.htm) →  [ABAP - Programming Language](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abenabap_reference.htm) →  [Processing Internal Data](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abenabap_data_working.htm) →  [Internal Tables (itab)](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abenitab.htm) → 

 [![](Mail.gif?object=Mail.gif&sap-language=EN "Feedback mail for displayed topic") Mail Feedback](mailto:f1_help@sap.com?subject=Feedback on ABAP Documentation&body=Document: itab - Performance Notes, ABENITAB_PERFO, 757%0D%0A%0D%0AError:%0D%0A%0D%0A%0D%0A%0D%
0ASuggestion for improvement:)

itab - Performance Notes

-   [Table Sharing](#abenitab-perfo-1-------initial-memory-requirement---@ITOC@@ABENITAB_PERFO_2)
-   [Index Administration](#abenitab-perfo-3-------block-processing-of-table-lines---@ITOC@@ABENITAB_PERFO_4)
-   [Selective Data Transport](#abenitab-perfo-5-------using-secondary-keys---@ITOC@@ABENITAB_PERFO_6)
-   [Deleting Table Lines](#abenitab-perfo-7-------free-key-specified-for-sorted-tables-and-hashed-tables---@ITOC@@ABENITAB_PERFO_8)
-   [Sorting](#abenitab-perfo-9---table-sharing-----when-assignments-are-made-between-internal-tables-of-the-same-type-whose-line-type-does-not-contain-any-table-types--only-the-internal-administration-functions-are-passed-to-the--table-body--https---help-sap-com-doc-abapdocu-757-index-htm-7-57-en-us-abentable-body-glosry-htm--glossary-entry---for-performance-reasons---table-sharing--https---help-sap-com-doc-abapdocu-757-index-htm-7-57-en-us-abentable-sharing-glosry-htm--glossary-entry---is-revoked-only-when-write-access-to-one-of-the-tables-involved-is-initiated--the-actual-copy-process-then-takes-place---initial-memory-requirement-----internal-tables-are--dynamic-data-objects--https---help-sap-com-doc-abapdocu-757-index-htm-7-57-en-us-abendynamic-data-object-glosry-htm--glossary-entry---whose-area-in-the-memory-is-extended-block-by-block--the-size-of-the-first-block-in-the-memory-is-called--initial-memory-requirement--https---help-sap-com-doc-abapdocu-757-index-htm-7-57-en-us-abeninitial-mem-req-glosry-htm--glossary-entry---and-can-be-affected-in-the-declaration-of-an-internal-table-using-the-additions--initial-size--https---help-sap-com-doc-abapdocu-757-index-htm-7-57-en-us-abaptypes-itab-htm--and-the-obsolete--occurs--https---help-sap-com-doc-abapdocu-757-index-htm-7-57-en-us-abapdata-occurs-htm----it-is-usually-up-to-the-system-to-determine-the-size-of-the-first-block--initial-size-is-not-used-or-specified-with-the-value-0--in-this-case--a-suitable-block-size-is-chosen-the-first-time-lines-are-added-to-an-internal-table---specifying-a-concrete-value-greater-than-0-after-initial-size-is-only-practical-if-it-is-known-in-advance-how-many-entries-are-to-be-made-in-the-table--and-the-first-block-is-therefore-to-be-created-with-the-most-suitable-dimensions--this-can-be-particularly-important-for-internal-tables-that-are-components-of-other-internal-tables--and-which-only-contain-a-few-lines--no-more-than-around-5----to-avoid-excessive-memory-demands--the-system-ignores-values-that-produce-memory-demands-greater-than-the-constant-block-size---index-administration-----in-an--index-table--https---help-sap-com-doc-abapdocu-757-index-htm-7-57-en-us-abenindex-table-glosry-htm--glossary-entry----the-logical-order-of-the-table-entries-is-not-generally-consistent-with-the-physical-order-of-the-entries-in-the-main-memory--in-this-case--the-logical-order-is-no-longer-administrated-by-a-physical-index--but-by-a-logical-index--the-same-basically-applies-to-the--secondary-table-indexes--https---help-sap-com-doc-abapdocu-757-index-htm-7-57-en-us-abensecondary-table-index-glosry-htm--glossary-entry---used-to-manage--secondary--https---help-sap-com-doc-abapdocu-757-index-htm-7-57-en-us-abensecondary-table-key-glosry-htm--glossary-entry----sorted-keys--https---help-sap-com-doc-abapdocu-757-index-htm-7-57-en-us-abensorted-key-glosry-htm--glossary-entry-----use-of-the-logical-index-produces-additional-memory-requirements--and-index-maintenance-places-a-high-demand-on-resources--time-and-memory--when-inserting-or-deleting-table-lines--the-resource-requirements-increase-proportionally-with-the-number-of-remaining-lines-after-the-insertion-or-deletion-position--for-very-large-internal-tables--this-can-result-in-considerable-demands-on-performance-at-runtime---the-logical-index-is-only-created-when-it-is-needed--that-is--when-a-line-is-inserted-in-front-of-another-line--if-the-order-of-the-table-lines-is-changed--or-a-line-other-than-the-last-line-is-deleted--a-logical-index-is-not-required-if-an-internal-table-is-filled-using-only--append--https---help-sap-com-doc-abapdocu-757-index-htm-7-57-en-us-abapappend-htm---and-if-only-its-last-line-or-lines-is-are-deleted-using--delete--https---help-sap-com-doc-abapdocu-757-index-htm-7-57-en-us-abapdelete-itab-htm----hint--in-contrast-to-filling-a-table-with--insert--https---help-sap-com-doc-abapdocu-757-index-htm-7-57-en-us-abapinsert-itab-htm---appending-lines-with--append--https---help-sap-com-doc-abapdocu-757-index-htm-7-57-en-us-abapappend-htm--does-not-require-any-resources-for-index-maintenance--it-is-therefore-preferable-to-use-append-instead-of-insert-to-create-a--standard-table--https---help-sap-com-doc-abapdocu-757-index-htm-7-57-en-us-abenstandard-table-glosry-htm--glossary-entry----this-is-possible-if-the-order-of-the-entries-is-not-important--or-if-entries-can-be-appended-in-the-correct-order---block-processing-of-table-lines-----if-entire-line-areas-of-a-table-can-be-processed-at-once--this-should-not-be-done-line-by-line--but-using-block-operations--block-operations-are-possible-using-the-from-and-to-additions-of-the-statements--insert--https---help-sap-com-doc-abapdocu-757-index-htm-7-57-en-us-abapinsert-itab-htm----append--https---help-sap-com-doc-abapdocu-757-index-htm-7-57-en-us-abapappend-htm--and--delete--https---help-sap-com-doc-abapdocu-757-index-htm-7-57-en-us-abapdelete-itab-htm---block-operations-are-also-more-efficient-than-single-record-operations-when-reading-from-or-modifying-database-tables-with--abap-sql--https---help-sap-com-doc-abapdocu-757-index-htm-7-57-en-us-abenabap-sql-glosry-htm--glossary-entry---statements-with-the-additions-from---appending---to-table---selective-data-transport-----if--when-reading-table-lines-using--read-table--https---help-sap-com-doc-abapdocu-757-index-htm-7-57-en-us-abapread-table-htm--or--loop-at--https---help-sap-com-doc-abapdocu-757-index-htm-7-57-en-us-abaploop-at-itab-htm---a-work-area-is-used-or-table-lines-can-be-changed-using--modify--https---help-sap-com-doc-abapdocu-757-index-htm-7-57-en-us-abapmodify-itab-htm--instead-of-direct-access--the-transporting-addition-can-be-used-to-prevent-unnecessary-assignments-of-table-components-to-the-work-area--this-can-lead-to-a-noticeable-improvement-in-performance--particularly-if-table-like-components-are-excluded-from-processing---using-secondary-keys-----the--use-of-secondary-table-keys--https---help-sap-com-doc-abapdocu-757-index-htm-7-57-en-us-abenitab-key-secondary-usage-htm--should-be-planned-and-executed-carefully-and-sparingly--the-time-gained-when-accessing-individual-lines-should-not-be-lost-again-by-the-increased-memory-and-time-requirements-for-managing-the-secondary-keys--secondary-keys-are-generally-recommended-for-internal-tables-that-are-filled-once-and-rarely-changed-during-program-execution---example--the-program-demo--secondary--keys-demonstrates-how-a-secondary-table-key-is-specified-and-the-resulting-performance-gain---deleting-table-lines-----when-lines-are-deleted-from-an-internal-table--administration-costs-are-incurred-for-all-table-keys-and-table-indexes--the-primary-key-and-all-unique-secondary-keys-are-updated-directly--but-non-unique-secondary-keys-are-updated-only-if-the-line-to-be-deleted-is-included-in-the-updated-part-of-an-associated-index---lazy-update--https---help-sap-com-doc-abapdocu-757-index-htm-7-57-en-us-abenlazy-update-glosry-htm--glossary-entry------it-should-be-noted-that--particularly-for-standard-tables--the-mean-runtime-of-the-statement--delete--https---help-sap-com-doc-abapdocu-757-index-htm-7-57-en-us-abapdelete-itab-htm--always-depends-linearly-on-the-number-of-table-lines--even-when-secondary-keys-are-specified-using--with-table-key--https---help-sap-com-doc-abapdocu-757-index-htm-7-57-en-us-abapdelete-itab-key-htm--or--using-key--https---help-sap-com-doc-abapdocu-757-index-htm-7-57-en-us-abapdelete-itab-key-htm---this-is-because-a-linear-search-is-required-to-update-the-primary-index--even-though-the-line-to-be-deleted-can-itself-be-found-quickly---deleting-lines-in-internal-tables-using--delete--https---help-sap-com-doc-abapdocu-757-index-htm-7-57-en-us-abapdelete-itab-htm--does-not-usually-release-any-memory-in-the-internal-table--statements-such-as--clear--https---help-sap-com-doc-abapdocu-757-index-htm-7-57-en-us-abapclear-htm--or--free--https---help-sap-com-doc-abapdocu-757-index-htm-7-57-en-us-abapfree-dataobject-htm--must-be-used-to-release-memory-in-internal-tables---free-key-specified-for-sorted-tables-and-hashed-tables-----when-using-the--read--https---help-sap-com-doc-abapdocu-757-index-htm-7-57-en-us-abapread-table-htm--statement-with-a-specified-free-key-of-the-form--with-key------https---help-sap-com-doc-abapdocu-757-index-htm-7-57-en-us-abapread-table-free-htm---the-search-is-optimized-in-all-cases-where-this-is-possible--that-is-------in--sorted-tables--https---help-sap-com-doc-abapdocu-757-index-htm-7-57-en-us-abensorted-table-glosry-htm--glossary-entry----if-any-initial-section-of-the--table-key--https---help-sap-com-doc-abapdocu-757-index-htm-7-57-en-us-abentable-key-glosry-htm--glossary-entry---or-the-complete-table-key-is-covered-by-the-specified-key------in--hashed-tables--https---help-sap-com-doc-abapdocu-757-index-htm-7-57-en-us-abenhashed-table-glosry-htm--glossary-entry----if-the-complete-table-key-is-covered---if-part-of-a-free-key-meets-these-conditions--this-partial-key-is-first-used-to-search-for-an-entry--in-sorted-tables--this-is-done-using-a-binary-search-with-a-logarithmic-consumption-of-resources--and-in-hashed-tables-using-a-hash-algorithm--that-is--with-constant-resource-consumption--if-an-entry-is-found--the-system-checks-whether-the-rest-of-the-key-conditions-are-also-met--this-means-that-over-specific-keys-in-particular-are-optimized---hint--see-also--optimization-of-the-where-condition--https---help-sap-com-doc-abapdocu-757-index-htm-7-57-en-us-abenitab-where-optimization-htm----sorting-----for-textual-sorting-of-an-internal-table-in-accordance-with-the-current--text-environment--https---help-sap-com-doc-abapdocu-757-index-htm-7-57-en-us-abentext-environment-glosry-htm--glossary-entry----it-can-be-more-efficient-to-use-the-statement--convert-text-into-sortable-code--https---help-sap-com-doc-abapdocu-757-index-htm-7-57-en-us-abapconvert-text-htm--instead-of--sort-as-text--https---help-sap-com-doc-abapdocu-757-index-htm-7-57-en-us-abapsort-itab-htm--in-the-following-cases-------if-an-internal-table-is-sorted-by-locale-and-then-searched-binarily-using-the-statement-read-table-or-using-a--table-expression--https---help-sap-com-doc-abapdocu-757-index-htm-7-57-en-us-abentable-expressions-htm-------an-internal-table-must-be-sorted-more-than-once------indexes-for-database-tables-should-be-structured-in-accordance-with-a-locale---continue--itab---optimizing-the-where-condition--https---help-sap-com-doc-abapdocu-757-index-htm-7-57-en-us-abenitab-where-optimization-htm--------abenitab-where-optimization-htm------title---hint--description------if-the-lines-selected-using-where-are-modified-or-deleted-using-modify-https---help-sap-com-doc-abapdocu-757-index-htm-7-57-en-us-abapmodify-itab-htm--or-delete-https---help-sap-com-doc-abapdocu-757-index-htm-7-57-en-us-abapdelete-itab-htm--and-not-just-read-using-loop-at-https---help-sap-com--version---7-57--category---general--type---abap-reference--sourceurl---https---help-sap-com-doc-abapdocu-757-index-htm-7-57-en-us-abenitab-where-optimization-htm--abapfile---abenitab-where-optimization-htm--keywords----select----update----delete----loop----do----if----case----try----catch----data----types----internal-table----abenitab----where----optimization---------------as-abap-release-757---copyright-2023-sap-se--all-rights-reserved----abap---keyword-documentation--https---help-sap-com-doc-abapdocu-757-index-htm-7-57-en-us-abenabap-htm------abap---programming-language--https---help-sap-com-doc-abapdocu-757-index-htm-7-57-en-us-abenabap-reference-htm------processing-internal-data--https---help-sap-com-doc-abapdocu-757-index-htm-7-57-en-us-abenabap-data-working-htm------internal-tables--itab---https---help-sap-com-doc-abapdocu-757-index-htm-7-57-en-us-abenitab-htm------itab---performance-notes--https---help-sap-com-doc-abapdocu-757-index-htm-7-57-en-us-abenitab-perfo-htm------------mail-gif-object-mail-gif-sap-language-en--feedback-mail-for-displayed-topic---mail-feedback--mailto-f1-helpsap.com?subject=Feedback on ABAP Documentation&body=Document: itab - Optimizing the WHERE Condition, ABENITAB_WHERE_OPTIMIZATION, 757%0D%0A%0D%0AEr
ror:%0D%0A%0D%0A%0D%0A%0D%0ASuggestion for improvement:)

itab - Optimizing the WHERE Condition

The statements [LOOP AT](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abaploop_at_itab.htm), [DELETE](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abapdelete_itab.htm), and [MODIFY](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abapmodify_itab.htm) can be specified together with a WHERE condition that selects specific lines of the internal table. Searches in a [standard table](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abenstandard_table_glosry.htm "Glossary Entry") using the [primary table key](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abenprimary_table_key_glosry.htm "Glossary Entry") are always linear and cannot be optimized. Searches using a [sorted key](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abensorted_key_glosry.htm "Glossary Entry") or a [hash key](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abenhash_key_glosry.htm "Glossary Entry"), however, can be optimized in certain circumstances. These keys are used for:

-   accessing a [sorted table](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abensorted_table_glosry.htm "Glossary Entry") using its primary key.
-   accessing a [hashed table](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abenhashed_table_glosry.htm "Glossary Entry") using its primary key.
-   accessing a table of any table type using a [secondary table key](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abensecondary_table_key_glosry.htm "Glossary Entry") specified by USING KEY.

The optimization takes place by mapping all [relational expressions](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abenrelational_expression_glosry.htm "Glossary Entry") or a group of the relational expressions in the WHERE condition to a specified key. This specified key performs a corresponding optimized key access (binary search or hash algorithm as in the statement [READ TABLE](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abapread_table.htm) or a [table expression](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abentable_expressions.htm)), to find one or more lines. The found line or lines are then checked using those remaining relational expressions from the WHERE condition that were not mapped to the specified key.

Prerequisites for the optimization are therefore:

-   The relational expressions of the WHERE condition can be transformed to a specified key.
-   The corresponding key access returns the same results as the evaluation of this part of the logical expression would. This is guaranteed only for compatible data types, since in the case of incompatible data types:
    -   the content of the specified data objects is converted to the data type of the columns before the evaluation in the case of key accesses.
    -   The [comparison rules](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abenlogexp_rules.htm) for incompatible data types apply when evaluating a [comparison expression](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abencomparison_expression_glosry.htm "Glossary Entry"). Here, all the data types involved play a part in determining which operand is converted into which comparison type.

If there are no or insufficient relational expressions to meet both of these prerequisites, no optimization is possible and the behavior is as follows:

-   If a sorted table or a hashed table is accessed using the primary table key, all lines of the internal table are checked as in a standard table.
-   If the table is read using a secondary table key, that is, if said key is specified after USING KEY, a syntax error or syntax check warning, or an exception is raised. Access using a secondary table key must always be executed in an optimized way.

The following sections describe exactly when an access can be optimized.

-   [Prerequisites for the Optimization of Hash Keys](#abenitab-where-optimization-1-------prerequisites-for-the-optimization-of-sorted-keys---@ITOC@@ABENITAB_WHERE_OPTIMIZATION_2)
-   [Requirements Made on the Operands](#@@ITOC@@ABENITAB_WHERE_OPTIMIZATION_3)

Hint

If the lines selected using WHERE are modified or deleted using [MODIFY](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abapmodify_itab.htm) or [DELETE](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abapdelete_itab.htm) and not just read using [LOOP AT](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abaploop_at_itab.htm), further update costs are incurred in addition to the search for the lines. When deleting lines from standard tables, it should be noted that searches using a secondary key optimize the selection of lines to be deleted, but not the update required for the primary key, which is usually performed using a linear search.

Prerequisites for the Optimization of Hash Keys   

In the case of [hash key](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abenhash_key_glosry.htm "Glossary Entry") accesses, there must be exactly one relational expression combined using AND for each component of the key. This expression is either

-   a [comparison expression](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abencomparison_expression_glosry.htm "Glossary Entry") with the comparison operator \= (or EQ), whose operands meet the requirements above or
-   a [predicate expression](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abenpredicate_expression_glosry.htm "Glossary Entry") IS INITIAL without the addition NOT.

These relational expressions construct the part of the logical expression used for the key access. This part must not contain duplicate key components. The remainder of the logical expression can contain any number of relational expressions combined using AND. Optimization may not be possible, however, if the Boolean operators NOT or OR are used. Key components may be used in the relational expressions not used for the key access.

Hint

Relational expressions other than comparisons using \= (or EQ) or predicate expressions IS INITIAL are not part of the key access. This applies particularly to the tabular comparison operator [IN range\_tab](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abenlogexp_select_option.htm), even if it can be traced back to optimizable comparisons.

Example

In the following example, the first two WHERE conditions can be optimized as key accesses with the secondary table key key. This is because:

1.  The optimizable conditions for b, d, and e cover the entire key.
2.  The optimizable conditions b, d, and e cover the entire key and a is a condition on a non-key column that is not involved in the part of the WHERE condition required for the optimization.
3.  The optimizable conditions b, d, and e cover the entire key and the other two conditions on the key columns b and d are not optimizable and are hence not involved in the part of the WHERE condition required for the optimization.

The next six WHERE conditions cannot be optimized and produce syntax errors. This is because:

1.  The key component d is not specified.
2.  A key component is combined using OR instead of AND.
3.  Two non-optimizable comparison operators are used.
4.  An operand of type i is used in the comparison b of type c, which does not meet the requirements made on the operands.
5.  The Boolean operator NOT is used in front of a key component.
6.  A further comparison is combined using OR.
7.  A further comparison is negated using NOT.
    
    DATA: BEGIN OF line,
            a TYPE c LENGTH 3,
            b TYPE c LENGTH 3,
            c TYPE c LENGTH 3,
            d TYPE c LENGTH 3,
            e TYPE c LENGTH 3,
            f TYPE c LENGTH 3,
          END OF line.
    DATA itab LIKE STANDARD TABLE OF line
                   WITH UNIQUE HASHED KEY key COMPONENTS b e d.
    DATA b\_tab LIKE RANGE OF line-b.
    LOOP AT itab INTO line USING KEY key
         WHERE b = '...' AND d = '...' AND e IS INITIAL.
    ENDLOOP.
    LOOP AT itab INTO line USING KEY key
         WHERE a = '...' AND b = '...' AND d = '...' AND e IS INITIAL.
    ENDLOOP.
    LOOP AT itab INTO line USING KEY key
         WHERE  b = '...' AND d = '...' AND e IS INITIAL AND
                b IN b\_tab AND d <> '...'.
    ENDLOOP.
    LOOP AT itab INTO line USING KEY key
         WHERE b = '...' AND e IS INITIAL.                     "syntax error
    ENDLOOP.
    LOOP AT itab INTO line USING KEY key
         WHERE b = '...' OR d = '...' AND e IS INITIAL OR      "syntax error
    ENDLOOP.
    LOOP AT itab INTO line USING KEY key
         WHERE b = '...' AND d <> '...' AND e IS NOT INITIAL.  "syntax error
    ENDLOOP.
    LOOP AT itab INTO line USING KEY key
         WHERE b = 333 AND d = '...' AND e IS INITIAL.         "syntax error
    ENDLOOP.
    LOOP AT itab INTO line USING KEY key
         WHERE b = '...'  AND NOT d = '...' AND e IS INITIAL.  "syntax error
    ENDLOOP.
    LOOP AT itab INTO line USING KEY key
         WHERE b = '...' AND d = '...' AND e IS INITIAL OR     "syntax error
               a = '...'.
    ENDLOOP.
    LOOP AT itab INTO line USING KEY key
         WHERE b = '...' AND d = '...' AND e IS INITIAL AND    "syntax error
               NOT a = '...'.
    ENDLOOP.
    

Prerequisites for the Optimization of Sorted Keys   

In the case of reads using a [sorted key](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abensorted_key_glosry.htm "Glossary Entry"), the same applies as to a hash key. The only difference is that only an initial section of the key consisting of at least one component needs to be covered rather than the entire key.

The internal table is accessed in part sequentially. The starting point for the processing of the table is determined by a binary search using the subconditions that cover the table key completely or partially. From the starting point onwards, the table is only processed for as long as these subconditions remain fulfilled.

Example

In the following example, the first five WHERE conditions can be optimized as key accesses with the secondary table key key. This is because:

1.  b is an initial part of the key.
2.  b is an initial part of the key and a is an independent condition.
3.  b and e are an initial part of the key.
4.  b, e, and d are an initial part of the key and the order in the WHERE condition is ignored.
5.  b is an initial part of the key and in this case, d is an independent condition, even though it is part of the key.

The next five WHERE conditions cannot be optimized and produce syntax errors. This is because:

1.  e is not an initial part of the key.
2.  No inequality comparison takes place.
3.  A comparison in a ranges table is specified.
4.  The Boolean operator NOT is used.
5.  An additional OR relationship is used.
    
    DATA: BEGIN OF line,
            a TYPE c LENGTH 3,
            b TYPE c LENGTH 3,
            c TYPE c LENGTH 3,
            d TYPE c LENGTH 3,
            e TYPE c LENGTH 3,
            f TYPE c LENGTH 3,
          END OF line.
    DATA itab LIKE STANDARD TABLE OF line
                   WITH UNIQUE SORTED KEY key COMPONENTS b e d.
    DATA b\_tab LIKE RANGE OF line-b.
    LOOP AT itab INTO line USING KEY key
                 WHERE b = '...'.
    ENDLOOP.
    LOOP AT itab INTO line USING KEY key
                 WHERE a = '...' AND b IS INITIAL.
    ENDLOOP.
    LOOP AT itab INTO line USING KEY key
                 WHERE b = '...' AND e = '...'.
    ENDLOOP.
    LOOP AT itab INTO line USING KEY key
                 WHERE b = '...' AND d IS INITIAL AND e = '...'.
    ENDLOOP.
    LOOP AT itab INTO line USING KEY key
                 WHERE b = '...' AND d <> '...'.
    ENDLOOP.
    LOOP AT itab INTO line USING KEY key
                 WHERE e = '...'.                    "syntax error
    ENDLOOP.
    LOOP AT itab INTO line USING KEY key
                 WHERE b <> '...'.                   "syntax error
    ENDLOOP.
    LOOP AT itab INTO line USING KEY key
                 WHERE b IN b\_tab.                   "syntax error
    ENDLOOP.
    LOOP AT itab INTO line USING KEY key
                 WHERE b = '...'  AND NOT e = '...'. "syntax error
    ENDLOOP.
    LOOP AT itab INTO line USING KEY key             "syntax error
                 WHERE b = '...'  AND ( d = '...' OR e IS INITIAL ).
    ENDLOOP.
    

Requirements Made on the Operands   

The part of the logical expression that can be mapped to a key access must select the same lines as a statement [READ TABLE](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abapread_table.htm) or a corresponding [table expression](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abentable_expressions.htm) that specifies the corresponding components as keys.

-   When comparing incompatible data objects, the WHERE condition is subject to the same [comparison rules](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abenlogexp_rules.htm) for incompatible data types. Here, the data types involved determine which operand is converted to which comparison type.
-   If the additions [WITH TABLE KEY](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abapread_table_key.htm) and [WITH KEY](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abapread_table_free.htm) of the statement READ or [KEY](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abentable_exp_itab_line.htm) in a table expression are used, however, the content of the specified data objects is always converted to the data type of the columns before the comparison.

If this produces differing results, an optimization is not possible. Due to the complexity of the comparison rules, particularly for [elementary data types](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abenlogexp_rules_operands.htm), it is not a good idea to construct a set of rules detailing exactly when the comparison type matches the data type of the left operand. Generally speaking,

-   only fully compatible operands are optimizable,
-   in some cases, elementary operands with different data types can be optimized, if the value ranges or lengths are suitable. For example, a comparison of a column with the type of a floating point number with an operand of type integer or of a column of c with a similar operand, if its length is less than the length of the column.

For this reason, it is advisable to use only pairs of [compatible](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abencompatible_glosry.htm "Glossary Entry") operands in the WHERE condition. This guarantees that the differences in behavior of the WHERE condition and the specified key do not affect the result.

Example

The following example is largely similar to the example in the section WHERE log\_exp in [LOOP AT itab](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abaploop_at_itab_cond.htm). In that case, access takes place using the primary key and no optimization. Here, however, access takes place using a secondary table key and a syntax check warning is produced and an exception raised when the program is executed. The number of lines in the internal table determines whether the exception is raised.

DATA text\_short TYPE c LENGTH 2.
DATA text\_long  TYPE c LENGTH 4.
DATA itab LIKE TABLE OF text\_short
          WITH UNIQUE HASHED KEY key COMPONENTS table\_line.
itab = VALUE #( ( 'AA' )
                ( 'BB' )
                ( 'CC' )
                ( 'DD' )
                ( 'EE' )
                ( 'FF' )
                ( 'GG' )
                ( 'HH' )
                ( 'II' )
                ( 'JJ' )
                ( 'KK' )
                ( 'LL' )
                ( 'MM' ) ).
text\_short = 'AA'.
text\_long  = 'AAXX'.
LOOP AT itab INTO text\_short USING KEY key
             WHERE table\_line = text\_long.
ENDLOOP.
cl\_demo\_output=>write( |LOOP: { sy-subrc }| ).
"Statement
READ TABLE itab INTO text\_short WITH TABLE KEY key
                                COMPONENTS table\_line = text\_long.
cl\_demo\_output=>write( |READ: { sy-subrc }| ).
"Expression
TRY.
    text\_short = itab\[ KEY key COMPONENTS table\_line = text\_long \].
  catch CX\_SY\_ITAB\_LINE\_NOT\_FOUND.
    ...
ENDTRY.
cl\_demo\_output=>display( |Expression: { text\_short }| ).


---


## ABAP - Keyword Documentation / ABAP - Programming Language / Processing Internal Data / Internal Tables (itab) / itab - Expressions and Functions / FOR, Table Iterations / itab - Examples of Table Reductions

**Files**: 6 | **Difficulty**: intermediate

# ABAP - Keyword Documentation / ABAP - Programming Language / Processing Internal Data / Internal Tables (itab) / itab - Performance Notes

Included pages: 2


### abenitab_perfo.htm

---
title: "Table Sharing"
description: |
  When assignments are made between internal tables of the same type whose line type does not contain any table types, only the internal administration functions are passed to the table body(https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abentable_body_glosry.htm 'Glossary Entry') for pe
version: "7.57"
category: "data-structures"
type: "abap-reference"
sourceUrl: "https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abenitab_perfo.htm"
abapFile: "abenitab_perfo.htm"
keywords: ["select", "insert", "update", "delete", "loop", "do", "if", "case", "try", "data", "types", "internal-table", "abenitab", "perfo"]
---

* * *

AS ABAP Release 757, ©Copyright 2023 SAP SE. All rights reserved.

[ABAP - Keyword Documentation](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abenabap.htm) →  [ABAP - Programming Language](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abenabap_reference.htm) →  [Processing Internal Data](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abenabap_data_working.htm) →  [Internal Tables (itab)](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abenitab.htm) → 

 [![](Mail.gif?object=Mail.gif&sap-language=EN "Feedback mail for displayed topic") Mail Feedback](mailto:f1_help@sap.com?subject=Feedback on ABAP Documentation&body=Document: itab - Performance Notes, ABENITAB_PERFO, 757%0D%0A%0D%0AError:%0D%0A%0D%0A%0D%0A%0D%
0ASuggestion for improvement:)

itab - Performance Notes

-   [Table Sharing](#abenitab-perfo-1-------initial-memory-requirement---@ITOC@@ABENITAB_PERFO_2)
-   [Index Administration](#abenitab-perfo-3-------block-processing-of-table-lines---@ITOC@@ABENITAB_PERFO_4)
-   [Selective Data Transport](#abenitab-perfo-5-------using-secondary-keys---@ITOC@@ABENITAB_PERFO_6)
-   [Deleting Table Lines](#abenitab-perfo-7-------free-key-specified-for-sorted-tables-and-hashed-tables---@ITOC@@ABENITAB_PERFO_8)
-   [Sorting](#abenitab-perfo-9---table-sharing-----when-assignments-are-made-between-internal-tables-of-the-same-type-whose-line-type-does-not-contain-any-table-types--only-the-internal-administration-functions-are-passed-to-the--table-body--https---help-sap-com-doc-abapdocu-757-index-htm-7-57-en-us-abentable-body-glosry-htm--glossary-entry---for-performance-reasons---table-sharing--https---help-sap-com-doc-abapdocu-757-index-htm-7-57-en-us-abentable-sharing-glosry-htm--glossary-entry---is-revoked-only-when-write-access-to-one-of-the-tables-involved-is-initiated--the-actual-copy-process-then-takes-place---initial-memory-requirement-----internal-tables-are--dynamic-data-objects--https---help-sap-com-doc-abapdocu-757-index-htm-7-57-en-us-abendynamic-data-object-glosry-htm--glossary-entry---whose-area-in-the-memory-is-extended-block-by-block--the-size-of-the-first-block-in-the-memory-is-called--initial-memory-requirement--https---help-sap-com-doc-abapdocu-757-index-htm-7-57-en-us-abeninitial-mem-req-glosry-htm--glossary-entry---and-can-be-affected-in-the-declaration-of-an-internal-table-using-the-additions--initial-size--https---help-sap-com-doc-abapdocu-757-index-htm-7-57-en-us-abaptypes-itab-htm--and-the-obsolete--occurs--https---help-sap-com-doc-abapdocu-757-index-htm-7-57-en-us-abapdata-occurs-htm----it-is-usually-up-to-the-system-to-determine-the-size-of-the-first-block--initial-size-is-not-used-or-specified-with-the-value-0--in-this-case--a-suitable-block-size-is-chosen-the-first-time-lines-are-added-to-an-internal-table---specifying-a-concrete-value-greater-than-0-after-initial-size-is-only-practical-if-it-is-known-in-advance-how-many-entries-are-to-be-made-in-the-table--and-the-first-block-is-therefore-to-be-created-with-the-most-suitable-dimensions--this-can-be-particularly-important-for-internal-tables-that-are-components-of-other-internal-tables--and-which-only-contain-a-few-lines--no-more-than-around-5----to-avoid-excessive-memory-demands--the-system-ignores-values-that-produce-memory-demands-greater-than-the-constant-block-size---index-administration-----in-an--index-table--https---help-sap-com-doc-abapdocu-757-index-htm-7-57-en-us-abenindex-table-glosry-htm--glossary-entry----the-logical-order-of-the-table-entries-is-not-generally-consistent-with-the-physical-order-of-the-entries-in-the-main-memory--in-this-case--the-logical-order-is-no-longer-administrated-by-a-physical-index--but-by-a-logical-index--the-same-basically-applies-to-the--secondary-table-indexes--https---help-sap-com-doc-abapdocu-757-index-htm-7-57-en-us-abensecondary-table-index-glosry-htm--glossary-entry---used-to-manage--secondary--https---help-sap-com-doc-abapdocu-757-index-htm-7-57-en-us-abensecondary-table-key-glosry-htm--glossary-entry----sorted-keys--https---help-sap-com-doc-abapdocu-757-index-htm-7-57-en-us-abensorted-key-glosry-htm--glossary-entry-----use-of-the-logical-index-produces-additional-memory-requirements--and-index-maintenance-places-a-high-demand-on-resources--time-and-memory--when-inserting-or-deleting-table-lines--the-resource-requirements-increase-proportionally-with-the-number-of-remaining-lines-after-the-insertion-or-deletion-position--for-very-large-internal-tables--this-can-result-in-considerable-demands-on-performance-at-runtime---the-logical-index-is-only-created-when-it-is-needed--that-is--when-a-line-is-inserted-in-front-of-another-line--if-the-order-of-the-table-lines-is-changed--or-a-line-other-than-the-last-line-is-deleted--a-logical-index-is-not-required-if-an-internal-table-is-filled-using-only--append--https---help-sap-com-doc-abapdocu-757-index-htm-7-57-en-us-abapappend-htm---and-if-only-its-last-line-or-lines-is-are-deleted-using--delete--https---help-sap-com-doc-abapdocu-757-index-htm-7-57-en-us-abapdelete-itab-htm----hint--in-contrast-to-filling-a-table-with--insert--https---help-sap-com-doc-abapdocu-757-index-htm-7-57-en-us-abapinsert-itab-htm---appending-lines-with--append--https---help-sap-com-doc-abapdocu-757-index-htm-7-57-en-us-abapappend-htm--does-not-require-any-resources-for-index-maintenance--it-is-therefore-preferable-to-use-append-instead-of-insert-to-create-a--standard-table--https---help-sap-com-doc-abapdocu-757-index-htm-7-57-en-us-abenstandard-table-glosry-htm--glossary-entry----this-is-possible-if-the-order-of-the-entries-is-not-important--or-if-entries-can-be-appended-in-the-correct-order---block-processing-of-table-lines-----if-entire-line-areas-of-a-table-can-be-processed-at-once--this-should-not-be-done-line-by-line--but-using-block-operations--block-operations-are-possible-using-the-from-and-to-additions-of-the-statements--insert--https---help-sap-com-doc-abapdocu-757-index-htm-7-57-en-us-abapinsert-itab-htm----append--https---help-sap-com-doc-abapdocu-757-index-htm-7-57-en-us-abapappend-htm--and--delete--https---help-sap-com-doc-abapdocu-757-index-htm-7-57-en-us-abapdelete-itab-htm---block-operations-are-also-more-efficient-than-single-record-operations-when-reading-from-or-modifying-database-tables-with--abap-sql--https---help-sap-com-doc-abapdocu-757-index-htm-7-57-en-us-abenabap-sql-glosry-htm--glossary-entry---statements-with-the-additions-from---appending---to-table---selective-data-transport-----if--when-reading-table-lines-using--read-table--https---help-sap-com-doc-abapdocu-757-index-htm-7-57-en-us-abapread-table-htm--or--loop-at--https---help-sap-com-doc-abapdocu-757-index-htm-7-57-en-us-abaploop-at-itab-htm---a-work-area-is-used-or-table-lines-can-be-changed-using--modify--https---help-sap-com-doc-abapdocu-757-index-htm-7-57-en-us-abapmodify-itab-htm--instead-of-direct-access--the-transporting-addition-can-be-used-to-prevent-unnecessary-assignments-of-table-components-to-the-work-area--this-can-lead-to-a-noticeable-improvement-in-performance--particularly-if-table-like-components-are-excluded-from-processing---using-secondary-keys-----the--use-of-secondary-table-keys--https---help-sap-com-doc-abapdocu-757-index-htm-7-57-en-us-abenitab-key-secondary-usage-htm--should-be-planned-and-executed-carefully-and-sparingly--the-time-gained-when-accessing-individual-lines-should-not-be-lost-again-by-the-increased-memory-and-time-requirements-for-managing-the-secondary-keys--secondary-keys-are-generally-recommended-for-internal-tables-that-are-filled-once-and-rarely-changed-during-program-execution---example--the-program-demo--secondary--keys-demonstrates-how-a-secondary-table-key-is-specified-and-the-resulting-performance-gain---deleting-table-lines-----when-lines-are-deleted-from-an-internal-table--administration-costs-are-incurred-for-all-table-keys-and-table-indexes--the-primary-key-and-all-unique-secondary-keys-are-updated-directly--but-non-unique-secondary-keys-are-updated-only-if-the-line-to-be-deleted-is-included-in-the-updated-part-of-an-associated-index---lazy-update--https---help-sap-com-doc-abapdocu-757-index-htm-7-57-en-us-abenlazy-update-glosry-htm--glossary-entry------it-should-be-noted-that--particularly-for-standard-tables--the-mean-runtime-of-the-statement--delete--https---help-sap-com-doc-abapdocu-757-index-htm-7-57-en-us-abapdelete-itab-htm--always-depends-linearly-on-the-number-of-table-lines--even-when-secondary-keys-are-specified-using--with-table-key--https---help-sap-com-doc-abapdocu-757-index-htm-7-57-en-us-abapdelete-itab-key-htm--or--using-key--https---help-sap-com-doc-abapdocu-757-index-htm-7-57-en-us-abapdelete-itab-key-htm---this-is-because-a-linear-search-is-required-to-update-the-primary-index--even-though-the-line-to-be-deleted-can-itself-be-found-quickly---deleting-lines-in-internal-tables-using--delete--https---help-sap-com-doc-abapdocu-757-index-htm-7-57-en-us-abapdelete-itab-htm--does-not-usually-release-any-memory-in-the-internal-table--statements-such-as--clear--https---help-sap-com-doc-abapdocu-757-index-htm-7-57-en-us-abapclear-htm--or--free--https---help-sap-com-doc-abapdocu-757-index-htm-7-57-en-us-abapfree-dataobject-htm--must-be-used-to-release-memory-in-internal-tables---free-key-specified-for-sorted-tables-and-hashed-tables-----when-using-the--read--https---help-sap-com-doc-abapdocu-757-index-htm-7-57-en-us-abapread-table-htm--statement-with-a-specified-free-key-of-the-form--with-key------https---help-sap-com-doc-abapdocu-757-index-htm-7-57-en-us-abapread-table-free-htm---the-search-is-optimized-in-all-cases-where-this-is-possible--that-is-------in--sorted-tables--https---help-sap-com-doc-abapdocu-757-index-htm-7-57-en-us-abensorted-table-glosry-htm--glossary-entry----if-any-initial-section-of-the--table-key--https---help-sap-com-doc-abapdocu-757-index-htm-7-57-en-us-abentable-key-glosry-htm--glossary-entry---or-the-complete-table-key-is-covered-by-the-specified-key------in--hashed-tables--https---help-sap-com-doc-abapdocu-757-index-htm-7-57-en-us-abenhashed-table-glosry-htm--glossary-entry----if-the-complete-table-key-is-covered---if-part-of-a-free-key-meets-these-conditions--this-partial-key-is-first-used-to-search-for-an-entry--in-sorted-tables--this-is-done-using-a-binary-search-with-a-logarithmic-consumption-of-resources--and-in-hashed-tables-using-a-hash-algorithm--that-is--with-constant-resource-consumption--if-an-entry-is-found--the-system-checks-whether-the-rest-of-the-key-conditions-are-also-met--this-means-that-over-specific-keys-in-particular-are-optimized---hint--see-also--optimization-of-the-where-condition--https---help-sap-com-doc-abapdocu-757-index-htm-7-57-en-us-abenitab-where-optimization-htm----sorting-----for-textual-sorting-of-an-internal-table-in-accordance-with-the-current--text-environment--https---help-sap-com-doc-abapdocu-757-index-htm-7-57-en-us-abentext-environment-glosry-htm--glossary-entry----it-can-be-more-efficient-to-use-the-statement--convert-text-into-sortable-code--https---help-sap-com-doc-abapdocu-757-index-htm-7-57-en-us-abapconvert-text-htm--instead-of--sort-as-text--https---help-sap-com-doc-abapdocu-757-index-htm-7-57-en-us-abapsort-itab-htm--in-the-following-cases-------if-an-internal-table-is-sorted-by-locale-and-then-searched-binarily-using-the-statement-read-table-or-using-a--table-expression--https---help-sap-com-doc-abapdocu-757-index-htm-7-57-en-us-abentable-expressions-htm-------an-internal-table-must-be-sorted-more-than-once------indexes-for-database-tables-should-be-structured-in-accordance-with-a-locale---continue--itab---optimizing-the-where-condition--https---help-sap-com-doc-abapdocu-757-index-htm-7-57-en-us-abenitab-where-optimization-htm--------abenitab-where-optimization-htm------title---hint--description------if-the-lines-selected-using-where-are-modified-or-deleted-using-modify-https---help-sap-com-doc-abapdocu-757-index-htm-7-57-en-us-abapmodify-itab-htm--or-delete-https---help-sap-com-doc-abapdocu-757-index-htm-7-57-en-us-abapdelete-itab-htm--and-not-just-read-using-loop-at-https---help-sap-com--version---7-57--category---general--type---abap-reference--sourceurl---https---help-sap-com-doc-abapdocu-757-index-htm-7-57-en-us-abenitab-where-optimization-htm--abapfile---abenitab-where-optimization-htm--keywords----select----update----delete----loop----do----if----case----try----catch----data----types----internal-table----abenitab----where----optimization---------------as-abap-release-757---copyright-2023-sap-se--all-rights-reserved----abap---keyword-documentation--https---help-sap-com-doc-abapdocu-757-index-htm-7-57-en-us-abenabap-htm------abap---programming-language--https---help-sap-com-doc-abapdocu-757-index-htm-7-57-en-us-abenabap-reference-htm------processing-internal-data--https---help-sap-com-doc-abapdocu-757-index-htm-7-57-en-us-abenabap-data-working-htm------internal-tables--itab---https---help-sap-com-doc-abapdocu-757-index-htm-7-57-en-us-abenitab-htm------itab---performance-notes--https---help-sap-com-doc-abapdocu-757-index-htm-7-57-en-us-abenitab-perfo-htm------------mail-gif-object-mail-gif-sap-language-en--feedback-mail-for-displayed-topic---mail-feedback--mailto-f1-helpsap.com?subject=Feedback on ABAP Documentation&body=Document: itab - Optimizing the WHERE Condition, ABENITAB_WHERE_OPTIMIZATION, 757%0D%0A%0D%0AEr
ror:%0D%0A%0D%0A%0D%0A%0D%0ASuggestion for improvement:)

itab - Optimizing the WHERE Condition

The statements [LOOP AT](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abaploop_at_itab.htm), [DELETE](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abapdelete_itab.htm), and [MODIFY](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abapmodify_itab.htm) can be specified together with a WHERE condition that selects specific lines of the internal table. Searches in a [standard table](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abenstandard_table_glosry.htm "Glossary Entry") using the [primary table key](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abenprimary_table_key_glosry.htm "Glossary Entry") are always linear and cannot be optimized. Searches using a [sorted key](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abensorted_key_glosry.htm "Glossary Entry") or a [hash key](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abenhash_key_glosry.htm "Glossary Entry"), however, can be optimized in certain circumstances. These keys are used for:

-   accessing a [sorted table](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abensorted_table_glosry.htm "Glossary Entry") using its primary key.
-   accessing a [hashed table](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abenhashed_table_glosry.htm "Glossary Entry") using its primary key.
-   accessing a table of any table type using a [secondary table key](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abensecondary_table_key_glosry.htm "Glossary Entry") specified by USING KEY.

The optimization takes place by mapping all [relational expressions](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abenrelational_expression_glosry.htm "Glossary Entry") or a group of the relational expressions in the WHERE condition to a specified key. This specified key performs a corresponding optimized key access (binary search or hash algorithm as in the statement [READ TABLE](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abapread_table.htm) or a [table expression](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abentable_expressions.htm)), to find one or more lines. The found line or lines are then checked using those remaining relational expressions from the WHERE condition that were not mapped to the specified key.

Prerequisites for the optimization are therefore:

-   The relational expressions of the WHERE condition can be transformed to a specified key.
-   The corresponding key access returns the same results as the evaluation of this part of the logical expression would. This is guaranteed only for compatible data types, since in the case of incompatible data types:
    -   the content of the specified data objects is converted to the data type of the columns before the evaluation in the case of key accesses.
    -   The [comparison rules](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abenlogexp_rules.htm) for incompatible data types apply when evaluating a [comparison expression](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abencomparison_expression_glosry.htm "Glossary Entry"). Here, all the data types involved play a part in determining which operand is converted into which comparison type.

If there are no or insufficient relational expressions to meet both of these prerequisites, no optimization is possible and the behavior is as follows:

-   If a sorted table or a hashed table is accessed using the primary table key, all lines of the internal table are checked as in a standard table.
-   If the table is read using a secondary table key, that is, if said key is specified after USING KEY, a syntax error or syntax check warning, or an exception is raised. Access using a secondary table key must always be executed in an optimized way.

The following sections describe exactly when an access can be optimized.

-   [Prerequisites for the Optimization of Hash Keys](#abenitab-where-optimization-1-------prerequisites-for-the-optimization-of-sorted-keys---@ITOC@@ABENITAB_WHERE_OPTIMIZATION_2)
-   [Requirements Made on the Operands](#@@ITOC@@ABENITAB_WHERE_OPTIMIZATION_3)

Hint

If the lines selected using WHERE are modified or deleted using [MODIFY](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abapmodify_itab.htm) or [DELETE](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abapdelete_itab.htm) and not just read using [LOOP AT](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abaploop_at_itab.htm), further update costs are incurred in addition to the search for the lines. When deleting lines from standard tables, it should be noted that searches using a secondary key optimize the selection of lines to be deleted, but not the update required for the primary key, which is usually performed using a linear search.

Prerequisites for the Optimization of Hash Keys   

In the case of [hash key](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abenhash_key_glosry.htm "Glossary Entry") accesses, there must be exactly one relational expression combined using AND for each component of the key. This expression is either

-   a [comparison expression](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abencomparison_expression_glosry.htm "Glossary Entry") with the comparison operator \= (or EQ), whose operands meet the requirements above or
-   a [predicate expression](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abenpredicate_expression_glosry.htm "Glossary Entry") IS INITIAL without the addition NOT.

These relational expressions construct the part of the logical expression used for the key access. This part must not contain duplicate key components. The remainder of the logical expression can contain any number of relational expressions combined using AND. Optimization may not be possible, however, if the Boolean operators NOT or OR are used. Key components may be used in the relational expressions not used for the key access.

Hint

Relational expressions other than comparisons using \= (or EQ) or predicate expressions IS INITIAL are not part of the key access. This applies particularly to the tabular comparison operator [IN range\_tab](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abenlogexp_select_option.htm), even if it can be traced back to optimizable comparisons.

Example

In the following example, the first two WHERE conditions can be optimized as key accesses with the secondary table key key. This is because:

1.  The optimizable conditions for b, d, and e cover the entire key.
2.  The optimizable conditions b, d, and e cover the entire key and a is a condition on a non-key column that is not involved in the part of the WHERE condition required for the optimization.
3.  The optimizable conditions b, d, and e cover the entire key and the other two conditions on the key columns b and d are not optimizable and are hence not involved in the part of the WHERE condition required for the optimization.

The next six WHERE conditions cannot be optimized and produce syntax errors. This is because:

1.  The key component d is not specified.
2.  A key component is combined using OR instead of AND.
3.  Two non-optimizable comparison operators are used.
4.  An operand of type i is used in the comparison b of type c, which does not meet the requirements made on the operands.
5.  The Boolean operator NOT is used in front of a key component.
6.  A further comparison is combined using OR.
7.  A further comparison is negated using NOT.
    
    DATA: BEGIN OF line,
            a TYPE c LENGTH 3,
            b TYPE c LENGTH 3,
            c TYPE c LENGTH 3,
            d TYPE c LENGTH 3,
            e TYPE c LENGTH 3,
            f TYPE c LENGTH 3,
          END OF line.
    DATA itab LIKE STANDARD TABLE OF line
                   WITH UNIQUE HASHED KEY key COMPONENTS b e d.
    DATA b\_tab LIKE RANGE OF line-b.
    LOOP AT itab INTO line USING KEY key
         WHERE b = '...' AND d = '...' AND e IS INITIAL.
    ENDLOOP.
    LOOP AT itab INTO line USING KEY key
         WHERE a = '...' AND b = '...' AND d = '...' AND e IS INITIAL.
    ENDLOOP.
    LOOP AT itab INTO line USING KEY key
         WHERE  b = '...' AND d = '...' AND e IS INITIAL AND
                b IN b\_tab AND d <> '...'.
    ENDLOOP.
    LOOP AT itab INTO line USING KEY key
         WHERE b = '...' AND e IS INITIAL.                     "syntax error
    ENDLOOP.
    LOOP AT itab INTO line USING KEY key
         WHERE b = '...' OR d = '...' AND e IS INITIAL OR      "syntax error
    ENDLOOP.
    LOOP AT itab INTO line USING KEY key
         WHERE b = '...' AND d <> '...' AND e IS NOT INITIAL.  "syntax error
    ENDLOOP.
    LOOP AT itab INTO line USING KEY key
         WHERE b = 333 AND d = '...' AND e IS INITIAL.         "syntax error
    ENDLOOP.
    LOOP AT itab INTO line USING KEY key
         WHERE b = '...'  AND NOT d = '...' AND e IS INITIAL.  "syntax error
    ENDLOOP.
    LOOP AT itab INTO line USING KEY key
         WHERE b = '...' AND d = '...' AND e IS INITIAL OR     "syntax error
               a = '...'.
    ENDLOOP.
    LOOP AT itab INTO line USING KEY key
         WHERE b = '...' AND d = '...' AND e IS INITIAL AND    "syntax error
               NOT a = '...'.
    ENDLOOP.
    

Prerequisites for the Optimization of Sorted Keys   

In the case of reads using a [sorted key](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abensorted_key_glosry.htm "Glossary Entry"), the same applies as to a hash key. The only difference is that only an initial section of the key consisting of at least one component needs to be covered rather than the entire key.

The internal table is accessed in part sequentially. The starting point for the processing of the table is determined by a binary search using the subconditions that cover the table key completely or partially. From the starting point onwards, the table is only processed for as long as these subconditions remain fulfilled.

Example

In the following example, the first five WHERE conditions can be optimized as key accesses with the secondary table key key. This is because:

1.  b is an initial part of the key.
2.  b is an initial part of the key and a is an independent condition.
3.  b and e are an initial part of the key.
4.  b, e, and d are an initial part of the key and the order in the WHERE condition is ignored.
5.  b is an initial part of the key and in this case, d is an independent condition, even though it is part of the key.

The next five WHERE conditions cannot be optimized and produce syntax errors. This is because:

1.  e is not an initial part of the key.
2.  No inequality comparison takes place.
3.  A comparison in a ranges table is specified.
4.  The Boolean operator NOT is used.
5.  An additional OR relationship is used.
    
    DATA: BEGIN OF line,
            a TYPE c LENGTH 3,
            b TYPE c LENGTH 3,
            c TYPE c LENGTH 3,
            d TYPE c LENGTH 3,
            e TYPE c LENGTH 3,
            f TYPE c LENGTH 3,
          END OF line.
    DATA itab LIKE STANDARD TABLE OF line
                   WITH UNIQUE SORTED KEY key COMPONENTS b e d.
    DATA b\_tab LIKE RANGE OF line-b.
    LOOP AT itab INTO line USING KEY key
                 WHERE b = '...'.
    ENDLOOP.
    LOOP AT itab INTO line USING KEY key
                 WHERE a = '...' AND b IS INITIAL.
    ENDLOOP.
    LOOP AT itab INTO line USING KEY key
                 WHERE b = '...' AND e = '...'.
    ENDLOOP.
    LOOP AT itab INTO line USING KEY key
                 WHERE b = '...' AND d IS INITIAL AND e = '...'.
    ENDLOOP.
    LOOP AT itab INTO line USING KEY key
                 WHERE b = '...' AND d <> '...'.
    ENDLOOP.
    LOOP AT itab INTO line USING KEY key
                 WHERE e = '...'.                    "syntax error
    ENDLOOP.
    LOOP AT itab INTO line USING KEY key
                 WHERE b <> '...'.                   "syntax error
    ENDLOOP.
    LOOP AT itab INTO line USING KEY key
                 WHERE b IN b\_tab.                   "syntax error
    ENDLOOP.
    LOOP AT itab INTO line USING KEY key
                 WHERE b = '...'  AND NOT e = '...'. "syntax error
    ENDLOOP.
    LOOP AT itab INTO line USING KEY key             "syntax error
                 WHERE b = '...'  AND ( d = '...' OR e IS INITIAL ).
    ENDLOOP.
    

Requirements Made on the Operands   

The part of the logical expression that can be mapped to a key access must select the same lines as a statement [READ TABLE](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abapread_table.htm) or a corresponding [table expression](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abentable_expressions.htm) that specifies the corresponding components as keys.

-   When comparing incompatible data objects, the WHERE condition is subject to the same [comparison rules](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abenlogexp_rules.htm) for incompatible data types. Here, the data types involved determine which operand is converted to which comparison type.
-   If the additions [WITH TABLE KEY](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abapread_table_key.htm) and [WITH KEY](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abapread_table_free.htm) of the statement READ or [KEY](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abentable_exp_itab_line.htm) in a table expression are used, however, the content of the specified data objects is always converted to the data type of the columns before the comparison.

If this produces differing results, an optimization is not possible. Due to the complexity of the comparison rules, particularly for [elementary data types](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abenlogexp_rules_operands.htm), it is not a good idea to construct a set of rules detailing exactly when the comparison type matches the data type of the left operand. Generally speaking,

-   only fully compatible operands are optimizable,
-   in some cases, elementary operands with different data types can be optimized, if the value ranges or lengths are suitable. For example, a comparison of a column with the type of a floating point number with an operand of type integer or of a column of c with a similar operand, if its length is less than the length of the column.

For this reason, it is advisable to use only pairs of [compatible](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abencompatible_glosry.htm "Glossary Entry") operands in the WHERE condition. This guarantees that the differences in behavior of the WHERE condition and the specified key do not affect the result.

Example

The following example is largely similar to the example in the section WHERE log\_exp in [LOOP AT itab](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abaploop_at_itab_cond.htm). In that case, access takes place using the primary key and no optimization. Here, however, access takes place using a secondary table key and a syntax check warning is produced and an exception raised when the program is executed. The number of lines in the internal table determines whether the exception is raised.

DATA text\_short TYPE c LENGTH 2.
DATA text\_long  TYPE c LENGTH 4.
DATA itab LIKE TABLE OF text\_short
          WITH UNIQUE HASHED KEY key COMPONENTS table\_line.
itab = VALUE #( ( 'AA' )
                ( 'BB' )
                ( 'CC' )
                ( 'DD' )
                ( 'EE' )
                ( 'FF' )
                ( 'GG' )
                ( 'HH' )
                ( 'II' )
                ( 'JJ' )
                ( 'KK' )
                ( 'LL' )
                ( 'MM' ) ).
text\_short = 'AA'.
text\_long  = 'AAXX'.
LOOP AT itab INTO text\_short USING KEY key
             WHERE table\_line = text\_long.
ENDLOOP.
cl\_demo\_output=>write( |LOOP: { sy-subrc }| ).
"Statement
READ TABLE itab INTO text\_short WITH TABLE KEY key
                                COMPONENTS table\_line = text\_long.
cl\_demo\_output=>write( |READ: { sy-subrc }| ).
"Expression
TRY.
    text\_short = itab\[ KEY key COMPONENTS table\_line = text\_long \].
  catch CX\_SY\_ITAB\_LINE\_NOT\_FOUND.
    ...
ENDTRY.
cl\_demo\_output=>display( |Expression: { text\_short }| ).


---


## ABAP - Keyword Documentation / ABAP - Programming Language / Processing Internal Data / Internal Tables (itab) / itab - Expressions and Functions / FOR, Table Iterations / itab - Examples of Grouping with FOR

**Files**: 11 | **Difficulty**: intermediate

# ABAP - Keyword Documentation / ABAP - Programming Language / Processing Internal Data / Internal Tables (itab) / itab - Performance Notes

Included pages: 2


### abenitab_perfo.htm

---
title: "Table Sharing"
description: |
  When assignments are made between internal tables of the same type whose line type does not contain any table types, only the internal administration functions are passed to the table body(https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abentable_body_glosry.htm 'Glossary Entry') for pe
version: "7.57"
category: "data-structures"
type: "abap-reference"
sourceUrl: "https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abenitab_perfo.htm"
abapFile: "abenitab_perfo.htm"
keywords: ["select", "insert", "update", "delete", "loop", "do", "if", "case", "try", "data", "types", "internal-table", "abenitab", "perfo"]
---

* * *

AS ABAP Release 757, ©Copyright 2023 SAP SE. All rights reserved.

[ABAP - Keyword Documentation](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abenabap.htm) →  [ABAP - Programming Language](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abenabap_reference.htm) →  [Processing Internal Data](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abenabap_data_working.htm) →  [Internal Tables (itab)](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abenitab.htm) → 

 [![](Mail.gif?object=Mail.gif&sap-language=EN "Feedback mail for displayed topic") Mail Feedback](mailto:f1_help@sap.com?subject=Feedback on ABAP Documentation&body=Document: itab - Performance Notes, ABENITAB_PERFO, 757%0D%0A%0D%0AError:%0D%0A%0D%0A%0D%0A%0D%
0ASuggestion for improvement:)

itab - Performance Notes

-   [Table Sharing](#abenitab-perfo-1-------initial-memory-requirement---@ITOC@@ABENITAB_PERFO_2)
-   [Index Administration](#abenitab-perfo-3-------block-processing-of-table-lines---@ITOC@@ABENITAB_PERFO_4)
-   [Selective Data Transport](#abenitab-perfo-5-------using-secondary-keys---@ITOC@@ABENITAB_PERFO_6)
-   [Deleting Table Lines](#abenitab-perfo-7-------free-key-specified-for-sorted-tables-and-hashed-tables---@ITOC@@ABENITAB_PERFO_8)
-   [Sorting](#abenitab-perfo-9---table-sharing-----when-assignments-are-made-between-internal-tables-of-the-same-type-whose-line-type-does-not-contain-any-table-types--only-the-internal-administration-functions-are-passed-to-the--table-body--https---help-sap-com-doc-abapdocu-757-index-htm-7-57-en-us-abentable-body-glosry-htm--glossary-entry---for-performance-reasons---table-sharing--https---help-sap-com-doc-abapdocu-757-index-htm-7-57-en-us-abentable-sharing-glosry-htm--glossary-entry---is-revoked-only-when-write-access-to-one-of-the-tables-involved-is-initiated--the-actual-copy-process-then-takes-place---initial-memory-requirement-----internal-tables-are--dynamic-data-objects--https---help-sap-com-doc-abapdocu-757-index-htm-7-57-en-us-abendynamic-data-object-glosry-htm--glossary-entry---whose-area-in-the-memory-is-extended-block-by-block--the-size-of-the-first-block-in-the-memory-is-called--initial-memory-requirement--https---help-sap-com-doc-abapdocu-757-index-htm-7-57-en-us-abeninitial-mem-req-glosry-htm--glossary-entry---and-can-be-affected-in-the-declaration-of-an-internal-table-using-the-additions--initial-size--https---help-sap-com-doc-abapdocu-757-index-htm-7-57-en-us-abaptypes-itab-htm--and-the-obsolete--occurs--https---help-sap-com-doc-abapdocu-757-index-htm-7-57-en-us-abapdata-occurs-htm----it-is-usually-up-to-the-system-to-determine-the-size-of-the-first-block--initial-size-is-not-used-or-specified-with-the-value-0--in-this-case--a-suitable-block-size-is-chosen-the-first-time-lines-are-added-to-an-internal-table---specifying-a-concrete-value-greater-than-0-after-initial-size-is-only-practical-if-it-is-known-in-advance-how-many-entries-are-to-be-made-in-the-table--and-the-first-block-is-therefore-to-be-created-with-the-most-suitable-dimensions--this-can-be-particularly-important-for-internal-tables-that-are-components-of-other-internal-tables--and-which-only-contain-a-few-lines--no-more-than-around-5----to-avoid-excessive-memory-demands--the-system-ignores-values-that-produce-memory-demands-greater-than-the-constant-block-size---index-administration-----in-an--index-table--https---help-sap-com-doc-abapdocu-757-index-htm-7-57-en-us-abenindex-table-glosry-htm--glossary-entry----the-logical-order-of-the-table-entries-is-not-generally-consistent-with-the-physical-order-of-the-entries-in-the-main-memory--in-this-case--the-logical-order-is-no-longer-administrated-by-a-physical-index--but-by-a-logical-index--the-same-basically-applies-to-the--secondary-table-indexes--https---help-sap-com-doc-abapdocu-757-index-htm-7-57-en-us-abensecondary-table-index-glosry-htm--glossary-entry---used-to-manage--secondary--https---help-sap-com-doc-abapdocu-757-index-htm-7-57-en-us-abensecondary-table-key-glosry-htm--glossary-entry----sorted-keys--https---help-sap-com-doc-abapdocu-757-index-htm-7-57-en-us-abensorted-key-glosry-htm--glossary-entry-----use-of-the-logical-index-produces-additional-memory-requirements--and-index-maintenance-places-a-high-demand-on-resources--time-and-memory--when-inserting-or-deleting-table-lines--the-resource-requirements-increase-proportionally-with-the-number-of-remaining-lines-after-the-insertion-or-deletion-position--for-very-large-internal-tables--this-can-result-in-considerable-demands-on-performance-at-runtime---the-logical-index-is-only-created-when-it-is-needed--that-is--when-a-line-is-inserted-in-front-of-another-line--if-the-order-of-the-table-lines-is-changed--or-a-line-other-than-the-last-line-is-deleted--a-logical-index-is-not-required-if-an-internal-table-is-filled-using-only--append--https---help-sap-com-doc-abapdocu-757-index-htm-7-57-en-us-abapappend-htm---and-if-only-its-last-line-or-lines-is-are-deleted-using--delete--https---help-sap-com-doc-abapdocu-757-index-htm-7-57-en-us-abapdelete-itab-htm----hint--in-contrast-to-filling-a-table-with--insert--https---help-sap-com-doc-abapdocu-757-index-htm-7-57-en-us-abapinsert-itab-htm---appending-lines-with--append--https---help-sap-com-doc-abapdocu-757-index-htm-7-57-en-us-abapappend-htm--does-not-require-any-resources-for-index-maintenance--it-is-therefore-preferable-to-use-append-instead-of-insert-to-create-a--standard-table--https---help-sap-com-doc-abapdocu-757-index-htm-7-57-en-us-abenstandard-table-glosry-htm--glossary-entry----this-is-possible-if-the-order-of-the-entries-is-not-important--or-if-entries-can-be-appended-in-the-correct-order---block-processing-of-table-lines-----if-entire-line-areas-of-a-table-can-be-processed-at-once--this-should-not-be-done-line-by-line--but-using-block-operations--block-operations-are-possible-using-the-from-and-to-additions-of-the-statements--insert--https---help-sap-com-doc-abapdocu-757-index-htm-7-57-en-us-abapinsert-itab-htm----append--https---help-sap-com-doc-abapdocu-757-index-htm-7-57-en-us-abapappend-htm--and--delete--https---help-sap-com-doc-abapdocu-757-index-htm-7-57-en-us-abapdelete-itab-htm---block-operations-are-also-more-efficient-than-single-record-operations-when-reading-from-or-modifying-database-tables-with--abap-sql--https---help-sap-com-doc-abapdocu-757-index-htm-7-57-en-us-abenabap-sql-glosry-htm--glossary-entry---statements-with-the-additions-from---appending---to-table---selective-data-transport-----if--when-reading-table-lines-using--read-table--https---help-sap-com-doc-abapdocu-757-index-htm-7-57-en-us-abapread-table-htm--or--loop-at--https---help-sap-com-doc-abapdocu-757-index-htm-7-57-en-us-abaploop-at-itab-htm---a-work-area-is-used-or-table-lines-can-be-changed-using--modify--https---help-sap-com-doc-abapdocu-757-index-htm-7-57-en-us-abapmodify-itab-htm--instead-of-direct-access--the-transporting-addition-can-be-used-to-prevent-unnecessary-assignments-of-table-components-to-the-work-area--this-can-lead-to-a-noticeable-improvement-in-performance--particularly-if-table-like-components-are-excluded-from-processing---using-secondary-keys-----the--use-of-secondary-table-keys--https---help-sap-com-doc-abapdocu-757-index-htm-7-57-en-us-abenitab-key-secondary-usage-htm--should-be-planned-and-executed-carefully-and-sparingly--the-time-gained-when-accessing-individual-lines-should-not-be-lost-again-by-the-increased-memory-and-time-requirements-for-managing-the-secondary-keys--secondary-keys-are-generally-recommended-for-internal-tables-that-are-filled-once-and-rarely-changed-during-program-execution---example--the-program-demo--secondary--keys-demonstrates-how-a-secondary-table-key-is-specified-and-the-resulting-performance-gain---deleting-table-lines-----when-lines-are-deleted-from-an-internal-table--administration-costs-are-incurred-for-all-table-keys-and-table-indexes--the-primary-key-and-all-unique-secondary-keys-are-updated-directly--but-non-unique-secondary-keys-are-updated-only-if-the-line-to-be-deleted-is-included-in-the-updated-part-of-an-associated-index---lazy-update--https---help-sap-com-doc-abapdocu-757-index-htm-7-57-en-us-abenlazy-update-glosry-htm--glossary-entry------it-should-be-noted-that--particularly-for-standard-tables--the-mean-runtime-of-the-statement--delete--https---help-sap-com-doc-abapdocu-757-index-htm-7-57-en-us-abapdelete-itab-htm--always-depends-linearly-on-the-number-of-table-lines--even-when-secondary-keys-are-specified-using--with-table-key--https---help-sap-com-doc-abapdocu-757-index-htm-7-57-en-us-abapdelete-itab-key-htm--or--using-key--https---help-sap-com-doc-abapdocu-757-index-htm-7-57-en-us-abapdelete-itab-key-htm---this-is-because-a-linear-search-is-required-to-update-the-primary-index--even-though-the-line-to-be-deleted-can-itself-be-found-quickly---deleting-lines-in-internal-tables-using--delete--https---help-sap-com-doc-abapdocu-757-index-htm-7-57-en-us-abapdelete-itab-htm--does-not-usually-release-any-memory-in-the-internal-table--statements-such-as--clear--https---help-sap-com-doc-abapdocu-757-index-htm-7-57-en-us-abapclear-htm--or--free--https---help-sap-com-doc-abapdocu-757-index-htm-7-57-en-us-abapfree-dataobject-htm--must-be-used-to-release-memory-in-internal-tables---free-key-specified-for-sorted-tables-and-hashed-tables-----when-using-the--read--https---help-sap-com-doc-abapdocu-757-index-htm-7-57-en-us-abapread-table-htm--statement-with-a-specified-free-key-of-the-form--with-key------https---help-sap-com-doc-abapdocu-757-index-htm-7-57-en-us-abapread-table-free-htm---the-search-is-optimized-in-all-cases-where-this-is-possible--that-is-------in--sorted-tables--https---help-sap-com-doc-abapdocu-757-index-htm-7-57-en-us-abensorted-table-glosry-htm--glossary-entry----if-any-initial-section-of-the--table-key--https---help-sap-com-doc-abapdocu-757-index-htm-7-57-en-us-abentable-key-glosry-htm--glossary-entry---or-the-complete-table-key-is-covered-by-the-specified-key------in--hashed-tables--https---help-sap-com-doc-abapdocu-757-index-htm-7-57-en-us-abenhashed-table-glosry-htm--glossary-entry----if-the-complete-table-key-is-covered---if-part-of-a-free-key-meets-these-conditions--this-partial-key-is-first-used-to-search-for-an-entry--in-sorted-tables--this-is-done-using-a-binary-search-with-a-logarithmic-consumption-of-resources--and-in-hashed-tables-using-a-hash-algorithm--that-is--with-constant-resource-consumption--if-an-entry-is-found--the-system-checks-whether-the-rest-of-the-key-conditions-are-also-met--this-means-that-over-specific-keys-in-particular-are-optimized---hint--see-also--optimization-of-the-where-condition--https---help-sap-com-doc-abapdocu-757-index-htm-7-57-en-us-abenitab-where-optimization-htm----sorting-----for-textual-sorting-of-an-internal-table-in-accordance-with-the-current--text-environment--https---help-sap-com-doc-abapdocu-757-index-htm-7-57-en-us-abentext-environment-glosry-htm--glossary-entry----it-can-be-more-efficient-to-use-the-statement--convert-text-into-sortable-code--https---help-sap-com-doc-abapdocu-757-index-htm-7-57-en-us-abapconvert-text-htm--instead-of--sort-as-text--https---help-sap-com-doc-abapdocu-757-index-htm-7-57-en-us-abapsort-itab-htm--in-the-following-cases-------if-an-internal-table-is-sorted-by-locale-and-then-searched-binarily-using-the-statement-read-table-or-using-a--table-expression--https---help-sap-com-doc-abapdocu-757-index-htm-7-57-en-us-abentable-expressions-htm-------an-internal-table-must-be-sorted-more-than-once------indexes-for-database-tables-should-be-structured-in-accordance-with-a-locale---continue--itab---optimizing-the-where-condition--https---help-sap-com-doc-abapdocu-757-index-htm-7-57-en-us-abenitab-where-optimization-htm--------abenitab-where-optimization-htm------title---hint--description------if-the-lines-selected-using-where-are-modified-or-deleted-using-modify-https---help-sap-com-doc-abapdocu-757-index-htm-7-57-en-us-abapmodify-itab-htm--or-delete-https---help-sap-com-doc-abapdocu-757-index-htm-7-57-en-us-abapdelete-itab-htm--and-not-just-read-using-loop-at-https---help-sap-com--version---7-57--category---general--type---abap-reference--sourceurl---https---help-sap-com-doc-abapdocu-757-index-htm-7-57-en-us-abenitab-where-optimization-htm--abapfile---abenitab-where-optimization-htm--keywords----select----update----delete----loop----do----if----case----try----catch----data----types----internal-table----abenitab----where----optimization---------------as-abap-release-757---copyright-2023-sap-se--all-rights-reserved----abap---keyword-documentation--https---help-sap-com-doc-abapdocu-757-index-htm-7-57-en-us-abenabap-htm------abap---programming-language--https---help-sap-com-doc-abapdocu-757-index-htm-7-57-en-us-abenabap-reference-htm------processing-internal-data--https---help-sap-com-doc-abapdocu-757-index-htm-7-57-en-us-abenabap-data-working-htm------internal-tables--itab---https---help-sap-com-doc-abapdocu-757-index-htm-7-57-en-us-abenitab-htm------itab---performance-notes--https---help-sap-com-doc-abapdocu-757-index-htm-7-57-en-us-abenitab-perfo-htm------------mail-gif-object-mail-gif-sap-language-en--feedback-mail-for-displayed-topic---mail-feedback--mailto-f1-helpsap.com?subject=Feedback on ABAP Documentation&body=Document: itab - Optimizing the WHERE Condition, ABENITAB_WHERE_OPTIMIZATION, 757%0D%0A%0D%0AEr
ror:%0D%0A%0D%0A%0D%0A%0D%0ASuggestion for improvement:)

itab - Optimizing the WHERE Condition

The statements [LOOP AT](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abaploop_at_itab.htm), [DELETE](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abapdelete_itab.htm), and [MODIFY](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abapmodify_itab.htm) can be specified together with a WHERE condition that selects specific lines of the internal table. Searches in a [standard table](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abenstandard_table_glosry.htm "Glossary Entry") using the [primary table key](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abenprimary_table_key_glosry.htm "Glossary Entry") are always linear and cannot be optimized. Searches using a [sorted key](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abensorted_key_glosry.htm "Glossary Entry") or a [hash key](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abenhash_key_glosry.htm "Glossary Entry"), however, can be optimized in certain circumstances. These keys are used for:

-   accessing a [sorted table](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abensorted_table_glosry.htm "Glossary Entry") using its primary key.
-   accessing a [hashed table](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abenhashed_table_glosry.htm "Glossary Entry") using its primary key.
-   accessing a table of any table type using a [secondary table key](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abensecondary_table_key_glosry.htm "Glossary Entry") specified by USING KEY.

The optimization takes place by mapping all [relational expressions](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abenrelational_expression_glosry.htm "Glossary Entry") or a group of the relational expressions in the WHERE condition to a specified key. This specified key performs a corresponding optimized key access (binary search or hash algorithm as in the statement [READ TABLE](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abapread_table.htm) or a [table expression](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abentable_expressions.htm)), to find one or more lines. The found line or lines are then checked using those remaining relational expressions from the WHERE condition that were not mapped to the specified key.

Prerequisites for the optimization are therefore:

-   The relational expressions of the WHERE condition can be transformed to a specified key.
-   The corresponding key access returns the same results as the evaluation of this part of the logical expression would. This is guaranteed only for compatible data types, since in the case of incompatible data types:
    -   the content of the specified data objects is converted to the data type of the columns before the evaluation in the case of key accesses.
    -   The [comparison rules](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abenlogexp_rules.htm) for incompatible data types apply when evaluating a [comparison expression](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abencomparison_expression_glosry.htm "Glossary Entry"). Here, all the data types involved play a part in determining which operand is converted into which comparison type.

If there are no or insufficient relational expressions to meet both of these prerequisites, no optimization is possible and the behavior is as follows:

-   If a sorted table or a hashed table is accessed using the primary table key, all lines of the internal table are checked as in a standard table.
-   If the table is read using a secondary table key, that is, if said key is specified after USING KEY, a syntax error or syntax check warning, or an exception is raised. Access using a secondary table key must always be executed in an optimized way.

The following sections describe exactly when an access can be optimized.

-   [Prerequisites for the Optimization of Hash Keys](#abenitab-where-optimization-1-------prerequisites-for-the-optimization-of-sorted-keys---@ITOC@@ABENITAB_WHERE_OPTIMIZATION_2)
-   [Requirements Made on the Operands](#@@ITOC@@ABENITAB_WHERE_OPTIMIZATION_3)

Hint

If the lines selected using WHERE are modified or deleted using [MODIFY](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abapmodify_itab.htm) or [DELETE](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abapdelete_itab.htm) and not just read using [LOOP AT](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abaploop_at_itab.htm), further update costs are incurred in addition to the search for the lines. When deleting lines from standard tables, it should be noted that searches using a secondary key optimize the selection of lines to be deleted, but not the update required for the primary key, which is usually performed using a linear search.

Prerequisites for the Optimization of Hash Keys   

In the case of [hash key](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abenhash_key_glosry.htm "Glossary Entry") accesses, there must be exactly one relational expression combined using AND for each component of the key. This expression is either

-   a [comparison expression](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abencomparison_expression_glosry.htm "Glossary Entry") with the comparison operator \= (or EQ), whose operands meet the requirements above or
-   a [predicate expression](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abenpredicate_expression_glosry.htm "Glossary Entry") IS INITIAL without the addition NOT.

These relational expressions construct the part of the logical expression used for the key access. This part must not contain duplicate key components. The remainder of the logical expression can contain any number of relational expressions combined using AND. Optimization may not be possible, however, if the Boolean operators NOT or OR are used. Key components may be used in the relational expressions not used for the key access.

Hint

Relational expressions other than comparisons using \= (or EQ) or predicate expressions IS INITIAL are not part of the key access. This applies particularly to the tabular comparison operator [IN range\_tab](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abenlogexp_select_option.htm), even if it can be traced back to optimizable comparisons.

Example

In the following example, the first two WHERE conditions can be optimized as key accesses with the secondary table key key. This is because:

1.  The optimizable conditions for b, d, and e cover the entire key.
2.  The optimizable conditions b, d, and e cover the entire key and a is a condition on a non-key column that is not involved in the part of the WHERE condition required for the optimization.
3.  The optimizable conditions b, d, and e cover the entire key and the other two conditions on the key columns b and d are not optimizable and are hence not involved in the part of the WHERE condition required for the optimization.

The next six WHERE conditions cannot be optimized and produce syntax errors. This is because:

1.  The key component d is not specified.
2.  A key component is combined using OR instead of AND.
3.  Two non-optimizable comparison operators are used.
4.  An operand of type i is used in the comparison b of type c, which does not meet the requirements made on the operands.
5.  The Boolean operator NOT is used in front of a key component.
6.  A further comparison is combined using OR.
7.  A further comparison is negated using NOT.
    
    DATA: BEGIN OF line,
            a TYPE c LENGTH 3,
            b TYPE c LENGTH 3,
            c TYPE c LENGTH 3,
            d TYPE c LENGTH 3,
            e TYPE c LENGTH 3,
            f TYPE c LENGTH 3,
          END OF line.
    DATA itab LIKE STANDARD TABLE OF line
                   WITH UNIQUE HASHED KEY key COMPONENTS b e d.
    DATA b\_tab LIKE RANGE OF line-b.
    LOOP AT itab INTO line USING KEY key
         WHERE b = '...' AND d = '...' AND e IS INITIAL.
    ENDLOOP.
    LOOP AT itab INTO line USING KEY key
         WHERE a = '...' AND b = '...' AND d = '...' AND e IS INITIAL.
    ENDLOOP.
    LOOP AT itab INTO line USING KEY key
         WHERE  b = '...' AND d = '...' AND e IS INITIAL AND
                b IN b\_tab AND d <> '...'.
    ENDLOOP.
    LOOP AT itab INTO line USING KEY key
         WHERE b = '...' AND e IS INITIAL.                     "syntax error
    ENDLOOP.
    LOOP AT itab INTO line USING KEY key
         WHERE b = '...' OR d = '...' AND e IS INITIAL OR      "syntax error
    ENDLOOP.
    LOOP AT itab INTO line USING KEY key
         WHERE b = '...' AND d <> '...' AND e IS NOT INITIAL.  "syntax error
    ENDLOOP.
    LOOP AT itab INTO line USING KEY key
         WHERE b = 333 AND d = '...' AND e IS INITIAL.         "syntax error
    ENDLOOP.
    LOOP AT itab INTO line USING KEY key
         WHERE b = '...'  AND NOT d = '...' AND e IS INITIAL.  "syntax error
    ENDLOOP.
    LOOP AT itab INTO line USING KEY key
         WHERE b = '...' AND d = '...' AND e IS INITIAL OR     "syntax error
               a = '...'.
    ENDLOOP.
    LOOP AT itab INTO line USING KEY key
         WHERE b = '...' AND d = '...' AND e IS INITIAL AND    "syntax error
               NOT a = '...'.
    ENDLOOP.
    

Prerequisites for the Optimization of Sorted Keys   

In the case of reads using a [sorted key](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abensorted_key_glosry.htm "Glossary Entry"), the same applies as to a hash key. The only difference is that only an initial section of the key consisting of at least one component needs to be covered rather than the entire key.

The internal table is accessed in part sequentially. The starting point for the processing of the table is determined by a binary search using the subconditions that cover the table key completely or partially. From the starting point onwards, the table is only processed for as long as these subconditions remain fulfilled.

Example

In the following example, the first five WHERE conditions can be optimized as key accesses with the secondary table key key. This is because:

1.  b is an initial part of the key.
2.  b is an initial part of the key and a is an independent condition.
3.  b and e are an initial part of the key.
4.  b, e, and d are an initial part of the key and the order in the WHERE condition is ignored.
5.  b is an initial part of the key and in this case, d is an independent condition, even though it is part of the key.

The next five WHERE conditions cannot be optimized and produce syntax errors. This is because:

1.  e is not an initial part of the key.
2.  No inequality comparison takes place.
3.  A comparison in a ranges table is specified.
4.  The Boolean operator NOT is used.
5.  An additional OR relationship is used.
    
    DATA: BEGIN OF line,
            a TYPE c LENGTH 3,
            b TYPE c LENGTH 3,
            c TYPE c LENGTH 3,
            d TYPE c LENGTH 3,
            e TYPE c LENGTH 3,
            f TYPE c LENGTH 3,
          END OF line.
    DATA itab LIKE STANDARD TABLE OF line
                   WITH UNIQUE SORTED KEY key COMPONENTS b e d.
    DATA b\_tab LIKE RANGE OF line-b.
    LOOP AT itab INTO line USING KEY key
                 WHERE b = '...'.
    ENDLOOP.
    LOOP AT itab INTO line USING KEY key
                 WHERE a = '...' AND b IS INITIAL.
    ENDLOOP.
    LOOP AT itab INTO line USING KEY key
                 WHERE b = '...' AND e = '...'.
    ENDLOOP.
    LOOP AT itab INTO line USING KEY key
                 WHERE b = '...' AND d IS INITIAL AND e = '...'.
    ENDLOOP.
    LOOP AT itab INTO line USING KEY key
                 WHERE b = '...' AND d <> '...'.
    ENDLOOP.
    LOOP AT itab INTO line USING KEY key
                 WHERE e = '...'.                    "syntax error
    ENDLOOP.
    LOOP AT itab INTO line USING KEY key
                 WHERE b <> '...'.                   "syntax error
    ENDLOOP.
    LOOP AT itab INTO line USING KEY key
                 WHERE b IN b\_tab.                   "syntax error
    ENDLOOP.
    LOOP AT itab INTO line USING KEY key
                 WHERE b = '...'  AND NOT e = '...'. "syntax error
    ENDLOOP.
    LOOP AT itab INTO line USING KEY key             "syntax error
                 WHERE b = '...'  AND ( d = '...' OR e IS INITIAL ).
    ENDLOOP.
    

Requirements Made on the Operands   

The part of the logical expression that can be mapped to a key access must select the same lines as a statement [READ TABLE](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abapread_table.htm) or a corresponding [table expression](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abentable_expressions.htm) that specifies the corresponding components as keys.

-   When comparing incompatible data objects, the WHERE condition is subject to the same [comparison rules](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abenlogexp_rules.htm) for incompatible data types. Here, the data types involved determine which operand is converted to which comparison type.
-   If the additions [WITH TABLE KEY](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abapread_table_key.htm) and [WITH KEY](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abapread_table_free.htm) of the statement READ or [KEY](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abentable_exp_itab_line.htm) in a table expression are used, however, the content of the specified data objects is always converted to the data type of the columns before the comparison.

If this produces differing results, an optimization is not possible. Due to the complexity of the comparison rules, particularly for [elementary data types](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abenlogexp_rules_operands.htm), it is not a good idea to construct a set of rules detailing exactly when the comparison type matches the data type of the left operand. Generally speaking,

-   only fully compatible operands are optimizable,
-   in some cases, elementary operands with different data types can be optimized, if the value ranges or lengths are suitable. For example, a comparison of a column with the type of a floating point number with an operand of type integer or of a column of c with a similar operand, if its length is less than the length of the column.

For this reason, it is advisable to use only pairs of [compatible](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abencompatible_glosry.htm "Glossary Entry") operands in the WHERE condition. This guarantees that the differences in behavior of the WHERE condition and the specified key do not affect the result.

Example

The following example is largely similar to the example in the section WHERE log\_exp in [LOOP AT itab](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abaploop_at_itab_cond.htm). In that case, access takes place using the primary key and no optimization. Here, however, access takes place using a secondary table key and a syntax check warning is produced and an exception raised when the program is executed. The number of lines in the internal table determines whether the exception is raised.

DATA text\_short TYPE c LENGTH 2.
DATA text\_long  TYPE c LENGTH 4.
DATA itab LIKE TABLE OF text\_short
          WITH UNIQUE HASHED KEY key COMPONENTS table\_line.
itab = VALUE #( ( 'AA' )
                ( 'BB' )
                ( 'CC' )
                ( 'DD' )
                ( 'EE' )
                ( 'FF' )
                ( 'GG' )
                ( 'HH' )
                ( 'II' )
                ( 'JJ' )
                ( 'KK' )
                ( 'LL' )
                ( 'MM' ) ).
text\_short = 'AA'.
text\_long  = 'AAXX'.
LOOP AT itab INTO text\_short USING KEY key
             WHERE table\_line = text\_long.
ENDLOOP.
cl\_demo\_output=>write( |LOOP: { sy-subrc }| ).
"Statement
READ TABLE itab INTO text\_short WITH TABLE KEY key
                                COMPONENTS table\_line = text\_long.
cl\_demo\_output=>write( |READ: { sy-subrc }| ).
"Expression
TRY.
    text\_short = itab\[ KEY key COMPONENTS table\_line = text\_long \].
  catch CX\_SY\_ITAB\_LINE\_NOT\_FOUND.
    ...
ENDTRY.
cl\_demo\_output=>display( |Expression: { text\_short }| ).


---


## ABAP - Keyword Documentation / ABAP - Programming Language / Processing Internal Data / Internal Tables (itab) / itab - Expressions and Functions / FILTER, Filter Operator

**Files**: 8 | **Difficulty**: intermediate

# ABAP - Keyword Documentation / ABAP - Programming Language / Processing Internal Data / Internal Tables (itab) / itab - Performance Notes

Included pages: 2


### abenitab_perfo.htm

---
title: "Table Sharing"
description: |
  When assignments are made between internal tables of the same type whose line type does not contain any table types, only the internal administration functions are passed to the table body(https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abentable_body_glosry.htm 'Glossary Entry') for pe
version: "7.57"
category: "data-structures"
type: "abap-reference"
sourceUrl: "https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abenitab_perfo.htm"
abapFile: "abenitab_perfo.htm"
keywords: ["select", "insert", "update", "delete", "loop", "do", "if", "case", "try", "data", "types", "internal-table", "abenitab", "perfo"]
---

* * *

AS ABAP Release 757, ©Copyright 2023 SAP SE. All rights reserved.

[ABAP - Keyword Documentation](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abenabap.htm) →  [ABAP - Programming Language](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abenabap_reference.htm) →  [Processing Internal Data](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abenabap_data_working.htm) →  [Internal Tables (itab)](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abenitab.htm) → 

 [![](Mail.gif?object=Mail.gif&sap-language=EN "Feedback mail for displayed topic") Mail Feedback](mailto:f1_help@sap.com?subject=Feedback on ABAP Documentation&body=Document: itab - Performance Notes, ABENITAB_PERFO, 757%0D%0A%0D%0AError:%0D%0A%0D%0A%0D%0A%0D%
0ASuggestion for improvement:)

itab - Performance Notes

-   [Table Sharing](#abenitab-perfo-1-------initial-memory-requirement---@ITOC@@ABENITAB_PERFO_2)
-   [Index Administration](#abenitab-perfo-3-------block-processing-of-table-lines---@ITOC@@ABENITAB_PERFO_4)
-   [Selective Data Transport](#abenitab-perfo-5-------using-secondary-keys---@ITOC@@ABENITAB_PERFO_6)
-   [Deleting Table Lines](#abenitab-perfo-7-------free-key-specified-for-sorted-tables-and-hashed-tables---@ITOC@@ABENITAB_PERFO_8)
-   [Sorting](#abenitab-perfo-9---table-sharing-----when-assignments-are-made-between-internal-tables-of-the-same-type-whose-line-type-does-not-contain-any-table-types--only-the-internal-administration-functions-are-passed-to-the--table-body--https---help-sap-com-doc-abapdocu-757-index-htm-7-57-en-us-abentable-body-glosry-htm--glossary-entry---for-performance-reasons---table-sharing--https---help-sap-com-doc-abapdocu-757-index-htm-7-57-en-us-abentable-sharing-glosry-htm--glossary-entry---is-revoked-only-when-write-access-to-one-of-the-tables-involved-is-initiated--the-actual-copy-process-then-takes-place---initial-memory-requirement-----internal-tables-are--dynamic-data-objects--https---help-sap-com-doc-abapdocu-757-index-htm-7-57-en-us-abendynamic-data-object-glosry-htm--glossary-entry---whose-area-in-the-memory-is-extended-block-by-block--the-size-of-the-first-block-in-the-memory-is-called--initial-memory-requirement--https---help-sap-com-doc-abapdocu-757-index-htm-7-57-en-us-abeninitial-mem-req-glosry-htm--glossary-entry---and-can-be-affected-in-the-declaration-of-an-internal-table-using-the-additions--initial-size--https---help-sap-com-doc-abapdocu-757-index-htm-7-57-en-us-abaptypes-itab-htm--and-the-obsolete--occurs--https---help-sap-com-doc-abapdocu-757-index-htm-7-57-en-us-abapdata-occurs-htm----it-is-usually-up-to-the-system-to-determine-the-size-of-the-first-block--initial-size-is-not-used-or-specified-with-the-value-0--in-this-case--a-suitable-block-size-is-chosen-the-first-time-lines-are-added-to-an-internal-table---specifying-a-concrete-value-greater-than-0-after-initial-size-is-only-practical-if-it-is-known-in-advance-how-many-entries-are-to-be-made-in-the-table--and-the-first-block-is-therefore-to-be-created-with-the-most-suitable-dimensions--this-can-be-particularly-important-for-internal-tables-that-are-components-of-other-internal-tables--and-which-only-contain-a-few-lines--no-more-than-around-5----to-avoid-excessive-memory-demands--the-system-ignores-values-that-produce-memory-demands-greater-than-the-constant-block-size---index-administration-----in-an--index-table--https---help-sap-com-doc-abapdocu-757-index-htm-7-57-en-us-abenindex-table-glosry-htm--glossary-entry----the-logical-order-of-the-table-entries-is-not-generally-consistent-with-the-physical-order-of-the-entries-in-the-main-memory--in-this-case--the-logical-order-is-no-longer-administrated-by-a-physical-index--but-by-a-logical-index--the-same-basically-applies-to-the--secondary-table-indexes--https---help-sap-com-doc-abapdocu-757-index-htm-7-57-en-us-abensecondary-table-index-glosry-htm--glossary-entry---used-to-manage--secondary--https---help-sap-com-doc-abapdocu-757-index-htm-7-57-en-us-abensecondary-table-key-glosry-htm--glossary-entry----sorted-keys--https---help-sap-com-doc-abapdocu-757-index-htm-7-57-en-us-abensorted-key-glosry-htm--glossary-entry-----use-of-the-logical-index-produces-additional-memory-requirements--and-index-maintenance-places-a-high-demand-on-resources--time-and-memory--when-inserting-or-deleting-table-lines--the-resource-requirements-increase-proportionally-with-the-number-of-remaining-lines-after-the-insertion-or-deletion-position--for-very-large-internal-tables--this-can-result-in-considerable-demands-on-performance-at-runtime---the-logical-index-is-only-created-when-it-is-needed--that-is--when-a-line-is-inserted-in-front-of-another-line--if-the-order-of-the-table-lines-is-changed--or-a-line-other-than-the-last-line-is-deleted--a-logical-index-is-not-required-if-an-internal-table-is-filled-using-only--append--https---help-sap-com-doc-abapdocu-757-index-htm-7-57-en-us-abapappend-htm---and-if-only-its-last-line-or-lines-is-are-deleted-using--delete--https---help-sap-com-doc-abapdocu-757-index-htm-7-57-en-us-abapdelete-itab-htm----hint--in-contrast-to-filling-a-table-with--insert--https---help-sap-com-doc-abapdocu-757-index-htm-7-57-en-us-abapinsert-itab-htm---appending-lines-with--append--https---help-sap-com-doc-abapdocu-757-index-htm-7-57-en-us-abapappend-htm--does-not-require-any-resources-for-index-maintenance--it-is-therefore-preferable-to-use-append-instead-of-insert-to-create-a--standard-table--https---help-sap-com-doc-abapdocu-757-index-htm-7-57-en-us-abenstandard-table-glosry-htm--glossary-entry----this-is-possible-if-the-order-of-the-entries-is-not-important--or-if-entries-can-be-appended-in-the-correct-order---block-processing-of-table-lines-----if-entire-line-areas-of-a-table-can-be-processed-at-once--this-should-not-be-done-line-by-line--but-using-block-operations--block-operations-are-possible-using-the-from-and-to-additions-of-the-statements--insert--https---help-sap-com-doc-abapdocu-757-index-htm-7-57-en-us-abapinsert-itab-htm----append--https---help-sap-com-doc-abapdocu-757-index-htm-7-57-en-us-abapappend-htm--and--delete--https---help-sap-com-doc-abapdocu-757-index-htm-7-57-en-us-abapdelete-itab-htm---block-operations-are-also-more-efficient-than-single-record-operations-when-reading-from-or-modifying-database-tables-with--abap-sql--https---help-sap-com-doc-abapdocu-757-index-htm-7-57-en-us-abenabap-sql-glosry-htm--glossary-entry---statements-with-the-additions-from---appending---to-table---selective-data-transport-----if--when-reading-table-lines-using--read-table--https---help-sap-com-doc-abapdocu-757-index-htm-7-57-en-us-abapread-table-htm--or--loop-at--https---help-sap-com-doc-abapdocu-757-index-htm-7-57-en-us-abaploop-at-itab-htm---a-work-area-is-used-or-table-lines-can-be-changed-using--modify--https---help-sap-com-doc-abapdocu-757-index-htm-7-57-en-us-abapmodify-itab-htm--instead-of-direct-access--the-transporting-addition-can-be-used-to-prevent-unnecessary-assignments-of-table-components-to-the-work-area--this-can-lead-to-a-noticeable-improvement-in-performance--particularly-if-table-like-components-are-excluded-from-processing---using-secondary-keys-----the--use-of-secondary-table-keys--https---help-sap-com-doc-abapdocu-757-index-htm-7-57-en-us-abenitab-key-secondary-usage-htm--should-be-planned-and-executed-carefully-and-sparingly--the-time-gained-when-accessing-individual-lines-should-not-be-lost-again-by-the-increased-memory-and-time-requirements-for-managing-the-secondary-keys--secondary-keys-are-generally-recommended-for-internal-tables-that-are-filled-once-and-rarely-changed-during-program-execution---example--the-program-demo--secondary--keys-demonstrates-how-a-secondary-table-key-is-specified-and-the-resulting-performance-gain---deleting-table-lines-----when-lines-are-deleted-from-an-internal-table--administration-costs-are-incurred-for-all-table-keys-and-table-indexes--the-primary-key-and-all-unique-secondary-keys-are-updated-directly--but-non-unique-secondary-keys-are-updated-only-if-the-line-to-be-deleted-is-included-in-the-updated-part-of-an-associated-index---lazy-update--https---help-sap-com-doc-abapdocu-757-index-htm-7-57-en-us-abenlazy-update-glosry-htm--glossary-entry------it-should-be-noted-that--particularly-for-standard-tables--the-mean-runtime-of-the-statement--delete--https---help-sap-com-doc-abapdocu-757-index-htm-7-57-en-us-abapdelete-itab-htm--always-depends-linearly-on-the-number-of-table-lines--even-when-secondary-keys-are-specified-using--with-table-key--https---help-sap-com-doc-abapdocu-757-index-htm-7-57-en-us-abapdelete-itab-key-htm--or--using-key--https---help-sap-com-doc-abapdocu-757-index-htm-7-57-en-us-abapdelete-itab-key-htm---this-is-because-a-linear-search-is-required-to-update-the-primary-index--even-though-the-line-to-be-deleted-can-itself-be-found-quickly---deleting-lines-in-internal-tables-using--delete--https---help-sap-com-doc-abapdocu-757-index-htm-7-57-en-us-abapdelete-itab-htm--does-not-usually-release-any-memory-in-the-internal-table--statements-such-as--clear--https---help-sap-com-doc-abapdocu-757-index-htm-7-57-en-us-abapclear-htm--or--free--https---help-sap-com-doc-abapdocu-757-index-htm-7-57-en-us-abapfree-dataobject-htm--must-be-used-to-release-memory-in-internal-tables---free-key-specified-for-sorted-tables-and-hashed-tables-----when-using-the--read--https---help-sap-com-doc-abapdocu-757-index-htm-7-57-en-us-abapread-table-htm--statement-with-a-specified-free-key-of-the-form--with-key------https---help-sap-com-doc-abapdocu-757-index-htm-7-57-en-us-abapread-table-free-htm---the-search-is-optimized-in-all-cases-where-this-is-possible--that-is-------in--sorted-tables--https---help-sap-com-doc-abapdocu-757-index-htm-7-57-en-us-abensorted-table-glosry-htm--glossary-entry----if-any-initial-section-of-the--table-key--https---help-sap-com-doc-abapdocu-757-index-htm-7-57-en-us-abentable-key-glosry-htm--glossary-entry---or-the-complete-table-key-is-covered-by-the-specified-key------in--hashed-tables--https---help-sap-com-doc-abapdocu-757-index-htm-7-57-en-us-abenhashed-table-glosry-htm--glossary-entry----if-the-complete-table-key-is-covered---if-part-of-a-free-key-meets-these-conditions--this-partial-key-is-first-used-to-search-for-an-entry--in-sorted-tables--this-is-done-using-a-binary-search-with-a-logarithmic-consumption-of-resources--and-in-hashed-tables-using-a-hash-algorithm--that-is--with-constant-resource-consumption--if-an-entry-is-found--the-system-checks-whether-the-rest-of-the-key-conditions-are-also-met--this-means-that-over-specific-keys-in-particular-are-optimized---hint--see-also--optimization-of-the-where-condition--https---help-sap-com-doc-abapdocu-757-index-htm-7-57-en-us-abenitab-where-optimization-htm----sorting-----for-textual-sorting-of-an-internal-table-in-accordance-with-the-current--text-environment--https---help-sap-com-doc-abapdocu-757-index-htm-7-57-en-us-abentext-environment-glosry-htm--glossary-entry----it-can-be-more-efficient-to-use-the-statement--convert-text-into-sortable-code--https---help-sap-com-doc-abapdocu-757-index-htm-7-57-en-us-abapconvert-text-htm--instead-of--sort-as-text--https---help-sap-com-doc-abapdocu-757-index-htm-7-57-en-us-abapsort-itab-htm--in-the-following-cases-------if-an-internal-table-is-sorted-by-locale-and-then-searched-binarily-using-the-statement-read-table-or-using-a--table-expression--https---help-sap-com-doc-abapdocu-757-index-htm-7-57-en-us-abentable-expressions-htm-------an-internal-table-must-be-sorted-more-than-once------indexes-for-database-tables-should-be-structured-in-accordance-with-a-locale---continue--itab---optimizing-the-where-condition--https---help-sap-com-doc-abapdocu-757-index-htm-7-57-en-us-abenitab-where-optimization-htm--------abenitab-where-optimization-htm------title---hint--description------if-the-lines-selected-using-where-are-modified-or-deleted-using-modify-https---help-sap-com-doc-abapdocu-757-index-htm-7-57-en-us-abapmodify-itab-htm--or-delete-https---help-sap-com-doc-abapdocu-757-index-htm-7-57-en-us-abapdelete-itab-htm--and-not-just-read-using-loop-at-https---help-sap-com--version---7-57--category---general--type---abap-reference--sourceurl---https---help-sap-com-doc-abapdocu-757-index-htm-7-57-en-us-abenitab-where-optimization-htm--abapfile---abenitab-where-optimization-htm--keywords----select----update----delete----loop----do----if----case----try----catch----data----types----internal-table----abenitab----where----optimization---------------as-abap-release-757---copyright-2023-sap-se--all-rights-reserved----abap---keyword-documentation--https---help-sap-com-doc-abapdocu-757-index-htm-7-57-en-us-abenabap-htm------abap---programming-language--https---help-sap-com-doc-abapdocu-757-index-htm-7-57-en-us-abenabap-reference-htm------processing-internal-data--https---help-sap-com-doc-abapdocu-757-index-htm-7-57-en-us-abenabap-data-working-htm------internal-tables--itab---https---help-sap-com-doc-abapdocu-757-index-htm-7-57-en-us-abenitab-htm------itab---performance-notes--https---help-sap-com-doc-abapdocu-757-index-htm-7-57-en-us-abenitab-perfo-htm------------mail-gif-object-mail-gif-sap-language-en--feedback-mail-for-displayed-topic---mail-feedback--mailto-f1-helpsap.com?subject=Feedback on ABAP Documentation&body=Document: itab - Optimizing the WHERE Condition, ABENITAB_WHERE_OPTIMIZATION, 757%0D%0A%0D%0AEr
ror:%0D%0A%0D%0A%0D%0A%0D%0ASuggestion for improvement:)

itab - Optimizing the WHERE Condition

The statements [LOOP AT](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abaploop_at_itab.htm), [DELETE](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abapdelete_itab.htm), and [MODIFY](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abapmodify_itab.htm) can be specified together with a WHERE condition that selects specific lines of the internal table. Searches in a [standard table](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abenstandard_table_glosry.htm "Glossary Entry") using the [primary table key](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abenprimary_table_key_glosry.htm "Glossary Entry") are always linear and cannot be optimized. Searches using a [sorted key](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abensorted_key_glosry.htm "Glossary Entry") or a [hash key](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abenhash_key_glosry.htm "Glossary Entry"), however, can be optimized in certain circumstances. These keys are used for:

-   accessing a [sorted table](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abensorted_table_glosry.htm "Glossary Entry") using its primary key.
-   accessing a [hashed table](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abenhashed_table_glosry.htm "Glossary Entry") using its primary key.
-   accessing a table of any table type using a [secondary table key](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abensecondary_table_key_glosry.htm "Glossary Entry") specified by USING KEY.

The optimization takes place by mapping all [relational expressions](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abenrelational_expression_glosry.htm "Glossary Entry") or a group of the relational expressions in the WHERE condition to a specified key. This specified key performs a corresponding optimized key access (binary search or hash algorithm as in the statement [READ TABLE](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abapread_table.htm) or a [table expression](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abentable_expressions.htm)), to find one or more lines. The found line or lines are then checked using those remaining relational expressions from the WHERE condition that were not mapped to the specified key.

Prerequisites for the optimization are therefore:

-   The relational expressions of the WHERE condition can be transformed to a specified key.
-   The corresponding key access returns the same results as the evaluation of this part of the logical expression would. This is guaranteed only for compatible data types, since in the case of incompatible data types:
    -   the content of the specified data objects is converted to the data type of the columns before the evaluation in the case of key accesses.
    -   The [comparison rules](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abenlogexp_rules.htm) for incompatible data types apply when evaluating a [comparison expression](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abencomparison_expression_glosry.htm "Glossary Entry"). Here, all the data types involved play a part in determining which operand is converted into which comparison type.

If there are no or insufficient relational expressions to meet both of these prerequisites, no optimization is possible and the behavior is as follows:

-   If a sorted table or a hashed table is accessed using the primary table key, all lines of the internal table are checked as in a standard table.
-   If the table is read using a secondary table key, that is, if said key is specified after USING KEY, a syntax error or syntax check warning, or an exception is raised. Access using a secondary table key must always be executed in an optimized way.

The following sections describe exactly when an access can be optimized.

-   [Prerequisites for the Optimization of Hash Keys](#abenitab-where-optimization-1-------prerequisites-for-the-optimization-of-sorted-keys---@ITOC@@ABENITAB_WHERE_OPTIMIZATION_2)
-   [Requirements Made on the Operands](#@@ITOC@@ABENITAB_WHERE_OPTIMIZATION_3)

Hint

If the lines selected using WHERE are modified or deleted using [MODIFY](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abapmodify_itab.htm) or [DELETE](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abapdelete_itab.htm) and not just read using [LOOP AT](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abaploop_at_itab.htm), further update costs are incurred in addition to the search for the lines. When deleting lines from standard tables, it should be noted that searches using a secondary key optimize the selection of lines to be deleted, but not the update required for the primary key, which is usually performed using a linear search.

Prerequisites for the Optimization of Hash Keys   

In the case of [hash key](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abenhash_key_glosry.htm "Glossary Entry") accesses, there must be exactly one relational expression combined using AND for each component of the key. This expression is either

-   a [comparison expression](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abencomparison_expression_glosry.htm "Glossary Entry") with the comparison operator \= (or EQ), whose operands meet the requirements above or
-   a [predicate expression](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abenpredicate_expression_glosry.htm "Glossary Entry") IS INITIAL without the addition NOT.

These relational expressions construct the part of the logical expression used for the key access. This part must not contain duplicate key components. The remainder of the logical expression can contain any number of relational expressions combined using AND. Optimization may not be possible, however, if the Boolean operators NOT or OR are used. Key components may be used in the relational expressions not used for the key access.

Hint

Relational expressions other than comparisons using \= (or EQ) or predicate expressions IS INITIAL are not part of the key access. This applies particularly to the tabular comparison operator [IN range\_tab](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abenlogexp_select_option.htm), even if it can be traced back to optimizable comparisons.

Example

In the following example, the first two WHERE conditions can be optimized as key accesses with the secondary table key key. This is because:

1.  The optimizable conditions for b, d, and e cover the entire key.
2.  The optimizable conditions b, d, and e cover the entire key and a is a condition on a non-key column that is not involved in the part of the WHERE condition required for the optimization.
3.  The optimizable conditions b, d, and e cover the entire key and the other two conditions on the key columns b and d are not optimizable and are hence not involved in the part of the WHERE condition required for the optimization.

The next six WHERE conditions cannot be optimized and produce syntax errors. This is because:

1.  The key component d is not specified.
2.  A key component is combined using OR instead of AND.
3.  Two non-optimizable comparison operators are used.
4.  An operand of type i is used in the comparison b of type c, which does not meet the requirements made on the operands.
5.  The Boolean operator NOT is used in front of a key component.
6.  A further comparison is combined using OR.
7.  A further comparison is negated using NOT.
    
    DATA: BEGIN OF line,
            a TYPE c LENGTH 3,
            b TYPE c LENGTH 3,
            c TYPE c LENGTH 3,
            d TYPE c LENGTH 3,
            e TYPE c LENGTH 3,
            f TYPE c LENGTH 3,
          END OF line.
    DATA itab LIKE STANDARD TABLE OF line
                   WITH UNIQUE HASHED KEY key COMPONENTS b e d.
    DATA b\_tab LIKE RANGE OF line-b.
    LOOP AT itab INTO line USING KEY key
         WHERE b = '...' AND d = '...' AND e IS INITIAL.
    ENDLOOP.
    LOOP AT itab INTO line USING KEY key
         WHERE a = '...' AND b = '...' AND d = '...' AND e IS INITIAL.
    ENDLOOP.
    LOOP AT itab INTO line USING KEY key
         WHERE  b = '...' AND d = '...' AND e IS INITIAL AND
                b IN b\_tab AND d <> '...'.
    ENDLOOP.
    LOOP AT itab INTO line USING KEY key
         WHERE b = '...' AND e IS INITIAL.                     "syntax error
    ENDLOOP.
    LOOP AT itab INTO line USING KEY key
         WHERE b = '...' OR d = '...' AND e IS INITIAL OR      "syntax error
    ENDLOOP.
    LOOP AT itab INTO line USING KEY key
         WHERE b = '...' AND d <> '...' AND e IS NOT INITIAL.  "syntax error
    ENDLOOP.
    LOOP AT itab INTO line USING KEY key
         WHERE b = 333 AND d = '...' AND e IS INITIAL.         "syntax error
    ENDLOOP.
    LOOP AT itab INTO line USING KEY key
         WHERE b = '...'  AND NOT d = '...' AND e IS INITIAL.  "syntax error
    ENDLOOP.
    LOOP AT itab INTO line USING KEY key
         WHERE b = '...' AND d = '...' AND e IS INITIAL OR     "syntax error
               a = '...'.
    ENDLOOP.
    LOOP AT itab INTO line USING KEY key
         WHERE b = '...' AND d = '...' AND e IS INITIAL AND    "syntax error
               NOT a = '...'.
    ENDLOOP.
    

Prerequisites for the Optimization of Sorted Keys   

In the case of reads using a [sorted key](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abensorted_key_glosry.htm "Glossary Entry"), the same applies as to a hash key. The only difference is that only an initial section of the key consisting of at least one component needs to be covered rather than the entire key.

The internal table is accessed in part sequentially. The starting point for the processing of the table is determined by a binary search using the subconditions that cover the table key completely or partially. From the starting point onwards, the table is only processed for as long as these subconditions remain fulfilled.

Example

In the following example, the first five WHERE conditions can be optimized as key accesses with the secondary table key key. This is because:

1.  b is an initial part of the key.
2.  b is an initial part of the key and a is an independent condition.
3.  b and e are an initial part of the key.
4.  b, e, and d are an initial part of the key and the order in the WHERE condition is ignored.
5.  b is an initial part of the key and in this case, d is an independent condition, even though it is part of the key.

The next five WHERE conditions cannot be optimized and produce syntax errors. This is because:

1.  e is not an initial part of the key.
2.  No inequality comparison takes place.
3.  A comparison in a ranges table is specified.
4.  The Boolean operator NOT is used.
5.  An additional OR relationship is used.
    
    DATA: BEGIN OF line,
            a TYPE c LENGTH 3,
            b TYPE c LENGTH 3,
            c TYPE c LENGTH 3,
            d TYPE c LENGTH 3,
            e TYPE c LENGTH 3,
            f TYPE c LENGTH 3,
          END OF line.
    DATA itab LIKE STANDARD TABLE OF line
                   WITH UNIQUE SORTED KEY key COMPONENTS b e d.
    DATA b\_tab LIKE RANGE OF line-b.
    LOOP AT itab INTO line USING KEY key
                 WHERE b = '...'.
    ENDLOOP.
    LOOP AT itab INTO line USING KEY key
                 WHERE a = '...' AND b IS INITIAL.
    ENDLOOP.
    LOOP AT itab INTO line USING KEY key
                 WHERE b = '...' AND e = '...'.
    ENDLOOP.
    LOOP AT itab INTO line USING KEY key
                 WHERE b = '...' AND d IS INITIAL AND e = '...'.
    ENDLOOP.
    LOOP AT itab INTO line USING KEY key
                 WHERE b = '...' AND d <> '...'.
    ENDLOOP.
    LOOP AT itab INTO line USING KEY key
                 WHERE e = '...'.                    "syntax error
    ENDLOOP.
    LOOP AT itab INTO line USING KEY key
                 WHERE b <> '...'.                   "syntax error
    ENDLOOP.
    LOOP AT itab INTO line USING KEY key
                 WHERE b IN b\_tab.                   "syntax error
    ENDLOOP.
    LOOP AT itab INTO line USING KEY key
                 WHERE b = '...'  AND NOT e = '...'. "syntax error
    ENDLOOP.
    LOOP AT itab INTO line USING KEY key             "syntax error
                 WHERE b = '...'  AND ( d = '...' OR e IS INITIAL ).
    ENDLOOP.
    

Requirements Made on the Operands   

The part of the logical expression that can be mapped to a key access must select the same lines as a statement [READ TABLE](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abapread_table.htm) or a corresponding [table expression](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abentable_expressions.htm) that specifies the corresponding components as keys.

-   When comparing incompatible data objects, the WHERE condition is subject to the same [comparison rules](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abenlogexp_rules.htm) for incompatible data types. Here, the data types involved determine which operand is converted to which comparison type.
-   If the additions [WITH TABLE KEY](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abapread_table_key.htm) and [WITH KEY](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abapread_table_free.htm) of the statement READ or [KEY](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abentable_exp_itab_line.htm) in a table expression are used, however, the content of the specified data objects is always converted to the data type of the columns before the comparison.

If this produces differing results, an optimization is not possible. Due to the complexity of the comparison rules, particularly for [elementary data types](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abenlogexp_rules_operands.htm), it is not a good idea to construct a set of rules detailing exactly when the comparison type matches the data type of the left operand. Generally speaking,

-   only fully compatible operands are optimizable,
-   in some cases, elementary operands with different data types can be optimized, if the value ranges or lengths are suitable. For example, a comparison of a column with the type of a floating point number with an operand of type integer or of a column of c with a similar operand, if its length is less than the length of the column.

For this reason, it is advisable to use only pairs of [compatible](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abencompatible_glosry.htm "Glossary Entry") operands in the WHERE condition. This guarantees that the differences in behavior of the WHERE condition and the specified key do not affect the result.

Example

The following example is largely similar to the example in the section WHERE log\_exp in [LOOP AT itab](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abaploop_at_itab_cond.htm). In that case, access takes place using the primary key and no optimization. Here, however, access takes place using a secondary table key and a syntax check warning is produced and an exception raised when the program is executed. The number of lines in the internal table determines whether the exception is raised.

DATA text\_short TYPE c LENGTH 2.
DATA text\_long  TYPE c LENGTH 4.
DATA itab LIKE TABLE OF text\_short
          WITH UNIQUE HASHED KEY key COMPONENTS table\_line.
itab = VALUE #( ( 'AA' )
                ( 'BB' )
                ( 'CC' )
                ( 'DD' )
                ( 'EE' )
                ( 'FF' )
                ( 'GG' )
                ( 'HH' )
                ( 'II' )
                ( 'JJ' )
                ( 'KK' )
                ( 'LL' )
                ( 'MM' ) ).
text\_short = 'AA'.
text\_long  = 'AAXX'.
LOOP AT itab INTO text\_short USING KEY key
             WHERE table\_line = text\_long.
ENDLOOP.
cl\_demo\_output=>write( |LOOP: { sy-subrc }| ).
"Statement
READ TABLE itab INTO text\_short WITH TABLE KEY key
                                COMPONENTS table\_line = text\_long.
cl\_demo\_output=>write( |READ: { sy-subrc }| ).
"Expression
TRY.
    text\_short = itab\[ KEY key COMPONENTS table\_line = text\_long \].
  catch CX\_SY\_ITAB\_LINE\_NOT\_FOUND.
    ...
ENDTRY.
cl\_demo\_output=>display( |Expression: { text\_short }| ).


---


## ABAP - Keyword Documentation / ABAP - Programming Language / Processing Internal Data / Internal Tables (itab) / itab - Performance Notes

**Files**: 2 | **Difficulty**: intermediate

# ABAP - Keyword Documentation / ABAP - Programming Language / Processing Internal Data / Internal Tables (itab) / itab - Performance Notes

Included pages: 2


### abenitab_perfo.htm

---
title: "Table Sharing"
description: |
  When assignments are made between internal tables of the same type whose line type does not contain any table types, only the internal administration functions are passed to the table body(https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abentable_body_glosry.htm 'Glossary Entry') for pe
version: "7.57"
category: "data-structures"
type: "abap-reference"
sourceUrl: "https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abenitab_perfo.htm"
abapFile: "abenitab_perfo.htm"
keywords: ["select", "insert", "update", "delete", "loop", "do", "if", "case", "try", "data", "types", "internal-table", "abenitab", "perfo"]
---

* * *

AS ABAP Release 757, ©Copyright 2023 SAP SE. All rights reserved.

[ABAP - Keyword Documentation](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abenabap.htm) →  [ABAP - Programming Language](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abenabap_reference.htm) →  [Processing Internal Data](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abenabap_data_working.htm) →  [Internal Tables (itab)](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abenitab.htm) → 

 [![](Mail.gif?object=Mail.gif&sap-language=EN "Feedback mail for displayed topic") Mail Feedback](mailto:f1_help@sap.com?subject=Feedback on ABAP Documentation&body=Document: itab - Performance Notes, ABENITAB_PERFO, 757%0D%0A%0D%0AError:%0D%0A%0D%0A%0D%0A%0D%
0ASuggestion for improvement:)

itab - Performance Notes

-   [Table Sharing](#abenitab-perfo-1-------initial-memory-requirement---@ITOC@@ABENITAB_PERFO_2)
-   [Index Administration](#abenitab-perfo-3-------block-processing-of-table-lines---@ITOC@@ABENITAB_PERFO_4)
-   [Selective Data Transport](#abenitab-perfo-5-------using-secondary-keys---@ITOC@@ABENITAB_PERFO_6)
-   [Deleting Table Lines](#abenitab-perfo-7-------free-key-specified-for-sorted-tables-and-hashed-tables---@ITOC@@ABENITAB_PERFO_8)
-   [Sorting](#abenitab-perfo-9---table-sharing-----when-assignments-are-made-between-internal-tables-of-the-same-type-whose-line-type-does-not-contain-any-table-types--only-the-internal-administration-functions-are-passed-to-the--table-body--https---help-sap-com-doc-abapdocu-757-index-htm-7-57-en-us-abentable-body-glosry-htm--glossary-entry---for-performance-reasons---table-sharing--https---help-sap-com-doc-abapdocu-757-index-htm-7-57-en-us-abentable-sharing-glosry-htm--glossary-entry---is-revoked-only-when-write-access-to-one-of-the-tables-involved-is-initiated--the-actual-copy-process-then-takes-place---initial-memory-requirement-----internal-tables-are--dynamic-data-objects--https---help-sap-com-doc-abapdocu-757-index-htm-7-57-en-us-abendynamic-data-object-glosry-htm--glossary-entry---whose-area-in-the-memory-is-extended-block-by-block--the-size-of-the-first-block-in-the-memory-is-called--initial-memory-requirement--https---help-sap-com-doc-abapdocu-757-index-htm-7-57-en-us-abeninitial-mem-req-glosry-htm--glossary-entry---and-can-be-affected-in-the-declaration-of-an-internal-table-using-the-additions--initial-size--https---help-sap-com-doc-abapdocu-757-index-htm-7-57-en-us-abaptypes-itab-htm--and-the-obsolete--occurs--https---help-sap-com-doc-abapdocu-757-index-htm-7-57-en-us-abapdata-occurs-htm----it-is-usually-up-to-the-system-to-determine-the-size-of-the-first-block--initial-size-is-not-used-or-specified-with-the-value-0--in-this-case--a-suitable-block-size-is-chosen-the-first-time-lines-are-added-to-an-internal-table---specifying-a-concrete-value-greater-than-0-after-initial-size-is-only-practical-if-it-is-known-in-advance-how-many-entries-are-to-be-made-in-the-table--and-the-first-block-is-therefore-to-be-created-with-the-most-suitable-dimensions--this-can-be-particularly-important-for-internal-tables-that-are-components-of-other-internal-tables--and-which-only-contain-a-few-lines--no-more-than-around-5----to-avoid-excessive-memory-demands--the-system-ignores-values-that-produce-memory-demands-greater-than-the-constant-block-size---index-administration-----in-an--index-table--https---help-sap-com-doc-abapdocu-757-index-htm-7-57-en-us-abenindex-table-glosry-htm--glossary-entry----the-logical-order-of-the-table-entries-is-not-generally-consistent-with-the-physical-order-of-the-entries-in-the-main-memory--in-this-case--the-logical-order-is-no-longer-administrated-by-a-physical-index--but-by-a-logical-index--the-same-basically-applies-to-the--secondary-table-indexes--https---help-sap-com-doc-abapdocu-757-index-htm-7-57-en-us-abensecondary-table-index-glosry-htm--glossary-entry---used-to-manage--secondary--https---help-sap-com-doc-abapdocu-757-index-htm-7-57-en-us-abensecondary-table-key-glosry-htm--glossary-entry----sorted-keys--https---help-sap-com-doc-abapdocu-757-index-htm-7-57-en-us-abensorted-key-glosry-htm--glossary-entry-----use-of-the-logical-index-produces-additional-memory-requirements--and-index-maintenance-places-a-high-demand-on-resources--time-and-memory--when-inserting-or-deleting-table-lines--the-resource-requirements-increase-proportionally-with-the-number-of-remaining-lines-after-the-insertion-or-deletion-position--for-very-large-internal-tables--this-can-result-in-considerable-demands-on-performance-at-runtime---the-logical-index-is-only-created-when-it-is-needed--that-is--when-a-line-is-inserted-in-front-of-another-line--if-the-order-of-the-table-lines-is-changed--or-a-line-other-than-the-last-line-is-deleted--a-logical-index-is-not-required-if-an-internal-table-is-filled-using-only--append--https---help-sap-com-doc-abapdocu-757-index-htm-7-57-en-us-abapappend-htm---and-if-only-its-last-line-or-lines-is-are-deleted-using--delete--https---help-sap-com-doc-abapdocu-757-index-htm-7-57-en-us-abapdelete-itab-htm----hint--in-contrast-to-filling-a-table-with--insert--https---help-sap-com-doc-abapdocu-757-index-htm-7-57-en-us-abapinsert-itab-htm---appending-lines-with--append--https---help-sap-com-doc-abapdocu-757-index-htm-7-57-en-us-abapappend-htm--does-not-require-any-resources-for-index-maintenance--it-is-therefore-preferable-to-use-append-instead-of-insert-to-create-a--standard-table--https---help-sap-com-doc-abapdocu-757-index-htm-7-57-en-us-abenstandard-table-glosry-htm--glossary-entry----this-is-possible-if-the-order-of-the-entries-is-not-important--or-if-entries-can-be-appended-in-the-correct-order---block-processing-of-table-lines-----if-entire-line-areas-of-a-table-can-be-processed-at-once--this-should-not-be-done-line-by-line--but-using-block-operations--block-operations-are-possible-using-the-from-and-to-additions-of-the-statements--insert--https---help-sap-com-doc-abapdocu-757-index-htm-7-57-en-us-abapinsert-itab-htm----append--https---help-sap-com-doc-abapdocu-757-index-htm-7-57-en-us-abapappend-htm--and--delete--https---help-sap-com-doc-abapdocu-757-index-htm-7-57-en-us-abapdelete-itab-htm---block-operations-are-also-more-efficient-than-single-record-operations-when-reading-from-or-modifying-database-tables-with--abap-sql--https---help-sap-com-doc-abapdocu-757-index-htm-7-57-en-us-abenabap-sql-glosry-htm--glossary-entry---statements-with-the-additions-from---appending---to-table---selective-data-transport-----if--when-reading-table-lines-using--read-table--https---help-sap-com-doc-abapdocu-757-index-htm-7-57-en-us-abapread-table-htm--or--loop-at--https---help-sap-com-doc-abapdocu-757-index-htm-7-57-en-us-abaploop-at-itab-htm---a-work-area-is-used-or-table-lines-can-be-changed-using--modify--https---help-sap-com-doc-abapdocu-757-index-htm-7-57-en-us-abapmodify-itab-htm--instead-of-direct-access--the-transporting-addition-can-be-used-to-prevent-unnecessary-assignments-of-table-components-to-the-work-area--this-can-lead-to-a-noticeable-improvement-in-performance--particularly-if-table-like-components-are-excluded-from-processing---using-secondary-keys-----the--use-of-secondary-table-keys--https---help-sap-com-doc-abapdocu-757-index-htm-7-57-en-us-abenitab-key-secondary-usage-htm--should-be-planned-and-executed-carefully-and-sparingly--the-time-gained-when-accessing-individual-lines-should-not-be-lost-again-by-the-increased-memory-and-time-requirements-for-managing-the-secondary-keys--secondary-keys-are-generally-recommended-for-internal-tables-that-are-filled-once-and-rarely-changed-during-program-execution---example--the-program-demo--secondary--keys-demonstrates-how-a-secondary-table-key-is-specified-and-the-resulting-performance-gain---deleting-table-lines-----when-lines-are-deleted-from-an-internal-table--administration-costs-are-incurred-for-all-table-keys-and-table-indexes--the-primary-key-and-all-unique-secondary-keys-are-updated-directly--but-non-unique-secondary-keys-are-updated-only-if-the-line-to-be-deleted-is-included-in-the-updated-part-of-an-associated-index---lazy-update--https---help-sap-com-doc-abapdocu-757-index-htm-7-57-en-us-abenlazy-update-glosry-htm--glossary-entry------it-should-be-noted-that--particularly-for-standard-tables--the-mean-runtime-of-the-statement--delete--https---help-sap-com-doc-abapdocu-757-index-htm-7-57-en-us-abapdelete-itab-htm--always-depends-linearly-on-the-number-of-table-lines--even-when-secondary-keys-are-specified-using--with-table-key--https---help-sap-com-doc-abapdocu-757-index-htm-7-57-en-us-abapdelete-itab-key-htm--or--using-key--https---help-sap-com-doc-abapdocu-757-index-htm-7-57-en-us-abapdelete-itab-key-htm---this-is-because-a-linear-search-is-required-to-update-the-primary-index--even-though-the-line-to-be-deleted-can-itself-be-found-quickly---deleting-lines-in-internal-tables-using--delete--https---help-sap-com-doc-abapdocu-757-index-htm-7-57-en-us-abapdelete-itab-htm--does-not-usually-release-any-memory-in-the-internal-table--statements-such-as--clear--https---help-sap-com-doc-abapdocu-757-index-htm-7-57-en-us-abapclear-htm--or--free--https---help-sap-com-doc-abapdocu-757-index-htm-7-57-en-us-abapfree-dataobject-htm--must-be-used-to-release-memory-in-internal-tables---free-key-specified-for-sorted-tables-and-hashed-tables-----when-using-the--read--https---help-sap-com-doc-abapdocu-757-index-htm-7-57-en-us-abapread-table-htm--statement-with-a-specified-free-key-of-the-form--with-key------https---help-sap-com-doc-abapdocu-757-index-htm-7-57-en-us-abapread-table-free-htm---the-search-is-optimized-in-all-cases-where-this-is-possible--that-is-------in--sorted-tables--https---help-sap-com-doc-abapdocu-757-index-htm-7-57-en-us-abensorted-table-glosry-htm--glossary-entry----if-any-initial-section-of-the--table-key--https---help-sap-com-doc-abapdocu-757-index-htm-7-57-en-us-abentable-key-glosry-htm--glossary-entry---or-the-complete-table-key-is-covered-by-the-specified-key------in--hashed-tables--https---help-sap-com-doc-abapdocu-757-index-htm-7-57-en-us-abenhashed-table-glosry-htm--glossary-entry----if-the-complete-table-key-is-covered---if-part-of-a-free-key-meets-these-conditions--this-partial-key-is-first-used-to-search-for-an-entry--in-sorted-tables--this-is-done-using-a-binary-search-with-a-logarithmic-consumption-of-resources--and-in-hashed-tables-using-a-hash-algorithm--that-is--with-constant-resource-consumption--if-an-entry-is-found--the-system-checks-whether-the-rest-of-the-key-conditions-are-also-met--this-means-that-over-specific-keys-in-particular-are-optimized---hint--see-also--optimization-of-the-where-condition--https---help-sap-com-doc-abapdocu-757-index-htm-7-57-en-us-abenitab-where-optimization-htm----sorting-----for-textual-sorting-of-an-internal-table-in-accordance-with-the-current--text-environment--https---help-sap-com-doc-abapdocu-757-index-htm-7-57-en-us-abentext-environment-glosry-htm--glossary-entry----it-can-be-more-efficient-to-use-the-statement--convert-text-into-sortable-code--https---help-sap-com-doc-abapdocu-757-index-htm-7-57-en-us-abapconvert-text-htm--instead-of--sort-as-text--https---help-sap-com-doc-abapdocu-757-index-htm-7-57-en-us-abapsort-itab-htm--in-the-following-cases-------if-an-internal-table-is-sorted-by-locale-and-then-searched-binarily-using-the-statement-read-table-or-using-a--table-expression--https---help-sap-com-doc-abapdocu-757-index-htm-7-57-en-us-abentable-expressions-htm-------an-internal-table-must-be-sorted-more-than-once------indexes-for-database-tables-should-be-structured-in-accordance-with-a-locale---continue--itab---optimizing-the-where-condition--https---help-sap-com-doc-abapdocu-757-index-htm-7-57-en-us-abenitab-where-optimization-htm--------abenitab-where-optimization-htm------title---hint--description------if-the-lines-selected-using-where-are-modified-or-deleted-using-modify-https---help-sap-com-doc-abapdocu-757-index-htm-7-57-en-us-abapmodify-itab-htm--or-delete-https---help-sap-com-doc-abapdocu-757-index-htm-7-57-en-us-abapdelete-itab-htm--and-not-just-read-using-loop-at-https---help-sap-com--version---7-57--category---general--type---abap-reference--sourceurl---https---help-sap-com-doc-abapdocu-757-index-htm-7-57-en-us-abenitab-where-optimization-htm--abapfile---abenitab-where-optimization-htm--keywords----select----update----delete----loop----do----if----case----try----catch----data----types----internal-table----abenitab----where----optimization---------------as-abap-release-757---copyright-2023-sap-se--all-rights-reserved----abap---keyword-documentation--https---help-sap-com-doc-abapdocu-757-index-htm-7-57-en-us-abenabap-htm------abap---programming-language--https---help-sap-com-doc-abapdocu-757-index-htm-7-57-en-us-abenabap-reference-htm------processing-internal-data--https---help-sap-com-doc-abapdocu-757-index-htm-7-57-en-us-abenabap-data-working-htm------internal-tables--itab---https---help-sap-com-doc-abapdocu-757-index-htm-7-57-en-us-abenitab-htm------itab---performance-notes--https---help-sap-com-doc-abapdocu-757-index-htm-7-57-en-us-abenitab-perfo-htm------------mail-gif-object-mail-gif-sap-language-en--feedback-mail-for-displayed-topic---mail-feedback--mailto-f1-helpsap.com?subject=Feedback on ABAP Documentation&body=Document: itab - Optimizing the WHERE Condition, ABENITAB_WHERE_OPTIMIZATION, 757%0D%0A%0D%0AEr
ror:%0D%0A%0D%0A%0D%0A%0D%0ASuggestion for improvement:)

itab - Optimizing the WHERE Condition

The statements [LOOP AT](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abaploop_at_itab.htm), [DELETE](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abapdelete_itab.htm), and [MODIFY](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abapmodify_itab.htm) can be specified together with a WHERE condition that selects specific lines of the internal table. Searches in a [standard table](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abenstandard_table_glosry.htm "Glossary Entry") using the [primary table key](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abenprimary_table_key_glosry.htm "Glossary Entry") are always linear and cannot be optimized. Searches using a [sorted key](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abensorted_key_glosry.htm "Glossary Entry") or a [hash key](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abenhash_key_glosry.htm "Glossary Entry"), however, can be optimized in certain circumstances. These keys are used for:

-   accessing a [sorted table](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abensorted_table_glosry.htm "Glossary Entry") using its primary key.
-   accessing a [hashed table](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abenhashed_table_glosry.htm "Glossary Entry") using its primary key.
-   accessing a table of any table type using a [secondary table key](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abensecondary_table_key_glosry.htm "Glossary Entry") specified by USING KEY.

The optimization takes place by mapping all [relational expressions](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abenrelational_expression_glosry.htm "Glossary Entry") or a group of the relational expressions in the WHERE condition to a specified key. This specified key performs a corresponding optimized key access (binary search or hash algorithm as in the statement [READ TABLE](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abapread_table.htm) or a [table expression](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abentable_expressions.htm)), to find one or more lines. The found line or lines are then checked using those remaining relational expressions from the WHERE condition that were not mapped to the specified key.

Prerequisites for the optimization are therefore:

-   The relational expressions of the WHERE condition can be transformed to a specified key.
-   The corresponding key access returns the same results as the evaluation of this part of the logical expression would. This is guaranteed only for compatible data types, since in the case of incompatible data types:
    -   the content of the specified data objects is converted to the data type of the columns before the evaluation in the case of key accesses.
    -   The [comparison rules](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abenlogexp_rules.htm) for incompatible data types apply when evaluating a [comparison expression](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abencomparison_expression_glosry.htm "Glossary Entry"). Here, all the data types involved play a part in determining which operand is converted into which comparison type.

If there are no or insufficient relational expressions to meet both of these prerequisites, no optimization is possible and the behavior is as follows:

-   If a sorted table or a hashed table is accessed using the primary table key, all lines of the internal table are checked as in a standard table.
-   If the table is read using a secondary table key, that is, if said key is specified after USING KEY, a syntax error or syntax check warning, or an exception is raised. Access using a secondary table key must always be executed in an optimized way.

The following sections describe exactly when an access can be optimized.

-   [Prerequisites for the Optimization of Hash Keys](#abenitab-where-optimization-1-------prerequisites-for-the-optimization-of-sorted-keys---@ITOC@@ABENITAB_WHERE_OPTIMIZATION_2)
-   [Requirements Made on the Operands](#@@ITOC@@ABENITAB_WHERE_OPTIMIZATION_3)

Hint

If the lines selected using WHERE are modified or deleted using [MODIFY](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abapmodify_itab.htm) or [DELETE](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abapdelete_itab.htm) and not just read using [LOOP AT](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abaploop_at_itab.htm), further update costs are incurred in addition to the search for the lines. When deleting lines from standard tables, it should be noted that searches using a secondary key optimize the selection of lines to be deleted, but not the update required for the primary key, which is usually performed using a linear search.

Prerequisites for the Optimization of Hash Keys   

In the case of [hash key](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abenhash_key_glosry.htm "Glossary Entry") accesses, there must be exactly one relational expression combined using AND for each component of the key. This expression is either

-   a [comparison expression](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abencomparison_expression_glosry.htm "Glossary Entry") with the comparison operator \= (or EQ), whose operands meet the requirements above or
-   a [predicate expression](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abenpredicate_expression_glosry.htm "Glossary Entry") IS INITIAL without the addition NOT.

These relational expressions construct the part of the logical expression used for the key access. This part must not contain duplicate key components. The remainder of the logical expression can contain any number of relational expressions combined using AND. Optimization may not be possible, however, if the Boolean operators NOT or OR are used. Key components may be used in the relational expressions not used for the key access.

Hint

Relational expressions other than comparisons using \= (or EQ) or predicate expressions IS INITIAL are not part of the key access. This applies particularly to the tabular comparison operator [IN range\_tab](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abenlogexp_select_option.htm), even if it can be traced back to optimizable comparisons.

Example

In the following example, the first two WHERE conditions can be optimized as key accesses with the secondary table key key. This is because:

1.  The optimizable conditions for b, d, and e cover the entire key.
2.  The optimizable conditions b, d, and e cover the entire key and a is a condition on a non-key column that is not involved in the part of the WHERE condition required for the optimization.
3.  The optimizable conditions b, d, and e cover the entire key and the other two conditions on the key columns b and d are not optimizable and are hence not involved in the part of the WHERE condition required for the optimization.

The next six WHERE conditions cannot be optimized and produce syntax errors. This is because:

1.  The key component d is not specified.
2.  A key component is combined using OR instead of AND.
3.  Two non-optimizable comparison operators are used.
4.  An operand of type i is used in the comparison b of type c, which does not meet the requirements made on the operands.
5.  The Boolean operator NOT is used in front of a key component.
6.  A further comparison is combined using OR.
7.  A further comparison is negated using NOT.
    
    DATA: BEGIN OF line,
            a TYPE c LENGTH 3,
            b TYPE c LENGTH 3,
            c TYPE c LENGTH 3,
            d TYPE c LENGTH 3,
            e TYPE c LENGTH 3,
            f TYPE c LENGTH 3,
          END OF line.
    DATA itab LIKE STANDARD TABLE OF line
                   WITH UNIQUE HASHED KEY key COMPONENTS b e d.
    DATA b\_tab LIKE RANGE OF line-b.
    LOOP AT itab INTO line USING KEY key
         WHERE b = '...' AND d = '...' AND e IS INITIAL.
    ENDLOOP.
    LOOP AT itab INTO line USING KEY key
         WHERE a = '...' AND b = '...' AND d = '...' AND e IS INITIAL.
    ENDLOOP.
    LOOP AT itab INTO line USING KEY key
         WHERE  b = '...' AND d = '...' AND e IS INITIAL AND
                b IN b\_tab AND d <> '...'.
    ENDLOOP.
    LOOP AT itab INTO line USING KEY key
         WHERE b = '...' AND e IS INITIAL.                     "syntax error
    ENDLOOP.
    LOOP AT itab INTO line USING KEY key
         WHERE b = '...' OR d = '...' AND e IS INITIAL OR      "syntax error
    ENDLOOP.
    LOOP AT itab INTO line USING KEY key
         WHERE b = '...' AND d <> '...' AND e IS NOT INITIAL.  "syntax error
    ENDLOOP.
    LOOP AT itab INTO line USING KEY key
         WHERE b = 333 AND d = '...' AND e IS INITIAL.         "syntax error
    ENDLOOP.
    LOOP AT itab INTO line USING KEY key
         WHERE b = '...'  AND NOT d = '...' AND e IS INITIAL.  "syntax error
    ENDLOOP.
    LOOP AT itab INTO line USING KEY key
         WHERE b = '...' AND d = '...' AND e IS INITIAL OR     "syntax error
               a = '...'.
    ENDLOOP.
    LOOP AT itab INTO line USING KEY key
         WHERE b = '...' AND d = '...' AND e IS INITIAL AND    "syntax error
               NOT a = '...'.
    ENDLOOP.
    

Prerequisites for the Optimization of Sorted Keys   

In the case of reads using a [sorted key](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abensorted_key_glosry.htm "Glossary Entry"), the same applies as to a hash key. The only difference is that only an initial section of the key consisting of at least one component needs to be covered rather than the entire key.

The internal table is accessed in part sequentially. The starting point for the processing of the table is determined by a binary search using the subconditions that cover the table key completely or partially. From the starting point onwards, the table is only processed for as long as these subconditions remain fulfilled.

Example

In the following example, the first five WHERE conditions can be optimized as key accesses with the secondary table key key. This is because:

1.  b is an initial part of the key.
2.  b is an initial part of the key and a is an independent condition.
3.  b and e are an initial part of the key.
4.  b, e, and d are an initial part of the key and the order in the WHERE condition is ignored.
5.  b is an initial part of the key and in this case, d is an independent condition, even though it is part of the key.

The next five WHERE conditions cannot be optimized and produce syntax errors. This is because:

1.  e is not an initial part of the key.
2.  No inequality comparison takes place.
3.  A comparison in a ranges table is specified.
4.  The Boolean operator NOT is used.
5.  An additional OR relationship is used.
    
    DATA: BEGIN OF line,
            a TYPE c LENGTH 3,
            b TYPE c LENGTH 3,
            c TYPE c LENGTH 3,
            d TYPE c LENGTH 3,
            e TYPE c LENGTH 3,
            f TYPE c LENGTH 3,
          END OF line.
    DATA itab LIKE STANDARD TABLE OF line
                   WITH UNIQUE SORTED KEY key COMPONENTS b e d.
    DATA b\_tab LIKE RANGE OF line-b.
    LOOP AT itab INTO line USING KEY key
                 WHERE b = '...'.
    ENDLOOP.
    LOOP AT itab INTO line USING KEY key
                 WHERE a = '...' AND b IS INITIAL.
    ENDLOOP.
    LOOP AT itab INTO line USING KEY key
                 WHERE b = '...' AND e = '...'.
    ENDLOOP.
    LOOP AT itab INTO line USING KEY key
                 WHERE b = '...' AND d IS INITIAL AND e = '...'.
    ENDLOOP.
    LOOP AT itab INTO line USING KEY key
                 WHERE b = '...' AND d <> '...'.
    ENDLOOP.
    LOOP AT itab INTO line USING KEY key
                 WHERE e = '...'.                    "syntax error
    ENDLOOP.
    LOOP AT itab INTO line USING KEY key
                 WHERE b <> '...'.                   "syntax error
    ENDLOOP.
    LOOP AT itab INTO line USING KEY key
                 WHERE b IN b\_tab.                   "syntax error
    ENDLOOP.
    LOOP AT itab INTO line USING KEY key
                 WHERE b = '...'  AND NOT e = '...'. "syntax error
    ENDLOOP.
    LOOP AT itab INTO line USING KEY key             "syntax error
                 WHERE b = '...'  AND ( d = '...' OR e IS INITIAL ).
    ENDLOOP.
    

Requirements Made on the Operands   

The part of the logical expression that can be mapped to a key access must select the same lines as a statement [READ TABLE](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abapread_table.htm) or a corresponding [table expression](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abentable_expressions.htm) that specifies the corresponding components as keys.

-   When comparing incompatible data objects, the WHERE condition is subject to the same [comparison rules](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abenlogexp_rules.htm) for incompatible data types. Here, the data types involved determine which operand is converted to which comparison type.
-   If the additions [WITH TABLE KEY](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abapread_table_key.htm) and [WITH KEY](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abapread_table_free.htm) of the statement READ or [KEY](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abentable_exp_itab_line.htm) in a table expression are used, however, the content of the specified data objects is always converted to the data type of the columns before the comparison.

If this produces differing results, an optimization is not possible. Due to the complexity of the comparison rules, particularly for [elementary data types](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abenlogexp_rules_operands.htm), it is not a good idea to construct a set of rules detailing exactly when the comparison type matches the data type of the left operand. Generally speaking,

-   only fully compatible operands are optimizable,
-   in some cases, elementary operands with different data types can be optimized, if the value ranges or lengths are suitable. For example, a comparison of a column with the type of a floating point number with an operand of type integer or of a column of c with a similar operand, if its length is less than the length of the column.

For this reason, it is advisable to use only pairs of [compatible](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abencompatible_glosry.htm "Glossary Entry") operands in the WHERE condition. This guarantees that the differences in behavior of the WHERE condition and the specified key do not affect the result.

Example

The following example is largely similar to the example in the section WHERE log\_exp in [LOOP AT itab](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abaploop_at_itab_cond.htm). In that case, access takes place using the primary key and no optimization. Here, however, access takes place using a secondary table key and a syntax check warning is produced and an exception raised when the program is executed. The number of lines in the internal table determines whether the exception is raised.

DATA text\_short TYPE c LENGTH 2.
DATA text\_long  TYPE c LENGTH 4.
DATA itab LIKE TABLE OF text\_short
          WITH UNIQUE HASHED KEY key COMPONENTS table\_line.
itab = VALUE #( ( 'AA' )
                ( 'BB' )
                ( 'CC' )
                ( 'DD' )
                ( 'EE' )
                ( 'FF' )
                ( 'GG' )
                ( 'HH' )
                ( 'II' )
                ( 'JJ' )
                ( 'KK' )
                ( 'LL' )
                ( 'MM' ) ).
text\_short = 'AA'.
text\_long  = 'AAXX'.
LOOP AT itab INTO text\_short USING KEY key
             WHERE table\_line = text\_long.
ENDLOOP.
cl\_demo\_output=>write( |LOOP: { sy-subrc }| ).
"Statement
READ TABLE itab INTO text\_short WITH TABLE KEY key
                                COMPONENTS table\_line = text\_long.
cl\_demo\_output=>write( |READ: { sy-subrc }| ).
"Expression
TRY.
    text\_short = itab\[ KEY key COMPONENTS table\_line = text\_long \].
  catch CX\_SY\_ITAB\_LINE\_NOT\_FOUND.
    ...
ENDTRY.
cl\_demo\_output=>display( |Expression: { text\_short }| ).


---


## ABAP - Keyword Documentation / ABAP - Programming Language / Processing External Data / Data Cluster / EXPORT / Export/Import Tables

**Files**: 2 | **Difficulty**: intermediate

# ABAP - Keyword Documentation / ABAP - Programming Language / Processing External Data / Data Cluster / EXPORT / Export/Import Tables

Included pages: 2


### abenexport_data_cluster_indx.htm

---
title: "Hints"
description: |
  -   The structure for data clusters in a row is the newer variant and is recommended for new database tables. -   Status information about the actual data cluster, such as date, user, or language, can be stored in freely definable fields. -   For information about processing export/import tables(h
version: "7.57"
category: "general"
type: "abap-reference"
sourceUrl: "https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abenexport_data_cluster_indx.htm"
abapFile: "abenexport_data_cluster_indx.htm"
keywords: ["select", "delete", "do", "while", "if", "try", "catch", "class", "data", "types", "abenexport", "cluster", "indx"]
---

* * *

AS ABAP Release 757, ©Copyright 2023 SAP SE. All rights reserved.

[ABAP - Keyword Documentation](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abenabap.htm) →  [ABAP - Programming Language](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abenabap_reference.htm) →  [Processing External Data](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abenabap_language_external_data.htm) →  [Data Cluster](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abendata_cluster.htm) →  [EXPORT](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abapexport_data_cluster.htm) → 

 [![](Mail.gif?object=Mail.gif&sap-language=EN "Feedback mail for displayed topic") Mail Feedback](mailto:f1_help@sap.com?subject=Feedback on ABAP Documentation&body=Document: Export/Import Tables, ABENEXPORT_DATA_CLUSTER_INDX, 757%0D%0A%0D%0AError:%0D%0A%0D%0A
%0D%0A%0D%0ASuggestion for improvement:)

Export/Import Tables

When storing [data clusters](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abendata_cluster_glosry.htm "Glossary Entry") in database tables and application buffers of the [shared memory](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abenshared_memory_glosry.htm "Glossary Entry"), database tables with one of the following structures must be specified: These database tables are referred to as [export/import tables](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abenexport_import_table_glosry.htm "Glossary Entry").

-   [Structure for Data Clusters in One Row](#abenexport-data-cluster-indx-1-------structure-for-data-clusters-in-multiple-rows---@ITOC@@ABENEXPORT_DATA_CLUSTER_INDX_2)

Hints

-   The structure for data clusters in a row is the newer variant and is recommended for new database tables.
-   Status information about the actual data cluster, such as date, user, or language, can be stored in freely definable fields.
-   For information about processing [export/import tables](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abenexport_import_table_glosry.htm "Glossary Entry") using SQL, see [SQL Access to Export/Import Tables](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abenindx_type_table_and_sql.htm).
-   When accessing data clusters in export/import tables using the statements [EXPORT ... TO DATABASE](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abapexport_data_cluster.htm) and [IMPORT ... FROM DATABASE](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abapimport_data_cluster.htm), [table buffering](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abentable_buffering_glosry.htm "Glossary Entry") is not supported.

Structure for Data Clusters in One Row   

In export/import table structures like this, the data cluster is stored in a single row in a column CLUSTD of the type [RAWSTRING](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abenddic_builtin_types.htm) ([BLOB](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abenblob_glosry.htm "Glossary Entry")).

-   If the data objects are to be stored as client-dependent objects, the first field must be a key field with the name MANDT of type CLNT for the client. This component is not required for client-independent storage.
-   The next field must be a key field with the name RELID of type CHAR and with length 2. The specification of the area ar is stored here.
-   This must be followed by at least one key field of type CHAR with any name. The identifier specified in id within the length of the key field is stored here. If more than one key field is defined, the identifier is divided among them according to the respective length of the key fields. If the total length of the key fields is not sufficient for the identifier, it is truncated on the right.
-   Any number of fields with freely selectable name and type can follow, which are filled with values by specifying FROM wa. The addition TO wa of the statement IMPORT reads these fields again.
-   The final field must be called CLUSTD and linked with the data element INDX\_CLUST\_BLOB with the dictionary type [RAWSTRING](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abenddic_builtin_types.htm). This column is given the actual data cluster.

Hint

The total length of all [key fields](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abenddic_database_tables_key.htm), that is the total length of MANDT, RELID, and the key fields for the ID, and SRTF2, is limited to 900 bytes, like every AS ABAP [database](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abenddic_database_tables.htm) defined in the ABAP Dictionary. If the table content is to be transported by specifying a key, a limit of 120 bytes is required here.

Example

The database table DEMO\_INDX\_BLOB is an example of how data clusters are stored in a single row.

Structure for Data Clusters in Multiple Rows   

In export/import table structures like this, the data cluster is stored in a column CLUSTD of the type [LRAW](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abenddic_builtin_types.htm) and can be split multiple rows. The structure requires the additional columns SRTF2 and CLUSTR to manage this repository.

-   The structure starts with the same key fields as in the structure above for data clusters in a single row.
-   The next field must be a further key field with the name SRTF2 of type INT4. It contains the row numbers of the data cluster stored in the field CLUSTD. This cluster can span multiple rows and is filled automatically by the system. If more rows are required than allowed by the value range of SRTF2, an uncatchable exception is raised.
-   Any number of fields with custom names and types can follow. The same applies to these fields as to the structure above for data clusters in a single row.
-   The last two components must be called CLUSTR and CLUSTD and have the types [INT2](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abenddic_builtin_types.htm) and [LRAW](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abenddic_builtin_types.htm) of any length. The current length of the field CLUSTD of each row is stored in CLUSTR, while CLUSTD contains the actual data cluster, which can span multiple rows.

Hints

-   When a data cluster is split across multiple rows, the associated administration data must be stored for each row. In each row, the content of the custom fields are stored redundantly.
-   The additional key field SRTF2 is part of the total length of all [key fields](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abenddic_database_tables_key.htm). When table content is transported by specifying a key, the key field SRTF2 does not usually need to be specified since only transports of all rows in a data cluster are feasible.
-   A database table INDX, delivered by SAP, has the layout for a data cluster in multiple rows and can be used as a template for creating custom database tables or for test purposes. In production programs, however, it is strongly recommended that separate [export/import tables](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abenexport_import_table_glosry.htm "Glossary Entry") are used:
    -   When data is stored in the table INDX, data is at risk of being overwritten or deleted unintentionally by other programs.
    -   The custom fields between SRTF2 and CLUSTR do not usually match their own application.
    -   The table INDX has the [delivery class](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abenddic_database_tables_delivery.htm) A and is client-dependent. The delivery class L may be better suited for storing temporary data. If the data needs to be client-independent data, the table used should not contain a client column. This prevents redundant data from being stored.
    -   New export/import tables should be created with a [BLOB](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abenblob_glosry.htm "Glossary Entry") column CLUSTD.
-   Old export/import tables can also occur, however, where the column SRTF2 has the data type INT1 or INT2. In these tables, a data cluster cannot cover more rows than allowed by the value range of these types.

Example

The database table DEMO\_INDX\_TABLE is an example of how data clusters are stored in multiple rows.

Continue
[SQL Access to Export/Import Tables](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abenindx_type_table_and_sql.htm)


### abenindx_type_table_and_sql.htm

---
title: "Example"
description: |
  An export/import table can be searched systematically for a particular data cluster using SELECT. Here, information in the freely definable columns can be evaluated. Example The following example deletes all data clusters of an area from the export/import tables DEMO_INDX_BLOB and DEMO_INDX_TABL
version: "7.57"
category: "general"
type: "abap-reference"
sourceUrl: "https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abenindx_type_table_and_sql.htm"
abapFile: "abenindx_type_table_and_sql.htm"
keywords: ["select", "insert", "update", "delete", "do", "if", "try", "data", "abenindx", "type", "table", "and", "sql"]
---

* * *

AS ABAP Release 757, ©Copyright 2023 SAP SE. All rights reserved.

[ABAP - Keyword Documentation](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abenabap.htm) →  [ABAP - Programming Language](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abenabap_reference.htm) →  [Processing External Data](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abenabap_language_external_data.htm) →  [Data Cluster](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abendata_cluster.htm) →  [EXPORT](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abapexport_data_cluster.htm) →  [Export/Import Tables](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abenexport_data_cluster_indx.htm) → 

 [![](Mail.gif?object=Mail.gif&sap-language=EN "Feedback mail for displayed topic") Mail Feedback](mailto:f1_help@sap.com?subject=Feedback on ABAP Documentation&body=Document: SQL Access to Export/Import Tables, ABENINDX_TYPE_TABLE_AND_SQL, 757%0D%0A%0D%0AError
:%0D%0A%0D%0A%0D%0A%0D%0ASuggestion for improvement:)

SQL Access to Export/Import Tables

[Export/import tables](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abenexport_import_table_glosry.htm "Glossary Entry") are relational databases defined in the ABAP Dictionary. This means that, in principle, SQL statements can also be used to access export/import tables.

To be able to use SQL statements on export/import tables effectively, the [special structure](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abenexport_data_cluster_indx.htm) of these tables must be respected.

It is not a good idea to perform reads or writes on the fields that manage the data cluster, such as CLUSTD or SRTF2 and CLUSTR. These fields contain the data cluster in an internal format and can only be handled correctly using the EXPORT TO DATABASE and IMPORT FROM DATABASE statements.

SQL statements should only be used if the corresponding combination of special data cluster statements would be too inefficient. The SQL statement INSERT should never be used on export/import tables.

ABAP SQL statements can, in certain circumstances, be used for administrative tasks on export/import tables, for which the data cluster specific statements are not suitable.

Example

An export/import table can be searched systematically for a particular data cluster using SELECT. Here, information in the freely definable columns can be evaluated.

Example

The following example deletes all data clusters of an area from the export/import tables DEMO\_INDX\_BLOB and DEMO\_INDX\_TABLE. Each time, all rows of the data cluster are to be deleted.

DELETE FROM demo\_indx\_blob  WHERE relid = '..'.
DELETE FROM demo\_indx\_table WHERE relid = '..'.

Example

The following example demonstrates how the name and area of a data cluster can be changed in the database tables DEMO\_INDX\_BLOB and DEMO\_INDX\_TABLE using UPDATE. Solving this problem using the special cluster statements would be considerably more time-consuming.

UPDATE demo\_indx\_blob
       SET   relid = @new\_relid,
             id    = @new\_id
       WHERE relid = @old\_relid AND
             id    = @old\_id.
UPDATE demo\_indx\_table
       SET   relid = @new\_relid,
             id    = @new\_id
       WHERE relid = @old\_relid AND
             id    = @old\_id.


---


## ABAP - Keyword Documentation / ABAP - Programming Language / SAP GUI User Dialogs / General Dynpros / dynpro - Statements in the Dynpro Flow Logic / dynpro - Table Controls

**Files**: 8 | **Difficulty**: intermediate

# ABAP - Keyword Documentation / ABAP - Programming Language / SAP GUI User Dialogs / General Dynpros / dynpro - Statements in the Dynpro Flow Logic / dynpro - Subscreens, Tabstrips, and Splitter Controls

Included pages: 11


### abendynp_subscreens.htm

---
title: "Continue"
description: |
  dynpro - Including Subscreens Directly(https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abendynp_subscreen.htm) dynpro - Tabstrip Controls(https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abendynp_tabstrip.htm) dynpro - Splitter Controls(https://help.sap.com/doc/abapdocu_75
version: "7.57"
category: "general"
type: "abap-reference"
sourceUrl: "https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abendynp_subscreens.htm"
abapFile: "abendynp_subscreens.htm"
keywords: ["do", "if", "try", "abendynp", "subscreens"]
---

* * *

AS ABAP Release 757, ©Copyright 2023 SAP SE. All rights reserved.

[ABAP - Keyword Documentation](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abenabap.htm) →  [ABAP - Programming Language](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abenabap_reference.htm) →  [SAP GUI User Dialogs](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abenabap_screens.htm) →  [General Dynpros](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abenabap_dynpros.htm) →  [dynpro - Statements in the Dynpro Flow Logic](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abenabap_dynpros_dynpro_statements.htm) → 

 [![](Mail.gif?object=Mail.gif&sap-language=EN "Feedback mail for displayed topic") Mail Feedback](mailto:f1_help@sap.com?subject=Feedback on ABAP Documentation&body=Document: dynpro - Subscreens, Tabstrips, and Splitter Controls, ABENDYNP_SUBSCREENS, 757%0D%0A
%0D%0AError:%0D%0A%0D%0A%0D%0A%0D%0ASuggestion for improvement:)

dynpro - Subscreens, Tabstrips, and Splitter Controls

Subscreens are screen layouts of special subscreen dynpros that can be included in other dynpros. Subscreens are either included directly, or using special [controls](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abencontrol_glosry.htm "Glossary Entry").

-   [Including Subscreens Directly](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abendynp_subscreen.htm)
-   [Tabstrip Controls](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abendynp_tabstrip.htm)
-   [Splitter Controls](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abendynp_splitter_control_spcl.htm)

Continue
[dynpro - Including Subscreens Directly](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abendynp_subscreen.htm)
[dynpro - Tabstrip Controls](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abendynp_tabstrip.htm)
[dynpro - Splitter Controls](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abendynp_splitter_control_spcl.htm)
[dynpro - CALL SUBSCREEN](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/dynpcall.htm)
[dynpro - Examples of Subscreens, Tabstrips, and Splitter Controls](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abentab_strip_control_abexas.htm)


### abendynp_subscreen.htm

---
title: "Hint"
description: |
  Subscreens dynpros are defined like regular dynpros in the Screen Painter(https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abenscreen_painter_glosry.htm 'Glossary Entry') and are flagged there as regular dynpros. Selection screens(https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en
version: "7.57"
category: "general"
type: "abap-reference"
sourceUrl: "https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abendynp_subscreen.htm"
abapFile: "abendynp_subscreen.htm"
keywords: ["select", "do", "if", "try", "abendynp", "subscreen"]
---

* * *

AS ABAP Release 757, ©Copyright 2023 SAP SE. All rights reserved.

[ABAP - Keyword Documentation](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abenabap.htm) →  [ABAP - Programming Language](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abenabap_reference.htm) →  [SAP GUI User Dialogs](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abenabap_screens.htm) →  [General Dynpros](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abenabap_dynpros.htm) →  [dynpro - Statements in the Dynpro Flow Logic](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abenabap_dynpros_dynpro_statements.htm) →  [dynpro - Subscreens, Tabstrips, and Splitter Controls](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abendynp_subscreens.htm) → 

 [![](Mail.gif?object=Mail.gif&sap-language=EN "Feedback mail for displayed topic") Mail Feedback](mailto:f1_help@sap.com?subject=Feedback on ABAP Documentation&body=Document: dynpro - Including Subscreens Directly, ABENDYNP_SUBSCREEN, 757%0D%0A%0D%0AError:%0D%
0A%0D%0A%0D%0A%0D%0ASuggestion for improvement:)

dynpro - Including Subscreens Directly

The statement [CALL SUBSCREEN](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/dynpcall.htm) can be used to include other screen layouts directly in the [screen layout](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abenscreen_glosry.htm "Glossary Entry") of a [dynpro](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abendynpro_glosry.htm "Glossary Entry") in the form of subscreens. Here, subscreen areas must first be defined in the screen layout of the current dynpro. Every subscreen area has a unique name and can be configured to support changes in screen size. If the latter is defined, each size change in the current GUI window raises the [PAI](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abenpai_glosry.htm "Glossary Entry") event.

Subscreens are the screen layouts of special [subscreen dynpros](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abensubscreen_dynpro_glosry.htm "Glossary Entry"). When a subscreen is included, the flow logic of the subscreen dynpro is also included. Subscreens can also include other subscreens. Subscreens cannot have their own OK field. Instead, user actions on subscreens pass the function codes to the OK field of the including dynpro. In the PAI event block of a subscreen dynpro, a [MODULE](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/dynpmodule.htm) statement is never executed with the AT EXIT-COMMAND addition.

Hint

Subscreens dynpros are defined like regular dynpros in the [Screen Painter](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abenscreen_painter_glosry.htm "Glossary Entry") and are flagged there as regular dynpros. [Selection screens](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abapselection-screen_subscreen.htm) can also be defined as subscreens.

Executable Example

[Dynpros, Subscreens](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abendynpro_subscreen_abexa.htm)


### abendynp_tabstrip.htm

---
title: "Hint"
description: |
  If a tab title is selected when browsing in the SAP GUI, input checks are not made, and data is not transported to the ABAP program. The entries are all checked and the data of all subscreens transported only if a user action raises the PAI event. When browsing in the ABAP program, the input is chec
version: "7.57"
category: "general"
type: "abap-reference"
sourceUrl: "https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abendynp_tabstrip.htm"
abapFile: "abendynp_tabstrip.htm"
keywords: ["select", "do", "if", "try", "data", "abendynp", "tabstrip"]
---

* * *

AS ABAP Release 757, ©Copyright 2023 SAP SE. All rights reserved.

[ABAP - Keyword Documentation](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abenabap.htm) →  [ABAP - Programming Language](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abenabap_reference.htm) →  [SAP GUI User Dialogs](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abenabap_screens.htm) →  [General Dynpros](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abenabap_dynpros.htm) →  [dynpro - Statements in the Dynpro Flow Logic](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abenabap_dynpros_dynpro_statements.htm) →  [dynpro - Subscreens, Tabstrips, and Splitter Controls](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abendynp_subscreens.htm) → 

 [![](Mail.gif?object=Mail.gif&sap-language=EN "Feedback mail for displayed topic") Mail Feedback](mailto:f1_help@sap.com?subject=Feedback on ABAP Documentation&body=Document: dynpro - Tabstrip Controls, ABENDYNP_TABSTRIP, 757%0D%0A%0D%0AError:%0D%0A%0D%0A%0D%0
A%0D%0ASuggestion for improvement:)

dynpro - Tabstrip Controls

A tabstrip control is a screen element that consists of multiple tab pages. Every tab page contains a single-line [tab title](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abentab_title_glosry.htm "Glossary Entry") linked with a function code and which can be used to select the tab page by clicking it once. Under the tab title, a tab page consists of a subscreen area. Each tab title must have a subscreen area assigned to it, in which any subscreens can be displayed. There are two ways to do this:

-   Browsing in SAP GUI
    
    A separate subscreen area is assigned to each tab title and the function codes of the tab titles are defined with the function type "P". If the user selects a tab title, the event PAI is not raised. The associated subscreens are included once in each individual subscreen area by using the [CALL SUBSCREEN](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/dynpcall.htm) statement of the flow logic. If the user selects a tab title, the SAP GUI browses to the associated tab page and displays its subscreen.
    
-   Browsing in ABAP Programs
    
    The same subscreen area is assigned to each tab title, and the function codes of the tab titles are defined without [typing](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abentyping_glosry.htm "Glossary Entry"). If the user selects a tab title, the event PAI is raised. The associated subscreen is included dynamically using the [CALL SUBSCREEN](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/dynpcall.htm) statement of the flow logic in the subscreen area each time the user browses. In the ABAP program, the associated tab page must be activated using [CONTROLS](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abapcontrols.htm) and the correct subscreen dynpro for the subscreen area must be specified.
    

Hint

If a tab title is selected when browsing in the SAP GUI, input checks are not made, and data is not transported to the ABAP program. The entries are all checked and the data of all subscreens transported only if a user action raises the PAI event. When browsing in the ABAP program, the input is checked each time a tab title is selected, and the current tab page data is transported to the ABAP program of the subscreen dynpro.

Executable Examples

-   [Dynpros, Tabstrips with Scrolling in SAP GUI](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abentab_strip_control1_abexa.htm)
-   [Dynpros, Tabstrips with Scrolling in AS instance](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abentab_strip_control2_abexa.htm)


### abendynp_splitter_control_spcl.htm

---
title: "Hints"
description: |
  -   A splitter control can only be created in the alphanumeric Screen Painter by using Edit → Create Element → Splitter Control. For this reason, it should only be used in cases when the functions offered are required on classic dynpros. SAPUI5(https://help.sap.com/doc/abapdocu_757_index_htm/7.57/
version: "7.57"
category: "general"
type: "abap-reference"
sourceUrl: "https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abendynp_splitter_control_spcl.htm"
abapFile: "abendynp_splitter_control_spcl.htm"
keywords: ["do", "while", "if", "case", "try", "method", "class", "abendynp", "splitter", "control", "spcl"]
---

* * *

AS ABAP Release 757, ©Copyright 2023 SAP SE. All rights reserved.

[ABAP - Keyword Documentation](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abenabap.htm) →  [ABAP - Programming Language](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abenabap_reference.htm) →  [SAP GUI User Dialogs](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abenabap_screens.htm) →  [General Dynpros](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abenabap_dynpros.htm) →  [dynpro - Statements in the Dynpro Flow Logic](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abenabap_dynpros_dynpro_statements.htm) →  [dynpro - Subscreens, Tabstrips, and Splitter Controls](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abendynp_subscreens.htm) → 

 [![](Mail.gif?object=Mail.gif&sap-language=EN "Feedback mail for displayed topic") Mail Feedback](mailto:f1_help@sap.com?subject=Feedback on ABAP Documentation&body=Document: dynpro - Splitter Controls, ABENDYNP_SPLITTER_CONTROL_SPCL, 757%0D%0A%0D%0AError:%0D%
0A%0D%0A%0D%0A%0D%0ASuggestion for improvement:)

dynpro - Splitter Controls

A splitter control is a screen element that divides the area it covers either horizontally into two adjacent [subscreen areas](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abensubscreen_arrea_glosry.htm "Glossary Entry") or vertically one above each other. The division is made by a sash. The horizontal or vertical position of the sash is specified statically in the definition of the splitter control. It can be set to PBO in the ABAP program and changed by the user while the screen layout is displayed.

[Subscreen dynpros](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abensubscreen_dynpro_glosry.htm "Glossary Entry") are included in both subscreen areas in exactly the same way as [direct inclusion](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abendynp_subscreen.htm) using the [CALL SUBSCREEN](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/dynpcall.htm) statement in the dynpro flow logic. Any subscreens can be included, particularly those that contain splitter controls again.

In ABAP programs, the position of the sash of a splitter controls is controlled using an instance of the CL\_DYNPRO\_SPLITTER class. If, before sending this screen layout, an object of this class is created and its constructor is given the name of a splitter control, this is bound to the splitter control and its methods can be used to set and read the position of the sash. The sash position is specified as a percentage and refers to the width or height of the splitter control. In the object, the position is represented by a private attribute. Important methods of the class are:

-   GET\_GUISASH
    
    At PAI sets the sash position of the object to the current value of the bound splitter control.
    
-   SET\_SASH
    
    If no value is passed to the POSITION parameter, the method sets the sash position of the bound splitter control at PBO to the value of the object. If a value is passed to the POSITION parameter, the method sets the attribute of the object and the sash position of the bound splitter control at PBO to this value. At PAI, only the attribute of the object is set.
    
-   GET\_SASH
    
    Returns the sash position of the bound splitter control at PBO and PAI.
    

A splitter control can have a [function code](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abenfunction_code_glosry.htm "Glossary Entry") assigned to it, which can be used to react to changes to the sash position made by the user in ABAP programs.

Hints

-   A splitter control can only be created in the alphanumeric Screen Painter by using Edit → Create Element → Splitter Control. For this reason, it should only be used in cases when the functions offered are required on classic dynpros. [SAPUI5](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abensapui5_glosry.htm "Glossary Entry") or [Web Dynpro ABAP](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abenweb_dynpro_glosry.htm "Glossary Entry") should be used for new developments instead of classic dynpros.
-   Splitter controls offer certain advantages over the corresponding [CFW](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abencfw_glosry.htm "Glossary Entry") containers. One advantage is that they allow all screen elements of a classic dynpro to be displayed directly in a flexible frame. Another is that they have better performance than CFW controls. An example of intensive use of splitter controls is the flexible interface of the ABAP Debugger.

Executable Example

[Dynpros, Splitter Controls](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abendynpro_splitter_control_abexa.htm)


### dynpcall.htm

---
title: "Syntax"
description: |
  CALL SUBSCREEN sub_area INCLUDING prog dynnr. Variants: 1. CALL SUBSCREEN sub_area INCLUDING prog dynnr.(#!ABAP_VARIANT_1@1@) 2. CALL SUBSCREEN sub_area.(#!ABAP_VARIANT_2@2@) Effect Includes a subscreen(https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abensubscreen_glosr
version: "7.57"
category: "general"
type: "abap-reference"
sourceUrl: "https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/dynpcall.htm"
abapFile: "dynpcall.htm"
keywords: ["loop", "do", "if", "try", "catch", "data", "dynpcall"]
---

* * *

AS ABAP Release 757, ©Copyright 2023 SAP SE. All rights reserved.

[ABAP - Keyword Documentation](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abenabap.htm) →  [ABAP - Programming Language](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abenabap_reference.htm) →  [SAP GUI User Dialogs](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abenabap_screens.htm) →  [General Dynpros](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abenabap_dynpros.htm) →  [dynpro - Statements in the Dynpro Flow Logic](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abenabap_dynpros_dynpro_statements.htm) →  [dynpro - Subscreens, Tabstrips, and Splitter Controls](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abendynp_subscreens.htm) → 

 [![](Mail.gif?object=Mail.gif&sap-language=EN "Feedback mail for displayed topic") Mail Feedback](mailto:f1_help@sap.com?subject=Feedback on ABAP Documentation&body=Document: dynpro - CALL SUBSCREEN, DYNPCALL, 757%0D%0A%0D%0AError:%0D%0A%0D%0A%0D%0A%0D%0ASugge
stion for improvement:)

dynpro - CALL SUBSCREEN

Syntax

CALL SUBSCREEN sub\_area *\[*INCLUDING prog dynnr*\]*.

Variants:

[1\. CALL SUBSCREEN sub\_area INCLUDING prog dynnr.](#!ABAP_VARIANT_1@1@)
[2\. CALL SUBSCREEN sub\_area.](#!ABAP_VARIANT_2@2@)

Effect

Includes a [subscreen](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abensubscreen_glosry.htm "Glossary Entry") in the [dynpro flow logic](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abendynpro_flow_logic_glosry.htm "Glossary Entry"). There is one variant for the event [PBO](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abenpbo_glosry.htm "Glossary Entry") and one variant for the event [PAI](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abenpai_glosry.htm "Glossary Entry"). The statement CALL SUBSCREEN cannot be used between the statements LOOP and ENDLOOP or CHAIN and ENDCHAIN.

Hints

-   The statement CALL SUBSCREEN is required to [include](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abendynp_subscreen.htm) subscreens directly and to include them using [tabstrips](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abendynp_tabstrip.htm) or [splitter controls](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abendynp_splitter_control_spcl.htm).
-   An obsolete variant of this statement is [CALL CUSTOMER SUBSCREEN](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/dynpcall_customer_subscreen.htm).

Variant 1   

CALL SUBSCREEN sub\_area INCLUDING prog dynnr.

Effect

PBO

This statement is used to include the [subscreen dynpro](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abensubscreen_dynpro_glosry.htm "Glossary Entry") of the program defined in prog and the dynpro number defined in dynnr in the [subscreen area](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abensubscreen_arrea_glosry.htm "Glossary Entry") sub\_area of the current dynpro, and processes its PBO flow logic at this point. After PBO processing of the subscreen dynpro, the flow logic of the current dynpro is continued after the CALL statement.

The area sub\_area must be specified directly. prog expects either a two-character data object from the current ABAP program or a text field literal. dynnr expects a data object of the type n and length 4 from the current ABAP program or a text field literal. An uncatchable exception is raised if the specified subscreen dynpro cannot be found. If no subscreen dynpro is included for PBO in a subscreen area, the area remains empty.

If the specified subscreen dynpro is not defined in the current ABAP program, the specified program is loaded into the [internal session](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abeninternal_session_glosry.htm "Glossary Entry") and [LOAD-OF-PROGRAM](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abapload-of-program.htm) is raised. If the object is a [function pool](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abenfunction_pool_glosry.htm "Glossary Entry"), a new [additional program group](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abenadditional_prog_group_glosry.htm "Glossary Entry") is created. If the object is an [executable program](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abenexecutable_program_glosry.htm "Glossary Entry") or a [module pool](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abenmodul_pool_glosry.htm "Glossary Entry"), the program is loaded to the [program group](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abenprogram_group_glosry.htm "Glossary Entry") of the current program.

The flow logic of the subscreen dynpro calls the dialog modules of its own ABAP program and the global fields of its own program are transported to the subscreen dynpro. When a subscreen is being processed, sy-dynnr contains the dynpro number of the subscreen.

The GUI status and the current next dynpro cannot be changed in the dialog modules of the subscreen, and the statements SET *{* TITLEBAR *|* PF-STATUS *}* and *{* LEAVE *|* SET *}* SCREEN raise an uncatchable exception there.

Variant 2   

CALL SUBSCREEN sub\_area.

Effect

PAI

The statement calls the PAI flow logic of the [subscreen dynpro](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abensubscreen_dynpro_glosry.htm "Glossary Entry") included in the sub\_area [subscreen area](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abensubscreen_arrea_glosry.htm "Glossary Entry"). The subscreen dynpro must be included in the subscreen area for PBO (see variant 1). The same applies to the dialog modules called by the PAI flow logic as to the modules called by PBO. The data transport between the subscreen dynpro and its ABAP program is performed at the call, or is delayed when [FIELD](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/dynpfield.htm) statements are executed in the PAI flow logic of the subscreen logic.

Hints

-   If the use of subscreens means that the names of the displayed screen elements are not unique, multiple dynpro fields can be assigned to a global data object of the ABAP program, and, accordingly, multiple transports can be performed for PBO and PAI.
-   Since function codes from the subscreen dynpro are moved to the OK field of the including dynpro, it is advisable to give these function codes unique names.
-   Since the dynpro fields of subscreen dynpros are transported to the global data objects of the program in which the subscreen dynpros are defined, it must be ensured that the calling program is provided with this data when called externally. If reusable subscreen dynpros are to be defined, it is advisable to encapsulate them in function pools and to use function modules to enable the caller to set and use the global data.

Example

If a tabstrip control with untyped tabstrips and a subscreen area called SUB is defined on a dynpro, the associated dynpro flow logic can appear as follows. The statement CALL SUBSCREEN includes the subscreen dynpro of the same ABAP program whose number is in the ABAP data object dynnr in the subscreen area SUB. The associated programming section of the ABAP program is in the example for [CONTROLS](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abapcontrols_tabstrip.htm).

PROCESS BEFORE OUTPUT.
  MODULE prepare\_tabstrip.
  CALL SUBSCREEN sub INCLUDING sy-repid dynnr.
PROCESS AFTER INPUT.
  CALL SUBSCREEN sub.
  MODULE handle\_user\_command.


### abentab_strip_control_abexas.htm

---
title: "Continue"
description: |
  !Example(exa.gif 'Example') dynpro - Subscreens(https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abendynpro_subscreen_abexa.htm) !Example(exa.gif 'Example') dynpro - Tabstrips with Scrolling in SAP GUI(https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abentab_strip_control
version: "7.57"
category: "general"
type: "abap-reference"
sourceUrl: "https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abentab_strip_control_abexas.htm"
abapFile: "abentab_strip_control_abexas.htm"
keywords: ["do", "if", "abentab", "strip", "control", "abexas"]
---

* * *

AS ABAP Release 757, ©Copyright 2023 SAP SE. All rights reserved.

[ABAP - Keyword Documentation](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abenabap.htm) →  [ABAP - Programming Language](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abenabap_reference.htm) →  [SAP GUI User Dialogs](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abenabap_screens.htm) →  [General Dynpros](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abenabap_dynpros.htm) →  [dynpro - Statements in the Dynpro Flow Logic](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abenabap_dynpros_dynpro_statements.htm) →  [dynpro - Subscreens, Tabstrips, and Splitter Controls](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abendynp_subscreens.htm) → 

 [![](Mail.gif?object=Mail.gif&sap-language=EN "Feedback mail for displayed topic") Mail Feedback](mailto:f1_help@sap.com?subject=Feedback on ABAP Documentation&body=Document: dynpro - Examples of Subscreens, Tabstrips, and Splitter Controls, ABENTAB_STRIP_CONT
ROL_ABEXAS, 757%0D%0A%0D%0AError:%0D%0A%0D%0A%0D%0A%0D%0ASuggestion for improvement:)

dynpro - Examples of Subscreens, Tabstrips, and Splitter Controls

Continue
![Example](exa.gif "Example") [dynpro - Subscreens](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abendynpro_subscreen_abexa.htm)
![Example](exa.gif "Example") [dynpro - Tabstrips with Scrolling in SAP GUI](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abentab_strip_control1_abexa.htm)
![Example](exa.gif "Example") [dynpro - Tabstrips with Scrolling on the ABAP Server](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abentab_strip_control2_abexa.htm)
![Example](exa.gif "Example") [dynpro - Splitter Control](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abendynpro_splitter_control_abexa.htm)


### abendynpro_subscreen_abexa.htm

---
title: "Source Code"
description: |
  REPORT demo_dynpro_subscreens. DATA: ok_code TYPE sy-ucomm, save_ok TYPE sy-ucomm. DATA: number1(4) TYPE n VALUE '0110', number2(4) TYPE n VALUE '0130', field(10) TYPE c, field1(10) TYPE c, field2(10) TYPE c. CALL SCREEN 100. MODULE status_100 OUTPUT. SET PF-STATUS 'SCREEN_100'. ENDMODULE. MOD
version: "7.57"
category: "general"
type: "abap-reference"
sourceUrl: "https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abendynpro_subscreen_abexa.htm"
abapFile: "abendynpro_subscreen_abexa.htm"
keywords: ["do", "if", "case", "try", "data", "abendynpro", "subscreen", "abexa"]
---

* * *

AS ABAP Release 757, ©Copyright 2023 SAP SE. All rights reserved.

[ABAP - Keyword Documentation](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abenabap.htm) →  [ABAP - Programming Language](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abenabap_reference.htm) →  [SAP GUI User Dialogs](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abenabap_screens.htm) →  [General Dynpros](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abenabap_dynpros.htm) →  [dynpro - Statements in the Dynpro Flow Logic](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abenabap_dynpros_dynpro_statements.htm) →  [dynpro - Subscreens, Tabstrips, and Splitter Controls](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abendynp_subscreens.htm) →  [dynpro - Examples of Subscreens, Tabstrips, and Splitter Controls](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abentab_strip_control_abexas.htm) → 

 [![](Mail.gif?object=Mail.gif&sap-language=EN "Feedback mail for displayed topic") Mail Feedback](mailto:f1_help@sap.com?subject=Feedback on ABAP Documentation&body=Document: dynpro - Subscreens, ABENDYNPRO_SUBSCREEN_ABEXA, 757%0D%0A%0D%0AError:%0D%0A%0D%0A%0D
%0A%0D%0ASuggestion for improvement:)

dynpro - Subscreens

This example demonstrates how to include subscreens.

Source Code   

REPORT demo\_dynpro\_subscreens.
DATA: ok\_code TYPE sy-ucomm,
      save\_ok TYPE sy-ucomm.
DATA: number1(4) TYPE n VALUE '0110',
      number2(4) TYPE n VALUE '0130',
      field(10) TYPE c, field1(10) TYPE c, field2(10) TYPE c.
CALL SCREEN 100.
MODULE status\_100 OUTPUT.
  SET PF-STATUS 'SCREEN\_100'.
ENDMODULE.
MODULE fill\_0110 OUTPUT.
  field = 'Entry 1'(001).
ENDMODULE.
MODULE fill\_0120 OUTPUT.
  field = field1.
ENDMODULE.
MODULE fill\_0130 OUTPUT.
  field = 'Entry 2'(002).
ENDMODULE.
MODULE fill\_0140 OUTPUT.
  field = field2.
ENDMODULE.
MODULE cancel INPUT.
  LEAVE PROGRAM.
ENDMODULE.
MODULE save\_ok INPUT.
  save\_ok = ok\_code.
  CLEAR ok\_code.
ENDMODULE.
MODULE user\_command\_0110 INPUT.
  IF save\_ok = 'OK1'.
    number1 = '0120'.
    field1 = field.
    CLEAR field.
  ENDIF.
ENDMODULE.
MODULE user\_command\_0130 INPUT.
  IF save\_ok = 'OK2'.
    number2 = '0140'.
    field2 = field.
    CLEAR field.
  ENDIF.
ENDMODULE.
MODULE user\_command\_100 INPUT.
  CASE save\_ok.
    WHEN 'SUB1'.
      number1 = '0110'.
    WHEN 'SUB2'.
      number1 = '0120'.
      CLEAR field1.
    WHEN 'SUB3'.
      number2 = '0130'.
    WHEN 'SUB4'.
      number2 = '0140'.
      CLEAR field2.
  ENDCASE.
ENDMODULE.

Description   

The static next dynpro number of dynpro 100 is 100. Four pushbuttons with function codes SUB1 to SUB4 and two identically sized subscreen areas area1 and area2 have been created. In the same ABAP program, four subscreen dynpros 110 to 140 are defined. The input/output field of all four subscreen dynpro has the name field. The function codes of the pushbuttons on the subscreen dynpros 110 and 130 are OK1 and OK2. The dynpro flow logic for dynpro 100 is as follows:

PROCESS BEFORE OUTPUT.
  MODULE status\_100.
  CALL SUBSCREEN: area1 INCLUDING sy-repid number1,
                  area2 INCLUDING sy-repid number2.
PROCESS AFTER INPUT.
  MODULE cancel AT EXIT-COMMAND.
  MODULE save\_ok.
  CALL SUBSCREEN: area1,
                  area2.
  MODULE user\_command\_100.

The dynpro flow logic of subscreen dynpros 110 and 130 is:

PROCESS BEFORE OUTPUT.
  MODULE fill\_0110*|*0130.
PROCESS AFTER INPUT.
  MODULE user\_command\_0110*|*0130.

The dynpro flow logic of subscreen dynpros 120 and 140 is:

PROCESS BEFORE OUTPUT.
  MODULE fill\_0120*|*0150.
PROCESS AFTER INPUT.

When the program is executed, a screen appears on which subscreens 110 and 130 are displayed. The pushbuttons on the main dynpro allow the user to choose between two subscreen dynpros for each screen area. The pushbuttons on the subscreen dynpros 110 and 130 allow data to be passed to the subscreen dynpros 120 and 140.

Since all subscreen dynpros use the same field name field, the identically named ABAP field is transported more than once at each PBO and PAI of the main dynpro. For this reason, the values must be stored in the auxiliary fields field1 and field2 in the ABAP program.

The function code of the pushbuttons of the subscreen dynpros is different and regular handling in an ABAP field is enough. If the function codes had the same names, it would be necessary to use multiple helper fields here as well.


### abentab_strip_control1_abexa.htm

---
title: "Source Code"
description: |
  REPORT demo_dynpro_tabstrip_local. CONTROLS mytabstrip TYPE TABSTRIP. DATA: ok_code TYPE sy-ucomm, save_ok TYPE sy-ucomm. mytabstrip-activetab = 'PUSH2'. CALL SCREEN 100. MODULE status_0100 OUTPUT. SET PF-STATUS 'SCREEN_100'. ENDMODULE. MODULE cancel INPUT. LEAVE PROGRAM. ENDMODULE. MODULE us
version: "7.57"
category: "general"
type: "abap-reference"
sourceUrl: "https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abentab_strip_control1_abexa.htm"
abapFile: "abentab_strip_control1_abexa.htm"
keywords: ["do", "if", "data", "abentab", "strip", "control1", "abexa"]
---

* * *

AS ABAP Release 757, ©Copyright 2023 SAP SE. All rights reserved.

[ABAP - Keyword Documentation](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abenabap.htm) →  [ABAP - Programming Language](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abenabap_reference.htm) →  [SAP GUI User Dialogs](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abenabap_screens.htm) →  [General Dynpros](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abenabap_dynpros.htm) →  [dynpro - Statements in the Dynpro Flow Logic](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abenabap_dynpros_dynpro_statements.htm) →  [dynpro - Subscreens, Tabstrips, and Splitter Controls](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abendynp_subscreens.htm) →  [dynpro - Examples of Subscreens, Tabstrips, and Splitter Controls](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abentab_strip_control_abexas.htm) → 

 [![](Mail.gif?object=Mail.gif&sap-language=EN "Feedback mail for displayed topic") Mail Feedback](mailto:f1_help@sap.com?subject=Feedback on ABAP Documentation&body=Document: dynpro - Tabstrips with Scrolling in SAP GUI, ABENTAB_STRIP_CONTROL1_ABEXA, 757%0D%0A
%0D%0AError:%0D%0A%0D%0A%0D%0A%0D%0ASuggestion for improvement:)

dynpro - Tabstrips with Scrolling in SAP GUI

This example demonstrates the use of tabstrip controls with local scrolling.

Source Code   

REPORT demo\_dynpro\_tabstrip\_local.
CONTROLS mytabstrip TYPE TABSTRIP.
DATA: ok\_code TYPE sy-ucomm,
      save\_ok TYPE sy-ucomm.
mytabstrip-activetab = 'PUSH2'.
CALL SCREEN 100.
MODULE status\_0100 OUTPUT.
  SET PF-STATUS 'SCREEN\_100'.
ENDMODULE.
MODULE cancel INPUT.
  LEAVE PROGRAM.
ENDMODULE.
MODULE user\_command INPUT.
  save\_ok = ok\_code.
  CLEAR ok\_code.
  IF save\_ok = 'OK'.
    MESSAGE i888(sabapdemos) WITH 'MYTABSTRIP-ACTIVETAB ='
                                  mytabstrip-activetab.
  ENDIF.
ENDMODULE.

Description   

The static next dynpro number of dynpro 100 is 100. It is a tabstrip page called mytabstrip created with three tabs, PUSH1, PUSH2, PUSH3 and identically named function codes of type p. One of the subscreen areas sub1 to sub3 is assigned to each tab title. The push button is called BUTTON and has the function code OK. Three subscreen dynpros 110 to 130 are also defined that fit into the subscreen areas mentioned above. The dynpro flow logic of subscreens 110 to 130 does not contain any module calls.

When the program is executed, the user sees a screen, the second tab page of which is active because before dynpro 100 is called, the component activetab of the structure mytabstrip is set to PUSH2. The user can scroll between the tab pages without raising the event PAI. One of the three subscreen dynpros is included on each tab page.

When the user chooses Continue, the PAI event is raised, and an information message displays the function code of the tab title of the page that is currently active.


### abentab_strip_control2_abexa.htm

---
title: "Source Code"
description: |
  REPORT demo_dynpro_tabstrip_server. CONTROLS mytabstrip TYPE TABSTRIP. DATA: ok_code TYPE sy-ucomm, save_ok TYPE sy-ucomm. DATA  number TYPE sy-dynnr. mytabstrip-activetab = 'PUSH2'. number = '0120'. CALL SCREEN 100. MODULE status_0100 OUTPUT. SET PF-STATUS 'SCREEN_100'. ENDMODULE. MODULE can
version: "7.57"
category: "general"
type: "abap-reference"
sourceUrl: "https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abentab_strip_control2_abexa.htm"
abapFile: "abentab_strip_control2_abexa.htm"
keywords: ["do", "if", "case", "data", "abentab", "strip", "control2", "abexa"]
---

* * *

AS ABAP Release 757, ©Copyright 2023 SAP SE. All rights reserved.

[ABAP - Keyword Documentation](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abenabap.htm) →  [ABAP - Programming Language](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abenabap_reference.htm) →  [SAP GUI User Dialogs](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abenabap_screens.htm) →  [General Dynpros](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abenabap_dynpros.htm) →  [dynpro - Statements in the Dynpro Flow Logic](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abenabap_dynpros_dynpro_statements.htm) →  [dynpro - Subscreens, Tabstrips, and Splitter Controls](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abendynp_subscreens.htm) →  [dynpro - Examples of Subscreens, Tabstrips, and Splitter Controls](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abentab_strip_control_abexas.htm) → 

 [![](Mail.gif?object=Mail.gif&sap-language=EN "Feedback mail for displayed topic") Mail Feedback](mailto:f1_help@sap.com?subject=Feedback on ABAP Documentation&body=Document: dynpro - Tabstrips with Scrolling on the ABAP Server, ABENTAB_STRIP_CONTROL2_ABEXA, 7
57%0D%0A%0D%0AError:%0D%0A%0D%0A%0D%0A%0D%0ASuggestion for improvement:)

dynpro - Tabstrips with Scrolling on the ABAP Server

This example demonstrates the use of tabstrip controls with centralized scrolling.

Source Code   

REPORT demo\_dynpro\_tabstrip\_server.
CONTROLS mytabstrip TYPE TABSTRIP.
DATA: ok\_code TYPE sy-ucomm,
      save\_ok TYPE sy-ucomm.
DATA  number TYPE sy-dynnr.
mytabstrip-activetab = 'PUSH2'.
number = '0120'.
CALL SCREEN 100.
MODULE status\_0100 OUTPUT.
  SET PF-STATUS 'SCREEN\_100'.
ENDMODULE.
MODULE cancel INPUT.
  LEAVE PROGRAM.
ENDMODULE.
MODULE user\_command INPUT.
  save\_ok = ok\_code.
  CLEAR ok\_code.
  IF save\_ok = 'OK'.
    MESSAGE i888(sabapdemos) WITH 'MYTABSTRIP-ACTIVETAB ='
                                  mytabstrip-activetab.
  ELSE.
    mytabstrip-activetab = save\_ok.
    CASE save\_ok.
      WHEN 'PUSH1'.
        number = '0110'.
      WHEN 'PUSH2'.
        number = '0120'.
      WHEN 'PUSH3'.
        number = '0130'.
    ENDCASE.
  ENDIF.
ENDMODULE.

Description   

The static next dynpro number of dynpro 100 is 100. The layout of dynpro 100 and the subscreen dynpros 110 to 130 is the same as in the [executable example](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abentab_strip_control1_abexa.htm) with local scrolling. The function codes of the three tab titles are not typed and a common subscreen area sub is assigned to all tab titles.

The dynpro flow logic of dynpro 100 makes a dynamic binding to PBO, a subscreen dynpro in the subscreen area sub. The dynpro flow logic of subscreen dynpros 110 to 130 does not contain any module calls.

This example works in exactly the same way as the [example with local scrolling](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abentab_strip_control1_abexa.htm) except that scrolling between the tabstrip pages is programmed in the ABAP program. Each time the user chooses a tab title, the function code from the OK field is assigned to the activetab component of structure mytabstrip. At the same time, the variable number is given the dynpro number of the subscreen dynpro to be displayed in the subscreen area SUB of the tabstrip.


### abendynpro_splitter_control_abexa.htm

---
title: "Source Code"
description: |
  REPORT demo_dynpro_splitter_control. DATA splitter TYPE REF TO cl_dynpro_splitter. START-OF-SELECTION. CREATE OBJECT splitter EXPORTING splitter_name = 'SPLITTER'. CALL SCREEN 100. MODULE set_status OUTPUT. SET PF-STATUS 'SCREEN_100'. ENDMODULE. MODULE set_sash OUTPUT. splitter->set_sash(
version: "7.57"
category: "general"
type: "abap-reference"
sourceUrl: "https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abendynpro_splitter_control_abexa.htm"
abapFile: "abendynpro_splitter_control_abexa.htm"
keywords: ["select", "do", "if", "try", "data", "abendynpro", "splitter", "control", "abexa"]
---

* * *

AS ABAP Release 757, ©Copyright 2023 SAP SE. All rights reserved.

[ABAP - Keyword Documentation](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abenabap.htm) →  [ABAP - Programming Language](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abenabap_reference.htm) →  [SAP GUI User Dialogs](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abenabap_screens.htm) →  [General Dynpros](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abenabap_dynpros.htm) →  [dynpro - Statements in the Dynpro Flow Logic](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abenabap_dynpros_dynpro_statements.htm) →  [dynpro - Subscreens, Tabstrips, and Splitter Controls](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abendynp_subscreens.htm) →  [dynpro - Examples of Subscreens, Tabstrips, and Splitter Controls](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abentab_strip_control_abexas.htm) → 

 [![](Mail.gif?object=Mail.gif&sap-language=EN "Feedback mail for displayed topic") Mail Feedback](mailto:f1_help@sap.com?subject=Feedback on ABAP Documentation&body=Document: dynpro - Splitter Control, ABENDYNPRO_SPLITTER_CONTROL_ABEXA, 757%0D%0A%0D%0AError:%0
D%0A%0D%0A%0D%0A%0D%0ASuggestion for improvement:)

dynpro - Splitter Control

This example demonstrates a [splitter control](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abensplitter_control_glosry.htm "Glossary Entry").

Source Code   

REPORT demo\_dynpro\_splitter\_control.
DATA splitter TYPE REF TO cl\_dynpro\_splitter.
START-OF-SELECTION.
  CREATE OBJECT splitter
    EXPORTING
      splitter\_name = 'SPLITTER'.
  CALL SCREEN 100.
MODULE set\_status OUTPUT.
  SET PF-STATUS 'SCREEN\_100'.
ENDMODULE.
MODULE set\_sash OUTPUT.
  splitter->set\_sash( ).
ENDMODULE.
MODULE cancel.
  LEAVE PROGRAM.
ENDMODULE.
MODULE get\_sash INPUT.
  splitter->get\_guisash( ).
ENDMODULE.

Description   

A subscreen is assigned to both parts of the splitter control. The subscreens are called in the dynpro flow logic.


### abentab_strip_control_abexas.htm

---
title: "Continue"
description: |
  !Example(exa.gif 'Example') dynpro - Subscreens(https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abendynpro_subscreen_abexa.htm) !Example(exa.gif 'Example') dynpro - Tabstrips with Scrolling in SAP GUI(https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abentab_strip_control
version: "7.57"
category: "general"
type: "abap-reference"
sourceUrl: "https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abentab_strip_control_abexas.htm"
abapFile: "abentab_strip_control_abexas.htm"
keywords: ["do", "if", "abentab", "strip", "control", "abexas"]
---

* * *

AS ABAP Release 757, ©Copyright 2023 SAP SE. All rights reserved.

[ABAP - Keyword Documentation](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abenabap.htm) →  [ABAP - Programming Language](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abenabap_reference.htm) →  [SAP GUI User Dialogs](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abenabap_screens.htm) →  [General Dynpros](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abenabap_dynpros.htm) →  [dynpro - Statements in the Dynpro Flow Logic](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abenabap_dynpros_dynpro_statements.htm) →  [dynpro - Subscreens, Tabstrips, and Splitter Controls](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abendynp_subscreens.htm) → 

 [![](Mail.gif?object=Mail.gif&sap-language=EN "Feedback mail for displayed topic") Mail Feedback](mailto:f1_help@sap.com?subject=Feedback on ABAP Documentation&body=Document: dynpro - Examples of Subscreens, Tabstrips, and Splitter Controls, ABENTAB_STRIP_CONT
ROL_ABEXAS, 757%0D%0A%0D%0AError:%0D%0A%0D%0A%0D%0A%0D%0ASuggestion for improvement:)

dynpro - Examples of Subscreens, Tabstrips, and Splitter Controls

Continue
![Example](exa.gif "Example") [dynpro - Subscreens](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abendynpro_subscreen_abexa.htm)
![Example](exa.gif "Example") [dynpro - Tabstrips with Scrolling in SAP GUI](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abentab_strip_control1_abexa.htm)
![Example](exa.gif "Example") [dynpro - Tabstrips with Scrolling on the ABAP Server](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abentab_strip_control2_abexa.htm)
![Example](exa.gif "Example") [dynpro - Splitter Control](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abendynpro_splitter_control_abexa.htm)


---


## ABAP - Keyword Documentation / ABAP - Programming Language / Obsolete Language Elements / Obsolete Declarations / Internal Tables

**Files**: 9 | **Difficulty**: intermediate

# ABAP - Keyword Documentation / ABAP - Programming Language / Obsolete Language Elements / Obsolete Declarations / Field Symbols

Included pages: 3


### abenfield_symbols_obsolete.htm

---
title: "Field Symbols"
description: |
  -   Obsolete Typing(https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abapfield-symbols_obsolete_typing.htm) FIELD-SYMBOLS, obsolete_typing(https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abapfield-symbols_obsolete_typing.htm) !Example(exa.gif 'Example') Field Symbols, Ca
version: "7.57"
category: "general"
type: "abap-reference"
sourceUrl: "https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abenfield_symbols_obsolete.htm"
abapFile: "abenfield_symbols_obsolete.htm"
keywords: ["do", "if", "field-symbol", "abenfield", "symbols", "obsolete"]
---

* * *

AS ABAP Release 757, ©Copyright 2023 SAP SE. All rights reserved.

[ABAP - Keyword Documentation](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abenabap.htm) →  [ABAP - Programming Language](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abenabap_reference.htm) →  [Obsolete Language Elements](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abenabap_obsolete.htm) →  [Obsolete Declarations](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abenobsolete_declarations.htm) → 

 [![](Mail.gif?object=Mail.gif&sap-language=EN "Feedback mail for displayed topic") Mail Feedback](mailto:f1_help@sap.com?subject=Feedback on ABAP Documentation&body=Document: Field Symbols, ABENFIELD_SYMBOLS_OBSOLETE, 757%0D%0A%0D%0AError:%0D%0A%0D%0A%0D%0A%0D
%0ASuggestion for improvement:)

Field Symbols

-   [Obsolete Typing](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abapfield-symbols_obsolete_typing.htm)

Continue
[FIELD-SYMBOLS, obsolete\_typing](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abapfield-symbols_obsolete_typing.htm)
![Example](exa.gif "Example") [Field Symbols, Cast Structures](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abenfield_symbols_struc_abexa.htm)


### abapfield-symbols_obsolete_typing.htm

---
title: "Obsolete Syntax"
description: |
  ...    STRUCTURE struc DEFAULT dobj ... Additions: 1. ...  (#!ABAP_ADDITION_1@1@) 2. ... STRUCTURE struc DEFAULT dobj(#!ABAP_ADDITION_2@2@) Effect These additions of the statement FIELD-SYMBOLS(https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abapfield-symbols.htm) p
version: "7.57"
category: "general"
type: "abap-reference"
sourceUrl: "https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abapfield-symbols_obsolete_typing.htm"
abapFile: "abapfield-symbols_obsolete_typing.htm"
keywords: ["do", "while", "if", "case", "try", "class", "data", "types", "field-symbol", "abapfield", "symbols", "obsolete", "typing"]
---

* * *

AS ABAP Release 757, ©Copyright 2023 SAP SE. All rights reserved.

[ABAP - Keyword Documentation](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abenabap.htm) →  [ABAP - Programming Language](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abenabap_reference.htm) →  [Obsolete Language Elements](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abenabap_obsolete.htm) →  [Obsolete Declarations](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abenobsolete_declarations.htm) →  [Field Symbols](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abenfield_symbols_obsolete.htm) → 

 [![](Mail.gif?object=Mail.gif&sap-language=EN "Feedback mail for displayed topic") Mail Feedback](mailto:f1_help@sap.com?subject=Feedback on ABAP Documentation&body=Document: FIELD-SYMBOLS, obsolete_typing, ABAPFIELD-SYMBOLS_OBSOLETE_TYPING, 757%0D%0A%0D%0AErr
or:%0D%0A%0D%0A%0D%0A%0D%0ASuggestion for improvement:)

FIELD-SYMBOLS, obsolete\_typing

[Short Reference](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abapfield-symbols_shortref.htm)

Obsolete Syntax

... *{* *}* *|* STRUCTURE struc DEFAULT dobj ...

Additions:

[1\. ... *{* *}*](#!ABAP_ADDITION_1@1@)
[2\. ... STRUCTURE struc DEFAULT dobj](#!ABAP_ADDITION_2@2@)

Effect

These additions of the statement [FIELD-SYMBOLS](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abapfield-symbols.htm) produce an obsolete typing of the field symbol and are forbidden in classes.

Addition 1   

... *{* *}*

Effect

If no explicit type is specified after FIELD-SYMBOLS, the field symbol is typed implicitly with the completely generic type any. Furthermore, the field symbol is assigned the predefined constant space when the context is loaded. This means that the field symbol is not initial directly after it has been declared, and a check using [IS ASSIGNED](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abenlogexp_assigned.htm) is true.

Addition 2   

... STRUCTURE struc DEFAULT dobj

Effect

If the addition STRUCTURE, which is forbidden within classes, is specified for a field symbol instead of [typing](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abentyping_syntax.htm) and struc is a local program structure (a data object, not a data type) or a [flat structure](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abenflat_structure_glosry.htm "Glossary Entry") from the ABAP Dictionary, this structure is cast for the field symbol <fs>. dobj must be used to specify a data object that is assigned to the field symbol as an initial object.

The field symbol inherits the technical properties of structure struc, as with complete typing. In the case of a structured data object dobj, this data object must be at least as long as the formal parameter:

-   In the case of a structured data object, its [fragment view](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abenunicode_fragment_view_glosry.htm "Glossary Entry") must match the fragment view of the corresponding initial part of struc.
-   An elementary data object must be character-like and flat and the corresponding initial part of struc can contain only components of this type.

The same applies to assignments of data objects to field symbols typed using STRUCTURE when using the statement [ASSIGN](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abapassign.htm).

Hint

Field symbols declared using the addition STRUCTURE are a mixture of typed field symbols and a tool for [casting](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abencast_casting_glosry.htm "Glossary Entry") to structured data types. The additions TYPE or LIKE of the statement FIELD-SYMBOLS should be used to type field symbols, while the addition CASTING of the statement ASSIGN is used for casting.

Example

The first example shows the obsolete use of the addition STRUCTURE.

DATA wa1 TYPE c LENGTH 512.
FIELD-SYMBOLS <scarr1> STRUCTURE scarr DEFAULT wa1.
<scarr1>-carrid = '...'.

The second example shows the replacement of STRUCTURE with the additions TYPE and CASTING.

DATA wa2 TYPE c LENGTH 512.
FIELD-SYMBOLS <scarr2> TYPE scarr.
ASSIGN wa2 TO <scarr2> CASTING.
<scarr2>-carrid = '...'.

Executable Example

[Field Symbols, Cast Structures](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abenfield_symbols_struc_abexa.htm)


### abenfield_symbols_struc_abexa.htm

---
title: "Field Symbols, Cast Structures"
description: |
  This example demonstrates how field symbols are cast. Source Code REPORT demo_field_symbols_structure. CLASS demo DEFINITION. PUBLIC SECTION. CLASS-METHODS main. ENDCLASS. CLASS demo IMPLEMENTATION. METHOD main. DATA: wa(10) TYPE c VALUE '0123456789'. DATA: BEGIN OF line1, col1(3) TYPE c, col2(2)
version: "7.57"
category: "general"
type: "abap-reference"
sourceUrl: "https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abenfield_symbols_struc_abexa.htm"
abapFile: "abenfield_symbols_struc_abexa.htm"
keywords: ["select", "do", "if", "method", "class", "data", "field-symbol", "abenfield", "symbols", "struc", "abexa"]
---

* * *

AS ABAP Release 757, ©Copyright 2023 SAP SE. All rights reserved.

[ABAP - Keyword Documentation](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abenabap.htm) →  [ABAP - Programming Language](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abenabap_reference.htm) →  [Obsolete Language Elements](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abenabap_obsolete.htm) →  [Obsolete Declarations](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abenobsolete_declarations.htm) →  [Field Symbols](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abenfield_symbols_obsolete.htm) → 

 [![](Mail.gif?object=Mail.gif&sap-language=EN "Feedback mail for displayed topic") Mail Feedback](mailto:f1_help@sap.com?subject=Feedback on ABAP Documentation&body=Document: Field Symbols, Cast Structures, ABENFIELD_SYMBOLS_STRUC_ABEXA, 757%0D%0A%0D%0AError:%
0D%0A%0D%0A%0D%0A%0D%0ASuggestion for improvement:)

Field Symbols, Cast Structures

This example demonstrates how field symbols are cast.

Source Code   

REPORT demo\_field\_symbols\_structure.
CLASS demo DEFINITION.
  PUBLIC SECTION.
    CLASS-METHODS main.
ENDCLASS.
CLASS demo IMPLEMENTATION.
  METHOD main.
    DATA: wa(10) TYPE c VALUE '0123456789'.
    DATA: BEGIN OF line1,
            col1(3) TYPE c,
            col2(2) TYPE c,
            col3(5) TYPE c,
          END OF line1.
    DATA: BEGIN OF line2,
            col1(2) TYPE c,
            col2 TYPE sy-datum,
          END OF line2.
\* correct --------------------------------------------------------------
    FIELD-SYMBOLS: <f1> LIKE line1,
                   <f2> LIKE line2.
    ASSIGN wa TO: <f1> CASTING,
                  <f2> CASTING.
\* obsolete, not supported in methods -----------------------------------
  "FIELD-SYMBOLS: <f1> STRUCTURE line1 DEFAULT wa,
  "               <f2> STRUCTURE line2 DEFAULT wa.
\* ----------------------------------------------------------------------
    cl\_demo\_output=>display(
             |{ <f1>-col1 } { <f1>-col2 } { <f1>-col3 }\\n| &&
             |{ <f2>-col1 } { <f2>-col2 }| ).  ENDMETHOD.
ENDCLASS.
START-OF-SELECTION.
  demo=>main( ).

Description   

The structures line1 and line2 are cast to the number string 0123456789. The structure is then accessed using the corresponding field symbol and the components are output individually. It should be noted that the date component contains an invalid date after the assignment, which is only used here for demonstration purposes.

The structures are cast using the ASSIGN CASTING statement. The obsolete addition STRUCTURE of the statement FIELD-SYMBOLS, replaced by ASSIGN CASTING, is shown here as a comment.


---


## ABAP - Keyword Documentation / ABAP - Programming Language / Obsolete Language Elements / Obsolete Processing of Internal Data / Obsolete Internal Table Processing

**Files**: 11 | **Difficulty**: intermediate

# ABAP - Keyword Documentation / ABAP - Programming Language / Obsolete Language Elements / Obsolete Processing of External Data / Logical Databases (LDB, Obsolete) / LDB - Examples

Included pages: 6


### abenldb_examples.htm

---
title: "LDB - Examples"
description: |
  -   Example of a logical database(https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abenldb_example.htm) -   Example of selection include(https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abenldb_selections_example.htm) -   Example of a database program(https://help.sap.com/d
version: "7.57"
category: "general"
type: "abap-reference"
sourceUrl: "https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abenldb_examples.htm"
abapFile: "abenldb_examples.htm"
keywords: ["select", "do", "if", "data", "abenldb", "examples"]
---

* * *

AS ABAP Release 757, ©Copyright 2023 SAP SE. All rights reserved.

[ABAP - Keyword Documentation](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abenabap.htm) →  [ABAP - Programming Language](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abenabap_reference.htm) →  [Obsolete Language Elements](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abenabap_obsolete.htm) →  [Obsolete Processing of External Data](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abendata_storage_obsolete.htm) →  [Logical Databases (LDB, Obsolete)](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abenldb.htm) → 

 [![](Mail.gif?object=Mail.gif&sap-language=EN "Feedback mail for displayed topic") Mail Feedback](mailto:f1_help@sap.com?subject=Feedback on ABAP Documentation&body=Document: LDB - Examples, ABENLDB_EXAMPLES, 757%0D%0A%0D%0AError:%0D%0A%0D%0A%0D%0A%0D%0ASugges
tion for improvement:)

LDB - Examples

-   [Example of a logical database](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abenldb_example.htm)
-   [Example of selection include](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abenldb_selections_example.htm)
-   [Example of a database program](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abenldb_program_example.htm)
-   [Logical database, linked with a program](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abenreport_abexa.htm)
-   [Logical database, called by function module](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abenlogical_database_abexa.htm)

Continue
[LDB - Example of a Logical Database](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abenldb_example.htm)
[LDB - Example of a Selection Include](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abenldb_selections_example.htm)
[LDB - Example of a Database Program](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abenldb_program_example.htm)
![Example](exa.gif "Example") [LDB - Linkage with a Program](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abenreport_abexa.htm)
![Example](exa.gif "Example") [LDB - Calls Using a Function Module](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abenlogical_database_abexa.htm)


### abenldb_example.htm

---
title: "LDB - Example of a Logical Database"
description: |
  This example demonstrates all significant components of the imaginary logical database TEST_LDB. -   Structure(#abenldb-example-1-------selections-in-the-selection-include---@ITOC@@ABENLDB_EXAMPLE_2) -   Database Program(#abenldb-example-3---structure-----lfa1------------lfb1-------------------
version: "7.57"
category: "database"
type: "abap-reference"
sourceUrl: "https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abenldb_example.htm"
abapFile: "abenldb_example.htm"
keywords: ["select", "do", "if", "case", "method", "data", "abenldb", "example"]
---

* * *

AS ABAP Release 757, ©Copyright 2023 SAP SE. All rights reserved.

[ABAP - Keyword Documentation](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abenabap.htm) →  [ABAP - Programming Language](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abenabap_reference.htm) →  [Obsolete Language Elements](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abenabap_obsolete.htm) →  [Obsolete Processing of External Data](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abendata_storage_obsolete.htm) →  [Logical Databases (LDB, Obsolete)](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abenldb.htm) →  [LDB - Examples](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abenldb_examples.htm) → 

 [![](Mail.gif?object=Mail.gif&sap-language=EN "Feedback mail for displayed topic") Mail Feedback](mailto:f1_help@sap.com?subject=Feedback on ABAP Documentation&body=Document: LDB - Example of a Logical Database, ABENLDB_EXAMPLE, 757%0D%0A%0D%0AError:%0D%0A%0D%
0A%0D%0A%0D%0ASuggestion for improvement:)

LDB - Example of a Logical Database

This example demonstrates all significant components of the imaginary logical database TEST\_LDB.

-   [Structure](#abenldb-example-1-------selections-in-the-selection-include---@ITOC@@ABENLDB_EXAMPLE_2)
-   [Database Program](#abenldb-example-3---structure-----lfa1------------lfb1--------------------------lfc1--------------------------bkpf--selections-in-the-selection-include-----select-options--slifnr---for-lfa1-lifnr------------------sbukrs---for-lfb1-bukrs------------------sgjahr---for-lfc1-gjahr------------------sbelnr---for-bkpf-belnr---database-program--------------------------------------------------------------------database-program-of-logical-database-test--ldb-------------------------------------------------------------program-sapdbtest--ldb-defining-database-test--ldb--nodes--lfa1---------lfb1---------lfc1---------bkpf-----------------------------------------------------------------initialize-selection-screen--processed-before-pbo--------------------------------------------------------------form-init-------endform-----------------------------------------------------------------pbo-of-selection-screen-------------------------------------------------------------form-pbo-------endform-----------------------------------------------------------------pai-of-selection-screen-------------------------------------------------------------form-pai-using-fname-mark----case-fname------when--slifnr-----------------when--sbukrs-----------------when--sgjahr-----------------when--sbelnr---------------endcase--endform-----------------------------------------------------------------raise-event-get-lfa1-------------------------------------------------------------form-put--lfa1----select----from-lfa1------------where-lifnr-in-slifnr INTO @lfa1.
    PUT lfa1.
  ENDSELECT.
ENDFORM.
\*-------------------------------------------------------\*
\* Raise event GET lfb1
\*-------------------------------------------------------\*
FORM put\_lfb1.
  SELECT \* FROM lfb1
           WHERE lifnr = @lfa1-lifnr
             AND bukrs IN @sbulrs
           INTO @lfb1.
    PUT lfb1.
  ENDSELECT.
ENDFORM.
\*-------------------------------------------------------\*
\* Raise event GET lfc1
\*-------------------------------------------------------\*
FORM put\_lfc1.
  SELECT \* FROM lfc1
           WHERE lifnr = @lfa1-lifnr
             AND bukrs      =  @lfb1-bukrs
             AND gjahr      IN @sgjahr
           INTO lfc1.
    PUT lfc1.
  ENDSELECT.
ENDFORM.
\*-------------------------------------------------------\*
\* Raise event GET bkpf
\*-------------------------------------------------------\*
FORM put\_bkpf.
  SELECT \* FROM bkpf
           WHERE bukrs      =  @lfb1-bukrs
             AND belnr      IN @sbelnr
             AND gjahr      IN @sgjahr
           INTO @bkpf.
    PUT bkpf.
  ENDSELECT.
ENDFORM.

The PROGRAM statement has the addition [DEFINING DATABASE test\_ldb](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abapreport_defining.htm). This defines the link of the database program with the logical database TEST\_LDB.

The nodes of the structure are declared using the [NODES statement](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abapnodes.htm). This creates the required interface work areas as table work areas. The statement [TABLES](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abaptables.htm) can be used as a node in the same way for database tables. If the nodes are not database tables, they must be declared using NODES. The interface work areas are shared by the database program and a linked executable program or the function module LDB\_PROCESS and therefore become the interface used for passing data.

The selection screen can be initialized in the subroutines init and pbo.

The user input on the selection screen can be, for example, checked for authorizations in the subroutine pai. Other checks, such as plausibility or value range checks, are also possible here. If a check is negative, an error dialog can be programmed and the corresponding field can be initialized again.

The database tables are read in accordance with the selection criteria of the user and the associated GET events are raised in the subroutines put\_....

This program is only intended to demonstrate the principles of the structure of a logical database. It does not contain any methods for optimizing response times. The chronological order of the subroutine calls is determined by the structure of the logical database.


### abenldb_selections_example.htm

---
title: "LDB - Example of a Selection Include"
description: |
  A logical database TEST_LDB has the structure shown in Example of a Logical Database(https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abenldb_example.htm). The generated proposal for the selection include is then as follows: -----------------------------------------------------------
version: "7.57"
category: "general"
type: "abap-reference"
sourceUrl: "https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abenldb_selections_example.htm"
abapFile: "abenldb_selections_example.htm"
keywords: ["select", "delete", "do", "if", "data", "abenldb", "selections", "example"]
---

* * *

AS ABAP Release 757, ©Copyright 2023 SAP SE. All rights reserved.

[ABAP - Keyword Documentation](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abenabap.htm) →  [ABAP - Programming Language](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abenabap_reference.htm) →  [Obsolete Language Elements](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abenabap_obsolete.htm) →  [Obsolete Processing of External Data](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abendata_storage_obsolete.htm) →  [Logical Databases (LDB, Obsolete)](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abenldb.htm) →  [LDB - Examples](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abenldb_examples.htm) → 

 [![](Mail.gif?object=Mail.gif&sap-language=EN "Feedback mail for displayed topic") Mail Feedback](mailto:f1_help@sap.com?subject=Feedback on ABAP Documentation&body=Document: LDB - Example of a Selection Include, ABENLDB_SELECTIONS_EXAMPLE, 757%0D%0A%0D%0AErro
r:%0D%0A%0D%0A%0D%0A%0D%0ASuggestion for improvement:)

LDB - Example of a Selection Include

A logical database TEST\_LDB has the structure shown in [Example of a Logical Database](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abenldb_example.htm). The generated proposal for the selection include is then as follows:

\*-----------------------------------------------------------\*
\* Include DBTEST\_LDBSEL
\* It will be automatically included into the database program
\*-----------------------------------------------------------\*
\* If the source is automatically generated,
\* perform the following steps:
\* 1. Replace ? by suitable names (at most 8 characters).
\* 2. Activate SELECT-OPTIONS and PARAMETERS (delete stars).
\* 3. Save source code.
\* 4. Edit database program.
\*
\* Hint : Syntax check is not possible within this include!
\* It will be checked during syntax check of database program.
\*-----------------------------------------------------------\*
\* SELECT-OPTIONS :  ?  FOR LFA1-LIFNR.
\* Parameter for search pattern selection:
\* PARAMETERS p\_sp AS SEARCH PATTERN FOR TABLE LFA1.
\* SELECT-OPTIONS :
\*                   ?  FOR LFB1-LIFNR,
\*                   ?  FOR LFB1-BUKRS.
\* SELECT-OPTIONS :
\*                   ?  FOR LFC1-LIFNR,
\*                   ?  FOR LFC1-BUKRS,
\*                   ?  FOR LFC1-GJAHR.
\* SELECT-OPTIONS :
\*                   ?  FOR BKPF-BUKRS,
\*                   ?  FOR BKPF-BELNR,
\*                   ?  FOR BKPF-GJAHR.
\* Enable DYNAMIC SELECTIONS for selected nodes :
\* Enable FIELD SELECTION for selected nodes :

If the nodes LFA1 and LFB1 are defined for dynamic selections and the node LFC1 defined for field selections, the following additional program lines are generated:

SELECTION-SCREEN DYNAMIC SELECTIONS FOR TABLE LFA1.
SELECTION-SCREEN DYNAMIC SELECTIONS FOR TABLE LFB1.
SELECTION-SCREEN FIELD SELECTION FOR TABLE LFC1.

This automatically created selection include can be completed, for example, as follows:

\* Selection criteria:
  SELECT-OPTIONS slifnr  FOR lfa1-lifnr.
  SELECT-OPTIONS sbukrs  FOR lfb1-bukrs.
  SELECT-OPTIONS sgjahr  FOR flc1-gjahr.
  SELECT-OPTIONS sbelnr  FOR bkpf-belnr.
\* Self-defined parameters:
  PARAMETERS pstida LIKE sy-datum FOR NODE bkpf.
\* Dynamic selections for LFA1 and LFB1:
  SELECTION-SCREEN DYNAMIC SELECTIONS FOR NODE: lfa1, lfb1.
\* Field selection for LFB1 and LFC1:
  SELECTION-SCREEN FIELD SELECTION FOR NODE: lfb1, lfc1.

A selection is made from the available selection criteria and is given a name. The additional parameter pstida is declared and connected to the node BKPF. Dynamic selections are defined for the tablesLFA1 and LFB1. The tables LFB1 and LFC1 are defined for field selections.


### abenldb_program_example.htm

---
title: "LDB - Example of a Database Program"
description: |
  A logical database TEST_LDB has the structure shown in Example of a Logical Database(https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abenldb_example.htm). All nodes are database tables. Selections are defined in the selection include: SELECT-OPTIONS SLIFNR  FOR LFA1-LIFNR. SELECT-OPTIO
version: "7.57"
category: "database"
type: "abap-reference"
sourceUrl: "https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abenldb_program_example.htm"
abapFile: "abenldb_program_example.htm"
keywords: ["select", "delete", "loop", "do", "if", "case", "data", "internal-table", "abenldb", "program", "example"]
---

* * *

AS ABAP Release 757, ©Copyright 2023 SAP SE. All rights reserved.

[ABAP - Keyword Documentation](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abenabap.htm) →  [ABAP - Programming Language](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abenabap_reference.htm) →  [Obsolete Language Elements](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abenabap_obsolete.htm) →  [Obsolete Processing of External Data](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abendata_storage_obsolete.htm) →  [Logical Databases (LDB, Obsolete)](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abenldb.htm) →  [LDB - Examples](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abenldb_examples.htm) → 

 [![](Mail.gif?object=Mail.gif&sap-language=EN "Feedback mail for displayed topic") Mail Feedback](mailto:f1_help@sap.com?subject=Feedback on ABAP Documentation&body=Document: LDB - Example of a Database Program, ABENLDB_PROGRAM_EXAMPLE, 757%0D%0A%0D%0AError:%0
D%0A%0D%0A%0D%0A%0D%0ASuggestion for improvement:)

LDB - Example of a Database Program

A logical database TEST\_LDB has the structure shown in [Example of a Logical Database](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abenldb_example.htm). All nodes are database tables. Selections are defined in the selection include:

SELECT-OPTIONS SLIFNR  FOR LFA1-LIFNR.
SELECT-OPTIONS SBUKRS  FOR LFB1-BUKRS.
SELECT-OPTIONS SGJAHR  FOR LFC1-GJAHR.
SELECT-OPTIONS SBELNR  FOR BKPF-BELNR.

The generated proposal for the database program is then as follows:

Master Program SAPDBTEST\_LDB

\*----------------------------------------------------------\*
\*      DATABASE PROGRAM OF LOGICAL DATABASE TEST\_LDB
\*----------------------------------------------------------\*
INCLUDE DBTEST\_LDBTOP.     " header
INCLUDE DBTEST\_LDBXXX.     " all system routines
\* INCLUDE DBTEST\_LDBF001.  " user defined include

Include Program DBTEST\_LDBTOP

PROGRAM SAPDBTEST\_LDB DEFINING DATABASE TEST\_LDB.
TABLES: LFA1,
         LFB1,
         LFC1,
         BKPF.
\* DATA: ...          "user defined variables

Include Program DBTEST\_LDB001

\*----------------------------------------------------------\*
\* Call event GET LFA1
\*----------------------------------------------------------\*
FORM PUT\_LFA1.
\* SELECT \* FROM LFA1
\*   INTO LFA1
\*   INTO TABLE ? (choose one!)
\*   WHERE LIFNR = ?.
    PUT LFA1.
\* ENDSELECT.
ENDFORM.                               "PUT\_LFA1
\*----------------------------------------------------------\*
\* Authority Check for node LFA1
\*----------------------------------------------------------\*
\* FORM AUTHORITY\_CHECK\_LFA1.
\*   AUTHORITY-CHECK ...
\* ENDFORM.

Include Programs DBTEST\_LDB002 and DBTEST\_LDB003

Like DBTEST\_LDB001 for the nodes LFB1 and LFC1

Include Program DBTEST\_LDB004

\*----------------------------------------------------------\*
\* Call event GET BKPF
\*----------------------------------------------------------\*
FORM PUT\_BKPF.
\* STATICS FLAG.
\* IF FLAG = SPACE.
\*   FLAG = 'X'.
\*\*\* Declarations for field selection for node BKPF \*\*\*
\*   STATICS BKPF\_FIELDS TYPE RSFS\_TAB\_FIELDS.
\*   MOVE 'BKPF' TO BKPF\_FIELDS-TABLENAME.
\*   READ TABLE SELECT\_FIELDS WITH KEY BKPF\_FIELDS-TABLENAME
\*     INTO BKPF\_FIELDS.
\* ENDIF.
\* SELECT (BKPF\_FIELDS-FIELDS) INTO CORRESPONDING FIELDS OF
\*     BKPF / TABLE ? " (choose one of them)
\*     FROM BKPF
\*   WHERE BUKRS = LFB1-BUKRS
\*     AND BELNR IN SBELNR
\*     AND GJAHR = ?.
    PUT BKPF.
ENDFORM.                               "PUT\_BKPF
\*----------------------------------------------------------\*
\* Authority Check for node BKPF
\*----------------------------------------------------------\*
\* FORM AUTHORITYCHECK\_BKPF.
\*   AUTHORITY-CHECK ...
\* ENDFORM.                             "AUTHORITY\_CHECK\_BKPF

Include Program DBTEST\_LDBFXXX

\*----------------------------------------------------------\*
\* BEFORE\_EVENT will be called before event EVENT
\* Possible values for EVENT: 'START-OF-SELECTION'
\*----------------------------------------------------------\*
\* FORM BEFORE\_EVENT USING EVENT.
\*   CASE EVENT.
\*     WHEN 'START-OF-SELECTION'
\*
\*   ENDCASE.
\* ENDFORM.                             "BEFORE\_EVENT
\*----------------------------------------------------------\*
\* AFTER\_EVENT will be called after event EVENT
\* Possible values for EVENT: 'END-OF-SELECTION'
\*----------------------------------------------------------\*
\* FORM AFTER\_EVENT USING EVENT.
\*   CASE EVENT.
\*     WHEN 'END-OF-SELECTION'
\*
\*   ENDCASE.
\* ENDFORM.                             "AFTER\_EVENT
\*-----------------------------------------------------------\*
\* Initialize global data for multiple processing of
\* one logical database.
\* Set returncode:
\*      0 -> all data are initialized, multiple processing o.k.
\*  other -> no multiple processing allowed
\*------------------------------------------------------------\*
FORM  LDB\_PROCESS\_INIT CHANGING SUBRC LIKE SY-SUBRC.
ENDFORM.                    "LDB\_PROCESS\_INIT
\*------------------------------------------------------------\*
\* LDB\_PROCESS\_CHECK\_SELECTIONS is called
\* after select-options and parameters are filled
\*------------------------------------------------------------\*
FORM  LDB\_PROCESS\_CHECK\_SELECTIONS CHANGING SUBRC LIKE SY-SUBRC
                                            MSG LIKE SYMSG.
ENDFORM.                    "LDB\_PROCESS\_CHECK\_SELECTIONS
\*----------------------------------------------------------\*
\* Initialize selection screen (processed before PBO)
\*----------------------------------------------------------\*
FORM INIT.
ENDFORM.                               "INIT.
\*----------------------------------------------------------\*
\* PBO of selection screen (processed always after ENTER)
\*----------------------------------------------------------\*
FORM PBO.
ENDFORM.                               "PBO.
\*----------------------------------------------------------\*
\* PAI of selection screen (processed always after ENTER)
\*----------------------------------------------------------\*
FORM PAI USING FNAME MARK.
\* CASE FNAME.
\*   WHEN 'SLIFNR  '.
\*   WHEN 'SBUKRS  '.
\*   WHEN 'SBELNR  '.
\*   WHEN 'SGJAHR  '.
\*   WHEN '\*'.
\*   ENDCASE.
ENDFORM.                               "PAI

Include Program DBTEST\_LDBSXXX

\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*
\* !!! PLEASE DO NOT CHANGE MANUALLY (BEGIN OF BLOCK) !!!!!! \*
\*-----------------------------------------------------------\*
\* Data structures for search pattern selection
\*
\* !!! PLEASE DO NOT CHANGE MANUALLY (END OF BLOCK) !!!!!!!! \*
\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*
\*-----------------------------------------------------------\*
\* PUT\_TEST\_LDB\_SP.
\* Processed when search pattern selection is used,
\* i.e. user input into PARAMETERS p\_sp AS SEARCH PATTERN
\* STRUCTURE.
\*-----------------------------------------------------------\*
\* FORM PUT\_TEST\_LDB\_SP.
\* ENDFORM.                             "PUT\_EXAMPLE\_SP

The comment characters in front of ABAP statements that are to be used in addition to the mandatory statements can be deleted and the question marks can be replaced by appropriate expressions. The syntax check checks all include programs that match the naming conventions and also the selection include.

When the database is accessed in the subroutines put\_node, SELECT statements with conditions for the primary key fields in the WHERE clauses are generated. The performance of these statements is, however, not yet optimized. In particular, the subroutines put\_node of a subtree of the structure represent nested SELECT loops, which should generally be avoided. Instead, the data read can be buffered in internal tables, for example, and passed from here to the application program using the PUT statement. The statement PUT node, however, should always be in a subroutine whose name starts with put\_node for technical reasons.

If the selections specify [dynamic selections](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abenldb_free_selections.htm) or [field selections](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abenldb_field_selections.htm) for a node, corresponding statements are generated in the subroutine put\_node and the SELECT statement created automatically is modified, as shown in the example for the node BKPF.

The subroutines before\_event, after\_event, and put\_ldb\_sp are created as a comment in the database program and can be modified and activated by deleting the asterisks. before\_event is called before the event specified in the parameter event is processed. after\_event is called after the event specified in the parameter event is processed. When a search help selection is made, put\_ldb\_sp is called to process the return values instead of put\_node for the root node.


### abenreport_abexa.htm

---
title: "LDB - Linkage with a Program"
description: |
  This example demonstrates how a logical database is linked with an executable program. Source Code REPORT demo_report. NODES: spfli, sflight, sbook. DATA: weight       TYPE p LENGTH 8 DECIMALS 4, total_weight TYPE p LENGTH 8 DECIMALS 4. INITIALIZATION. carrid-sign = 'I'. carrid-option = 'EQ'. carr
version: "7.57"
category: "general"
type: "abap-reference"
sourceUrl: "https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abenreport_abexa.htm"
abapFile: "abenreport_abexa.htm"
keywords: ["select", "do", "if", "try", "data", "abenreport", "abexa"]
---

* * *

AS ABAP Release 757, ©Copyright 2023 SAP SE. All rights reserved.

[ABAP - Keyword Documentation](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abenabap.htm) →  [ABAP - Programming Language](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abenabap_reference.htm) →  [Obsolete Language Elements](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abenabap_obsolete.htm) →  [Obsolete Processing of External Data](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abendata_storage_obsolete.htm) →  [Logical Databases (LDB, Obsolete)](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abenldb.htm) →  [LDB - Examples](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abenldb_examples.htm) → 

 [![](Mail.gif?object=Mail.gif&sap-language=EN "Feedback mail for displayed topic") Mail Feedback](mailto:f1_help@sap.com?subject=Feedback on ABAP Documentation&body=Document: LDB - Linkage with a Program, ABENREPORT_ABEXA, 757%0D%0A%0D%0AError:%0D%0A%0D%0A%0D%
0A%0D%0ASuggestion for improvement:)

LDB - Linkage with a Program

This example demonstrates how a logical database is linked with an executable program.

Source Code   

REPORT demo\_report.
NODES: spfli, sflight, sbook.
DATA: weight       TYPE p LENGTH 8 DECIMALS 4,
      total\_weight TYPE p LENGTH 8 DECIMALS 4.
INITIALIZATION.
  carrid-sign = 'I'.
  carrid-option = 'EQ'.
  carrid-low = 'AA'.
  carrid-high = 'LH'.
  APPEND carrid TO carrid.
START-OF-SELECTION.
  WRITE 'Luggage weight of flights'.
GET spfli FIELDS carrid connid cityfrom cityto.
  SKIP.
  ULINE.
  WRITE: / 'Carrid:', spfli-carrid,
           'Connid:', spfli-connid,
         / 'From:  ', spfli-cityfrom,
           'To:    ', spfli-cityto.
  ULINE.
GET sflight FIELDS fldate.
  SKIP.
  WRITE: / 'Date:', sflight-fldate.
GET sbook FIELDS luggweight.
  weight += sbook-luggweight.
GET sflight LATE FIELDS carrid .
  WRITE: / 'Luggage weight =', weight.
  total\_weight += weight.
  weight = 0.
END-OF-SELECTION.
  ULINE.
  WRITE: / 'Sum of luggage weights =', total\_weight.

Description   

This example shows a typical report where the [logical database](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abenlogical_data_base_glosry.htm "Glossary Entry") F1S is assigned to its properties.


### abenlogical_database_abexa.htm

---
title: "LDB - Calls Using a Function Module"
description: |
  This example demonstrates calling a logical database using the function module LDB_PROCESS. Source Code REPORT demo_logical_database. DATA wa_spfli TYPE spfli. SELECTION-SCREEN BEGIN OF SCREEN 1100. SELECT-OPTIONS s_carr FOR wa_spfli-carrid. SELECTION-SCREEN END OF SCREEN 1100. CLASS demo DEFI
version: "7.57"
category: "general"
type: "abap-reference"
sourceUrl: "https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abenlogical_database_abexa.htm"
abapFile: "abenlogical_database_abexa.htm"
keywords: ["select", "loop", "do", "if", "case", "method", "class", "data", "internal-table", "abenlogical", "database", "abexa"]
---

* * *

AS ABAP Release 757, ©Copyright 2023 SAP SE. All rights reserved.

[ABAP - Keyword Documentation](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abenabap.htm) →  [ABAP - Programming Language](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abenabap_reference.htm) →  [Obsolete Language Elements](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abenabap_obsolete.htm) →  [Obsolete Processing of External Data](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abendata_storage_obsolete.htm) →  [Logical Databases (LDB, Obsolete)](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abenldb.htm) →  [LDB - Examples](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abenldb_examples.htm) → 

 [![](Mail.gif?object=Mail.gif&sap-language=EN "Feedback mail for displayed topic") Mail Feedback](mailto:f1_help@sap.com?subject=Feedback on ABAP Documentation&body=Document: LDB - Calls Using a Function Module, ABENLOGICAL_DATABASE_ABEXA, 757%0D%0A%0D%0AError
:%0D%0A%0D%0A%0D%0A%0D%0ASuggestion for improvement:)

LDB - Calls Using a Function Module

This example demonstrates calling a logical database using the function module LDB\_PROCESS.

Source Code   

REPORT demo\_logical\_database.
DATA wa\_spfli TYPE spfli.
SELECTION-SCREEN BEGIN OF SCREEN 1100.
SELECT-OPTIONS s\_carr FOR wa\_spfli-carrid.
SELECTION-SCREEN END OF SCREEN 1100.
CLASS demo DEFINITION.
  PUBLIC SECTION.
    CLASS-METHODS main.
ENDCLASS.
CLASS demo IMPLEMENTATION.
  METHOD main.
    DATA callback    TYPE TABLE OF ldbcb.
    DATA: seltab    TYPE TABLE OF rsparams,
          seltab\_wa LIKE LINE OF seltab,
          scarr\_wa  LIKE LINE OF s\_carr.
    CALL SELECTION-SCREEN 1100 STARTING AT 10 10.
    IF sy-subrc <> 0.
      RETURN.
    ENDIF.
    callback = VALUE #( ( ldbnode     = 'SPFLI'
                          get         = 'X'
                          get\_late    = 'X'
                          cb\_prog     = sy-repid
                          cb\_form     = 'CALLBACK\_SPFLI' )
                        ( ldbnode     = 'SFLIGHT'
                          get         = 'X'
                          cb\_prog     = sy-repid
                          cb\_form     = 'CALLBACK\_SFLIGHT' ) ).
    seltab\_wa-kind = 'S'.
    seltab\_wa-selname = 'CARRID'.
    LOOP AT s\_carr INTO scarr\_wa.
      MOVE-CORRESPONDING scarr\_wa TO seltab\_wa.
      APPEND seltab\_wa TO seltab.
    ENDLOOP.
    CALL FUNCTION 'LDB\_PROCESS'
      EXPORTING
        ldbname                     = 'F1S'
        variant                     = ' '
      TABLES
        callback                    = callback
        selections                  = seltab
      EXCEPTIONS
        OTHERS                      = 4.
    IF sy-subrc <> 0.
      WRITE: 'Exception with SY-SUBRC', sy-subrc.
    ENDIF.  ENDMETHOD.
ENDCLASS.
START-OF-SELECTION.
  demo=>main( ).
FORM callback\_spfli USING name  TYPE ldbn-ldbnode
                          wa    TYPE spfli
                          evt   TYPE c
                          check TYPE c.
  CASE evt.
    WHEN 'G'.
      WRITE: / wa-carrid, wa-connid, wa-cityfrom, wa-cityto.
      ULINE.
    WHEN 'L'.
      ULINE.
  ENDCASE.
ENDFORM.
FORM callback\_sflight USING name  TYPE ldbn-ldbnode
                            wa    TYPE sflight
                            evt   TYPE c
                            check TYPE c.
  WRITE: / wa-fldate, wa-seatsocc, wa-seatsmax.
ENDFORM.

Description   

The program reads data using the logical database F1S. First a program-specific selection screen is defined. The data object wa\_spfli is only required here. Next, suitable variables for the interface are declared.

The internal table callback is filled in such a way that, for the two nodes SPFLI and SFLIGHT, different callback routines in the calling program are called. For the node SPFLI, the corresponding routine for GET and GET LATE is only to be called for GET in the case of SFLIGHT.

The internal table seltab is filled with values from the selection table s\_carr of the standalone selection screen 1100 for the selections of node SPFLI.

The function module LDB\_PROCESS is called with these parameters.

The subroutines callback\_spfli and callback\_sflight are used as callback routines. Since the interface parameter wa is completely typed, the individual components of the work area can be accessed. In callback\_spfli, the events GET and GET LATE are handled differently.


---


## ABAP - Keyword Documentation / ABAP - Programming Guidelines / Robust ABAP / Internal Tables

**Files**: 8 | **Difficulty**: intermediate

# ABAP - Keyword Documentation / ABAP - Programming Guidelines / Robust ABAP / Internal Tables

Included pages: 8


### abenitab_gdl.htm

---
title: "Internal Tables"
description: |
  An internal table is a dynamic data object consisting of a sequence of lines with the same data type. The data type of an internal table is a table type that has the following basic properties of every internal table: -   Line Type The line type can be any data type. In particular, tables of element
version: "7.57"
category: "data-structures"
type: "abap-reference"
sourceUrl: "https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abenitab_gdl.htm"
abapFile: "abenitab_gdl.htm"
keywords: ["select", "loop", "do", "if", "try", "method", "data", "types", "internal-table", "abenitab", "gdl"]
---

* * *

AS ABAP Release 757, ©Copyright 2023 SAP SE. All rights reserved.

[ABAP - Keyword Documentation](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abenabap.htm) →  [ABAP - Programming Guidelines](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abenabap_pgl.htm) →  [Robust ABAP](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abenrobust_abap_gdl.htm) → 

 [![](Mail.gif?object=Mail.gif&sap-language=EN "Feedback mail for displayed topic") Mail Feedback](mailto:f1_help@sap.com?subject=Feedback on ABAP Documentation&body=Document: Internal Tables, ABENITAB_GDL, 757%0D%0A%0D%0AError:%0D%0A%0D%0A%0D%0A%0D%0ASuggestio
n for improvement:)

Internal Tables

An internal table is a dynamic data object consisting of a sequence of lines with the same data type. The data type of an internal table is a table type that has the following basic properties of every internal table:

-   Line Type
    
    The line type can be any data type. In particular, tables of
    
    elementary types, tables of structures, tables of tables, and
    
    tables or references are all possible.
    
-   Table category
    
    The table category specifies the storage method and primary access method. The possible table categories are:
    
    -   Standard tables administered using a primary table index and which cannot have a unique primary table key.
    -   Sorted tables administered using a primary table index and that can have a unique or non-unique primary table key (used to sort the table).
    -   Hashed tables whose primary table key always has to be unique and which use a hash algorithm (distributed memory management) to administer their lines. A hashed table does not have a primary table index.
-   Primary table key
    
    Every internal table has a primary table key. A table key consists of columns from the internal table. The content of these columns identifies table lines. The table category determines whether a key is unique or non-unique.
    

Internal tables enable variable datasets (a variable number of lines) with a fixed structure (the line type) to be processed in the working memory of the [internal session](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abeninternal_session_glosry.htm "Glossary Entry") of a program. The content of an internal table can either be accessed sequentially in a LOOP or by accessing individual lines (for example, by using READ TABLE or a table expression).

There are two ways of accessing individual lines:

-   By specifying a key (a table key or a free key)
-   By specifying a line index

Primary table access is possible for all three table categories. Access using the primary key, however, is optimized only for sorted tables and hashed tables. In standard tables, primary key access uses a linear search. Access using the primary line index, on the other hand, is possible for standard tables and sorted tables only. As well as its primary key, an internal key can also have further secondary keys. These keys enhance and optimize access options to the various table categories.

-   [Selecting the Table Category](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abenselect_table_type_guidl.htm "Guideline")
-   [Secondary Keys](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abensecondary_key_guidl.htm "Guideline")
-   [Initial Memory Requirement](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abeninitial_memory_requ_guidl.htm "Guideline")
-   [Sorted Filling](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abensort_guidl.htm "Guideline")
-   [Compressed Filling](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abencollect_guidl.htm "Guideline")
-   [Target Area](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abentable_output_guidl.htm "Guideline")
-   [Loop Processing](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abenloop_guidl.htm "Guideline")

Continue
[Selecting the Table Category](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abenselect_table_type_guidl.htm)
[Secondary Key](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abensecondary_key_guidl.htm)
[Initial Memory Requirement](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abeninitial_memory_requ_guidl.htm)
[Sorted Filling](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abensort_guidl.htm)
[Collected Filling](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abencollect_guidl.htm)
[Target Area](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abentable_output_guidl.htm)
[Loop Processing](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abenloop_guidl.htm)


### abenselect_table_type_guidl.htm

---
title: "Selecting the Table Category"
description: |
  Background The table category specifies the internal administration for an internal table and the primary access type: -   Standard tables that are managed with a primary table index. When inserting or deleting table lines, only the table index is reorganized, but not the remaining table lines. If l
version: "7.57"
category: "data-structures"
type: "abap-reference"
sourceUrl: "https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abenselect_table_type_guidl.htm"
abapFile: "abenselect_table_type_guidl.htm"
keywords: ["select", "insert", "delete", "loop", "do", "if", "case", "try", "data", "types", "internal-table", "abenselect", "table", "type", "guidl"]
---

* * *

AS ABAP Release 757, ©Copyright 2023 SAP SE. All rights reserved.

[ABAP - Keyword Documentation](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abenabap.htm) →  [ABAP - Programming Guidelines](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abenabap_pgl.htm) →  [Robust ABAP](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abenrobust_abap_gdl.htm) →  [Internal Tables](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abenitab_gdl.htm) → 

 [![](Mail.gif?object=Mail.gif&sap-language=EN "Feedback mail for displayed topic") Mail Feedback](mailto:f1_help@sap.com?subject=Feedback on ABAP Documentation&body=Document: Selecting the Table Category, ABENSELECT_TABLE_TYPE_GUIDL, 757%0D%0A%0D%0AError:%0D%0
A%0D%0A%0D%0A%0D%0ASuggestion for improvement:)

Selecting the Table Category

Background   

The table category specifies the internal administration for an internal table and the primary access type:

-   Standard tables that are managed with a primary table index. When inserting or deleting table lines, only the table index is reorganized, but not the remaining table lines. If lines are only appended (APPEND) at the end or deleted, no reorganization of the table index is required. However, access using the primary key is not optimized. It triggers a linear search across all lines.
-   Sorted tables are also managed using their primary table index, which is always available in the memory, sorted according to the primary table key. This means that the table index must usually be reorganized each time a table line is inserted or deleted. When accessing using the primary key, a binary search is performed, causing the time required for the search to be merely logarithmically dependent on the number of lines.
-   Hashed tables are based on distributed memory management. They are therefore optimized for access using the primary table key and attain a constant access time, regardless of the number of lines. In return, the distributed memory management requires additional memory space and does not allow for non-unique primary table keys. There is no primary table index, and a respective index access is not possible.

Standard tables and sorted tables can be summarized under the term index tables. An index access is always the fastest way to access table entries. The prerequisite for an index access is that the value for the index specification has been determined in advance. This usually requires a previous key access, for example, using READ TABLE, where the sy-tabix system field is set.

Rule   

Use a suitable table category

Select the table category according to the primary requirements. As a rule of thumb, if the tables are large, the following selection criteria apply:

-   Mainly index accesses: standard tables
-   Index accesses and key accesses: sorted tables
-   Only key accesses: hashed tables

Details   

Particularly for tables with a lot of lines, you have to select the appropriate table category carefully. The following recommendations are mainly derived from the processing speed requirements:

-   Standard Tables
    
    This table category can always be used if the primary access types are sequential processing or index access. You should fill standard tables by appending lines using APPEND and implement the other accesses using an index specification (the addition INDEX of the respective statements). Ideally, the filling process is decoupled from other accesses. After explicit sorting has taken place, you can also use an optimized key access (free key) using BINARY SEARCH, which enables you to identify an entry point for sequential processing (LOOP), for example. However, due to the linear search, large standard tables (more than 100 lines) are not the appropriate table category, if the primary access type for an internal table is through key accesses.
    
-   Sorted Tables
    
    This table category is useful if both a fast key access and an index access are necessary, and if the lines are supposed to be sorted when the table is filled. In addition, sorted tables are also suited for partially sequential access in a LOOP loop, where the first part of the table key is specified in the WHERE condition. Finally, sorted tables with an ambiguous key are the only alternative to hashed tables if no unique key can be defined.
    
-   Hashed Tables
    
    This table category is useful if key accesses are the central operation for table entries, if the tables are large, and if a unique key can be defined.
    

In addition to the processing speed, memory requirements can also play an important role. If this is supposed to be optimized according to [Consider the Ratio of Administration and Application Data](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abenadmin_costs_dyn_mem_obj_guidl.htm "Guideline"), you must also take into account the administration costs of the table categories.

-   Standard tables and sorted tables (index tables) that are managed using a table index, incur the least [administration costs](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abenadmin_costs_dyn_mem_obj_guidl.htm "Guideline") (6 bytes for each line on average). As long as the logical order in the table index corresponds to the physical order in the table body, a standard table does not incur any line-related administration costs. This is the case if you always append lines after the last line or delete only the last line.
-   Hashed tables require considerably more space for their [administration data](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abenadmin_costs_dyn_mem_obj_guidl.htm "Guideline") than index tables (18 or 30 bytes for each line on average).

Depending on the length of the key and the number of lines in an internal table, access using a sorted key can be as fast as or even faster than using a hashed table. In cases like this, and if the memory space is critical, you should work with a sorted table instead of a hashed table.

If you use [secondary keys](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abensecondary_key_guidl.htm "Guideline"), the rules mentioned here may be qualified to a certain degree, as the overall costs need to be considered in this case.


### abensecondary_key_guidl.htm

---
title: "Secondary Key"
description: |
  Background Secondary keys can be declared for internal tables. The following options are possible: -   Sorted keys (non-unique or unique) -   Hash keys that can only be unique These keys are assigned a name when they are declared and can be created for any table category. The primary key (nameless u
version: "7.57"
category: "general"
type: "abap-reference"
sourceUrl: "https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abensecondary_key_guidl.htm"
abapFile: "abensecondary_key_guidl.htm"
keywords: ["update", "delete", "loop", "do", "if", "case", "data", "types", "internal-table", "abensecondary", "key", "guidl"]
---

* * *

AS ABAP Release 757, ©Copyright 2023 SAP SE. All rights reserved.

[ABAP - Keyword Documentation](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abenabap.htm) →  [ABAP - Programming Guidelines](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abenabap_pgl.htm) →  [Robust ABAP](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abenrobust_abap_gdl.htm) →  [Internal Tables](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abenitab_gdl.htm) → 

 [![](Mail.gif?object=Mail.gif&sap-language=EN "Feedback mail for displayed topic") Mail Feedback](mailto:f1_help@sap.com?subject=Feedback on ABAP Documentation&body=Document: Secondary Key, ABENSECONDARY_KEY_GUIDL, 757%0D%0A%0D%0AError:%0D%0A%0D%0A%0D%0A%0D%0A
Suggestion for improvement:)

Secondary Key

Background   

Secondary keys can be declared for internal tables. The following options are possible:

-   Sorted keys (non-unique or unique)
-   Hash keys that can only be unique

These keys are assigned a name when they are declared and can be created for any table category. The primary key (nameless up to this point) is assigned a predefined name (primary\_key), which allows it to be explicitly addressed. A secondary table index is created internally for each sorted secondary key. This enables index access to hashed tables. When internal tables are accessed, a table key or index must be specified. If nothing is explicitly specified, the internal table is accessed using the primary key or primary index by default.

Access to internal tables using secondary keys is always optimized. This generally increases read performance significantly. Previously, no optimized key access was possible for this. On the other hand, secondary keys also incur additional administration costs due to memory consumption and runtime. Additional runtime costs arise, if a secondary table index needs to be updated after changes to table content. The ABAP runtime framework delays these runtime costs for as long as possible, until they are actually required (lazy update and delayed update). The [administration costs](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abenadmin_costs_dyn_mem_obj_guidl.htm "Guideline") for a secondary key are just as high as for the primary table keys: on average, 6 bytes for each secondary index line and 18 or 30 bytes for each hash key line. On average, another 8 bytes per line are required if the table has at least one non-unique sorted secondary key. Additional memory costs are incurred if a secondary key needs to be updated after changes to internal table content. These memory costs are on the same scale as the costs above and also depend on the number of lines.

Rule   

Use secondary keys in a way that benefits the table.

Use secondary keys sparingly and only in cases where the benefits outweigh the extra costs.

Details   

The internal management of secondary keys in an internal table can involve significant memory consumption and updates. Secondary keys are useful for accelerating reads in the following cases:

-   The standard scenario for the profitable use of secondary table keys is a very large internal table that is filled once and the content is changed very infrequently. In this case, runtime costs for secondary key administration are only incurred when the internal table is created and in a few other rare situations. These costs are more than outweighed by more efficient, more frequent reads.
-   Secondary keys might be useful for small internal tables in some circumstances because they ensure unique table entries in relation to particular components. This justifies the extra costs for the secondary key. This applies to standard tables in particular, whose primary keys can never be unique.

When using secondary keys, remember:

-   As a matter of principle, secondary hash keys should not have too many components. Otherwise, the system has to deal with a high system load caused by the additional hash management. Sorted keys are preferable for secondary keys with a large number of components. The same applies to primary keys.
-   In the case of read-only access where unique table entries are not relevant, non-unique secondary keys are usually sufficient. Read access is either just as fast or if duplicate entries exist almost as fast as for unique keys. Updates are only performed after table modifications if necessary.
-   If index table lines are deleted using secondary key accesses, the primary index of the table must be updated. This cannot be optimized for standard tables; a linear search needs to be performed instead.

Secondary table keys should not be used in the following situations:

-   For small internal tables (less than 50 lines), the performance gain for reads is greatly outweighed by the increased memory and administration costs.
-   In tables where a large number of writes are performed, the load incurred by updating the secondary keys outweighs the performance benefits in the case of reads. Delayed updates and lazy updates in particular can incur update costs for exactly those reads for which the optimization was actually intended. This results in either no gain or a negative gain.

Hints

-   It is relatively easy to provide secondary keys later on for existing internal table types in ABAP programs, especially for table types that are defined in ABAP Dictionary. It must be remembered that the secondary key of an internal table, unlike database access, must be specified at the position where it was used, so that it can be evaluated. In these cases, only non-unique sorted keys are usually defined, otherwise programs that use tables of this type and fill these tables with non-unique lines based on these components will no longer function properly.
-   Note that the sy-tabix system field is populated by the assigned secondary index, if sorted secondary keys are used. If this value is used for the subsequent index access to the internal table, the same table index must be explicitly used here. If used implicitly, the value would be interpreted as a primary index.

Bad Example

In the following source code, a large hashed table is accessed using a free key, which does not correspond to the primary key of the table. Therefore, a linear search is required for this access. This is very time-intensive.

DATA itab TYPE HASHED TABLE OF dbtab
  WITH UNIQUE KEY col1 col2 ...
  "fill itab with a large amount of data
  ...
READ TABLE itab
           WITH KEY col3 = ... col4 = ...
           ASSIGNING ...

Good Example

The following source code optimizes the above example by adding a secondary table key to the table declaration and replacing the use of the free key during access. Sequential processing in the order defined with this key is now also possible.

DATA itab TYPE HASHED TABLE OF dbtab
  WITH UNIQUE KEY col1 col2 ...
  WITH NON-UNIQUE SORTED KEY second\_key
    COMPONENTS col3 col4 ...
  "fill itab with a large amount of data
  ...
ASSIGN itab\[ KEY second\_key
             COMPONENTS col3 = ... col4 = ... \]
             TO ...
...
LOOP AT itab USING KEY second\_key.
...
ENDLOOP.


### abeninitial_memory_requ_guidl.htm

---
title: "Initial Memory Requirement"
description: |
  Background Internal tables are stored in the memory block by block. The ABAP runtime framework allocates a suitable memory area for the data of the table by default as the initial memory requirement(https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abeninitial_mem_req_glosry.htm 'Glossary
version: "7.57"
category: "ui"
type: "abap-reference"
sourceUrl: "https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abeninitial_memory_requ_guidl.htm"
abapFile: "abeninitial_memory_requ_guidl.htm"
keywords: ["do", "if", "try", "class", "data", "types", "internal-table", "abeninitial", "memory", "requ", "guidl"]
---

* * *

AS ABAP Release 757, ©Copyright 2023 SAP SE. All rights reserved.

[ABAP - Keyword Documentation](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abenabap.htm) →  [ABAP - Programming Guidelines](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abenabap_pgl.htm) →  [Robust ABAP](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abenrobust_abap_gdl.htm) →  [Internal Tables](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abenitab_gdl.htm) → 

 [![](Mail.gif?object=Mail.gif&sap-language=EN "Feedback mail for displayed topic") Mail Feedback](mailto:f1_help@sap.com?subject=Feedback on ABAP Documentation&body=Document: Initial Memory Requirement, ABENINITIAL_MEMORY_REQU_GUIDL, 757%0D%0A%0D%0AError:%0D%0
A%0D%0A%0D%0A%0D%0ASuggestion for improvement:)

Initial Memory Requirement

Background   

Internal tables are stored in the memory block by block. The ABAP runtime framework allocates a suitable memory area for the data of the table by default as the [initial memory requirement](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abeninitial_mem_req_glosry.htm "Glossary Entry"). If the initial memory requirement is insufficient, further blocks are created using an internal duplication strategy until a threshold is reached. After this, all blocks are requested with a constant size between eight and 16 kilobytes.

The [INITIAL SIZE](abaptypes_itab.htm#!ABAP_ONE_ADD@1@) addition can be used to predefine a number of table lines when declaring an internal table, to override the number of initially allocated lines set by the system.

Rule   

Modify the initial memory requirement only for nested tables

Only use the INITIAL SIZE addition for the declaration of inner tables in nested tables if you can avoid using a large amount of memory unnecessarily.

Details   

The INITIAL SIZE addition is not necessary for external or non-nested tables since the automatic memory location by the runtime framework leads to the required result. Automatic memory allocation only results in excessive memory consumption in nested inner tables if more memory is allocated for a number of inner tables than they actually use. If the number of entries in the inner tables is known from the outset, the initial main memory requirement can be set accordingly using INITIAL SIZE.

Hint

Instance attributes of classes that are declared as inner tables can also be considered as nested tables. If many instances of a class with tabular attributes are expected, it can be useful to specify INITIAL SIZE.

Bad Example

The following source text shows the declaration of a nested table, where the initial memory requirement is specified incorrectly for the outer large table, not the inner small table.

TYPES small\_table TYPE STANDARD TABLE OF ...
  WITH NON-UNIQUE KEY ...
TYPES: BEGIN OF line\_structure,
         ...
         int\_table TYPE small\_table,
         ...
       END OF line\_structure,
       big\_table TYPE SORTED TABLE OF line\_structure
                 WITH UNIQUE KEY ...
                 INITIAL SIZE 10000.

Good Example

The following source text shows the declaration of a nested table, where the initial memory requirement is specified according to the above rule: for the inner small table and not the outer large table.

TYPES small\_table TYPE STANDARD TABLE OF ...
  WITH NON-UNIQUE KEY ...
  INITIAL SIZE 4.
TYPES: BEGIN OF line\_structure,
         ...
         int\_table TYPE small\_table,
         ...
       END OF line\_structure,
       big\_table TYPE SORTED TABLE OF line\_structure
                 WITH UNIQUE KEY ...


### abensort_guidl.htm

---
title: "Sorted Filling"
description: |
  Background The statement APPEND for attaching lines to an internal table has the addition SORTED BY. This addition can be used to fill a standard table by using sorted filling. The prerequisites are: -   A value greater than zero must be specified for the addition INITIAL SIZE(https://help.sap.com
version: "7.57"
category: "general"
type: "abap-reference"
sourceUrl: "https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abensort_guidl.htm"
abapFile: "abensort_guidl.htm"
keywords: ["loop", "do", "if", "data", "internal-table", "abensort", "guidl"]
---

* * *

AS ABAP Release 757, ©Copyright 2023 SAP SE. All rights reserved.

[ABAP - Keyword Documentation](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abenabap.htm) →  [ABAP - Programming Guidelines](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abenabap_pgl.htm) →  [Robust ABAP](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abenrobust_abap_gdl.htm) →  [Internal Tables](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abenitab_gdl.htm) → 

 [![](Mail.gif?object=Mail.gif&sap-language=EN "Feedback mail for displayed topic") Mail Feedback](mailto:f1_help@sap.com?subject=Feedback on ABAP Documentation&body=Document: Sorted Filling, ABENSORT_GUIDL, 757%0D%0A%0D%0AError:%0D%0A%0D%0A%0D%0A%0D%0ASuggesti
on for improvement:)

Sorted Filling

Background   

The statement APPEND for attaching lines to an internal table has the addition SORTED BY. This addition can be used to fill a standard table by using sorted filling. The prerequisites are:

-   A value greater than zero must be specified for the addition [INITIAL SIZE](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abeninitial_memory_requ_guidl.htm "Guideline").
-   Only the statement APPEND with the addition SORTED BY can be used to fill the internal table.

Once these prerequisites have been met, a ranking list is created that contains at most the same number of lines as specified with INITIAL SIZE. This list is sorted by the component specified after SORTED BY in descending order.

Rule   

Create ranking lists with unsorted filling

Do not use the addition SORTED BY of the statement APPEND to create ranking lists. Use the statement SORT instead.

Details   

If the statement APPEND is used with the addition SORTED BY, you cannot simply append lines (contrary to what the name implies). Instead, a complicated process is started that only creates a ranking list if specific prerequisites are met. Otherwise incomprehensible results are returned. In addition, it is not possible to sort by more than one column.

The statement SORT is more robust, more powerful and easier to comprehend when used in this scenario.

Bad Example

The following source code shows how to create a ranking list of the ten longest distances from a table of flight connections, by using the rule APPEND SORTED BY. This rule is no longer recommended, as described above. When declaring the ranking list table, you need to specify the addition INITIAL SIZE.

...
DATA distance\_list TYPE TABLE OF spfli-distance
                   INITIAL SIZE 10.
FIELD-SYMBOLS <spfli\_wa> LIKE LINE OF spfli\_tab.
...
LOOP AT spfli\_tab ASSIGNING <spfli\_wa>.
  APPEND <spfli\_wa>-distance TO distance\_list
    SORTED BY table\_line.
ENDLOOP.
...

Good Example

The following source code shows how to create the same ranking list in the previous example, but using the more robust statement SORT.

...
DATA distance\_list TYPE TABLE OF spfli-distance.
FIELD-SYMBOLS <spfli\_wa> LIKE LINE OF spfli\_tab.
...
SORT spfli\_tab BY distance DESCENDING.
LOOP AT spfli\_tab TO 10 ASSIGNING <spfli\_wa>.
  APPEND <spfli\_wa>-distance TO distance\_list.
ENDLOOP.
...


### abencollect_guidl.htm

---
title: "Collected Filling"
description: |
  Background The statement COLLECT can be used to collect lines and insert them in an internal table. If a line with the relevant primary key already exists in the target table, the values of numeric components are added to the values in the existing table line. Otherwise, a new line is inserted in th
version: "7.57"
category: "general"
type: "abap-reference"
sourceUrl: "https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abencollect_guidl.htm"
abapFile: "abencollect_guidl.htm"
keywords: ["insert", "do", "if", "internal-table", "abencollect", "guidl"]
---

* * *

AS ABAP Release 757, ©Copyright 2023 SAP SE. All rights reserved.

[ABAP - Keyword Documentation](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abenabap.htm) →  [ABAP - Programming Guidelines](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abenabap_pgl.htm) →  [Robust ABAP](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abenrobust_abap_gdl.htm) →  [Internal Tables](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abenitab_gdl.htm) → 

 [![](Mail.gif?object=Mail.gif&sap-language=EN "Feedback mail for displayed topic") Mail Feedback](mailto:f1_help@sap.com?subject=Feedback on ABAP Documentation&body=Document: Collected Filling, ABENCOLLECT_GUIDL, 757%0D%0A%0D%0AError:%0D%0A%0D%0A%0D%0A%0D%0ASu
ggestion for improvement:)

Collected Filling

Background   

The statement COLLECT can be used to collect lines and insert them in an internal table. If a line with the relevant primary key already exists in the target table, the values of numeric components are added to the values in the existing table line. Otherwise, a new line is inserted in the table.

Rule   

Do not fill standard tables with collections of lines

Only use the statement COLLECT for hashed tables or sorted tables with a unique key. Do not use it any more for standard tables.

Details   

The statement COLLECT is based on unique entries with respect to the primary key and stable key administration. This means that not all categories of internal tables are suitable for COLLECT:

-   If the statement COLLECT is applied to a standard table, this table first needs its own internal hash administration. Change operations on the table can invalidate this temporary hash administration. After a change operation of this type, the following COLLECT statements must resort to a linear search, which can affect performance considerably. The primary key of a standard table is also never unique.
-   COLLECT can be used for sorted tables and hashed tables without any problems since these, unlike standard tables, always have a separate, stable key administration that can be utilized by COLLECT. COLLECT can work properly for sorted tables only if the primary key is unique. If a sorted table has a non-unique key, only COLLECT can be used to fill the table, which is difficult to guarantee. In hashed tables, the key values are always unique.


### abentable_output_guidl.htm

---
title: "Target Area"
description: |
  Background Internal tables can be read by accessing individual lines using READ TABLE or table expressions(https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abentable_expression_glosry.htm 'Glossary Entry'), or sequentially using LOOP AT. In both cases, the following output behavior can b
version: "7.57"
category: "general"
type: "abap-reference"
sourceUrl: "https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abentable_output_guidl.htm"
abapFile: "abentable_output_guidl.htm"
keywords: ["select", "insert", "loop", "do", "if", "case", "try", "data", "internal-table", "field-symbol", "abentable", "output", "guidl"]
---

* * *

AS ABAP Release 757, ©Copyright 2023 SAP SE. All rights reserved.

[ABAP - Keyword Documentation](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abenabap.htm) →  [ABAP - Programming Guidelines](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abenabap_pgl.htm) →  [Robust ABAP](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abenrobust_abap_gdl.htm) →  [Internal Tables](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abenitab_gdl.htm) → 

 [![](Mail.gif?object=Mail.gif&sap-language=EN "Feedback mail for displayed topic") Mail Feedback](mailto:f1_help@sap.com?subject=Feedback on ABAP Documentation&body=Document: Target Area, ABENTABLE_OUTPUT_GUIDL, 757%0D%0A%0D%0AError:%0D%0A%0D%0A%0D%0A%0D%0ASug
gestion for improvement:)

Target Area

Background   

Internal tables can be read by accessing individual lines using READ TABLE or [table expressions](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abentable_expression_glosry.htm "Glossary Entry"), or sequentially using LOOP AT. In both cases, the following output behavior can be defined by using the statements with the following additions:

-   The addition INTO copies the content of the line to an appropriate data object.
-   The addition ASSIGNING assigns the read line to a [field symbol](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abendyn_access_data_obj_guidl.htm "Guideline"), which enables the line to be addressed directly.
-   The REFERENCE INTO addition sets a [data reference](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abendyn_access_data_obj_guidl.htm "Guideline") to the read line.

In the case of [table expressions](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abentable_expressions.htm), the output behavior is controlled by the [category of the result](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abentable_exp_result.htm).

As well as for exports, the ASSIGNING and REFERENCE INTO additions can also be used for the APPEND, COLLECT, INSERT, and MODIFY statements, where they create references to the line being processed.

Rule   

Choose appropriate output behavior

When reading lines of internal tables, select an appropriate output behavior. The rule of thumb is:

-   Copy to a work area if the line type is narrow and the read line is not to be modified.
-   Assign to a field symbol if the line type is wide or deep and the read line is to be modified.
-   Set a data reference if the line type is wide or deep and a reference to the read line is to be passed.

Details   

The criteria for selecting the output behavior are the processing speed, on the one hand, and what is to be done with the read line, on the other hand:

-   If the content of the read line is to be modified, the addition ASSIGNING or (in the case of table expressions) the appropriate [result](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abentable_exp_result.htm) should usually be used. This allows direct access to the line using the value semantics and removes the need for a MODIFY operation later on.
-   If a reference to the read line is required that can be processed using reference semantics, the addition REFERENCE INTO or (in the case of table expressions) the appropriate [result](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abentable_exp_result.htm) is to be used.
-   If the content of the read line is not to be modified, any of these procedures can be used. The line type of the table is significant for performance. If the table line is wide or contains deep components (for example, strings or other tables), reads are usually faster if ASSIGNING or REFERENCE INTO is used instead of INTO. The [way they are used](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abendyn_access_data_obj_guidl.htm "Guideline") is the determining factor for selecting which of the two should be used.
    
    When working with tables whose lines are flat and do not occupy more than approximately 1KB, copying with INTO is faster (at least for the READ statement) than configuring the administration that is required for dynamic access. For the statement LOOP, these costs are incurred only once, so that using ASSIGNING or REFERENCE INTO is always recommended above a certain number of lines. In contrast, INTO should always be used if the target area is to be modified without this affecting the internal table.
    

Besides the processing speed, it is also important that the source code can be understood. If the recommendations mentioned are kept, reading a table with the addition ASSIGNING (but also REFERENCE INTO) indicates to the reader that the table content is potentially changed. Reading a table with the INTO addition, on the other hand, indicates that the table will not be modified.

For table expressions, the information here applies to the selection of the appropriate [result](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abentable_exp_result.htm).

Bad Example

The following source code shows the assignment of lines of an internal table to a work area with the aim of modifying the read lines. For this modification, however, an additional statement, MODIFY, is required, and two unnecessary copy processes take place for each loop pass.

LOOP AT itab INTO wa.
   ...
   wa = ...
   MODIFY itab FROM wa.
ENDLOOP.

Good Example

The following source code corrects the above example; here, a field symbol is used for direct access to modify the read lines. No unnecessary copy costs are incurred.

LOOP AT itab ASSIGNING <fs>.
   ...
   <fs> = ...
ENDLOOP.


### abenloop_guidl.htm

---
title: "Loop Processing"
description: |
  Background Alongside the statements for processing individual lines in internal tables, other statements can be used to address and modify the entire body of the table. Examples: -   All categories of assignments applying to whole internal tables -   Deleting the whole of an internal table using CLE
version: "7.57"
category: "general"
type: "abap-reference"
sourceUrl: "https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abenloop_guidl.htm"
abapFile: "abenloop_guidl.htm"
keywords: ["select", "loop", "do", "if", "class", "types", "internal-table", "abenloop", "guidl"]
---

* * *

AS ABAP Release 757, ©Copyright 2023 SAP SE. All rights reserved.

[ABAP - Keyword Documentation](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abenabap.htm) →  [ABAP - Programming Guidelines](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abenabap_pgl.htm) →  [Robust ABAP](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abenrobust_abap_gdl.htm) →  [Internal Tables](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abenitab_gdl.htm) → 

 [![](Mail.gif?object=Mail.gif&sap-language=EN "Feedback mail for displayed topic") Mail Feedback](mailto:f1_help@sap.com?subject=Feedback on ABAP Documentation&body=Document: Loop Processing, ABENLOOP_GUIDL, 757%0D%0A%0D%0AError:%0D%0A%0D%0A%0D%0A%0D%0ASuggest
ion for improvement:)

Loop Processing

Background   

Alongside the statements for processing individual lines in internal tables, other statements can be used to address and modify the entire body of the table. Examples:

-   All categories of assignments applying to whole internal tables
-   Deleting the whole of an internal table using CLEAR or FREE
-   Operations in target ranges such as SELECT INTO TABLE

These types of accesses to the table body cause problems by producing a loop across the internal table

Rule   

Do not modify the entire table body in a loop

You cannot use a loop across an internal table to perform accesses to the table that modify the entire table body at once.

Details   

A modifying access to the entire table body usually produces a runtime error and at the very least unpredictable program behavior. If this is known statically, a syntax error occurs within classes. This error also occurs in LOOP statements with a secondary key known statically when the table operations in question are used. Otherwise, the syntax check simply returns a warning for compatibility reasons.

Hints

-   This rule is mainly intended to make you more aware of the problem. If you only work with [ABAP Objects](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abenabap_obj_progr_model_guidl.htm "Guideline") or if no [syntax check warnings](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abensyntax_check_guidl.htm "Guideline") are ignored, the rule above should be met automatically.
-   For more information, see [Changing Internal Tables in a Loop](https://help.sap.com/doc/abapdocu_757_index_htm/7.57/en-US/abenitab_loop_change.htm).


---
