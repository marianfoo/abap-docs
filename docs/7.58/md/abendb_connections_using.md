  

* * *

AS ABAP Release 758, ©Copyright 2024 SAP SE. All rights reserved.

[ABAP - Keyword Documentation](javascript:call_link\('abenabap.htm'\)) →  [ABAP - Programming Language](javascript:call_link\('abenabap_reference.htm'\)) →  [Processing External Data](javascript:call_link\('abenabap_language_external_data.htm'\)) →  [ABAP Database Access](javascript:call_link\('abendb_access.htm'\)) →  [Database Connections](javascript:call_link\('abendb_connections.htm'\)) → 

 [![](Mail.gif?object=Mail.gif "Feedback mail for displayed topic") Mail Feedback](mailto:f1_help@sap.com?subject=Feedback%20on%20ABAP%20Documentation&body=Document:%20Database%20Access%20Using%20Secondary%20Connections%20and%20Service%20Connections%2C%20ABENDB_CONNECTIONS_USING%2C%20758%0D%0A%0D%0AError:%0D%0A%0D%0A%0D%0A%
0D%0ASuggestion%20for%20improvement:)

Database Access Using Secondary Connections and Service Connections

Secondary connections and service connections are opened and used in different ways in ABAP SQL, Native SQL, and AMDP. A secondary or service connection active for an internal session can be shared by ABAP SQL, Native SQL, or AMDP. Connections used by ABAP SQL, however, cannot have any lowercase letters in their names and ADBC can reserve connections for itself exclusively.

-   [ABAP SQL](#abendb-connections-using-1-------native-sql---adbc---@ITOC@@ABENDB_CONNECTIONS_USING_2)
-   [Native SQL - EXEC SQL](#abendb-connections-using-3-------amdp---@ITOC@@ABENDB_CONNECTIONS_USING_4)
-   [Shared ABAP Connections](#abendb-connections-using-5---abap-sql-----the-following-additions-can-be-used-to-use-a-database-connection-other-than-the--standard-connection--javascript-call-link---abenstandard-db-connection-glosry-htm-----glossary-entry---in-abap-sql-------the-addition--connection--javascript-call-link---abapselect-connection-htm-----for-read-statements-----the-identical-addition--connection--javascript-call-link---abapiumd-conn-htm-----for-write-statements--if-the-addition-connection-is-specified-using-the-name-of-a--secondary-connection--javascript-call-link---abensecondary-db-connection-glosry-htm-----glossary-entry---from-the-database-table-dbcon-or-using-the-name-of-a--service-connection--javascript-call-link---abenservice-connection-glosry-htm-----glossary-entry---in-an-abap-sql-statement--the-following-applies-------if-the-specified-connection-is-not-yet-active-in-the-current--internal-session--javascript-call-link---abeninternal-session-glosry-htm-----glossary-entry----it-is-either-opened-and-given-the-state-active-or--if-an-open-inactive-connection-exists-for-the-current-work-process--it-is-reused-and-set-to-active--when-the-connection-is-activated--a--database-luw--javascript-call-link---abendatabase-luw-glosry-htm-----glossary-entry---is-opened-for-it-and-this-can-be-used-by-abap-sql--native-sql--or-amdp------if-the-specified-connection-is-already-active-in-the-current--internal-session--javascript-call-link---abeninternal-session-glosry-htm-----glossary-entry----the-abap-sql-statement-uses-this-connection-and-works-in-its--database-luw--javascript-call-link---abendatabase-luw-glosry-htm-----glossary-entry----the-connection-can-be-activated-using-abap-sql--native-sql--or-amdp---when-a--secondary-connection--javascript-call-link---abensecondary-db-connection-glosry-htm-----glossary-entry---is-used--an-abap-sql-statement-only-accesses-the--database-schema--javascript-call-link---abendatabase-schema-glosry-htm-----glossary-entry---assigned-to-the--database-user-name--javascript-call-link---abendatabase-user-name-glosry-htm-----glossary-entry---assigned-to-the-secondary-connection--abap-sql-can-only-access-database-tables-and-views-that-are-defined-in-the--abap-dictionary--javascript-call-link---abenabap-dictionary-glosry-htm-----glossary-entry---in-the-current-as-abap--which-means-that-every-database-table-or-view-accessed-using-a--secondary-connection--javascript-call-link---abensecondary-db-connection-glosry-htm-----glossary-entry---must-exist-and-be-active-as-a-database-or-view-with-the-same-name-and-matching-ddic-structure-in-the-current-as-abap--regardless-of-the--secondary-database--javascript-call-link---abensecondary-db-glosry-htm-----glossary-entry---and-database-schema--for-the-database-tables-or-views-of-the-secondary-database--abap-sql-assumes-that-their--table-category--javascript-call-link---abenddic-database-tables-tab-cat-htm-----and-type-information-matches-the-local-definition-exactly--this-prerequisite-is-essential--for-example--for-the-correct-interpretation-of-the-database-content-and--if-necessary--their-conversion-with-respect-to-the-abap-types-of-the-target-fields--if-this-prerequisite-is-not-met--incorrect-data-or-runtime-errors-can-be-caused-by-reads-or-writes-depending-on-the-database-system--because-the-abap-runtime-framework-cannot-ensure-the-consistency-of-the-type-descriptions-in-the-local-and-remote-databases--the-consistency-must-be-guaranteed-by-the-relevant-application-program---the-name-of-a--secondary-connection--javascript-call-link---abensecondary-db-connection-glosry-htm-----glossary-entry---or--service-connection--javascript-call-link---abenservice-connection-glosry-htm-----glossary-entry---specified-after-connection-is-transformed-into-uppercase-letters-internally--this-must-be-respected-when-native-sql-accesses-the-connection-explicitly--conversely--an-abap-sql-statement-can-reuse-database-connections-active-in-native-sql-or-amdp-only-if-their-names-do-not-contain-any-lowercase-letters---hints------the-type-of-a-database-object-specified-in-an-abap-sql-statement-using-the-addition-connection-does-not-necessarily-need-to-match-the-type-of-the-database-object-with-the-same-name-in-the-secondary-database--for-example--a-view-with-the-same-name-in-the-secondary-database-can-be-accessed-by-specifying-a-database-table-and-vice-versa-if-they-have-the-same-structure------if-a-database-table-specified-using-the-addition-connection-in-an-abap-sql-statement-is-a--global-temporary-table--gtt---javascript-call-link---abenglobal-temporary-table-glosry-htm-----glossary-entry----it-is-handled-like-a-gtt--even-if-it-is-a-regular-transparent-table-in-the-secondary-database--conversely--there-is-no-special-handling-in-abap-sql-if-the-database-is-a-gtt-on-the-secondary-database-only------the-prerequisite-that-an-identically-named-database-object-with-a-suitable-ddic-structure-must-exist-in-the-current-system-for-views-accessed-using-a-secondary-connection-is-particularly-important-for--ddic-external-views--javascript-call-link---abenexternal-view-glosry-htm-----glossary-entry-----example--specification-of-a-database-connection-in-abap-sql---final-conn----conv-dbcon-con--name-------------delete-from-demo--update-connection--conn----native-sql---adbc-----to-use-a-database-connection-other-than-the--standard-connection--javascript-call-link---abenstandard-db-connection-glosry-htm-----glossary-entry---in--adbc--javascript-call-link---abenadbc-glosry-htm-----glossary-entry----the-static-method--get--abap--connection--javascript-call-link---abencl-sql-connection-htm-----of-the-class-cl--sql--connection-can-be-used--the-return-value-of-the-method-is-a-reference-to-a-connection-object-that-can-be-passed-to-other-adbc-objects--using-the-input-parameter-con--name--the-method-can-be-passed-the-name-of-a--secondary-connection--javascript-call-link---abensecondary-db-connection-glosry-htm-----glossary-entry---from-the-database-table-dbcon-or-a--service-connection--javascript-call-link---abenservice-connection-glosry-htm-----glossary-entry----these-names-are-case-sensitive--the-activated-connection-is-an--abap-connection--javascript-call-link---abenabap-connection-glosry-htm-----glossary-entry---that-can-be-used-in-abap-sql--native-sql--and-amdp--a-further-method--get--connection--javascript-call-link---abencl-sql-connection-htm-----works-in-a-similar-way-to-get--abap--connection--but-has-an-additional-input-parameter-sharable--which-activates-an-exclusive-connection-if-its-default-parameter-abap--false-is-used-------get--abap--connection-or-get--connection-with-abap--true-passed-to-sharable-for-shared--abap-connections--javascript-call-link---abenabap-connection-glosry-htm-----glossary-entry------------if-the-connection-passed-to-con--name-is-not-yet-active-in-the-current--internal-session--javascript-call-link---abeninternal-session-glosry-htm-----glossary-entry----it-is-either-opened-and-set-to-active-or--if-an-open-inactive-connection-exists-for-the-current-work-process--it-is-reused-and-set-to-active--when-the-connection-is-activated--a--database-luw--javascript-call-link---abendatabase-luw-glosry-htm-----glossary-entry---is-opened-for-it----------if-the-connection-passed-to-con--name-is-already-active-in-the-current--internal-session--javascript-call-link---abeninternal-session-glosry-htm-----glossary-entry----this-connection-and-its--database-luw--javascript-call-link---abendatabase-luw-glosry-htm-----glossary-entry---are-used--the-connection-can-be-activated-using-abap-sql--native-sql--or-amdp------get--connection-with-abap--false-passed-to-sharable--default--for-exclusive-connections-----------a-new-connection-is-always-activated-for-the-current--internal-session--javascript-call-link---abeninternal-session-glosry-htm-----glossary-entry---by-opening-a-new-connection-or-activating-an-inactive-connection-of-the-current-work-process--no-existing-active-connection-of-the-name-passed-to-con--name-is-used--a-connection-activated-like-this-can-only-be-used-exclusively-using-the-returned-connection-object-in-adbc--------after-successful-execution--get--connection-gets-a-reference-to-a-connection-object--the-connection-object-represents-the-connection-activated-or-reused-using-get--connection-in-adbc-and-can-be-passed-to-the-instance-constructors-of-the-classes-cl--sql--statement-and-cl--sql--prepared--statement--the-sql-statements-of-these-classes-are-then-executed-on-this-connection-in-its-database-luw---hints------abap--false-can-be-used-for-the-parameter-sharable-of-the-method-get--connection-to-control-the-use-of-a-database-connection-and-its-database-luw-explicitly--database-connections-that-are-activated-differently-are-usually-available-to-all-accesses-in-abap-sql-and-native-sql------if-abap--false-is-passed-to-the-parameter-sharable-of-the-method-get--connection--multiple-database-connections-with-the-same-name-can-be-activated-and-used-within-a-single-internal-session--these-are-indicated-in-the-output-of-the-program-dbconinfo-by-the-different-values-in-the-column-hdl------when-opening-exclusive-connections-for-connection-objects--the-maximum-number-of-connections-for-each-work-process-must-not-be-exceeded--exclusive-connection-should-be-closed-explicitly-once-they-are-no-longer-needed-and-if-there-are-a-large-number-of-connection-objects---example--specification-of-a-database-connection-in-adbc---final-conn----conv-dbcon-con--name-------------try------new-cl--sql--statement--------con--ref---cl--sql--connection--get--abap--connection--------------------con--name---conn----------------------execute--update----delete-from-demo--update--------catch-cx--sql--exception----------endtry---native-sql---exec-sql-----the-following-special-statements-can-be-used-to-use-a-database-connection-other-than-the--standard-connection--javascript-call-link---abenstandard-db-connection-glosry-htm-----glossary-entry---in-native-sql-embedded-between--exec-sql--javascript-call-link---abapexec-htm-----and--endexec--javascript-call-link---abapendexec-htm-----------connect-to--javascript-call-link---abapexec-connection-htm----------set-connection--javascript-call-link---abapexec-connection-htm------the-statement--connect-to--javascript-call-link---abapexec-connection-htm-----can-be-used-to-activate-a--secondary-connection--javascript-call-link---abensecondary-db-connection-glosry-htm-----glossary-entry---or-a--service-connection--javascript-call-link---abenservice-connection-glosry-htm-----glossary-entry----here--the-addition-as-can-be-used-to-open-the-same-connection-more-than-once-under-different-names--the-entries-made-here-are-case-sensitive-------if-no-name-is-specified-using-as--the-following-applies----------if-the-connection-specified-after-connect-to-is-not-yet-active-in-the-current--internal-session--javascript-call-link---abeninternal-session-glosry-htm-----glossary-entry----it-is-either-opened-and-set-to-active-or--if-an-open-inactive-connection-exists-for-the-current-work-process--it-is-reused-and-set-to-active--when-the-connection-is-activated--a--database-luw--javascript-call-link---abendatabase-luw-glosry-htm-----glossary-entry---is-opened-for-it-and-this-can-be-used-by-abap-sql--native-sql--and-amdp----------if-the-connection-specified-after-con--name-is-already-active-in-the-current--internal-session--javascript-call-link---abeninternal-session-glosry-htm-----glossary-entry----this-connection-and-its--database-luw--javascript-call-link---abendatabase-luw-glosry-htm-----glossary-entry---are-reused--the-connection-can-be-activated-using-abap-sql--native-sql--or-amdp------if-a-name-is-specified-using-as--the-following-applies----------if-the-connection-specified-after-connect-to-is-not-yet-active-under-this-name-in-the-current--internal-session--javascript-call-link---abeninternal-session-glosry-htm-----glossary-entry----it-is-either-opened-and-set-to-active-or--if-an-open-inactive-connection-exists-for-the-current-work-process--it-is-reused-and-given-the-state-active--when-the-connection-is-activated--a--database-luw--javascript-call-link---abendatabase-luw-glosry-htm-----glossary-entry---is-opened-for-it--a-connection-with-a-name-defined-using-as-is-only-used-by-native-sql-embedded-between--exec-sql--javascript-call-link---abapexec-htm-----and--endexec--javascript-call-link---abapendexec-htm------abap-sql-and-other-kinds-of-native-sql-or-amdp-do-not-use-this-type-of-connection----------if-the-connection-specified-after-con--name-is-already-active-under-this-name-in-the-current--internal-session--javascript-call-link---abeninternal-session-glosry-htm-----glossary-entry----this-connection-and-its--database-luw--javascript-call-link---abendatabase-luw-glosry-htm-----glossary-entry---are-reused--the-connection-can-only-have-been-activated-using-connect-to---after-the-statement-connect-to--all-subsequent-native-sql-statements-embedded-between--exec-sql--javascript-call-link---abapexec-htm-----and--endexec--javascript-call-link---abapendexec-htm-----in-the-current-internal-session-use-the-connection-activated-or-reused-using-connect-to--the-statement--set-connection--javascript-call-link---abapexec-connection-htm-----can-be-used-to-switch-to-the-use-of-the-previously-activated-connection-of-the-current-internal-session--here--a-name-defined-with-as-must-be-specified-using-this-connection--more-specifically--the--standard-connection--javascript-call-link---abenstandard-db-connection-glosry-htm-----glossary-entry---can-be-activated-by-specifying-default--the-statement-set-connection-is-ignored-by-the-database-luws-of-the-connections-involved---hint--when-a-name-is-specified-after-as-in-the-statement-connect-to--multiple-database-connections-with-the-same-original-name-can-be-activated-and-used-in-the-same-internal-session--these-are-indicated-in-the-output-of-the-program-dbconinfo-by-the-different-values-in-the-column-hdl---example--specification-of-a-database-connection-after-exec-sql---final-conn----conv-dbcon-con--name-------------exec-sql----connect-to--conn-endexec--exec-sql----delete-from-demo--update-endexec---amdp-----to-use-a-database-connection-other-than-the--standard-connection--javascript-call-link---abenstandard-db-connection-glosry-htm-----glossary-entry---to-execute-an--amdp-procedure-implementation--javascript-call-link---abenamdp-procedure-method-glosry-htm-----glossary-entry----the-names-of--service-connections--javascript-call-link---abenservice-connection-glosry-htm-----glossary-entry---can-be-passed-to-the-input-parameter--connection--javascript-call-link---abenamdp-db-connections-htm-----of-the-associated--amdp-method--javascript-call-link---abenamdp-method-glosry-htm-----glossary-entry----the-names-are-case-sensitive-here---secondary-connections--javascript-call-link---abensecondary-db-connection-glosry-htm-----glossary-entry---cannot-be-used-------if-the-passed-connection-is-not-yet-active-in-the-current--internal-session--javascript-call-link---abeninternal-session-glosry-htm-----glossary-entry----it-is-either-opened-and-set-to-active-or--if-an-open-inactive-connection-exists-for-the-current-work-process--it-is-reused-and-set-to-active--when-the-connection-is-activated--a--database-luw--javascript-call-link---abendatabase-luw-glosry-htm-----glossary-entry---is-opened-for-it-and-this-can-be-used-by-abap-sql--native-sql--and-amdp------if-the-specified-connection-is-already-active-in-the-current--internal-session--javascript-call-link---abeninternal-session-glosry-htm-----glossary-entry----the-procedure-implementation-is-called-using-this-connection-and-works-in-its--database-luw--javascript-call-link---abendatabase-luw-glosry-htm-----glossary-entry----the-connection-can-be-activated-using-abap-sql--native-sql--or-amdp---hint--the-service-connections-that-can-be-used-by-amdp-are-also-connections-that-can-be-used-by-abap-sql--native-sql--and-amdp--as-long-as-the-appropriate-conditions-are-met---example--specification-of-a-database-connection-in-amdp---final-conn----conv-dbcon-con--name----r-3-----------try------new-cl--demo--amdp--connection---------------get--scarr--exporting---------------------------connection---conn---------------------------clnt---------sy-mandt-------------------------importing---------------------------carriers---final-result-------catch-cx--amdp--error-into-final-amdp--error-----------endtry---shared-abap-connections-----a-secondary-connection-or-service-connection-active-within-an-internal-session-is-an--abap-connection--javascript-call-link---abenabap-connection-glosry-htm-----glossary-entry---that-is-shared-by-abap-sql--native-sql--and-amdp-with-the-following-exceptions-------a-connection-activated-using-adbc-that-uses-the-value-abap--false-for-the-parameter-sharable-of-the-method-get--connection-of-the-class-cl--sql--connection-can-only-be-used-exclusively-using-the-associated-connection-object------a-connection-activated-after-exec-sql-with-connect-to-using-a-name-specified-after-as-can-only-be-used-between-exec-and-endexec------amdp-can-only-use-service-connections---shared-abap-connections-are-activated-as-follows-------using-the-connection-addition-of-abap-sql-statements-to-activate-the-connection-----using-either-the-method-get--abap--connection-of-the-adbc-class-cl--sql--connection-or-the-method-get--connection-with-the-value-abap--true-for-the-parameter-sharable-to-activate-the-connection------passing-the-name-to-the-input-parameter-connection-of-an-amdp-method-to-activate-the-connection------using-the-statement-connect-to-after-exec-sql-to-activate-the-connection--without-specifying-a-name-after-as---after-a-shared-abap-connection-is-activated--it-is-reused-by-all-following-accesses-from-abap-sql--native-sql--and-amdp-within-the-same-internal-session--regardless-of-how-it-was-activated---shared-abap-connections-can-be-closed-using-native-sql--as-described--here--abendb-connections-mngmnt-htm-@ITOC@@ABENDB_CONNECTIONS_MNGMNT_1). The connection can then no longer be used. When a closed connection is specified in ABAP SQL, it is opened again implicitly. If a closed connection is reused in Native SQL or AMDP an exception is raised.

Hint

When sharing database connections, it should be noted that the name of a database connection is always converted to uppercase letters in ABAP SQL. In Native SQL and AMDP, on the other hand, the name is case-sensitive. To access a database connection activated in ABAP SQL in Native SQL or AMDP, the connection must be specified in uppercase letters. Conversely, an ABAP SQL statement cannot use a database connection activated using Native SQL AMDP if its name contains lowercase letters. This mainly affects [service connections](javascript:call_link\('abenservice_connection_glosry.htm'\) "Glossary Entry") and names defined using the addition AS of the statement [CONNECT TO](javascript:call_link\('abapexec_connection.htm'\)). [Secondary connections](javascript:call_link\('abensecondary_db_connection_glosry.htm'\) "Glossary Entry"), on the other hand, must be specified in uppercase letters in Native SQL too in accordance with their spelling in the table DBCON.

Example

Use of a shared service connection in ADBC and ABAP SQL. The modifying statements are executed in a database LUW. If the name of the service connection were to contain lowercase letters or if the method GET\_CONNECTION with the value abap\_false were used for the parameter SHARABLE in ADBC, separate connections with two different database LUWs would be produced. Accessing the same database table would then usually cause a lock situation.

FINAL(conn) = CONV dbcon-con\_name( \`R/3\*DEMO\` ).
TRY.
    NEW cl\_sql\_statement(
      con\_ref = cl\_sql\_connection=>get\_abap\_connection(
                  con\_name = conn )
                  )->execute\_update( \`DELETE FROM demo\_update\` ).
    INSERT demo\_update CONNECTION (conn)
      FROM @( VALUE #(
        id = 'X'  col1 = 1 col2 = 2 col3 = 3 col4 = 4 ) ).
  CATCH cx\_sql\_exception.
    ...
ENDTRY.